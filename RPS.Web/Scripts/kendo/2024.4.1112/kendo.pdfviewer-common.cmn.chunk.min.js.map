{"version":3,"file":"kendo.pdfviewer-common.cmn.chunk.min.js","names":["global","factory","exports","module","require","define","amd","globalThis","self","kendo","_globals","PdfviewerCommonCmnChunk","DraggableCmnChunk","FileSaverCmnChunk","CommonCmnChunk","PdfjsLoader","DateinputsCommonCmnChunk","this","kendo_draggable_cmn_chunk_js","kendo_fileSaver_cmn_chunk_js","kendo_common_cmn_chunk_js","kendo_pdfjs_loader_js","kendo_dateinputsCommon_cmn_chunk_js","extend","args","Object","assign","isObject","value","Array","isArray","deepExtend","target","sources","length","source","shift","key","Component","HTMLElement","window","DotNet","DotNetObject","buffer","ArrayBuffer","getPrototypeOf","prototype","noop","constructor","element","options","events","destroy","extendOptions","setOptions","trigger","eventName","eventData","defaultPrevented","preventDefault","sender","throttle","func","wait","timeout","context","result","previous","later","leading","Date","getTime","undefined","apply","now","remaining","arguments","clearTimeout","trailing","setTimeout","FRAMES_PER_SECOND$1","SCROLL$1","Scroller","super","filter","panScrollThrottleDelay","scrollDirectionModifier","scrollThrottleDelay","onElementScroll","e","shouldTrackScrollEvents","state","trackNextElementScroll","scrollTo","scrollLeft","scrollTop","originalEvent","onDragStart","dragStarted","shouldTrackPanEvents","selector","closest","matchesElementSelector","setState","location","pageX","pageY","locationDelta","x","y","onDrag","calculateEventLocationDelta","directionModifier","onDragEnd","resetState","bindEvents","unbindEvents","initDraggable","destroyDraggable","throttledOnDrag","draggable","D","mouseOnly","press","drag","release","bindTo","cancel","bindDraggableEvents","bindElementScroll","throttledOnElementScroll","addEventListener","unbindElementScroll","unbindDraggableEvents","removeEventListener","newState","trackPanEvents","trackScrollEvents","enablePanEventsTracking","disablePanEventsTracking","enableScrollEventsTracking","disableScrollEventsTracking","trackScrollEvent","unwrapElement","parentElement","replaceWith","from","childNodes","toClassSelector","className","CHAR_INDEX_DATA_ATTR","MATCH_INDEX_DATA_ATTR","SearchService","highlightClass","highlightMarkClass","charClass","textContainers","clearSearch","text","textNodes","charIndex","activeMatchIndex","matches","escapeRegExp","replace","search","matchCase","escapedText","searchRegex","RegExp","match","shouldTransformText","transformTextForSearch","removeIndicators","exec","push","startOffset","index","endOffset","highlightAllMatches","addActiveMatchMark","restoreOriginalText","forEachTextContainer","textContainer","querySelectorAll","forEach","node","innerHTML","textContent","extractTextNodes","transformTextNodesForSearch","nodeType","Node","TEXT_NODE","i","transformTextNodeForSearch","span","document","createElement","wrapper","parentNode","insertBefore","appendChild","splittedHtml","splitTextByChars","splittedTextHtml","callback","matchIndex","addMatchHighlight","matchStartOffset","matchEndOffset","highlight","classList","add","setAttribute","removeMatchHighlights","remove","removeAttribute","removeActiveMatchMark","mark","firstChild","wrapInnerElement","cloneNode","elements","unwrapElements","flatMap","markNextMatch","markNextMatchIndex","markPreviousMatch","markPreviousMatchIndex","moveActiveMatchIndex","delta","Math","max","getActiveMatchElement","markedMatch","querySelector","Annotation","container","viewport","annotation","pdfDoc","zoom","rootElement","LinkAnnotation","onLinkClick","destination","getAttribute","indexOf","navigateToDestination","linkElement","renderAnnotation","dest","split","getDestination","then","r","getPageIndex","goToPage","pageNumber","scrollToPage","rect","boundingRect","rawHeight","rawDims","pageHeight","left","min","top","width","height","url","encodeURI","annotationElement","position","display","pointerEvents","append","MAX_CANVAS_AREA_CHROME_SAFARI","scale","test","navigator","userAgent","maxTouchPoints","devicePixelRatio","parsePdfFromBase64String","base64String","atob","appendPage","dom","page","removeChild","removeChildren","openPrintDialog","done","onError","printDialog","open","body","style","margin","focus","print","onAfterPrint","close","createEmptyPage","canvasContext","pageElement","styles","createCanvas","renderCanvas","error","scaleNum","canvas","render","promise","printContent","Image","floor","src","toDataURL","onload","catch","name","keys","transforms","renderPage","emptyPage","_pageInfo","renderInProgress","getTextContent","textLayer","TextLayer","textContentSource","rotation","transform","transformOrigin","el","fontSize","prepend","getAnnotations","intent","annotations","annotationLayer","overflow","subtype","rendered","scrollToSearchMatch","matchElement","ref","closestCharElement","closestTextElement","closestPageElement","offsetLeft","scroller","offsetTop","pages","HTMLDivElement","offsetHeight","scrollElement","behavior","currentPage","round","adjustCanvasSize","targetWidth","targetHeight","maxWidth","maxHeight","maxArea","desktopBrowser","d","mobileOS","a","mozilla","browser","isFirefox","safari","adjustedWidth","adjustedHeight","ratio","deltaHeight","adjustedArea","areaRatio","sqrt","adjustRatio","cssClass","getViewport","getContext","adjustedScale","addClass","LINE_FACTOR","AnnotationEditorPrefix","AnnotationEditorType","AnnotationBorderStyleType","shadow","obj","prop","nonSerializable","defineProperty","enumerable","configurable","writable","hexNumbers","n","toString","padStart","Util","makeHexColor","g","b","normalizeRect","slice","AnnotationPrefix","_IdManager_id","_CommandManager_commands","_CommandManager_locked","_CommandManager_maxSize","_CommandManager_position","_AnnotationEditorUIManager_instances","_AnnotationEditorUIManager_abortController","_AnnotationEditorUIManager_activeEditor","_AnnotationEditorUIManager_allEditors","_AnnotationEditorUIManager_allLayers","_AnnotationEditorUIManager_annotationStorage","_AnnotationEditorUIManager_changedExistingAnnotations","_AnnotationEditorUIManager_commandManager","_AnnotationEditorUIManager_currentPageIndex","_AnnotationEditorUIManager_deletedAnnotationsElementIds","_AnnotationEditorUIManager_draggingEditors","_AnnotationEditorUIManager_editorTypes","_AnnotationEditorUIManager_editorsToRescale","_AnnotationEditorUIManager_enableHighlightFloatingButton","_AnnotationEditorUIManager_focusMainContainerTimeoutId","_AnnotationEditorUIManager_focusManagerAC","_AnnotationEditorUIManager_highlightColors","_AnnotationEditorUIManager_highlightWhenShiftUp","_AnnotationEditorUIManager_highlightToolbar","_AnnotationEditorUIManager_idManager","_AnnotationEditorUIManager_isEnabled","_AnnotationEditorUIManager_isWaiting","_AnnotationEditorUIManager_lastActiveElement","_AnnotationEditorUIManager_mode","_AnnotationEditorUIManager_selectedEditors","_AnnotationEditorUIManager_selectedTextNode","_AnnotationEditorUIManager_showAllStates","_AnnotationEditorUIManager_previousStates","_AnnotationEditorUIManager_translation","_AnnotationEditorUIManager_translationTimeoutId","_AnnotationEditorUIManager_container","_AnnotationEditorUIManager_viewer","_AnnotationEditorUIManager_getAnchorElementForSelection","_AnnotationEditorUIManager_getLayerForTextLayer","_AnnotationEditorUIManager_displayHighlightToolbar","_AnnotationEditorUIManager_selectionChange","_AnnotationEditorUIManager_onSelectEnd","_AnnotationEditorUIManager_addSelectionListener","_AnnotationEditorUIManager_addFocusManager","_AnnotationEditorUIManager_removeFocusManager","_AnnotationEditorUIManager_addKeyboardManager","_AnnotationEditorUIManager_removeKeyboardManager","_AnnotationEditorUIManager_addCopyPasteListeners","_AnnotationEditorUIManager_removeCopyPasteListeners","_AnnotationEditorUIManager_addDragAndDropListeners","_AnnotationEditorUIManager_dispatchUpdateStates","_AnnotationEditorUIManager_dispatchUpdateUI","_AnnotationEditorUIManager_enableAll","_AnnotationEditorUIManager_disableAll","_AnnotationEditorUIManager_addEditorToLayer","_AnnotationEditorUIManager_lastSelectedEditor_get","_AnnotationEditorUIManager_isEmpty","_AnnotationEditorUIManager_selectEditors","IdManager","idPrefix","set","_","id","_a","_b","WeakMap","CommandManager","maxSize","cmd","undo","post","mustExec","type","NaN","overwriteIfSameType","keepUndo","save","next","splice","redo","hasSomethingToUndo","hasSomethingToRedo","AnnotationEditorUIManager","viewer","pdfViewer","eventBus","pdfDocument","highlightColors","annotationEditorMode","NONE","viewParameters","isShiftKeyDown","_eventBus","AbortController","Map","Set","isEditing","isEmpty","hasSelectedEditor","hasSelectedText","signal","_signal","_on","onEditingAction","bind","onPageChanging","onScaleChanging","onRotationChanging","onSetPreference","call","annotationStorage","realScale","PixelsPerInch","PDF_TO_CSS_UNITS","abort","layer","values","clear","getTextLayerForAnchor","anchorElement","combinedSignal","abortSignal","AbortSignal","any","direction","getComputedStyle","highlightColorNames","reverse","switchToMode","mode","on","once","dispatch","setPreference","focusMainContainer","findParent","layerX","layerY","div","getBoundingClientRect","disableUserSelect","toggle","addShouldRescale","editor","removeShouldRescale","delete","commitOrRemove","pagesRotation","highlightSelection","methodOfCreation","selection","getSelection","isCollapsed","anchorNode","anchorOffset","focusNode","focusOffset","boxes","getSelectionBoxes","empty","isNoneMode","createAndAddNewEditor","showAllEditors","HIGHLIGHT","showEditorToolBar","anchor","getMode","FREETEXT","hideEditorToolBar","addToAnnotationStorage","has","setValue","blur","hasSelection","activeElement","contains","_focusEventsAllowed","lastEditor","lastActiveElement","addEditListeners","removeEditListeners","dragOver","event","dataTransfer","items","editorType","isHandlingMimeForPasting","dropEffect","drop","item","paste","currentLayer","copy","editors","serialized","serialize","clipboardData","setData","JSON","stringify","cut","data","getData","parse","ex","unselectAll","newEditors","deserializedEditor","deserialize","addCommands","setEditingState","registerEditorTypes","types","defaultPropertiesToUpdate","getId","get","getLayer","pageIndex","currentPageIndex","addLayer","enable","disable","removeLayer","updateMode","editId","isFromKeyboard","annotationElementId","setSelected","enterInEditMode","addNewEditorFromKeyboard","canCreateNewEmptyEditor","addNewEditor","updateToolbar","updateParams","AnnotationEditorParamsType","CREATE","HIGHLIGHT_DEFAULT_COLOR","HIGHLIGHT_SHOW_ALL","updateDefaultParams","visible","show","enableWaiting","mustWait","disableClick","enableClick","getEditors","getEditor","addEditor","removeEditor","unselect","addDeletedAnnotationElement","addChangedExistingAnnotation","deleted","isDeletedAnnotationElement","removeDeletedAnnotationElement","removeChangedExistingAnnotation","setActiveEditor","propertiesToUpdate","updateUI","toggleSelected","select","selectedEditor","isSelected","firstSelectedEditor","size","isEnterHandled","params","hasSomethingToControl","selectAll","commit","translateSelectedEditors","noCommit","totalX","totalY","translateInPage","setUpDragSession","savedX","savedY","savedPageIndex","newX","newY","newPageIndex","endDragSession","map","mustBeAddedInUndoStack","move","parent","_setParentAndPosition","dragSelectedEditors","tx","ty","rebuild","changeParent","addOrRebuild","isActive","getActive","getActiveEditor","ii","rangeCount","getRangeAt","commonAncestorContainer","parentWidth","parentHeight","rotator","w","h","range","collapsed","getClientRects","renderAnnotationElement","editorId","getRawValue","hasBeenModified","WeakSet","hasTextLayer","hide","activeLayer","toggleDrawing","abortController","pointerup","button","details","entries","some","HIGHLIGHT_FREE","ed","TRANSLATE_SMALL","TRANSLATE_BIG","PresentationModeState","ScrollMode","binarySearchFirstItem","condition","start","minIndex","maxIndex","currentIndex","_TextAccessibilityManager_instances","_a$8","_TextAccessibilityManager_enabled","_TextAccessibilityManager_textChildren","_TextAccessibilityManager_textNodes","_TextAccessibilityManager_waitingElements","_TextAccessibilityManager_compareElementPositions","_TextAccessibilityManager_addIdToAriaOwns","_TextLayerBuilder_instances","_a$7","_TextLayerBuilder_onAppend","_TextLayerBuilder_textLayer","_TextLayerBuilder_textLayers","_TextLayerBuilder_selectionChangeAbortController","_TextLayerBuilder_bindMouse","_TextLayerBuilder_removeGlobalSelectionListener","_TextLayerBuilder_enableGlobalSelectionListener","_AnnotationElement_instances","_AnnotationElement_updates","_AnnotationElement_hasBorder","_AnnotationElement_popupElement","_AnnotationElement_setRectEdited","_LinkAnnotationElement_instances","_LinkAnnotationElement_setInternalLink","_PopupElement_instances","_PopupElement_boundKeyDown","_PopupElement_boundHide","_PopupElement_boundShow","_PopupElement_boundToggle","_PopupElement_color","_PopupElement_container","_PopupElement_contentsObj","_PopupElement_dateObj","_PopupElement_elements","_PopupElement_parent","_PopupElement_parentRect","_PopupElement_pinned","_PopupElement_popup","_PopupElement_position","_PopupElement_rect","_PopupElement_richText","_PopupElement_titleObj","_PopupElement_updates","_PopupElement_wasVisible","_PopupElement_html_get","_PopupElement_fontSize_get","_PopupElement_fontColor_get","_PopupElement_makePopupContent","_PopupElement_keyDown","_PopupElement_setPosition","_PopupElement_toggle","_PopupElement_show","_PopupElement_hide","_AnnotationLayer_accessibilityManager","_AnnotationLayer_annotationCanvasMap","TextAccessibilityManager","setTextMapping","textDivs","Error","sort","textChildren","nodeIndex","getElementById","isRemovable","addPointerInTextLayer","removePointerInTextLayer","children","owns","includes","join","console","warn","child","moveElementInDOM","contentElement","hasChildNodes","elementToCompare","before","after","e1","e2","rect1","rect2","top1","bot1","mid1","top2","bot2","mid2","TextLayerBuilder","pdfPage","accessibilityManager","onAppend","tabIndex","viewport_1","textContentParams","_c","update","onBefore","streamTextContent","includeMarkedContent","disableNormalization","markedContentElements","endOfContent","hidden","makeColorComp","scaleAndClamp","end","textLayerDiv","ColorConverters","CMYK_G","c","m","k","G_CMYK","G_RGB","G_rgb","G_HTML","G","RGB_G","RGB_rgb","color","RGB_HTML","T_HTML","T_rgb","CMYK_RGB","CMYK_rgb","CMYK_HTML","components","rgb","RGB_CMYK","GetElementsByNameSet","getRectDims","AnnotationElement","parameters","isRenderable","ignoreBorder","createQuadrilaterals","linkService","downloadManager","imageResourcesPath","renderForms","svgFactory","enableScripting","hasJSActions","_fieldObjects","popup","annotationEditorType","fieldObjects","_createContainer","_createQuadrilaterals","_hasPopupData","titleObj","contentsObj","richText","str","_isEditable","isEditable","hasPopupData","updateEdited","resetEdited","WidgetAnnotationElement","zIndex","popupRef","alternativeText","title","noRotate","PopupAnnotationElement","rotationValue","hasOwnCanvas","setRotation","borderStyle","borderWidth","horizontalRadius","horizontalCornerRadius","verticalRadius","verticalCornerRadius","radius","borderRadius","RadioButtonWidgetAnnotationElement","borderBottomStyle","borderColor","view","pageWidth","angle","elementWidth","elementHeight","_commonActions","setColor","jsName","styleName","detail","colorType","colorArray","visibility","noView","noPrint","preventScroll","userName","readonly","disabled","required","_setRequired","bgColor","fillColor","fgColor","textColor","strokeColor","_dispatchEventFromSandbox","actions","jsEvent","commonActions","action","_setDefaultPropertiesFromJS","storedData","actionName","quadPoints","rectBlX","rectBlY","rectTrX","rectTrY","fround","trX","trY","blX","blY","subarray","svgBuffer","svg","defs","clipPath","rectWidth","rectHeight","backgroundImage","_createPopup","_getElementsByName","skipId","fields","fieldObj","exportValues","exportValue","domElement","getElementsByName","maybeShow","forceHide","getElementsToTriggerPopup","addHighlightArea","triggers","_editOnDoubleClick","isRequired","currentRect","showElementAndHideCanvas","previousSibling","nodeName","_getKeyModifier","FeatureTest","platform","isMac","metaKey","ctrlKey","_setEventListener","elementData","baseName","valueGetter","shiftKey","modifier","focused","relatedTarget","_setEventListeners","names","getter","Blur","Focus","_setBackgroundColor","backgroundColor","_setTextStyle","TEXT_ALIGNMENT","fontColor","defaultAppearanceData","computedFontSize","roundToOneDecimal","multiLine","abs","lineHeight","textAlignment","textAlign","storage","getValue","fieldValue","buttonValue","radio","fieldName","readOnly","checked","defaultValue","defaultFieldValue","pdfButtonValue","curChecked","PopupElement","modificationDate","parentRect","elementIds","PDFDateString","toDateObject","popupShow","baseColor","outlineColor","CSS","supports","BACKGROUND_ENLIGHT","header","dir","date","toLocaleDateString","time","toLocaleTimeString","html","XfaLayer","xfaHtml","lastChild","contents","_formatContents","p","lines","line","createTextNode","popupContent","isVisible","attributes","popupLines","lineAttributes","altKey","useParentRect","intersect","normalizedRect","popupLeft","popupTop","parseInt","FreeTextAnnotationElement","textPosition","content","lineSpan","_DrawLayer_instances","_a$6","_DrawLayer_parent","_DrawLayer_id","_DrawLayer_mapping","_DrawLayer_toUpdate","_DrawLayer_setBox","_DrawLayer_createSVG","_DrawLayer_createClipPath","_AnnotationEditor_instances","_a$5","_AnnotationEditor_x","_AnnotationEditor_y","_AnnotationEditor_disabled","_AnnotationEditor_keepAspectRatio","_AnnotationEditor_focusAC","_AnnotationEditor_hasBeenClicked","_AnnotationEditor_initialPosition","_AnnotationEditor_isEditing","_AnnotationEditor_isInEditMode","_AnnotationEditor_moveInDOMTimeout","_AnnotationEditor_prevDragX","_AnnotationEditor_prevDragY","_AnnotationEditor_isDraggable","_AnnotationEditor_zIndex","_AnnotationEditor_translate","_AnnotationEditor_rotatePoint","_AnnotationEditor_selectOnPointerEvent","_AnnotationEditor_setUpDragSession","_AnnotationEditor_addFocusListeners","_AnnotationEditor_stopResizing","_FreeTextEditor_instances","_a$4","_FreeTextEditor_color","_FreeTextEditor_content","_FreeTextEditor_editorDivId","_FreeTextEditor_editModeAC","_FreeTextEditor_fontSize","_FreeTextEditor_initialData","_FreeTextEditor_updateFontSize","_FreeTextEditor_updateColor","_FreeTextEditor_extractText","_FreeTextEditor_setEditorDimensions","_FreeTextEditor_getNodeContent","_FreeTextEditor_setContent","_FreeTextEditor_serializeContent","_FreeTextEditor_deserializeContent","_FreeTextEditor_hasElementChanged","DrawLayer","setParent","root","_svgFactory","DOMSVGFactory","outlines","opacity","isPathUpdatable","box","free","path","pathId","toSVGPath","clipPathId","use","highlightOutline","maskId","mask","use1","use2","finalizeLine","updateBox","updateLine","removeFreeHighlight","updatePath","rotate","changeColor","changeOpacity","removeClass","create","clipPathUse","getRGB","startsWith","colorRGB","ColorManager","_colors","_colorsMapping","colors","computedColor","getColorValues","convert","matchMedia","RGB","every","getHexCode","AnnotationEditor","_willKeepAspectRatio","_structTreeParentId","pageRotation","pageDimensions","pageTranslation","isAttachedToDOM","_editToolbar","_initialOptions","_isVisible","_uiManager","_l10nPromise","_zIndex","idManager","uiManager","isCentered","parentDimensions","_type","_defaultLineColor","_colorManager","deleteAnnotationElement","fakeEditor","FakeEditor","getNextId","initialize","l10n","_value","mime","_isDraggable","center","parentRotation","fixAndSetPosition","setInBackground","setInForeground","focusin","focusout","isMultipleSelection","setAt","screenToPageTranslation","translate","scrollIntoView","block","xValue","yValue","findNewParent","bx","by","getBaseTranslation","toFixed","_hasBeenMoved","_borderLineWidth","_mustFixPosition","moveInDOM","pageTranslationToScreen","parentScale","scaledWidth","scaledHeight","isCSSRoundSupported","setDims","fixDims","getInitialTranslation","addEditToolbar","removeEditToolbar","getClientDimensions","pointerdown","moveEditorInDOM","getRect","shiftX","shiftY","getRectInCurrentCoords","x1","y1","x2","y2","onceAdded","enableEditMode","disableEditMode","isInEditMode","needsToBeRebuilt","isForCopying","isResizable","makeResizable","toolbarPosition","_stopResizingWithKeyboard","disableEditing","enableEditing","getImageForAltText","contentDiv","setAspectRatio","aspectRatio","MIN_SIZE","telemetryInitialData","telemetryFinalData","_reportTelemetry","resetAnnotationElement","highlightEditor","freeTextEditor","ac","clientX","clientY","pointerMoveCallback","passive","capture","pointerUpCallback","_telemetryTimeout","EOL_PATTERN","FreeTextEditor","editorDiv","overlayDiv","_defaultColor","_defaultFontSize","strings","documentElement","_internalPadding","parseFloat","getPropertyValue","FREETEXT_SIZE","FREETEXT_COLOR","_translateEmpty","contentEditable","editorDivKeydown","editorDivFocus","editorDivBlur","editorDivInput","editorDivPaste","innerText","trim","savedText","newText","trimEnd","setText","shouldGetKeyboardEvents","dblclick","keydown","baseX","baseY","messages","freeTextEditorPlaceholder","posX","posY","replaceAll","normalize","deleteFromDocument","insertNode","collapseToStart","startContainer","bufferBefore","bufferAfter","nodeValue","newRange","Range","beforeLength","reduce","acc","setStart","setEnd","removeAllRanges","addRange","initialData","annotationType","padding","structTreeParentId","replaceChildren","toJSON","_Outliner_instances","_Outliner_box","_Outliner_verticalEdges","_Outliner_intervals","_Outliner_getOutlines","_Outliner_binarySearch","_Outliner_insert","_Outliner_remove","_Outliner_breakEdge","_HighlightOutline_box","_HighlightOutline_outlines","_FreeOutliner_instances","_a$3","_FreeOutliner_box","_FreeOutliner_bottom","_FreeOutliner_innerMargin","_FreeOutliner_isLTR","_FreeOutliner_top","_FreeOutliner_last","_FreeOutliner_lastX","_FreeOutliner_lastY","_FreeOutliner_min","_FreeOutliner_min_dist","_FreeOutliner_scaleFactor","_FreeOutliner_thickness","_FreeOutliner_points","_FreeOutliner_MIN_DIST","_FreeOutliner_MIN_DIFF","_FreeOutliner_MIN","_FreeOutliner_getLastCoords","_FreeHighlightOutline_instances","_FreeHighlightOutline_box","_FreeHighlightOutline_bbox","_FreeHighlightOutline_innerMargin","_FreeHighlightOutline_isLTR","_FreeHighlightOutline_points","_FreeHighlightOutline_scaleFactor","_FreeHighlightOutline_outline","_FreeHighlightOutline_rescale","_FreeHighlightOutline_rescaleAndSwap","_FreeHighlightOutline_computeMinMax","_HighlightEditor_instances","_a$2","_HighlightEditor_anchorNode","_HighlightEditor_anchorOffset","_HighlightEditor_boxes","_HighlightEditor_clipPathId","_HighlightEditor_focusOutlines","_HighlightEditor_focusNode","_HighlightEditor_focusOffset","_HighlightEditor_highlightDiv","_HighlightEditor_highlightOutlines","_HighlightEditor_id","_HighlightEditor_isFreeHighlight","_HighlightEditor_lastPoint","_HighlightEditor_opacity","_HighlightEditor_outlineId","_HighlightEditor_text","_HighlightEditor_thickness","_HighlightEditor_methodOfCreation","_HighlightEditor_createOutlines","_HighlightEditor_createFreeOutlines","_HighlightEditor_updateColor","_HighlightEditor_updateThickness","_HighlightEditor_cleanDrawLayer","_HighlightEditor_addToDrawLayer","_HighlightEditor_rotateBbox","_HighlightEditor_keydown","_HighlightEditor_setCaret","_HighlightEditor_getRotation","_HighlightEditor_serializeBoxes","_HighlightEditor_serializeOutlines","_HighlightEditor_highlightMove","_HighlightEditor_endHighlight","_AnnotationEditorLayer_instances","_a$1","_AnnotationEditorLayer_accessibilityManager","_AnnotationEditorLayer_allowClick","_AnnotationEditorLayer_annotationLayer","_AnnotationEditorLayer_clickAC","_AnnotationEditorLayer_editorFocusTimeoutId","_AnnotationEditorLayer_editors","_AnnotationEditorLayer_hadPointerDown","_AnnotationEditorLayer_isCleaningUp","_AnnotationEditorLayer_isDisabling","_AnnotationEditorLayer_textLayer","_AnnotationEditorLayer_textSelectionAC","_AnnotationEditorLayer_uiManager","_AnnotationEditorLayer_editorTypes","_AnnotationEditorLayer_textLayerPointerDown","_AnnotationEditorLayer_currentEditorType_get","_AnnotationEditorLayer_createNewEditor","_AnnotationEditorLayer_getCenterPoint","_AnnotationEditorLayer_cleanup","_Page_instances","_Page_previousRotation","_Page_layers","_Page_dispatchLayerRendered","setFontsize","savedFontsize","col","savedColor","savedDisplay","savedVisibility","_freeTextDefaultContent","_editorType","Outliner","innerMargin","isLTR","minX","Infinity","maxX","minY","maxY","EPSILON","pow","ceil","right","bboxWidth","bboxHeight","shiftedMinX","shiftedMinY","lastEdge","at","lastPoint","edge","getOutlines","outlineVerticalEdges","edges","allEdges","edge1","edge2","outline","lastPointX","lastPointY","HighlightOutline","array","middle","results","j","jj","y3","y4","Outline","FreeHighlightOutline","polygon","prevX","prevY","points","FreeOutliner","scaleFactor","thickness","Float64Array","isNaN","layerWidth","layerHeight","diffX","diffY","hypot","diffD","K","x0","y0","nY","thX","thY","atan2","PI","bottom","lastTop","lastBottom","lastTopX","lastTopY","lastBottomX","lastBottomY","last","outlineObj","N","getNewOutline","sx","sy","outliner","lastX","lastY","ltrCallback","bbox","bezierBoundingBox","HighlightEditor","_defaultThickness","_defaultOpacity","highlightId","computeTelemetryFinalData","numberOfColors","_d","_e","HIGHLIGHT_THICKNESS","HIGHLIGHT_COLOR","addUndoableEditor","mustBeSelected","drawLayer","highlightDiv","pointerover","pointerleave","_moveCaret","startHighlighting","stopPropagation","noContextMenu","_freeHighlight","_freeHighlightId","_freeHighlightClipId","outlinerForOutline","highlightOutlines","setPosition","Float32Array","AnnotationEditorLayer","editorTypes","_initialized","isInvisible","disableTextSelection","togglePointerEvents","toggleAnnotationLayerPointerEvents","INK","addInkEditorIfNeeded","enableTextSelection","isCommitting","offsetX","offsetY","enabled","annotationElementIds","editables","getEditableAnnotations","editable","changedAnnotations","resetAnnotations","getEditableAnnotation","attach","detach","pasteEditor","STAMP","setLayerDimensions","oldRotation","tlX","tlY","centerX","innerWidth","centerY","innerHeight","LAYERS_ORDER","_AnnotationStorage_modified","freeze","hash","transfer","_PDFLinkService_isValidExplicitDest","LinkTarget","PDFLinkService","externalLinkTarget","externalLinkRel","ignoreDestinationZoom","_ignoreDestinationZoom","baseUrl","pdfHistory","externalLinkEnabled","setDocument","setViewer","setHistory","pagesCount","numPages","currentPageNumber","isInPresentationMode","goToDestination","namedDest","explicitDest","destRef","cachedPageNumber","Number","isInteger","pushCurrentPosition","scrollPageIntoView","destArray","val","pageLabelToPageNumber","pushPage","addLinkAttributes","link","newWindow","rel","href","onclick","targetStr","getDestinationHash","getAnchorUrl","escape","setHash","query","urlSearchParams","URLSearchParams","toLowerCase","parseQueryString","phrase","zoomArgs","zoomArg","zoomArgNumber","allowNegativeOffset","unescape","executeNamedAction","back","forward","nextPage","previousPage","executeSetOCGState","optionalContentConfig","optionalContentConfigPromise","setOCGState","Promise","resolve","PdfViewerInteractionMode","num","gen","argsLen","allowNull","arg","S","__meta__","category","description","depends","chunk","zoomLevel","zoomLevelType","currentZoom","documentContainer","pageSize","offsetWidth","calculatedZoomLevel","fileName","saveOptions","onDownload","pdf","Blob","blob","s","reason","f","l","verbosity","isEvalSupported","arrayBuffer","typedArray","getDocumentParameters","loadOnDemandPageSize","getDocument","getPage","all","loadOnDemand","pdfPages","sheet","CSSStyleSheet","replaceSync","ownerDocument","adoptedStyleSheets","allDone","Boolean"],"sources":["kendo.pdfviewer-common.cmn.chunk.js"],"mappings":"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","ignoreList":[],"sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('kendo.draggable.cmn.chunk.js'), require('kendo.file-saver.cmn.chunk.js'), require('kendo.common.cmn.chunk.js'), require('kendo.pdfjs.loader.js'), require('kendo.dateinputs-common.cmn.chunk.js')) :\n    typeof define === 'function' && define.amd ? define(['exports', 'kendo.draggable.cmn.chunk', 'kendo.file-saver.cmn.chunk', 'kendo.common.cmn.chunk', 'kendo.pdfjs.loader', 'kendo.dateinputs-common.cmn.chunk'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.kendo = global.kendo || {}, global.kendo._globals = global.kendo._globals || {}, global.kendo._globals.PdfviewerCommonCmnChunk = {}), global.kendo._globals.DraggableCmnChunk, global.kendo._globals.FileSaverCmnChunk, global.kendo._globals.CommonCmnChunk, global.kendo._globals.PdfjsLoader, global.kendo._globals.DateinputsCommonCmnChunk));\n})(this, (function (exports, kendo_draggable_cmn_chunk_js, kendo_fileSaver_cmn_chunk_js, kendo_common_cmn_chunk_js, kendo_pdfjs_loader_js, kendo_dateinputsCommon_cmn_chunk_js) {\n    const __meta__ = {\n        id: \"pdfviewer-common.cmn.chunk\",\n        name: \"PdfviewerCommonCmnChunk\",\n        category: \"web\",\n        description: \"A reusable outputed chunk of code\",\n        depends: ['draggable.cmn.chunk', 'file-saver.cmn.chunk', 'common.cmn.chunk', 'pdfjs.loader', 'dateinputs-common.cmn.chunk'],\n        hidden: true,\n        chunk: true\n    };\n\n    // @ts-expect-error TS(2556): A spread argument must either have a tuple type or... Remove this comment to see the full error message\n    const extend = (...args) => Object.assign(...args);\n    const isObject = (value) => value && typeof (value) === \"object\" && !Array.isArray(value);\n    const isHtmlElement = (element) => element instanceof HTMLElement;\n    const isDomElement = (element) => element instanceof Element;\n    /* eslint-disable no-undef */\n    // @ts-expect-error TS(2304): Cannot find name 'DotNet'.\n    const isDotNetObject = (value) => value && window && window.DotNet && window.DotNet.DotNetObject && value instanceof DotNet.DotNetObject;\n    /* eslint-enable no-undef */\n    const deepExtend = (target, ...sources) => {\n        if (!sources.length) {\n            return target;\n        }\n        const source = sources.shift();\n        if (isObject(target) && isObject(source)) {\n            for (const key in source) {\n                if (source[key] instanceof Component) {\n                    target[key] = source[key];\n                }\n                else if (isHtmlElement(source[key])) {\n                    target[key] = source[key];\n                }\n                else if (key === \"dotNetInstance\" || isDotNetObject(source[key])) {\n                    // avoid cloning a DotNetObject as it might have circular properties\n                    // see https://github.com/telerik/blazor/issues/7507\n                    // the check for the name of our own option - \"dotNetInstance\"\n                    // is an additional guard against the Blazor API being different in other .NET versions\n                    target[key] = source[key];\n                }\n                else if (source[key] && source[key].buffer && source[key].buffer instanceof ArrayBuffer) {\n                    target[key] = source[key];\n                }\n                else if (isObject(source[key]) && Object.getPrototypeOf(source[key]) !== Object.prototype) {\n                    target[key] = source[key];\n                }\n                else if (isObject(source[key])) {\n                    if (!target[key] || !isObject(target[key])) {\n                        extend(target, { [key]: {} });\n                    }\n                    deepExtend(target[key], source[key]);\n                }\n                else {\n                    extend(target, { [key]: source[key] });\n                }\n            }\n        }\n        return deepExtend(target, ...sources);\n    };\n    const isFunction = fn => typeof (fn) === \"function\";\n    const isString = value => typeof (value) === \"string\";\n    const toArray = value => Array.from(value);\n    const isDefined = value => typeof (value) !== \"undefined\";\n    const isNotNull = value => value !== null;\n    const hasValue = value => isDefined(value) && isNotNull(value);\n    const noop = function () { };\n    const convertToHtml = (htmlString, ownerDocument) => {\n        const template = (ownerDocument || document).createElement('template');\n        template.innerHTML = htmlString.trim();\n        const content = template.content;\n        if (content.childNodes.length > 1) {\n            return content.childNodes;\n        }\n        return content.firstChild;\n    };\n    const toPixel = value => parseFloat(value) + \"px\";\n    const toClassSelector$1 = (className) => (className === null || className === void 0 ? void 0 : className.startsWith(\".\")) ? className : `.${className}`;\n    const mousewheelDelta = (e) => {\n        let delta = 0;\n        if (e.wheelDelta) {\n            delta = -e.wheelDelta / 120;\n        }\n        else if (e.detail) {\n            delta = e.detail / 3;\n        }\n        delta = delta > 0 ? Math.ceil(delta) : Math.floor(delta);\n        return delta;\n    };\n    const createPromise = () => {\n        let resolveFn;\n        let rejectFn;\n        const promise = new Promise(function (resolve, reject) {\n            resolveFn = resolve;\n            rejectFn = reject;\n        });\n        // @ts-expect-error TS(2339): Property 'resolve' does not exist on type 'Promise... Remove this comment to see the full error message\n        promise.resolve = resolveFn;\n        // @ts-expect-error TS(2339): Property 'reject' does not exist on type 'Promise<... Remove this comment to see the full error message\n        promise.reject = rejectFn;\n        return promise;\n    };\n\n    class Component {\n        constructor(element, options) {\n            this.options = {\n                events: {}\n            };\n            this.element = element;\n            this.options = options;\n        }\n        destroy() {\n            this.element = null;\n        }\n        extendOptions(options) {\n            this.options = deepExtend(this.options, options);\n        }\n        setOptions(options) {\n            this.options = options;\n        }\n        trigger(eventName, args = {}) {\n            const eventData = {\n                defaultPrevented: false,\n                preventDefault: () => {\n                    eventData.defaultPrevented = true;\n                }\n            };\n            if (isFunction(this.options.events[eventName])) {\n                this.options.events[eventName](extend(eventData, args, {\n                    sender: this\n                }));\n            }\n            return eventData.defaultPrevented;\n        }\n    }\n\n    const throttle = function (func, wait, options = {}) {\n        let timeout, context, args, result;\n        let previous = 0;\n        const later = function () {\n            previous = options.leading === false ? 0 : new Date().getTime();\n            timeout = undefined;\n            result = func.apply(context, args);\n            if (!timeout) {\n                context = args = null;\n            }\n        };\n        const throttled = function () {\n            const now = new Date().getTime();\n            if (!previous && options.leading === false) {\n                previous = now;\n            }\n            const remaining = wait - (now - previous);\n            context = undefined; // this\n            args = arguments;\n            if (remaining <= 0 || remaining > wait) {\n                if (timeout) {\n                    clearTimeout(timeout);\n                    timeout = undefined;\n                }\n                previous = now;\n                result = func.apply(context, args);\n                if (!timeout) {\n                    context = args = null;\n                }\n            }\n            else if (!timeout && options.trailing !== false) {\n                timeout = window.setTimeout(later, remaining);\n            }\n            return result;\n        };\n        return throttled;\n    };\n    const preventDefault = (e) => {\n        if (e.preventDefault) {\n            e.preventDefault();\n        }\n        if (e.originalEvent) {\n            e.originalEvent.preventDefault();\n        }\n    };\n    const matchesElementSelector = (element, selector) => {\n        if (!element || !selector) {\n            return false;\n        }\n        return element.closest(selector);\n    };\n    const FRAMES_PER_SECOND$1 = 1000 / 60;\n    const SCROLL$1 = \"scroll\";\n    /**\n     * @hidden\n     */\n    class Scroller extends Component {\n        constructor(element, options) {\n            super(element, options);\n            this.options = {\n                events: {\n                    [SCROLL$1]: noop,\n                },\n                filter: '',\n                // throttle the scroll events to get a more similar experience\n                // to the scrolling behavior in Adobe Acrobat Reader\n                // as well as allow a way to improve the scrolling performance for large files\n                panScrollThrottleDelay: FRAMES_PER_SECOND$1,\n                // the drag directions are actually reversed, e.g.\n                // dragging to the right actually moves the document to the left\n                scrollDirectionModifier: -1,\n                scrollThrottleDelay: FRAMES_PER_SECOND$1,\n            };\n            this.onElementScroll = (e) => {\n                const element = this.element;\n                if (!this.shouldTrackScrollEvents()) {\n                    return;\n                }\n                if (this.state.trackNextElementScroll) {\n                    this.scrollTo(element.scrollLeft, element.scrollTop);\n                }\n                else {\n                    // reset the state, so that consecutive scroll events can be handled\n                    this.state.trackNextElementScroll = true;\n                }\n                this.trigger(SCROLL$1, {\n                    originalEvent: e\n                });\n            };\n            this.onDragStart = (e) => {\n                this.state.dragStarted = false;\n                if (!this.shouldTrackPanEvents()) {\n                    return;\n                }\n                const target = e.target || (e.originalEvent || {}).target;\n                if (this.options.filter &&\n                    !matchesElementSelector(target, this.options.filter)) {\n                    return;\n                }\n                preventDefault(e);\n                this.setState({\n                    dragStarted: true,\n                    location: {\n                        pageX: e.pageX,\n                        pageY: e.pageY\n                    },\n                    locationDelta: {\n                        x: 0,\n                        y: 0\n                    }\n                });\n            };\n            this.onDrag = (e) => {\n                if (!this.shouldTrackPanEvents() || !this.state.dragStarted) {\n                    return;\n                }\n                this.calculateEventLocationDelta(e);\n                this.setState({\n                    location: {\n                        pageX: e.pageX,\n                        pageY: e.pageY\n                    }\n                });\n                const directionModifier = this.options.scrollDirectionModifier;\n                const scrollLeft = this.element.scrollLeft +\n                    directionModifier * this.state.locationDelta.x;\n                const scrollTop = this.element.scrollTop +\n                    directionModifier * this.state.locationDelta.y;\n                this.scrollTo(scrollLeft, scrollTop);\n            };\n            this.onDragEnd = () => {\n                if (!this.shouldTrackPanEvents()) {\n                    return;\n                }\n            };\n            this.extendOptions(options);\n            this.resetState();\n            this.bindEvents();\n        }\n        destroy() {\n            this.unbindEvents();\n        }\n        initDraggable() {\n            this.destroyDraggable();\n            if (this.options.panScrollThrottleDelay > 0) {\n                this.throttledOnDrag = throttle(this.onDrag, this.options.panScrollThrottleDelay);\n            }\n            else {\n                this.throttledOnDrag = this.onDrag;\n            }\n            this.draggable = new kendo_draggable_cmn_chunk_js.D({\n                mouseOnly: false,\n                press: this.onDragStart,\n                drag: this.throttledOnDrag,\n                release: this.onDragEnd\n            });\n            this.draggable.bindTo(this.element);\n        }\n        destroyDraggable() {\n            if (this.draggable && this.draggable.destroy) {\n                this.draggable.destroy();\n                if (this.throttledOnDrag && this.throttledOnDrag.cancel) {\n                    this.throttledOnDrag.cancel();\n                    this.throttledOnDrag = null;\n                }\n            }\n        }\n        bindEvents() {\n            this.bindDraggableEvents();\n            this.bindElementScroll();\n        }\n        bindDraggableEvents() {\n            this.initDraggable();\n        }\n        bindElementScroll() {\n            if (this.options.scrollThrottleDelay > 0) {\n                this.throttledOnElementScroll = throttle(this.onElementScroll, this.options.scrollThrottleDelay);\n            }\n            else {\n                this.throttledOnElementScroll = this.onElementScroll;\n            }\n            this.element.addEventListener(SCROLL$1, this.throttledOnElementScroll);\n        }\n        unbindEvents() {\n            this.unbindElementScroll();\n            this.unbindDraggableEvents();\n        }\n        unbindDraggableEvents() {\n            this.destroyDraggable();\n        }\n        unbindElementScroll() {\n            if (this.throttledOnElementScroll &&\n                this.throttledOnElementScroll.cancel) {\n                this.throttledOnElementScroll.cancel();\n                this.throttledOnElementScroll = null;\n            }\n            this.element.removeEventListener(SCROLL$1, this.throttledOnElementScroll);\n        }\n        setState(newState) {\n            this.state = Object.assign({}, this.state || {}, newState);\n        }\n        resetState() {\n            this.setState({\n                trackPanEvents: false,\n                trackScrollEvents: false,\n                trackNextElementScroll: false,\n                location: { pageX: 0, pageY: 0 },\n                locationDelta: { x: 0, y: 0 }\n            });\n        }\n        enablePanEventsTracking() {\n            this.state.trackPanEvents = true;\n            this.bindDraggableEvents();\n        }\n        disablePanEventsTracking() {\n            this.unbindDraggableEvents();\n            this.state.trackPanEvents = false;\n        }\n        shouldTrackPanEvents() {\n            return this.state.trackPanEvents;\n        }\n        enableScrollEventsTracking() {\n            this.state.trackScrollEvents = true;\n            this.unbindElementScroll();\n            this.bindElementScroll();\n        }\n        disableScrollEventsTracking() {\n            this.unbindElementScroll();\n            this.state.trackScrollEvents = false;\n        }\n        shouldTrackScrollEvents() {\n            return this.state.trackScrollEvents;\n        }\n        calculateEventLocationDelta(e) {\n            this.state.locationDelta = {\n                x: e.pageX - this.state.location.pageX,\n                y: e.pageY - this.state.location.pageY\n            };\n        }\n        scrollTo(x, y, options = { trackScrollEvent: true }) {\n            if (!options.trackScrollEvent) {\n                this.state.trackNextElementScroll = false;\n            }\n            this.element.scrollLeft = x;\n            this.element.scrollTop = y;\n        }\n    }\n\n    const unwrapElement = (element) => {\n        const parentElement = element.parentElement;\n        if (!element || !parentElement) {\n            return;\n        }\n        parentElement.replaceWith(...Array.from(parentElement.childNodes));\n    };\n    const unwrapElements = (elements) => {\n        if (!elements || !elements.length || elements.length <= 0) {\n            return;\n        }\n        for (let i = 0; i < elements.length; i++) {\n            unwrapElement(elements[i]);\n        }\n    };\n    const wrapElement = (element, wrapper) => {\n        if (element.parentNode) {\n            element.parentNode.insertBefore(wrapper, element);\n            wrapper.appendChild(element);\n        }\n    };\n    const wrapInnerElement = (element, wrapper) => {\n        if (!element || !element.parentNode || !wrapper) {\n            return;\n        }\n        element.appendChild(wrapper);\n        while (element.firstChild && element.firstChild !== wrapper) {\n            wrapper.appendChild(element.firstChild);\n        }\n    };\n    const addClass$1 = (className, element) => {\n        element.classList.add(className);\n    };\n    const removeClass$1 = (className, element) => {\n        element.classList.remove(className);\n    };\n    const toClassSelector = (className) => `.${className}`;\n    const CHAR_INDEX_DATA_ATTR = 'data-char-index';\n    const MATCH_INDEX_DATA_ATTR = 'data-match-index';\n    /**\n     * @hidden\n     */\n    class SearchService {\n        constructor(options) {\n            this.options = {\n                highlightClass: 'k-search-highlight',\n                highlightMarkClass: 'k-search-highlight-mark',\n                charClass: 'k-text-char',\n                textContainers: []\n            };\n            this.extendOptions(options);\n            this.resetState();\n        }\n        destroy() {\n            this.clearSearch();\n        }\n        extendOptions(options) {\n            this.options = Object.assign({}, this.options, options);\n        }\n        setState(newState) {\n            this.state = Object.assign({}, this.state || {}, newState);\n        }\n        resetState() {\n            this.setState({\n                text: '',\n                textNodes: [],\n                charIndex: 0,\n                activeMatchIndex: 0,\n                matches: []\n            });\n        }\n        escapeRegExp(text) {\n            return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        }\n        search({ text, matchCase }) {\n            const escapedText = this.escapeRegExp(text);\n            const searchRegex = new RegExp(escapedText, matchCase ? 'g' : 'ig');\n            let match;\n            if (this.shouldTransformText()) {\n                this.transformTextForSearch();\n            }\n            this.state.matches = [];\n            this.state.activeMatchIndex = 0;\n            this.removeIndicators();\n            if (escapedText === '') {\n                return [];\n            }\n            match = searchRegex.exec(this.state.text);\n            while (match) {\n                this.state.matches.push({\n                    startOffset: match.index,\n                    endOffset: match.index + match[0].length\n                });\n                match = searchRegex.exec(this.state.text);\n            }\n            this.highlightAllMatches();\n            this.addActiveMatchMark();\n            return this.state.matches;\n        }\n        clearSearch() {\n            this.removeIndicators();\n            this.restoreOriginalText();\n        }\n        restoreOriginalText() {\n            this.forEachTextContainer((textContainer) => {\n                const nodes = Array.from(textContainer.querySelectorAll('span:not(.' + this.options.charClass + ')'));\n                nodes.forEach((node) => {\n                    node.innerHTML = node.textContent;\n                });\n            });\n        }\n        shouldTransformText() {\n            return !this.state.text;\n        }\n        transformTextForSearch() {\n            this.state.textNodes = [];\n            this.state.charIndex = 0;\n            this.state.text = '';\n            this.forEachTextContainer((textContainer) => {\n                this.extractTextNodes(textContainer);\n            });\n            this.transformTextNodesForSearch(this.state.textNodes);\n        }\n        extractTextNodes(node) {\n            if (node.nodeType === Node.TEXT_NODE) {\n                this.state.textNodes.push(node);\n            }\n            else {\n                for (let i = 0; i < node.childNodes.length; i++) {\n                    this.extractTextNodes(node.childNodes[i]);\n                }\n            }\n        }\n        transformTextNodesForSearch(textNodes) {\n            for (let i = 0; i < textNodes.length; i++) {\n                this.transformTextNodeForSearch(textNodes[i]);\n            }\n        }\n        transformTextNodeForSearch(node) {\n            const text = node.textContent;\n            if (text.length <= 0) {\n                return;\n            }\n            this.state.text = this.state.text + text;\n            const span = document.createElement('span');\n            wrapElement(node, span);\n            const splittedHtml = this.splitTextByChars(text);\n            span.innerHTML = splittedHtml;\n            unwrapElement(span.childNodes[0]);\n        }\n        splitTextByChars(text) {\n            let splittedTextHtml = '';\n            for (let i = 0; i < text.length; i++) {\n                splittedTextHtml += `<span class='${this.options.charClass}' ${CHAR_INDEX_DATA_ATTR}=${this.state.charIndex}>${text[i]}</span>`;\n                this.state.charIndex++;\n            }\n            return splittedTextHtml;\n        }\n        forEachTextContainer(callback) {\n            for (let i = 0; i < this.options.textContainers.length; i++) {\n                const textContainer = this.options.textContainers[i];\n                callback(textContainer, i);\n            }\n        }\n        highlightAllMatches() {\n            this.state.matches.forEach((match, matchIndex) => {\n                this.addMatchHighlight(match.startOffset, match.endOffset, matchIndex);\n            });\n        }\n        addMatchHighlight(matchStartOffset, matchEndOffset, matchIndex) {\n            for (let i = matchStartOffset; i < matchEndOffset; i++) {\n                this.forEachTextContainer((textContainer) => {\n                    const highlights = Array.from(textContainer.querySelectorAll(toClassSelector(`${this.options.charClass}[${CHAR_INDEX_DATA_ATTR}='${i}']`)));\n                    highlights.forEach((highlight) => {\n                        addClass$1(this.options.highlightClass, highlight);\n                        highlight.setAttribute(MATCH_INDEX_DATA_ATTR, matchIndex);\n                    });\n                });\n            }\n        }\n        removeMatchHighlights() {\n            this.forEachTextContainer((textContainer) => {\n                const highlights = Array.from(textContainer.querySelectorAll(toClassSelector(this.options.highlightClass)));\n                highlights.forEach((highlight) => {\n                    removeClass$1(this.options.highlightClass, highlight);\n                    highlight.removeAttribute(MATCH_INDEX_DATA_ATTR);\n                });\n            });\n        }\n        addActiveMatchMark() {\n            if (!this.state.activeMatchIndex && this.state.activeMatchIndex !== 0) {\n                this.state.activeMatchIndex = 0;\n            }\n            else if (this.state.activeMatchIndex > this.state.matches.length) {\n                this.state.activeMatchIndex = this.state.matches.length;\n            }\n            else {\n                this.removeActiveMatchMark();\n            }\n            const mark = document.createElement('span');\n            mark.classList.add(this.options.highlightMarkClass);\n            this.forEachTextContainer((textContainer) => {\n                const matches = Array.from(textContainer.querySelectorAll(toClassSelector(this.options.charClass +\n                    '[' +\n                    MATCH_INDEX_DATA_ATTR +\n                    '=\\'' +\n                    this.state.activeMatchIndex +\n                    '\\']')));\n                matches.forEach((match) => {\n                    wrapInnerElement(match, mark.cloneNode(true));\n                });\n            });\n        }\n        removeActiveMatchMark() {\n            this.forEachTextContainer((textContainer) => {\n                const marks = Array.from(textContainer.querySelectorAll(toClassSelector(this.options.highlightMarkClass)));\n                const childNodes = marks.flatMap((x) => Array.from(x.childNodes));\n                unwrapElements(childNodes);\n            });\n        }\n        removeIndicators() {\n            this.removeActiveMatchMark();\n            this.removeMatchHighlights();\n        }\n        markNextMatch() {\n            this.markNextMatchIndex();\n            this.addActiveMatchMark();\n        }\n        markPreviousMatch() {\n            this.markPreviousMatchIndex();\n            this.addActiveMatchMark();\n        }\n        markNextMatchIndex() {\n            this.moveActiveMatchIndex(1);\n        }\n        markPreviousMatchIndex() {\n            this.moveActiveMatchIndex(-1);\n        }\n        moveActiveMatchIndex(delta) {\n            this.state.activeMatchIndex += delta;\n            if (this.state.activeMatchIndex < 0) {\n                this.state.activeMatchIndex = Math.max(this.state.matches.length - 1, 0);\n            }\n            else if (this.state.activeMatchIndex >\n                this.state.matches.length - 1) {\n                this.state.activeMatchIndex = 0;\n            }\n        }\n        getActiveMatchElement() {\n            let markedMatch;\n            this.forEachTextContainer((textContainer) => {\n                const mark = textContainer.querySelector(toClassSelector(this.options.highlightMarkClass));\n                if (mark) {\n                    markedMatch = mark;\n                    return;\n                }\n            });\n            return markedMatch;\n        }\n    }\n\n    class Annotation {\n        constructor(container, viewport, annotation, pdfDoc, zoom, rootElement) {\n            this.container = container;\n            this.viewport = viewport;\n            this.zoom = zoom;\n            this.annotation = annotation;\n            this.pdfDoc = pdfDoc;\n            this.rootElement = rootElement;\n        }\n        destroy() {\n        }\n    }\n    class LinkAnnotation extends Annotation {\n        constructor(container, viewport, annotation, pdfDoc, zoom, rootElement) {\n            super(container, viewport, annotation, pdfDoc, zoom, rootElement);\n            this.onLinkClick = (e) => {\n                const destination = e.target.getAttribute('href');\n                if (destination && destination.indexOf('#') === 0) {\n                    this.navigateToDestination(destination);\n                    e.preventDefault();\n                }\n            };\n            this.linkElement = null;\n            this.renderAnnotation();\n            this.bindEvents();\n        }\n        destroy() {\n            this.unbindEvents();\n        }\n        bindEvents() {\n            this.linkElement.addEventListener('click', this.onLinkClick);\n        }\n        unbindEvents() {\n            this.linkElement.removeEventListener('click', this.onLinkClick);\n        }\n        navigateToDestination(destination) {\n            const dest = destination.split('#')[1];\n            this.pdfDoc.getDestination(dest).then(r => {\n                this.pdfDoc.getPageIndex(r[0]).then(i => this.goToPage(i));\n            });\n        }\n        goToPage(pageNumber) {\n            scrollToPage(this.rootElement, pageNumber);\n        }\n        renderAnnotation() {\n            const annotation = this.annotation, viewport = this.viewport, rect = annotation.rect, boundingRect = [\n                [rect[0], rect[1]],\n                [rect[2], rect[3]]\n            ], rawHeight = viewport.rawDims.pageHeight;\n            const left = Math.min(boundingRect[0][0], boundingRect[1][0]) * this.zoom, top = (rawHeight - Math.max(boundingRect[0][1], boundingRect[1][1])) * this.zoom, width = (boundingRect[1][0] - boundingRect[0][0]) * this.zoom, height = (boundingRect[1][1] - boundingRect[0][1]) * this.zoom;\n            const url = annotation.url || (annotation.dest && `#${encodeURI(annotation.dest)}`);\n            const annotationElement = createElement('span', '', {\n                position: 'absolute',\n                left: left + 'pt',\n                top: top + 'pt'\n            });\n            const linkElement = this.linkElement = createElement('a', '', {\n                width: width + 'pt',\n                height: height + 'pt',\n                display: 'inline-block',\n                pointerEvents: 'auto'\n            });\n            linkElement.setAttribute('href', url);\n            annotationElement.append(linkElement);\n            this.container.append(annotationElement);\n        }\n    }\n\n    const MAX_CANVAS_WIDTH_HEIGHT_CHROME = 65535;\n    const MAX_CANVAS_AREA_CHROME_SAFARI = 268435456;\n    const MAX_CANVAS_WIDTH_HEIGHT_FIREFOX = 32767;\n    const MAX_CANVAS_AREA_FIREFOX = 124992400;\n    const MAX_CANVAS_WIDTH_SAFARI = 4194303;\n    const MAX_CANVAS_HEIGHT_SAFARI = 8388607;\n    const isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent) || (navigator.maxTouchPoints &&\n        navigator.maxTouchPoints > 2 &&\n        /Macintosh/i.test(navigator.userAgent));\n    const isSafari = (userAgent) => {\n        return kendo_common_cmn_chunk_js.d(userAgent).safari ||\n            (kendo_common_cmn_chunk_js.a(userAgent) && kendo_common_cmn_chunk_js.a(userAgent).browser === 'mobilesafari');\n    };\n    const isFirefox = (userAgent) => {\n        const desktopBrowser = kendo_common_cmn_chunk_js.d(userAgent);\n        const mobileOS = kendo_common_cmn_chunk_js.a(userAgent);\n        return (desktopBrowser && desktopBrowser.mozilla) || (mobileOS && mobileOS.browser === 'firefox');\n    };\n    /**\n     * @hidden\n     */\n    const DEFAULT_ZOOM_LEVEL$2 = 1.25;\n    const scale = () => (isIOS() ? devicePixelRatio : devicePixelRatio * 3);\n    const parsePdfFromBase64String = (base64String) => {\n        return atob(base64String.replace(/^(data:application\\/pdf;base64,)/gi, ''));\n    };\n    const getDocumentParameters = (options) => {\n        let params = {\n            verbosity: 0,\n            isEvalSupported: false\n        };\n        if (typeof options.data === 'string') {\n            params.data = parsePdfFromBase64String(options.data);\n        }\n        else if (typeof options.url === 'string') {\n            params.url = options.url;\n        }\n        else if (options.arrayBuffer instanceof ArrayBuffer) {\n            params = options.arrayBuffer;\n        }\n        else if (options.typedArray) {\n            params = options.typedArray;\n        }\n        return params;\n    };\n    /**\n     * @hidden\n     */\n    const removeChildren = (dom) => {\n        while (dom.firstChild) {\n            dom.removeChild(dom.firstChild);\n        }\n    };\n    const appendPage = (dom, page, index) => {\n        if (index === 0) {\n            removeChildren(dom);\n        }\n        dom.appendChild(page);\n    };\n    /**\n     * @hidden\n     */\n    const download = (options, fileName = 'Document', saveOptions = {}, onDownload) => {\n        if (options.pdf) {\n            options.pdf\n                .getData()\n                .then((data) => new Blob([data], { type: 'application/pdf' }))\n                .then((blob) => {\n                if (!onDownload(blob, fileName, saveOptions)) {\n                    kendo_fileSaver_cmn_chunk_js.s(blob, fileName, saveOptions);\n                }\n            })\n                .catch((reason) => {\n                options.error.call(undefined, reason);\n            });\n        }\n    };\n    /**\n     * @hidden\n     */\n    const loadPDF = (options) => {\n        const params = getDocumentParameters(options);\n        const { dom, zoom, done, error, rootElement } = options;\n        const loadOnDemandPageSize = options.loadOnDemandPageSize || 2;\n        kendo_pdfjs_loader_js.getDocument(params)\n            .promise.then((pdfDoc) => {\n            const pages = [];\n            for (let i = 1; i <= pdfDoc.numPages; i++) {\n                pages.push(pdfDoc.getPage(i));\n            }\n            return { pages, pdfDoc };\n        }).then(({ pages, pdfDoc }) => {\n            Promise.all(pages)\n                .then((all) => all.map((page, i) => {\n                const emptyPage = createEmptyPage(page, zoom, pdfDoc, rootElement);\n                appendPage(dom, emptyPage.pageElement, i);\n                if (options.loadOnDemand) {\n                    // If LOD is enabled, render the first two(default) or X pages initially.\n                    if (i < loadOnDemandPageSize) {\n                        renderPage(page, emptyPage, error);\n                    }\n                }\n                else {\n                    renderPage(page, emptyPage, error);\n                }\n                page._pageInfo.emptyPage = emptyPage;\n                return page;\n            })).then((pdfPages) => {\n                // required by new PDFJS version\n                const sheet = new CSSStyleSheet();\n                sheet.replaceSync(`.hiddenCanvasElement {\n                        position: absolute;\n                        top: 0;\n                        left: 0;\n                        width: 0;\n                        height: 0;\n                        display: none;\n                    }`);\n                options.dom.ownerDocument.adoptedStyleSheets = [sheet];\n                done({ pdfPages, pdfDoc, zoom });\n            })\n                .catch((reason) => {\n                options.error(reason);\n            });\n        })\n            .catch((reason) => {\n            options.error(reason);\n        });\n    };\n    /**\n     * @hidden\n     */\n    const reloadDocument = (params) => {\n        const { pdfDoc, zoom, dom, done, error, loadOnDemand, rootElement } = params;\n        const pages = [];\n        let currentPageIndex = 0;\n        // Save the index of the current page in view before we reload the document.\n        if (loadOnDemand && rootElement) {\n            currentPageIndex = currentPage(rootElement);\n        }\n        for (let i = 1; i <= pdfDoc.numPages; i++) {\n            pages.push(pdfDoc.getPage(i));\n        }\n        Promise.all(pages)\n            .then((all) => all.map((page, i) => {\n            // Set 'rendered' back to false so that the pages can be re-rendered when scrolling.\n            page._pageInfo.rendered = false;\n            const emptyPage = createEmptyPage(page, zoom, pdfDoc, rootElement);\n            appendPage(dom, emptyPage.pageElement, i);\n            // If on demand is not enabled, proceed as usual.\n            if (!loadOnDemand) {\n                renderPage(page, emptyPage, error);\n            }\n            page._pageInfo.emptyPage = emptyPage;\n            return page;\n        }))\n            .then((pdfPages) => {\n            /* If on demand is enabled, render the page that was previously in view.\n               Then scroll to that page. */\n            if (loadOnDemand) {\n                const page = pdfPages[currentPageIndex];\n                renderPage(page, page._pageInfo.emptyPage, error);\n                scrollToPage(rootElement, currentPageIndex);\n            }\n            done(pdfPages);\n        })\n            .catch(error);\n    };\n    /**\n     * @hidden\n     */\n    const print = (pages, done, error) => {\n        const dom = document.createElement('div');\n        const allDone = pages.map(() => false);\n        const scaleNum = scale();\n        pages.forEach((page, index) => {\n            const viewport = renderCanvas(page, (el) => {\n                dom.appendChild(el);\n                allDone[index] = true;\n                if (allDone.every(Boolean)) {\n                    openPrintDialog(dom, Math.floor(viewport.width / scaleNum), Math.floor(viewport.height / scaleNum), done, error);\n                }\n            }, error);\n        });\n    };\n    const openPrintDialog = (dom, width, height, done, onError) => {\n        const printDialog = window.open('', '', 'innerWidth=' +\n            width +\n            ',innerHeight=' +\n            height +\n            'location=no,titlebar=no,toolbar=no');\n        if (!printDialog || !printDialog.document) {\n            onError();\n            return;\n        }\n        if (printDialog) {\n            printDialog.document.body.style.margin = '0';\n            printDialog.document.body.appendChild(dom);\n            printDialog.focus();\n            setTimeout(() => {\n                printDialog.print();\n                done();\n            });\n            const onAfterPrint = () => {\n                printDialog.removeEventListener('afterprint', onAfterPrint);\n                printDialog.close();\n            };\n            printDialog.addEventListener('afterprint', onAfterPrint);\n        }\n    };\n    const createEmptyPage = (page, zoom, pdfDoc, rootElement) => {\n        const { canvasContext, viewport, pageElement, styles } = createCanvas(page, zoom, 'k-page');\n        return {\n            canvasContext,\n            viewport,\n            pageElement,\n            styles,\n            zoom,\n            pdfDoc,\n            rootElement\n        };\n    };\n    const renderCanvas = (page, done, error) => {\n        const { canvasContext, viewport, scaleNum, canvas, pageElement } = createCanvas(page);\n        page.render({ canvasContext, viewport })\n            .promise.then(() => {\n            const printContent = new Image(Math.floor((viewport.width / scaleNum)), Math.floor((viewport.height / scaleNum)));\n            printContent.src = canvas.toDataURL();\n            const onload = () => {\n                printContent.removeEventListener('load', onload);\n                done(pageElement);\n            };\n            printContent.addEventListener('load', onload);\n        })\n            .catch(error);\n        return viewport;\n    };\n    const createElement = function (name, className, styles) {\n        const element = document.createElement(name);\n        if (className) {\n            element.className = className;\n        }\n        Object.keys(styles).forEach((key) => (element.style[key] = styles[key]));\n        return element;\n    };\n    const transforms = {\n        '0': '',\n        '90': 'rotate(90deg) translateY(-100%)',\n        '180': 'rotate(180deg) translate(-100%, -100%)',\n        '270': 'rotate(270deg) translateX(-100%)'\n    };\n    const renderPage = (page, emptyPage, error) => {\n        const { canvasContext, viewport, pageElement, styles, zoom, pdfDoc, rootElement } = emptyPage;\n        page._pageInfo.renderInProgress = true;\n        page.render({ canvasContext, viewport })\n            .promise.then(() => {\n            page.getTextContent().then((textContent) => {\n                const textLayer = createElement('div', 'k-text-layer', styles);\n                new kendo_pdfjs_loader_js.TextLayer({\n                    textContentSource: textContent,\n                    container: textLayer,\n                    viewport: viewport\n                }).render().then(() => {\n                    textLayer.style.width = textLayer.style.width.replace(/px/g, 'pt');\n                    textLayer.style.height = textLayer.style.height.replace(/px/g, 'pt');\n                    const rotation = textLayer.getAttribute('data-main-rotation') || '0';\n                    if (transforms[rotation]) {\n                        textLayer.style.transform = transforms[rotation];\n                        textLayer.style.transformOrigin = 'top left';\n                    }\n                    textLayer.querySelectorAll('span').forEach((el) => {\n                        if (el.style.fontSize) {\n                            el.style.fontSize = el.style.fontSize.replace(/px/g, 'pt');\n                        }\n                    });\n                    pageElement.prepend(textLayer); // Use prepend to ensure the element is always inserted before the annotation layer.\n                }).catch(error);\n            });\n            page.getAnnotations({ intent: 'display' }).then((annotations) => {\n                const annotationLayer = createElement('div', 'k-annotations-layer', {\n                    position: 'absolute',\n                    top: '0',\n                    left: '0',\n                    overflow: 'hidden',\n                    height: styles.height,\n                    width: styles.width,\n                    pointerEvents: 'none'\n                });\n                pageElement.appendChild(annotationLayer);\n                for (const annotation of annotations) {\n                    switch (annotation.subtype) {\n                        case 'Link':\n                            new LinkAnnotation(annotationLayer, viewport, annotation, pdfDoc, zoom, rootElement);\n                            break;\n                        default:\n                            null;\n                    }\n                }\n            });\n        })\n            .then(() => {\n            page._pageInfo.rendered = true;\n            page._pageInfo.renderInProgress = false;\n        })\n            .catch(error);\n        return pageElement;\n    };\n    const searchMatchScrollLeftOffset = 0;\n    const searchMatchScrollTopOffset = -64;\n    const scrollToSearchMatch = (matchElement, ref) => {\n        if (!matchElement) {\n            return;\n        }\n        const closestCharElement = matchElement.closest('.k-text-char');\n        const closestTextElement = closestCharElement\n            ? closestCharElement.closest('span[role=\"presentation\"]')\n            : null;\n        if (!closestTextElement) {\n            return;\n        }\n        const closestPageElement = closestTextElement.closest('.k-page');\n        if (!closestPageElement) {\n            return;\n        }\n        const scrollLeft = closestPageElement.offsetLeft +\n            -1 * ref.scroller.element.offsetLeft +\n            closestTextElement.offsetLeft +\n            searchMatchScrollLeftOffset;\n        const scrollTop = closestPageElement.offsetTop +\n            -1 * ref.scroller.element.offsetTop +\n            closestTextElement.offsetTop +\n            searchMatchScrollTopOffset;\n        ref.scroller.scrollTo(scrollLeft, scrollTop, { trackScrollEvent: false });\n    };\n    /**\n     * @hidden\n     */\n    const goToNextSearchMatch = (ref) => {\n        ref.search.markNextMatch();\n        const matchElement = ref.search.getActiveMatchElement();\n        scrollToSearchMatch(matchElement, ref);\n    };\n    /**\n     * @hidden\n     */\n    const goToPreviousSearchMatch = (ref) => {\n        ref.search.markPreviousMatch();\n        const matchElement = ref.search.getActiveMatchElement();\n        scrollToSearchMatch(matchElement, ref);\n    };\n    /**\n     * @hidden\n     */\n    const calculateZoomLevel = (zoomLevel, zoomLevelType, currentZoom, dom) => {\n        const documentContainer = dom.closest('.k-pdf-viewer-canvas');\n        const page = dom.querySelector('.k-page');\n        const pageSize = { width: page.offsetWidth, height: page.offsetHeight };\n        let calculatedZoomLevel = zoomLevel;\n        if (zoomLevelType === 'ActualWidth') {\n            calculatedZoomLevel = 1;\n        }\n        else if (zoomLevelType === 'FitToWidth') {\n            calculatedZoomLevel =\n                documentContainer.offsetWidth / (pageSize.width / currentZoom);\n        }\n        else if (zoomLevelType === 'FitToPage') {\n            calculatedZoomLevel =\n                documentContainer.offsetHeight / (pageSize.height / currentZoom);\n        }\n        return calculatedZoomLevel;\n    };\n    /**\n     * Scrolls the PDFViewer document to the passed page number.\n     *\n     * @param rootElement The root HTML element of the PDFViewer component.\n     * @param pageNumber The page number.\n     */\n    const scrollToPage = (rootElement, pageNumber) => {\n        const pages = rootElement.querySelectorAll('.k-page');\n        const page = pages[0];\n        if (page instanceof HTMLDivElement) {\n            const top = (page.offsetHeight + page.offsetTop) *\n                Math.max(0, Math.min(pageNumber, pages.length - 1));\n            const scrollElement = page.closest('.k-pdf-viewer-canvas');\n            if (scrollElement) {\n                scrollElement.scrollTo({ top, behavior: 'auto' });\n            }\n        }\n    };\n    /**\n     * A function which gives you the page number of the document according to the scroll position.\n     *\n     * @param rootElement The root HTML element of the PDFViewer component.\n     * @returns The page number.\n     */\n    const currentPage = (rootElement) => {\n        const scrollElement = rootElement.querySelector('.k-pdf-viewer-canvas');\n        const page = rootElement.querySelector('.k-page');\n        return scrollElement && page\n            ? Math.floor(Math.round(scrollElement.scrollTop) /\n                (page.offsetHeight + page.offsetTop) +\n                0.01)\n            : 0;\n    };\n    /**\n     * @hidden\n     *\n     * related to https://github.com/telerik/kendo-pdfviewer-common/issues/6\n     * the bigger the canvas size, the worse the performance;\n     * if initial size after scaling is greater than browser limits,\n     * we are limiting it to the limits, then halving it for performance.\n     */\n    const adjustCanvasSize = (targetWidth, targetHeight) => {\n        const { maxWidth, maxHeight, maxArea } = isFirefox(navigator.userAgent) ?\n            { maxWidth: MAX_CANVAS_WIDTH_HEIGHT_FIREFOX, maxHeight: MAX_CANVAS_WIDTH_HEIGHT_FIREFOX, maxArea: MAX_CANVAS_AREA_FIREFOX } :\n            isSafari(navigator.userAgent) ?\n                { maxWidth: MAX_CANVAS_WIDTH_SAFARI, maxHeight: MAX_CANVAS_HEIGHT_SAFARI, maxArea: MAX_CANVAS_AREA_CHROME_SAFARI } :\n                {\n                    maxWidth: MAX_CANVAS_WIDTH_HEIGHT_CHROME,\n                    maxHeight: MAX_CANVAS_WIDTH_HEIGHT_CHROME,\n                    maxArea: MAX_CANVAS_AREA_CHROME_SAFARI\n                };\n        let adjustedWidth = targetWidth;\n        let adjustedHeight = targetHeight;\n        const ratio = targetWidth / targetHeight;\n        if (targetWidth > maxWidth) {\n            adjustedWidth = maxWidth;\n            const deltaWidth = targetWidth - maxWidth;\n            const deltaHeight = deltaWidth / ratio;\n            adjustedHeight = targetHeight - deltaHeight;\n        }\n        if (adjustedHeight > maxHeight) {\n            const deltaHeight = adjustedHeight - maxHeight;\n            const deltaWidth = deltaHeight * ratio;\n            adjustedHeight = maxHeight;\n            adjustedWidth -= deltaWidth;\n        }\n        const adjustedArea = adjustedWidth * adjustedHeight;\n        if (adjustedArea > maxArea) {\n            const areaRatio = Math.sqrt(maxArea / adjustedArea);\n            adjustedWidth *= areaRatio;\n            adjustedHeight *= areaRatio;\n        }\n        const adjustRatio = adjustedWidth / targetWidth;\n        return {\n            adjustedWidth: adjustedWidth !== targetWidth ? Math.floor(adjustedWidth / 2) : targetWidth,\n            adjustedHeight: adjustedHeight !== targetHeight ? Math.floor(adjustedHeight / 2) : targetHeight,\n            adjustRatio: adjustRatio !== 1 ? adjustRatio / 2 : 1\n        };\n    };\n    const createCanvas = (page, zoom = 1, cssClass = '') => {\n        const scaleNum = scale();\n        const viewport = page.getViewport({ scale: scaleNum });\n        const { adjustedWidth, adjustedHeight, adjustRatio } = adjustCanvasSize(viewport.width, viewport.height);\n        const styles = {\n            width: Math.floor(viewport.width / scaleNum) * zoom + 'pt',\n            height: Math.floor(viewport.height / scaleNum) * zoom + 'pt'\n        };\n        const pageElement = createElement('div', cssClass, styles);\n        const canvas = createElement('canvas', '', {\n            width: '100%',\n            height: '100%'\n        });\n        canvas.height = adjustedHeight;\n        canvas.width = adjustedWidth;\n        const canvasContext = canvas.getContext('2d');\n        pageElement.appendChild(canvas);\n        const adjustedScale = adjustRatio * scaleNum;\n        viewport.width = adjustedWidth;\n        viewport.height = adjustedHeight;\n        viewport.scale = adjustedScale;\n        return {\n            canvasContext,\n            viewport,\n            scaleNum,\n            canvas,\n            pageElement,\n            styles\n        };\n    };\n\n    const addClass = (className, element) => {\n        element.classList.add(className);\n    };\n    const removeClass = (className, element) => {\n        element.classList.remove(className);\n    };\n    const hasClass = (className, element) => {\n        if (element instanceof HTMLElement) {\n            return element.classList.contains(className);\n        }\n    };\n\n    const clamp = (value, min, max) => Math.min(max, Math.max(min, value));\n\n    /* Copyright 2012 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    // /* globals process */\n    // NW.js / Electron is a browser context, but copies some Node.js objects; see\n    // http://docs.nwjs.io/en/latest/For%20Users/Advanced/JavaScript%20Contexts%20in%20NW.js/access-nodejs-and-nwjs-api-in-browser-context\n    // https://www.electronjs.org/docs/api/processprocessversionselectron-readonly\n    // https://www.electronjs.org/docs/api/processprocesstype-readonly\n    // const isNodeJS =\n    //     (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n    //     typeof process === \"object\" &&\n    //     process + \"\" === \"[object process]\" &&\n    //     !process.versions.nw &&\n    //     !(process.versions.electron && process.type && process.type !== \"browser\");\n    // const IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\n    // const FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\n    // const MAX_IMAGE_SIZE_TO_CACHE = 10e6; // Ten megabytes.\n    // Represent the percentage of the height of a single-line field over\n    // the font size. Acrobat seems to use this value.\n    const LINE_FACTOR = 1.35;\n    const LINE_DESCENT_FACTOR = 0.35;\n    const BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\n    /**\n     * Refer to the `WorkerTransport.getRenderingIntent`-method in the API, to see\n     * how these flags are being used:\n     *  - ANY, DISPLAY, and PRINT are the normal rendering intents, note the\n     *    `PDFPageProxy.{render, getOperatorList, getAnnotations}`-methods.\n     *  - SAVE is used, on the worker-thread, when saving modified annotations.\n     *  - ANNOTATIONS_FORMS, ANNOTATIONS_STORAGE, ANNOTATIONS_DISABLE control which\n     *    annotations are rendered onto the canvas (i.e. by being included in the\n     *    operatorList), note the `PDFPageProxy.{render, getOperatorList}`-methods\n     *    and their `annotationMode`-option.\n     *  - IS_EDITING is used when editing is active in the viewer.\n     *  - OPLIST is used with the `PDFPageProxy.getOperatorList`-method, note the\n     *    `OperatorList`-constructor (on the worker-thread).\n     */\n    // const RenderingIntentFlag = {\n    //     ANY: 0x01,\n    //     DISPLAY: 0x02,\n    //     PRINT: 0x04,\n    //     SAVE: 0x08,\n    //     ANNOTATIONS_FORMS: 0x10,\n    //     ANNOTATIONS_STORAGE: 0x20,\n    //     ANNOTATIONS_DISABLE: 0x40,\n    //     IS_EDITING: 0x80,\n    //     OPLIST: 0x100\n    // };\n    const AnnotationMode = {\n        DISABLE: 0,\n        ENABLE: 1,\n        ENABLE_FORMS: 2,\n        ENABLE_STORAGE: 3\n    };\n    const AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\n    const AnnotationEditorType = {\n        DISABLE: -1,\n        NONE: 0,\n        FREETEXT: 3,\n        HIGHLIGHT: 9,\n        STAMP: 13,\n        INK: 15\n    };\n    const AnnotationEditorParamsType = {\n        RESIZE: 1,\n        CREATE: 2,\n        FREETEXT_SIZE: 11,\n        FREETEXT_COLOR: 12,\n        FREETEXT_OPACITY: 13,\n        INK_COLOR: 21,\n        INK_THICKNESS: 22,\n        INK_OPACITY: 23,\n        HIGHLIGHT_COLOR: 31,\n        HIGHLIGHT_DEFAULT_COLOR: 32,\n        HIGHLIGHT_THICKNESS: 33,\n        HIGHLIGHT_FREE: 34,\n        HIGHLIGHT_SHOW_ALL: 35\n    };\n    // Permission flags from Table 22, Section 7.6.3.2 of the PDF specification.\n    // const PermissionFlag = {\n    //     PRINT: 0x04,\n    //     MODIFY_CONTENTS: 0x08,\n    //     COPY: 0x10,\n    //     MODIFY_ANNOTATIONS: 0x20,\n    //     FILL_INTERACTIVE_FORMS: 0x100,\n    //     COPY_FOR_ACCESSIBILITY: 0x200,\n    //     ASSEMBLE: 0x400,\n    //     PRINT_HIGH_QUALITY: 0x800\n    // };\n    // const TextRenderingMode = {\n    //     FILL: 0,\n    //     STROKE: 1,\n    //     FILL_STROKE: 2,\n    //     INVISIBLE: 3,\n    //     FILL_ADD_TO_PATH: 4,\n    //     STROKE_ADD_TO_PATH: 5,\n    //     FILL_STROKE_ADD_TO_PATH: 6,\n    //     ADD_TO_PATH: 7,\n    //     FILL_STROKE_MASK: 3,\n    //     ADD_TO_PATH_FLAG: 4\n    // };\n    // const ImageKind = {\n    //     GRAYSCALE_1BPP: 1,\n    //     RGB_24BPP: 2,\n    //     RGBA_32BPP: 3\n    // };\n    const AnnotationType = {\n        TEXT: 1,\n        LINK: 2,\n        FREETEXT: 3,\n        LINE: 4,\n        SQUARE: 5,\n        CIRCLE: 6,\n        POLYGON: 7,\n        POLYLINE: 8,\n        HIGHLIGHT: 9,\n        UNDERLINE: 10,\n        SQUIGGLY: 11,\n        STRIKEOUT: 12,\n        STAMP: 13,\n        CARET: 14,\n        INK: 15,\n        POPUP: 16,\n        FILEATTACHMENT: 17,\n        SOUND: 18,\n        MOVIE: 19,\n        WIDGET: 20,\n        SCREEN: 21,\n        PRINTERMARK: 22,\n        TRAPNET: 23,\n        WATERMARK: 24,\n        THREED: 25,\n        REDACT: 26\n    };\n    const AnnotationReplyType = {\n        GROUP: \"Group\",\n        REPLY: \"R\"\n    };\n    const AnnotationFlag = {\n        INVISIBLE: 0x01,\n        HIDDEN: 0x02,\n        PRINT: 0x04,\n        NOZOOM: 0x08,\n        NOROTATE: 0x10,\n        NOVIEW: 0x20,\n        READONLY: 0x40,\n        LOCKED: 0x80,\n        TOGGLENOVIEW: 0x100,\n        LOCKEDCONTENTS: 0x200\n    };\n    const AnnotationFieldFlag = {\n        READONLY: 0x0000001,\n        REQUIRED: 0x0000002,\n        NOEXPORT: 0x0000004,\n        MULTILINE: 0x0001000,\n        PASSWORD: 0x0002000,\n        NOTOGGLETOOFF: 0x0004000,\n        RADIO: 0x0008000,\n        PUSHBUTTON: 0x0010000,\n        COMBO: 0x0020000,\n        EDIT: 0x0040000,\n        SORT: 0x0080000,\n        FILESELECT: 0x0100000,\n        MULTISELECT: 0x0200000,\n        DONOTSPELLCHECK: 0x0400000,\n        DONOTSCROLL: 0x0800000,\n        COMB: 0x1000000,\n        RICHTEXT: 0x2000000,\n        RADIOSINUNISON: 0x2000000,\n        COMMITONSELCHANGE: 0x4000000\n    };\n    const AnnotationBorderStyleType = {\n        SOLID: 1,\n        DASHED: 2,\n        BEVELED: 3,\n        INSET: 4,\n        UNDERLINE: 5\n    };\n    const AnnotationActionEventType = {\n        E: \"Mouse Enter\",\n        X: \"Mouse Exit\",\n        D: \"Mouse Down\",\n        U: \"Mouse Up\",\n        Fo: \"Focus\",\n        Bl: \"Blur\",\n        PO: \"PageOpen\",\n        PC: \"PageClose\",\n        PV: \"PageVisible\",\n        PI: \"PageInvisible\",\n        K: \"Keystroke\",\n        F: \"Format\",\n        V: \"Validate\",\n        C: \"Calculate\"\n    };\n    // const DocumentActionEventType = {\n    //     WC: \"WillClose\",\n    //     WS: \"WillSave\",\n    //     DS: \"DidSave\",\n    //     WP: \"WillPrint\",\n    //     DP: \"DidPrint\"\n    // };\n    // const PageActionEventType = {\n    //     O: \"PageOpen\",\n    //     C: \"PageClose\"\n    // };\n    // const VerbosityLevel = {\n    //     ERRORS: 0,\n    //     WARNINGS: 1,\n    //     INFOS: 5\n    // };\n    // const CMapCompressionType = {\n    //     NONE: 0,\n    //     BINARY: 1\n    // };\n    // // All the possible operations for an operator list.\n    // const OPS = {\n    //     // Intentionally start from 1 so it is easy to spot bad operators that will be\n    //     // 0's.\n    //     // PLEASE NOTE: We purposely keep any removed operators commented out, since\n    //     //              re-numbering the list would risk breaking third-party users.\n    //     dependency: 1,\n    //     setLineWidth: 2,\n    //     setLineCap: 3,\n    //     setLineJoin: 4,\n    //     setMiterLimit: 5,\n    //     setDash: 6,\n    //     setRenderingIntent: 7,\n    //     setFlatness: 8,\n    //     setGState: 9,\n    //     save: 10,\n    //     restore: 11,\n    //     transform: 12,\n    //     moveTo: 13,\n    //     lineTo: 14,\n    //     curveTo: 15,\n    //     curveTo2: 16,\n    //     curveTo3: 17,\n    //     closePath: 18,\n    //     rectangle: 19,\n    //     stroke: 20,\n    //     closeStroke: 21,\n    //     fill: 22,\n    //     eoFill: 23,\n    //     fillStroke: 24,\n    //     eoFillStroke: 25,\n    //     closeFillStroke: 26,\n    //     closeEOFillStroke: 27,\n    //     endPath: 28,\n    //     clip: 29,\n    //     eoClip: 30,\n    //     beginText: 31,\n    //     endText: 32,\n    //     setCharSpacing: 33,\n    //     setWordSpacing: 34,\n    //     setHScale: 35,\n    //     setLeading: 36,\n    //     setFont: 37,\n    //     setTextRenderingMode: 38,\n    //     setTextRise: 39,\n    //     moveText: 40,\n    //     setLeadingMoveText: 41,\n    //     setTextMatrix: 42,\n    //     nextLine: 43,\n    //     showText: 44,\n    //     showSpacedText: 45,\n    //     nextLineShowText: 46,\n    //     nextLineSetSpacingShowText: 47,\n    //     setCharWidth: 48,\n    //     setCharWidthAndBounds: 49,\n    //     setStrokeColorSpace: 50,\n    //     setFillColorSpace: 51,\n    //     setStrokeColor: 52,\n    //     setStrokeColorN: 53,\n    //     setFillColor: 54,\n    //     setFillColorN: 55,\n    //     setStrokeGray: 56,\n    //     setFillGray: 57,\n    //     setStrokeRGBColor: 58,\n    //     setFillRGBColor: 59,\n    //     setStrokeCMYKColor: 60,\n    //     setFillCMYKColor: 61,\n    //     shadingFill: 62,\n    //     beginInlineImage: 63,\n    //     beginImageData: 64,\n    //     endInlineImage: 65,\n    //     paintXObject: 66,\n    //     markPoint: 67,\n    //     markPointProps: 68,\n    //     beginMarkedContent: 69,\n    //     beginMarkedContentProps: 70,\n    //     endMarkedContent: 71,\n    //     beginCompat: 72,\n    //     endCompat: 73,\n    //     paintFormXObjectBegin: 74,\n    //     paintFormXObjectEnd: 75,\n    //     beginGroup: 76,\n    //     endGroup: 77,\n    //     // beginAnnotations: 78,\n    //     // endAnnotations: 79,\n    //     beginAnnotation: 80,\n    //     endAnnotation: 81,\n    //     // paintJpegXObject: 82,\n    //     paintImageMaskXObject: 83,\n    //     paintImageMaskXObjectGroup: 84,\n    //     paintImageXObject: 85,\n    //     paintInlineImageXObject: 86,\n    //     paintInlineImageXObjectGroup: 87,\n    //     paintImageXObjectRepeat: 88,\n    //     paintImageMaskXObjectRepeat: 89,\n    //     paintSolidColorImageMask: 90,\n    //     constructPath: 91,\n    //     setStrokeTransparent: 92,\n    //     setFillTransparent: 93\n    // };\n    // const PasswordResponses = {\n    //     NEED_PASSWORD: 1,\n    //     INCORRECT_PASSWORD: 2\n    // };\n    // let verbosity = VerbosityLevel.WARNINGS;\n    // function setVerbosityLevel(level) {\n    //     if (Number.isInteger(level)) {\n    //         verbosity = level;\n    //     }\n    // }\n    // function getVerbosityLevel() {\n    //     return verbosity;\n    // }\n    // // A notice for devs. These are good for things that are helpful to devs, such\n    // // as warning that Workers were disabled, which is important to devs but not\n    // // end users.\n    // function info(msg) {\n    //     if (verbosity >= VerbosityLevel.INFOS) {\n    //         console.log(`Info: ${msg}`);\n    //     }\n    // }\n    // // Non-fatal warnings.\n    // function warn(msg) {\n    //     if (verbosity >= VerbosityLevel.WARNINGS) {\n    //         console.log(`Warning: ${msg}`);\n    //     }\n    // }\n    // function unreachable(msg) {\n    //     throw new Error(msg);\n    // }\n    // function assert(cond, msg) {\n    //     if (!cond) {\n    //         unreachable(msg);\n    //     }\n    // }\n    // // Checks if URLs use one of the allowed protocols, e.g. to avoid XSS.\n    // function _isValidProtocol(url) {\n    //     if (!url || (url && !url.protocol)) {\n    //         return false;\n    //     }\n    //     switch (url.protocol) {\n    //         case \"http:\":\n    //         case \"https:\":\n    //         case \"ftp:\":\n    //         case \"mailto:\":\n    //         case \"tel:\":\n    //             return true;\n    //         default:\n    //             return false;\n    //     }\n    // }\n    // /**\n    //  * Attempts to create a valid absolute URL.\n    //  *\n    //  * @param {URL|string} url - An absolute, or relative, URL.\n    //  * @param {URL|string} [baseUrl] - An absolute URL.\n    //  * @param {Object} [options]\n    //  * @returns Either a valid {URL}, or `null` otherwise.\n    //  */\n    // function createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n    //     if (!url) {\n    //         return null;\n    //     }\n    //     try {\n    //         if (options && typeof url === \"string\") {\n    //             // Let URLs beginning with \"www.\" default to using the \"http://\" protocol.\n    //             if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n    //                 const dots = url.match(/\\./g);\n    //                 // Avoid accidentally matching a *relative* URL pointing to a file named\n    //                 // e.g. \"www.pdf\" or similar.\n    //                 if (dots && dots.length >= 2) {\n    //                     url = `http://${url}`;\n    //                 }\n    //             }\n    //             // According to ISO 32000-1:2008, section 12.6.4.7, URIs should be encoded\n    //             // in 7-bit ASCII. Some bad PDFs use UTF-8 encoding; see bug 1122280.\n    //             if (options.tryConvertEncoding) {\n    //                 try {\n    //                     url = stringToUTF8String(url);\n    //                 } catch (e) { }\n    //             }\n    //         }\n    //         const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    //         if (_isValidProtocol(absoluteUrl)) {\n    //             return absoluteUrl;\n    //         }\n    //     } catch (e) {\n    //         /* `new URL()` will throw on incorrect data. */\n    //     }\n    //     return null;\n    // }\n    function shadow(obj, prop, value, nonSerializable = false) {\n        // if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n        //     assert(\n        //         prop in obj,\n        //         `shadow: Property \"${prop && prop.toString()}\" not found in object.`\n        //     );\n        // }\n        Object.defineProperty(obj, prop, {\n            value,\n            enumerable: !nonSerializable,\n            configurable: true,\n            writable: false\n        });\n        return value;\n    }\n    // /**\n    //  * @type {any}\n    //  */\n    // const BaseException = (function BaseExceptionClosure() {\n    //     // eslint-disable-next-line no-shadow\n    //     function BaseException(message, name) {\n    //         if (this.constructor === BaseException) {\n    //             unreachable(\"Cannot initialize BaseException.\");\n    //         }\n    //         this.message = message;\n    //         this.name = name;\n    //     }\n    //     BaseException.prototype = new Error();\n    //     BaseException.constructor = BaseException;\n    //     return BaseException;\n    // })();\n    // class PasswordException extends BaseException {\n    //     constructor(msg, code) {\n    //         super(msg, \"PasswordException\");\n    //         this.code = code;\n    //     }\n    // }\n    // class UnknownErrorException extends BaseException {\n    //     constructor(msg, details) {\n    //         super(msg, \"UnknownErrorException\");\n    //         this.details = details;\n    //     }\n    // }\n    // class InvalidPDFException extends BaseException {\n    //     constructor(msg) {\n    //         super(msg, \"InvalidPDFException\");\n    //     }\n    // }\n    // class MissingPDFException extends BaseException {\n    //     constructor(msg) {\n    //         super(msg, \"MissingPDFException\");\n    //     }\n    // }\n    // class UnexpectedResponseException extends BaseException {\n    //     constructor(msg, status) {\n    //         super(msg, \"UnexpectedResponseException\");\n    //         this.status = status;\n    //     }\n    // }\n    // /**\n    //  * Error caused during parsing PDF data.\n    //  */\n    // class FormatError extends BaseException {\n    //     constructor(msg) {\n    //         super(msg, \"FormatError\");\n    //     }\n    // }\n    // /**\n    //  * Error used to indicate task cancellation.\n    //  */\n    // class AbortException extends BaseException {\n    //     constructor(msg) {\n    //         super(msg, \"AbortException\");\n    //     }\n    // }\n    function bytesToString(bytes) {\n        if (typeof bytes !== \"object\" || (bytes && bytes.length === undefined)) {\n            // unreachable(\"Invalid argument for bytesToString\");\n        }\n        const length = bytes.length;\n        const MAX_ARGUMENT_COUNT = 8192;\n        if (length < MAX_ARGUMENT_COUNT) {\n            return String.fromCharCode.apply(null, bytes);\n        }\n        const strBuf = [];\n        for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n            const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n            const chunk = bytes.subarray(i, chunkEnd);\n            strBuf.push(String.fromCharCode.apply(null, chunk));\n        }\n        return strBuf.join(\"\");\n    }\n    // function stringToBytes(str) {\n    //     if (typeof str !== \"string\") {\n    //         unreachable(\"Invalid argument for stringToBytes\");\n    //     }\n    //     const length = str.length;\n    //     const bytes = new Uint8Array(length);\n    //     for (let i = 0; i < length; ++i) {\n    //         bytes[i] = str.charCodeAt(i) & 0xff;\n    //     }\n    //     return bytes;\n    // }\n    // function string32(value) {\n    //     if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n    //         assert(\n    //             typeof value === \"number\" && Math.abs(value) < 2 ** 32,\n    //             `string32: Unexpected input \"${value}\".`\n    //         );\n    //     }\n    //     return String.fromCharCode(\n    //         (value >> 24) & 0xff,\n    //         (value >> 16) & 0xff,\n    //         (value >> 8) & 0xff,\n    //         value & 0xff\n    //     );\n    // }\n    // function objectSize(obj) {\n    //     return Object.keys(obj).length;\n    // }\n    // // Ensure that the returned Object has a `null` prototype; hence why\n    // // `Object.fromEntries(...)` is not used.\n    function objectFromMap(map) {\n        const obj = Object.create(null);\n        for (const [key, value] of map) {\n            obj[key] = value;\n        }\n        return obj;\n    }\n    // // Checks the endianness of the platform.\n    // function isLittleEndian() {\n    //     const buffer8 = new Uint8Array(4);\n    //     buffer8[0] = 1;\n    //     const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n    //     return view32[0] === 1;\n    // }\n    // // Checks if it's possible to eval JS expressions.\n    // function isEvalSupported() {\n    //     try {\n    //         new Function(\"\"); // eslint-disable-line no-new, no-new-func\n    //         return true;\n    //     } catch (e) {\n    //         return false;\n    //     }\n    // }\n    class FeatureTest {\n        // static get isLittleEndian() {\n        //     return shadow(this, \"isLittleEndian\", isLittleEndian());\n        // }\n        // static get isEvalSupported() {\n        //     return shadow(this, \"isEvalSupported\", isEvalSupported());\n        // }\n        // static get isOffscreenCanvasSupported() {\n        //     return shadow(\n        //         this,\n        //         \"isOffscreenCanvasSupported\",\n        //         typeof OffscreenCanvas !== \"undefined\"\n        //     );\n        // }\n        // static get platform() {\n        //     if (\n        //         (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n        //         (typeof navigator !== \"undefined\" &&\n        //             navigator && typeof navigator.platform === \"string\")\n        //     ) {\n        //         return shadow(this, \"platform\", {\n        //             isMac: navigator.platform.includes(\"Mac\"),\n        //         });\n        //     }\n        //     return shadow(this, \"platform\", { isMac: false });\n        // }\n        static get isCSSRoundSupported() {\n            return shadow(this, \"isCSSRoundSupported\", globalThis && globalThis.CSS && globalThis.CSS.supports &&\n                globalThis.CSS.supports(\"width: round(1.5px, 1px)\"));\n        }\n    }\n    const hexNumbers = Array.from(Array(256).keys(), n => n.toString(16).padStart(2, \"0\"));\n    class Util {\n        static makeHexColor(r, g, b) {\n            return `${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n        }\n        //     // Apply a scaling matrix to some min/max values.\n        //     // If a scaling factor is negative then min and max must be\n        //     // swapped.\n        //     static scaleMinMax(transform, minMax) {\n        //         let temp;\n        //         if (transform[0]) {\n        //             if (transform[0] < 0) {\n        //                 temp = minMax[0];\n        //                 minMax[0] = minMax[2];\n        //                 minMax[2] = temp;\n        //             }\n        //             minMax[0] *= transform[0];\n        //             minMax[2] *= transform[0];\n        //             if (transform[3] < 0) {\n        //                 temp = minMax[1];\n        //                 minMax[1] = minMax[3];\n        //                 minMax[3] = temp;\n        //             }\n        //             minMax[1] *= transform[3];\n        //             minMax[3] *= transform[3];\n        //         } else {\n        //             temp = minMax[0];\n        //             minMax[0] = minMax[1];\n        //             minMax[1] = temp;\n        //             temp = minMax[2];\n        //             minMax[2] = minMax[3];\n        //             minMax[3] = temp;\n        //             if (transform[1] < 0) {\n        //                 temp = minMax[1];\n        //                 minMax[1] = minMax[3];\n        //                 minMax[3] = temp;\n        //             }\n        //             minMax[1] *= transform[1];\n        //             minMax[3] *= transform[1];\n        //             if (transform[2] < 0) {\n        //                 temp = minMax[0];\n        //                 minMax[0] = minMax[2];\n        //                 minMax[2] = temp;\n        //             }\n        //             minMax[0] *= transform[2];\n        //             minMax[2] *= transform[2];\n        //         }\n        //         minMax[0] += transform[4];\n        //         minMax[1] += transform[5];\n        //         minMax[2] += transform[4];\n        //         minMax[3] += transform[5];\n        //     }\n        //     // Concatenates two transformation matrices together and returns the result.\n        //     static transform(m1, m2) {\n        //         return [\n        //             m1[0] * m2[0] + m1[2] * m2[1],\n        //             m1[1] * m2[0] + m1[3] * m2[1],\n        //             m1[0] * m2[2] + m1[2] * m2[3],\n        //             m1[1] * m2[2] + m1[3] * m2[3],\n        //             m1[0] * m2[4] + m1[2] * m2[5] + m1[4],\n        //             m1[1] * m2[4] + m1[3] * m2[5] + m1[5],\n        //         ];\n        //     }\n        //     // For 2d affine transforms\n        //     static applyTransform(p, m) {\n        //         const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n        //         const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n        //         return [xt, yt];\n        //     }\n        //     static applyInverseTransform(p, m) {\n        //         const d = m[0] * m[3] - m[1] * m[2];\n        //         const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n        //         const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n        //         return [xt, yt];\n        //     }\n        //     // Applies the transform to the rectangle and finds the minimum axially\n        //     // aligned bounding box.\n        //     static getAxialAlignedBoundingBox(r, m) {\n        //         const p1 = this.applyTransform(r, m);\n        //         const p2 = this.applyTransform(r.slice(2, 4), m);\n        //         const p3 = this.applyTransform([r[0], r[3]], m);\n        //         const p4 = this.applyTransform([r[2], r[1]], m);\n        //         return [\n        //             Math.min(p1[0], p2[0], p3[0], p4[0]),\n        //             Math.min(p1[1], p2[1], p3[1], p4[1]),\n        //             Math.max(p1[0], p2[0], p3[0], p4[0]),\n        //             Math.max(p1[1], p2[1], p3[1], p4[1]),\n        //         ];\n        //     }\n        //     static inverseTransform(m) {\n        //         const d = m[0] * m[3] - m[1] * m[2];\n        //         return [\n        //             m[3] / d,\n        //             -m[1] / d,\n        //             -m[2] / d,\n        //             m[0] / d,\n        //             (m[2] * m[5] - m[4] * m[3]) / d,\n        //             (m[4] * m[1] - m[5] * m[0]) / d,\n        //         ];\n        //     }\n        //     // This calculation uses Singular Value Decomposition.\n        //     // The SVD can be represented with formula A = USV. We are interested in the\n        //     // matrix S here because it represents the scale values.\n        //     static singularValueDecompose2dScale(m) {\n        //         const transpose = [m[0], m[2], m[1], m[3]];\n        //         // Multiply matrix m with its transpose.\n        //         const a = m[0] * transpose[0] + m[1] * transpose[2];\n        //         const b = m[0] * transpose[1] + m[1] * transpose[3];\n        //         const c = m[2] * transpose[0] + m[3] * transpose[2];\n        //         const d = m[2] * transpose[1] + m[3] * transpose[3];\n        //         // Solve the second degree polynomial to get roots.\n        //         const first = (a + d) / 2;\n        //         const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n        //         const sx = first + second || 1;\n        //         const sy = first - second || 1;\n        //         // Scale values are the square roots of the eigenvalues.\n        //         return [Math.sqrt(sx), Math.sqrt(sy)];\n        //     }\n        //     // Normalize rectangle rect=[x1, y1, x2, y2] so that (x1,y1) < (x2,y2)\n        //     // For coordinate systems whose origin lies in the bottom-left, this\n        //     // means normalization to (BL,TR) ordering. For systems with origin in the\n        //     // top-left, this means (TL,BR) ordering.\n        static normalizeRect(rect) {\n            const r = rect.slice(0); // clone rect\n            if (rect[0] > rect[2]) {\n                r[0] = rect[2];\n                r[2] = rect[0];\n            }\n            if (rect[1] > rect[3]) {\n                r[1] = rect[3];\n                r[3] = rect[1];\n            }\n            return r;\n        }\n    }\n    // const PDFStringTranslateTable = [\n    //     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8,\n    //     0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    //     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    //     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    //     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    //     0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192,\n    //     0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018,\n    //     0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d,\n    //     0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac,\n    // ];\n    // function stringToPDFString(str) {\n    //     // See section 7.9.2.2 Text String Type.\n    //     // The string can contain some language codes bracketed with 0x0b,\n    //     // so we must remove them.\n    //     if (str[0] >= \"\\xEF\") {\n    //         let encoding;\n    //         if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n    //             encoding = \"utf-16be\";\n    //             if (str.length % 2 === 1) {\n    //                 str = str.slice(0, -1);\n    //             }\n    //         } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n    //             encoding = \"utf-16le\";\n    //             if (str.length % 2 === 1) {\n    //                 str = str.slice(0, -1);\n    //             }\n    //         } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n    //             encoding = \"utf-8\";\n    //         }\n    //         if (encoding) {\n    //             try {\n    //                 const decoder = new TextDecoder(encoding, { fatal: true });\n    //                 const buffer = stringToBytes(str);\n    //                 const decoded = decoder.decode(buffer);\n    //                 if (!decoded.includes(\"\\x1b\")) {\n    //                     return decoded;\n    //                 }\n    //                 return decoded.replaceAll(/\\x1b[^\\x1b]*(?:\\x1b|$)/g, \"\");\n    //             } catch (ex) {\n    //                 warn(`stringToPDFString: \"${ex}\".`);\n    //             }\n    //         }\n    //     }\n    //     // ISO Latin 1\n    //     const strBuf = [];\n    //     for (let i = 0, ii = str.length; i < ii; i++) {\n    //         const charCode = str.charCodeAt(i);\n    //         if (charCode === 0x1b) {\n    //             // eslint-disable-next-line no-empty\n    //             while (++i < ii && str.charCodeAt(i) !== 0x1b) { }\n    //             continue;\n    //         }\n    //         const code = PDFStringTranslateTable[charCode];\n    //         strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n    //     }\n    //     return strBuf.join(\"\");\n    // }\n    // function stringToUTF8String(str) {\n    //     return decodeURIComponent(escape(str));\n    // }\n    // function utf8StringToString(str) {\n    //     return unescape(encodeURIComponent(str));\n    // }\n    // function isArrayEqual(arr1, arr2) {\n    //     if (arr1.length !== arr2.length) {\n    //         return false;\n    //     }\n    //     for (let i = 0, ii = arr1.length; i < ii; i++) {\n    //         if (arr1[i] !== arr2[i]) {\n    //             return false;\n    //         }\n    //     }\n    //     return true;\n    // }\n    // function getModificationDate(date = new Date()) {\n    //     const buffer = [\n    //         date.getUTCFullYear().toString(),\n    //         (date.getUTCMonth() + 1).toString().padStart(2, \"0\"),\n    //         date.getUTCDate().toString().padStart(2, \"0\"),\n    //         date.getUTCHours().toString().padStart(2, \"0\"),\n    //         date.getUTCMinutes().toString().padStart(2, \"0\"),\n    //         date.getUTCSeconds().toString().padStart(2, \"0\"),\n    //     ];\n    //     return buffer.join(\"\");\n    // }\n    // let NormalizeRegex = null;\n    // let NormalizationMap = null;\n    // function normalizeUnicode(str) {\n    //     if (!NormalizeRegex) {\n    //         // In order to generate the following regex:\n    //         //  - create a PDF containing all the chars in the range 0000-FFFF with\n    //         //    a NFKC which is different of the char.\n    //         //  - copy and paste all those chars and get the ones where NFKC is\n    //         //    required.\n    //         // It appears that most the chars here contain some ligatures.\n    //         NormalizeRegex =\n    //             /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n    //         NormalizationMap = new Map([[\"\", \"t\"]]);\n    //     }\n    //     return str.replaceAll(NormalizeRegex, (_, p1, p2) =>\n    //         p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2)\n    //     );\n    // }\n    function getUuid() {\n        if (\n        // (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n        (typeof crypto !== \"undefined\" && crypto && typeof crypto.randomUUID === \"function\")) {\n            return crypto.randomUUID();\n        }\n        const buf = new Uint8Array(32);\n        if (typeof crypto !== \"undefined\" &&\n            crypto && typeof crypto.getRandomValues === \"function\") {\n            crypto.getRandomValues(buf);\n        }\n        else {\n            for (let i = 0; i < 32; i++) {\n                buf[i] = Math.floor(Math.random() * 255);\n            }\n        }\n        return bytesToString(buf);\n    }\n    const AnnotationPrefix = \"pdfjs_internal_id_\";\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _IdManager_id;\n    class IdManager {\n        constructor(idPrefix = AnnotationEditorPrefix) {\n            _IdManager_id.set(this, 0);\n            this.idPrefix = AnnotationEditorPrefix;\n            // if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n            Object.defineProperty(this, \"reset\", {\n                value: () => (kendo_dateinputsCommon_cmn_chunk_js._(this, _IdManager_id, 0, \"f\"))\n            });\n            // }\n            this.idPrefix = idPrefix;\n        }\n        get id() {\n            var _a, _b;\n            return `${this.idPrefix}${kendo_dateinputsCommon_cmn_chunk_js._(this, _IdManager_id, (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _IdManager_id, \"f\"), _a = _b++, _b), \"f\"), _a}`;\n        }\n    }\n    _IdManager_id = new WeakMap();\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _CommandManager_commands, _CommandManager_locked, _CommandManager_maxSize, _CommandManager_position;\n    /*\n     * Class to handle undo/redo.\n     * Commands are just saved in a buffer.\n     * If we hit some memory issues we could likely use a circular buffer.\n     * It has to be used as a singleton.\n     */\n    class CommandManager {\n        constructor(maxSize = 128) {\n            _CommandManager_commands.set(this, []);\n            _CommandManager_locked.set(this, false);\n            _CommandManager_maxSize.set(this, void 0);\n            _CommandManager_position.set(this, -1);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_maxSize, maxSize, \"f\");\n        }\n        /**\n         * @typedef {Object} addOptions\n         * @property {function} cmd\n         * @property {function} undo\n         * @property {function} [post]\n         * @property {boolean} mustExec\n         * @property {number} type\n         * @property {boolean} overwriteIfSameType\n         * @property {boolean} keepUndo\n         */\n        /*\n         * Add a new couple of commands to be used in case of redo/undo.\n         * @param {addOptions} options\n         */\n        add({ cmd, undo, post, mustExec, type = NaN, overwriteIfSameType = false, keepUndo = false, }) {\n            if (mustExec) {\n                cmd();\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_locked, \"f\")) {\n                return;\n            }\n            const save = { cmd, undo, post, type };\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") === -1) {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").length > 0) {\n                    // All the commands have been undone and then a new one is added\n                    // hence we clear the queue.\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").length = 0;\n                }\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_position, 0, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").push(save);\n                return;\n            }\n            if (overwriteIfSameType && kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\")[kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\")].type === type) {\n                // For example when we change a color we don't want to\n                // be able to undo all the steps, hence we only want to\n                // keep the last undoable action in this sequence of actions.\n                if (keepUndo) {\n                    save.undo = kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\")[kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\")].undo;\n                }\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\")[kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\")] = save;\n                return;\n            }\n            const next = kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") + 1;\n            if (next === kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_maxSize, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").splice(0, 1);\n            }\n            else {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_position, next, \"f\");\n                if (next < kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").length) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").splice(next);\n                }\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").push(save);\n        }\n        /**\n         * Undo the last command.\n         */\n        undo() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") === -1) {\n                // Nothing to undo.\n                return;\n            }\n            // Avoid to insert something during the undo execution.\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_locked, true, \"f\");\n            const { undo, post } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\")[kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\")];\n            undo();\n            post === null || post === void 0 ? void 0 : post();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_locked, false, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_position, kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") - 1, \"f\");\n        }\n        /**\n         * Redo the last command.\n         */\n        redo() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") < kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").length - 1) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_position, kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") + 1, \"f\");\n                // Avoid to insert something during the redo execution.\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_locked, true, \"f\");\n                const { cmd, post } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\")[kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\")];\n                cmd();\n                post === null || post === void 0 ? void 0 : post();\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_locked, false, \"f\");\n            }\n        }\n        /**\n         * Check if there is something to undo.\n         * @returns {boolean}\n         */\n        hasSomethingToUndo() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") !== -1;\n        }\n        /**\n         * Check if there is something to redo.\n         * @returns {boolean}\n         */\n        hasSomethingToRedo() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_position, \"f\") < kendo_dateinputsCommon_cmn_chunk_js.a(this, _CommandManager_commands, \"f\").length - 1;\n        }\n        destroy() {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _CommandManager_commands, null, \"f\");\n        }\n    }\n    _CommandManager_commands = new WeakMap(), _CommandManager_locked = new WeakMap(), _CommandManager_maxSize = new WeakMap(), _CommandManager_position = new WeakMap();\n\n    /* Copyright 2014 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationEditorUIManager_instances, _AnnotationEditorUIManager_abortController, _AnnotationEditorUIManager_activeEditor, _AnnotationEditorUIManager_allEditors, _AnnotationEditorUIManager_allLayers, _AnnotationEditorUIManager_annotationStorage, _AnnotationEditorUIManager_changedExistingAnnotations, _AnnotationEditorUIManager_commandManager, _AnnotationEditorUIManager_currentPageIndex, _AnnotationEditorUIManager_deletedAnnotationsElementIds, _AnnotationEditorUIManager_draggingEditors, _AnnotationEditorUIManager_editorTypes, _AnnotationEditorUIManager_editorsToRescale, _AnnotationEditorUIManager_enableHighlightFloatingButton, _AnnotationEditorUIManager_focusMainContainerTimeoutId, _AnnotationEditorUIManager_focusManagerAC, _AnnotationEditorUIManager_highlightColors, _AnnotationEditorUIManager_highlightWhenShiftUp, _AnnotationEditorUIManager_highlightToolbar, _AnnotationEditorUIManager_idManager, _AnnotationEditorUIManager_isEnabled, _AnnotationEditorUIManager_isWaiting, _AnnotationEditorUIManager_lastActiveElement, _AnnotationEditorUIManager_mode, _AnnotationEditorUIManager_selectedEditors, _AnnotationEditorUIManager_selectedTextNode, _AnnotationEditorUIManager_showAllStates, _AnnotationEditorUIManager_previousStates, _AnnotationEditorUIManager_translation, _AnnotationEditorUIManager_translationTimeoutId, _AnnotationEditorUIManager_container, _AnnotationEditorUIManager_viewer, _AnnotationEditorUIManager_getAnchorElementForSelection, _AnnotationEditorUIManager_getLayerForTextLayer, _AnnotationEditorUIManager_displayHighlightToolbar, _AnnotationEditorUIManager_selectionChange, _AnnotationEditorUIManager_onSelectEnd, _AnnotationEditorUIManager_addSelectionListener, _AnnotationEditorUIManager_addFocusManager, _AnnotationEditorUIManager_removeFocusManager, _AnnotationEditorUIManager_addKeyboardManager, _AnnotationEditorUIManager_removeKeyboardManager, _AnnotationEditorUIManager_addCopyPasteListeners, _AnnotationEditorUIManager_removeCopyPasteListeners, _AnnotationEditorUIManager_addDragAndDropListeners, _AnnotationEditorUIManager_dispatchUpdateStates, _AnnotationEditorUIManager_dispatchUpdateUI, _AnnotationEditorUIManager_enableAll, _AnnotationEditorUIManager_disableAll, _AnnotationEditorUIManager_addEditorToLayer, _AnnotationEditorUIManager_lastSelectedEditor_get, _AnnotationEditorUIManager_isEmpty, _AnnotationEditorUIManager_selectEditors;\n    // import { ImageManager } from \"./helpers/image-manager\";\n    class AnnotationEditorUIManager {\n        // static get _keyboardManager() {\n        //     const proto = AnnotationEditorUIManager.prototype;\n        //     /**\n        //      * If the focused element is an input, we don't want to handle the arrow.\n        //      * For example, sliders can be controlled with the arrow keys.\n        //      */\n        //     const arrowChecker = self =>\n        //         self.#container.contains(document.activeElement) &&\n        //         document.activeElement.tagName !== \"BUTTON\" &&\n        //         self.hasSomethingToControl();\n        //     const textInputChecker = (_self, { target: el }) => {\n        //         if (el instanceof HTMLInputElement) {\n        //             const { type } = el;\n        //             return type !== \"text\" && type !== \"number\";\n        //         }\n        //         return true;\n        //     };\n        //     const small = this.TRANSLATE_SMALL;\n        //     const big = this.TRANSLATE_BIG;\n        //     return shadow(\n        //         this,\n        //         \"_keyboardManager\",\n        //         new KeyboardManager([\n        //             [\n        //                 [\"ctrl+a\", \"mac+meta+a\"],\n        //                 proto.selectAll,\n        //                 { checker: textInputChecker },\n        //             ],\n        //             [[\"ctrl+z\", \"mac+meta+z\"], proto.undo, { checker: textInputChecker }],\n        //             [\n        //                 // On mac, depending of the OS version, the event.key is either \"z\" or\n        //                 // \"Z\" when the user presses \"meta+shift+z\".\n        //                 [\n        //                     \"ctrl+y\",\n        //                     \"ctrl+shift+z\",\n        //                     \"mac+meta+shift+z\",\n        //                     \"ctrl+shift+Z\",\n        //                     \"mac+meta+shift+Z\",\n        //                 ],\n        //                 proto.redo,\n        //                 { checker: textInputChecker },\n        //             ],\n        //             [\n        //                 [\n        //                     \"Backspace\",\n        //                     \"alt+Backspace\",\n        //                     \"ctrl+Backspace\",\n        //                     \"shift+Backspace\",\n        //                     \"mac+Backspace\",\n        //                     \"mac+alt+Backspace\",\n        //                     \"mac+ctrl+Backspace\",\n        //                     \"Delete\",\n        //                     \"ctrl+Delete\",\n        //                     \"shift+Delete\",\n        //                     \"mac+Delete\",\n        //                 ],\n        //                 proto.delete,\n        //                 { checker: textInputChecker },\n        //             ],\n        //             [\n        //                 [\"Enter\", \"mac+Enter\"],\n        //                 proto.addNewEditorFromKeyboard,\n        //                 {\n        //                     // Those shortcuts can be used in the toolbar for some other actions\n        //                     // like zooming, hence we need to check if the container has the\n        //                     // focus.\n        //                     checker: (self, { target: el }) =>\n        //                         !(el instanceof HTMLButtonElement) &&\n        //                         self.#container.contains(el) &&\n        //                         !self.isEnterHandled,\n        //                 },\n        //             ],\n        //             [\n        //                 [\" \", \"mac+ \"],\n        //                 proto.addNewEditorFromKeyboard,\n        //                 {\n        //                     // Those shortcuts can be used in the toolbar for some other actions\n        //                     // like zooming, hence we need to check if the container has the\n        //                     // focus.\n        //                     checker: (self, { target: el }) =>\n        //                         !(el instanceof HTMLButtonElement) &&\n        //                         self.#container.contains(document.activeElement),\n        //                 },\n        //             ],\n        //             [[\"Escape\", \"mac+Escape\"], proto.unselectAll],\n        //             [\n        //                 [\"ArrowLeft\", \"mac+ArrowLeft\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [-small, 0], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [-big, 0], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ArrowRight\", \"mac+ArrowRight\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [small, 0], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [big, 0], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ArrowUp\", \"mac+ArrowUp\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [0, -small], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [0, -big], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ArrowDown\", \"mac+ArrowDown\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [0, small], checker: arrowChecker },\n        //             ],\n        //             [\n        //                 [\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"],\n        //                 proto.translateSelectedEditors,\n        //                 { args: [0, big], checker: arrowChecker },\n        //             ],\n        //         ])\n        //     );\n        // }\n        constructor({ container = null, viewer, pdfViewer, \n        // altTextManager,\n        eventBus, pdfDocument, \n        // pageColors,\n        highlightColors = \"\",\n        // enableHighlightFloatingButton,\n        // enableUpdatedAddImage,\n        // enableNewAltTextWhenAddingImage,\n        // mlManager\n         }) {\n            _AnnotationEditorUIManager_instances.add(this);\n            // todo: props\n            // todo: extract to pdf viewer\n            this.pdfViewer = null;\n            this.annotationEditorMode = kendo_pdfjs_loader_js.AnnotationEditorType.NONE;\n            this.viewParameters = {};\n            this.isShiftKeyDown = false;\n            this._eventBus = null;\n            // todo: props\n            _AnnotationEditorUIManager_abortController.set(this, new AbortController());\n            _AnnotationEditorUIManager_activeEditor.set(this, null);\n            _AnnotationEditorUIManager_allEditors.set(this, new Map());\n            _AnnotationEditorUIManager_allLayers.set(this, new Map());\n            // #altTextManager = null;\n            _AnnotationEditorUIManager_annotationStorage.set(this, null);\n            _AnnotationEditorUIManager_changedExistingAnnotations.set(this, null);\n            _AnnotationEditorUIManager_commandManager.set(this, new CommandManager());\n            // #copyPasteAC = null;\n            _AnnotationEditorUIManager_currentPageIndex.set(this, 0);\n            _AnnotationEditorUIManager_deletedAnnotationsElementIds.set(this, new Set());\n            _AnnotationEditorUIManager_draggingEditors.set(this, null);\n            _AnnotationEditorUIManager_editorTypes.set(this, null);\n            _AnnotationEditorUIManager_editorsToRescale.set(this, new Set());\n            // todo: change default value\n            // #enableHighlightFloatingButton = false;\n            _AnnotationEditorUIManager_enableHighlightFloatingButton.set(this, true);\n            // #enableUpdatedAddImage = false;\n            // #enableNewAltTextWhenAddingImage = false;\n            // #filterFactory = null;\n            _AnnotationEditorUIManager_focusMainContainerTimeoutId.set(this, null);\n            _AnnotationEditorUIManager_focusManagerAC.set(this, null);\n            // todo: this is defined in \"highlightEditorColors\" in pdf.js as\n            // value: \"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F\",\n            _AnnotationEditorUIManager_highlightColors.set(this, \"\");\n            _AnnotationEditorUIManager_highlightWhenShiftUp.set(this, false);\n            _AnnotationEditorUIManager_highlightToolbar.set(this, null);\n            _AnnotationEditorUIManager_idManager.set(this, new IdManager());\n            _AnnotationEditorUIManager_isEnabled.set(this, false);\n            _AnnotationEditorUIManager_isWaiting.set(this, false);\n            // #keyboardManagerAC = null;\n            _AnnotationEditorUIManager_lastActiveElement.set(this, null);\n            // #mainHighlightColorPicker = null;\n            // #mlManager = null;\n            _AnnotationEditorUIManager_mode.set(this, kendo_pdfjs_loader_js.AnnotationEditorType.NONE);\n            _AnnotationEditorUIManager_selectedEditors.set(this, new Set());\n            _AnnotationEditorUIManager_selectedTextNode.set(this, null);\n            // #pageColors = null;\n            _AnnotationEditorUIManager_showAllStates.set(this, null);\n            _AnnotationEditorUIManager_previousStates.set(this, {\n                isEditing: false,\n                isEmpty: true,\n                hasSomethingToUndo: false,\n                hasSomethingToRedo: false,\n                hasSelectedEditor: false,\n                hasSelectedText: false,\n            });\n            _AnnotationEditorUIManager_translation.set(this, [0, 0]);\n            _AnnotationEditorUIManager_translationTimeoutId.set(this, null);\n            _AnnotationEditorUIManager_container.set(this, null);\n            _AnnotationEditorUIManager_viewer.set(this, null);\n            // // const signal = (this._signal = this.#abortController.signal);\n            const signal = this._signal = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_abortController, \"f\").signal;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_container, container, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_viewer, viewer, \"f\");\n            this.pdfViewer = pdfViewer;\n            // this.#altTextManager = altTextManager;\n            this._eventBus = eventBus;\n            this._eventBus._on(\"editingaction\", this.onEditingAction.bind(this), {\n                signal,\n            });\n            this._eventBus._on(\"pagechanging\", this.onPageChanging.bind(this), {\n                signal,\n            });\n            this._eventBus._on(\"scalechanging\", this.onScaleChanging.bind(this), {\n                signal,\n            });\n            this._eventBus._on(\"rotationchanging\", this.onRotationChanging.bind(this), {\n                signal,\n            });\n            this._eventBus._on(\"setpreference\", this.onSetPreference.bind(this), {\n                signal,\n            });\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addSelectionListener).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addDragAndDropListeners).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addKeyboardManager).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_annotationStorage, pdfDocument.annotationStorage, \"f\");\n            // this.#filterFactory = pdfDocument.filterFactory;\n            // this.#pageColors = pageColors;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_highlightColors, highlightColors || \"\", \"f\");\n            // this.#enableHighlightFloatingButton = enableHighlightFloatingButton;\n            // this.#enableUpdatedAddImage = enableUpdatedAddImage;\n            // this.#enableNewAltTextWhenAddingImage = enableNewAltTextWhenAddingImage;\n            // this.#mlManager = mlManager || null;\n            this.viewParameters = {\n                realScale: kendo_pdfjs_loader_js.PixelsPerInch.PDF_TO_CSS_UNITS,\n                rotation: 0,\n            };\n            // this.isShiftKeyDown = false;\n            // if ( typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n            //     window.uiManager = this;\n            //     Object.defineProperty(this, \"reset\", {\n            //         value: () => {\n            //             this.selectAll();\n            //             this.delete();\n            //             this.#idManager.reset();\n            //         },\n            //     });\n            // }\n        }\n        destroy() {\n            var _a;\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_abortController, \"f\")) === null || _a === void 0 ? void 0 : _a.abort();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_abortController, null, \"f\");\n            this._signal = null;\n            for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n                layer.destroy();\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorsToRescale, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_activeEditor, null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").destroy();\n            // this.#altTextManager?.destroy();\n            // this.#highlightToolbar?.hide();\n            // this.#highlightToolbar = null;\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, \"f\")) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, null, \"f\");\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translationTimeoutId, \"f\")) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translationTimeoutId, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_translationTimeoutId, null, \"f\");\n            }\n        }\n        // todo: new\n        getTextLayerForAnchor(anchorElement) {\n            if (!anchorElement) {\n                return null;\n            }\n            return anchorElement.closest(\".textLayer\") || anchorElement.closest(\".k-text-layer\");\n        }\n        combinedSignal(abortSignal) {\n            // eslint-disable-next-line\n            if (AbortSignal && AbortSignal[\"any\"]) {\n                return AbortSignal.any([this._signal, abortSignal.signal]);\n            }\n            else {\n                // add this for the unit tests\n                // AbortSignal.any is an API since March 2024\n                // however, this API is not currently available in\n                // the node/jest-related bits version that we are using\n                return this._signal || abortSignal.signal;\n            }\n        }\n        // get mlManager() {\n        //     return this.#mlManager;\n        // }\n        // get useNewAltTextFlow() {\n        //     return this.#enableUpdatedAddImage;\n        // }\n        // get useNewAltTextWhenAddingImage() {\n        //     return this.#enableNewAltTextWhenAddingImage;\n        // }\n        // get hcmFilter() {\n        //     return shadow(\n        //         this,\n        //         \"hcmFilter\",\n        //         this.#pageColors\n        //             ? this.#filterFactory.addHCMFilter(\n        //                 this.#pageColors.foreground,\n        //                 this.#pageColors.background\n        //             )\n        //             : \"none\"\n        //     );\n        // }\n        get direction() {\n            return kendo_pdfjs_loader_js.shadow(this, \"direction\", getComputedStyle(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_container, \"f\")).direction);\n        }\n        get highlightColors() {\n            return kendo_pdfjs_loader_js.shadow(this, \"highlightColors\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_highlightColors, \"f\")\n                ? new Map(\n                // Array.from(\n                //     this.#highlightColors\n                //         .split(\",\")\n                //         .map(pair => pair.split(\"=\").map(x => x.trim()))\n                // )\n                )\n                : null);\n        }\n        get highlightColorNames() {\n            return kendo_pdfjs_loader_js.shadow(this, \"highlightColorNames\", this.highlightColors\n                ? new Map(Array.from(this.highlightColors, e => e.reverse()))\n                : null);\n        }\n        // setMainHighlightColorPicker(colorPicker) {\n        //     this.#mainHighlightColorPicker = colorPicker;\n        // }\n        // editAltText(editor, firstTime = false) {\n        //     this.#altTextManager?.editAltText(this, editor, firstTime);\n        // }\n        switchToMode(mode, callback) {\n            // Switching to a mode can be asynchronous.\n            this._eventBus.on(\"annotationeditormodechanged\", callback, {\n                once: true,\n                signal: this._signal,\n                mode\n            });\n            this._eventBus.dispatch(\"showannotationeditorui\", {\n                source: this,\n                mode,\n            });\n        }\n        setPreference(name, value) {\n            this._eventBus.dispatch(\"setpreference\", {\n                source: this,\n                name,\n                value,\n            });\n        }\n        // onSetPreference({ name, value }) {\n        onSetPreference({ name }) {\n            switch (name) {\n                case \"enableNewAltTextWhenAddingImage\":\n                    // this.#enableNewAltTextWhenAddingImage = value;\n                    break;\n                default: break;\n            }\n        }\n        onPageChanging({ pageNumber }) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_currentPageIndex, pageNumber - 1, \"f\");\n        }\n        focusMainContainer() {\n            var _a;\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_container, \"f\")) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n        findParent(x, y) {\n            for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n                const { x: layerX, y: layerY, width, height, } = layer.div.getBoundingClientRect();\n                if (x >= layerX &&\n                    x <= layerX + width &&\n                    y >= layerY &&\n                    y <= layerY + height) {\n                    return layer;\n                }\n            }\n            return null;\n        }\n        disableUserSelect(value = false) {\n            var _a;\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_viewer, \"f\")) === null || _a === void 0 ? void 0 : _a.classList.toggle(\"noUserSelect\", value);\n        }\n        addShouldRescale(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorsToRescale, \"f\").add(editor);\n        }\n        removeShouldRescale(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorsToRescale, \"f\").delete(editor);\n        }\n        onScaleChanging({ scale }) {\n            this.commitOrRemove();\n            this.viewParameters.realScale = scale * kendo_pdfjs_loader_js.PixelsPerInch.PDF_TO_CSS_UNITS;\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorsToRescale, \"f\")) {\n                editor.onScaleChanging();\n            }\n        }\n        onRotationChanging({ pagesRotation }) {\n            this.commitOrRemove();\n            this.viewParameters.rotation = pagesRotation;\n        }\n        highlightSelection(methodOfCreation = \"\") {\n            const selection = document.getSelection();\n            if (!selection || selection.isCollapsed) {\n                return;\n            }\n            const { anchorNode, anchorOffset, focusNode, focusOffset } = selection;\n            const text = selection.toString();\n            const anchorElement = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_getAnchorElementForSelection).call(this, selection);\n            // const textLayer = anchorElement.closest(\".textLayer\");\n            const textLayer = this.getTextLayerForAnchor(anchorElement);\n            const boxes = this.getSelectionBoxes(textLayer);\n            if (!boxes) {\n                return;\n            }\n            selection.empty();\n            const layer = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_getLayerForTextLayer).call(this, textLayer);\n            const isNoneMode = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.NONE;\n            const callback = () => {\n                layer === null || layer === void 0 ? void 0 : layer.createAndAddNewEditor({ x: 0, y: 0 }, false, {\n                    methodOfCreation,\n                    boxes,\n                    anchorNode,\n                    anchorOffset,\n                    focusNode,\n                    focusOffset,\n                    text,\n                });\n                if (isNoneMode) {\n                    // this.showAllEditors(\"highlight\", true, /* updateButton = */ true);\n                    this.showAllEditors(\"highlight\", true);\n                }\n            };\n            if (isNoneMode) {\n                this.switchToMode(kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT, callback);\n                return;\n            }\n            callback();\n        }\n        showEditorToolBar(anchor) {\n            if (!anchor) {\n                return;\n            }\n            // todo: disable showing a toolbar for other annotations\n            const annotationEditorMode = this.getMode();\n            if (annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT) {\n                const editor = anchor.closest(\".highlightEditor\");\n                if (!editor) {\n                    return;\n                }\n            }\n            if (annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT) {\n                const editor = anchor.closest(\".freeTextEditor\");\n                if (!editor) {\n                    return;\n                }\n            }\n            if (annotationEditorMode !== kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT &&\n                annotationEditorMode !== kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT) {\n                return;\n            }\n            this._eventBus.dispatch(\"kendoAnnotationEditorToolBarShow\", {\n                source: this,\n                anchor: anchor\n            });\n        }\n        hideEditorToolBar() {\n            this._eventBus.dispatch(\"kendoAnnotationEditorToolBarHide\", {\n                source: this,\n            });\n        }\n        /**\n         * Add an editor in the annotation storage.\n         * @param {AnnotationEditor} editor\n         */\n        addToAnnotationStorage(editor) {\n            if (!editor.isEmpty() &&\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_annotationStorage, \"f\") &&\n                !kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_annotationStorage, \"f\").has(editor.id)) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_annotationStorage, \"f\").setValue(editor.id, editor);\n            }\n        }\n        blur() {\n            this.isShiftKeyDown = false;\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_highlightWhenShiftUp, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_highlightWhenShiftUp, false, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_onSelectEnd).call(this, \"main_toolbar\");\n            }\n            if (!this.hasSelection) {\n                return;\n            }\n            // When several editors are selected and the window loses focus, we want to\n            // keep the last active element in order to be able to focus it again when\n            // the window gets the focus back but we don't want to trigger any focus\n            // callbacks else only one editor will be selected.\n            const { activeElement } = document;\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                if (editor.div.contains(activeElement)) {\n                    kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_lastActiveElement, [editor, activeElement], \"f\");\n                    editor._focusEventsAllowed = false;\n                    break;\n                }\n            }\n        }\n        focus() {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_lastActiveElement, \"f\")) {\n                return;\n            }\n            const [lastEditor, lastActiveElement] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_lastActiveElement, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_lastActiveElement, null, \"f\");\n            lastActiveElement.addEventListener(\"focusin\", () => {\n                lastEditor._focusEventsAllowed = true;\n            }, { once: true, signal: this._signal });\n            lastActiveElement.focus();\n        }\n        addEditListeners() {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addKeyboardManager).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addCopyPasteListeners).call(this);\n        }\n        removeEditListeners() {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_removeKeyboardManager).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_removeCopyPasteListeners).call(this);\n        }\n        dragOver(event) {\n            for (const { type } of event.dataTransfer.items) {\n                for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                    if (editorType.isHandlingMimeForPasting(type)) {\n                        event.dataTransfer.dropEffect = \"copy\";\n                        event.preventDefault();\n                        return;\n                    }\n                }\n            }\n        }\n        /**\n         * Drop callback.\n         * @param {DragEvent} event\n         */\n        drop(event) {\n            for (const item of event.dataTransfer.items) {\n                for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                    if (editorType.isHandlingMimeForPasting(item.type)) {\n                        editorType.paste(item, this.currentLayer);\n                        event.preventDefault();\n                        return;\n                    }\n                }\n            }\n        }\n        /**\n         * Copy callback.\n         * @param {ClipboardEvent} event\n         */\n        copy(event) {\n            var _a;\n            event.preventDefault();\n            // An editor is being edited so just commit it.\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\")) === null || _a === void 0 ? void 0 : _a.commitOrRemove();\n            if (!this.hasSelection) {\n                return;\n            }\n            const editors = [];\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                const serialized = editor.serialize(/* isForCopying = */ true);\n                if (serialized) {\n                    editors.push(serialized);\n                }\n            }\n            if (editors.length === 0) {\n                return;\n            }\n            event.clipboardData.setData(\"application/pdfjs\", JSON.stringify(editors));\n        }\n        /**\n         * Cut callback.\n         * @param {ClipboardEvent} event\n         */\n        cut(event) {\n            this.copy(event);\n            this.delete();\n        }\n        /**\n         * Paste callback.\n         * @param {ClipboardEvent} event\n         */\n        paste(event) {\n            event.preventDefault();\n            const { clipboardData } = event;\n            for (const item of clipboardData.items) {\n                for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                    if (editorType.isHandlingMimeForPasting(item.type)) {\n                        editorType.paste(item, this.currentLayer);\n                        return;\n                    }\n                }\n            }\n            let data = clipboardData.getData(\"application/pdfjs\");\n            if (!data) {\n                return;\n            }\n            try {\n                data = JSON.parse(data);\n            }\n            catch (ex) {\n                // warn(`paste: \"${ex.message}\".`);\n                return;\n            }\n            if (!Array.isArray(data)) {\n                return;\n            }\n            this.unselectAll();\n            const layer = this.currentLayer;\n            try {\n                const newEditors = [];\n                for (const editor of data) {\n                    const deserializedEditor = layer.deserialize(editor);\n                    if (!deserializedEditor) {\n                        return;\n                    }\n                    newEditors.push(deserializedEditor);\n                }\n                const cmd = () => {\n                    for (const editor of newEditors) {\n                        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addEditorToLayer).call(this, editor);\n                    }\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_selectEditors).call(this, newEditors);\n                };\n                const undo = () => {\n                    for (const editor of newEditors) {\n                        editor.remove();\n                    }\n                };\n                this.addCommands({ cmd, undo, mustExec: true });\n            }\n            catch (ex) {\n                // warn(`paste: \"${ex.message}\".`);\n            }\n        }\n        // /**\n        //  * Keydown callback.\n        //  * @param {KeyboardEvent} event\n        //  */\n        // keydown(event) {\n        //     if (!this.isShiftKeyDown && event.key === \"Shift\") {\n        //         this.isShiftKeyDown = true;\n        //     }\n        //     if (\n        //         this.#mode !== AnnotationEditorType.NONE &&\n        //         !this.isEditorHandlingKeyboard\n        //     ) {\n        //         AnnotationEditorUIManager._keyboardManager.exec(this, event);\n        //     }\n        // }\n        // /**\n        //  * Keyup callback.\n        //  * @param {KeyboardEvent} event\n        //  */\n        // keyup(event) {\n        //     if (this.isShiftKeyDown && event.key === \"Shift\") {\n        //         this.isShiftKeyDown = false;\n        //         if (this.#highlightWhenShiftUp) {\n        //             this.#highlightWhenShiftUp = false;\n        //             this.#onSelectEnd(\"main_toolbar\");\n        //         }\n        //     }\n        // }\n        /**\n         * Execute an action for a given name.\n         * For example, the user can click on the \"Undo\" entry in the context menu\n         * and it'll trigger the undo action.\n         */\n        onEditingAction({ name }) {\n            switch (name) {\n                case \"undo\":\n                case \"redo\":\n                case \"delete\":\n                case \"selectAll\":\n                    this[name]();\n                    break;\n                case \"highlightSelection\":\n                    this.highlightSelection(\"context_menu\");\n                    break;\n                default: break;\n            }\n        }\n        /**\n         * Set the editing state.\n         * It can be useful to temporarily disable it when the user is editing a\n         * FreeText annotation.\n         * @param {boolean} isEditing\n         */\n        setEditingState(isEditing) {\n            // setEditingState() {\n            if (isEditing) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addFocusManager).call(this);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addCopyPasteListeners).call(this);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                    isEditing: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") !== kendo_pdfjs_loader_js.AnnotationEditorType.NONE,\n                    isEmpty: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_isEmpty).call(this),\n                    hasSomethingToUndo: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").hasSomethingToUndo(),\n                    hasSomethingToRedo: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").hasSomethingToRedo(),\n                    hasSelectedEditor: false,\n                });\n            }\n            else {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_removeFocusManager).call(this);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_removeCopyPasteListeners).call(this);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                    isEditing: false,\n                });\n                this.disableUserSelect(false);\n            }\n        }\n        registerEditorTypes(types) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_editorTypes, types, \"f\");\n            for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, editorType.defaultPropertiesToUpdate);\n            }\n        }\n        /**\n         * Get an id.\n         * @returns {string}\n         */\n        getId() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_idManager, \"f\").id;\n        }\n        get currentLayer() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").get(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_currentPageIndex, \"f\"));\n        }\n        getLayer(pageIndex) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").get(pageIndex);\n        }\n        get currentPageIndex() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_currentPageIndex, \"f\");\n        }\n        /**\n         * Add a new layer for a page which will contains the editors.\n         * @param {AnnotationEditorLayer} layer\n         */\n        addLayer(layer) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").set(layer.pageIndex, layer);\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_isEnabled, \"f\")) {\n                layer.enable();\n            }\n            else {\n                layer.disable();\n            }\n        }\n        /**\n         * Remove a layer.\n         * @param {AnnotationEditorLayer} layer\n         */\n        removeLayer(layer) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").delete(layer.pageIndex);\n        }\n        /**\n         * Change the editor mode (None, FreeText, Ink, ...)\n         * @param {number} mode\n         * @param {string|null} editId\n         * @param {boolean} [isFromKeyboard] - true if the mode change is due to a\n         *   keyboard action.\n         */\n        updateMode(mode, editId = null, isFromKeyboard = false) {\n            // todo: set isFromKeyboard intentionally to allow editor creation\n            // updateMode(mode, editId = null, isFromKeyboard = true) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === mode) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_mode, mode, \"f\");\n            if (mode === kendo_pdfjs_loader_js.AnnotationEditorType.NONE) {\n                this.setEditingState(false);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_disableAll).call(this);\n                return;\n            }\n            this.setEditingState(true);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_enableAll).call(this);\n            this.unselectAll();\n            for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n                layer.updateMode(mode);\n            }\n            if (!editId && isFromKeyboard) {\n                this.addNewEditorFromKeyboard();\n                return;\n            }\n            if (!editId) {\n                return;\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values()) {\n                if (editor.annotationElementId === editId) {\n                    this.setSelected(editor);\n                    editor.enterInEditMode();\n                    break;\n                }\n            }\n        }\n        addNewEditorFromKeyboard() {\n            if (this.currentLayer.canCreateNewEmptyEditor()) {\n                this.currentLayer.addNewEditor();\n            }\n        }\n        /**\n         * Update the toolbar if it's required to reflect the tool currently used.\n         * @param {number} mode\n         * @returns {undefined}\n         */\n        updateToolbar(mode) {\n            if (mode === kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\")) {\n                return;\n            }\n            this._eventBus.dispatch(\"switchannotationeditormode\", {\n                source: this,\n                mode,\n            });\n        }\n        /**\n         * Update a parameter in the current editor or globally.\n         * @param {number} type\n         * @param {*} value\n         */\n        updateParams(type, value) {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                return;\n            }\n            switch (type) {\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.CREATE:\n                    this.currentLayer.addNewEditor();\n                    return;\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:\n                    // this.#mainHighlightColorPicker?.updateColor(value);\n                    break;\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:\n                    // this._eventBus.dispatch(\"reporttelemetry\", {\n                    //     source: this,\n                    //     details: {\n                    //         type: \"editing\",\n                    //         data: {\n                    //             type: \"highlight\",\n                    //             action: \"toggle_visibility\",\n                    //         },\n                    //     },\n                    // });\n                    (kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_showAllStates, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_showAllStates, \"f\") || new Map(), \"f\")).set(type, value);\n                    this.showAllEditors(\"highlight\", value);\n                    break;\n                default: break;\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                editor.updateParams(type, value);\n            }\n            for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_editorTypes, \"f\")) {\n                editorType.updateDefaultParams(type, value);\n            }\n        }\n        // showAllEditors(type, visible, updateButton = false) {\n        showAllEditors(type, visible) {\n            var _a, _b;\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values()) {\n                if (editor.editorType === type) {\n                    editor.show(visible);\n                }\n            }\n            const state = (_b = (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_showAllStates, \"f\")) === null || _a === void 0 ? void 0 : _a.get(kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL)) !== null && _b !== void 0 ? _b : true;\n            if (state !== visible) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, [\n                    [kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL, visible],\n                ]);\n            }\n        }\n        enableWaiting(mustWait = false) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_isWaiting, \"f\") === mustWait) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_isWaiting, mustWait, \"f\");\n            for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n                if (mustWait) {\n                    layer.disableClick();\n                }\n                else {\n                    layer.enableClick();\n                }\n                layer.div.classList.toggle(\"waiting\", mustWait);\n            }\n        }\n        /**\n         * Get all the editors belonging to a given page.\n         * @param {number} pageIndex\n         * @returns {Array<AnnotationEditor>}\n         */\n        getEditors(pageIndex) {\n            const editors = [];\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values()) {\n                if (editor.pageIndex === pageIndex) {\n                    editors.push(editor);\n                }\n            }\n            return editors;\n        }\n        /**\n         * Get an editor with the given id.\n         * @param {string} id\n         * @returns {AnnotationEditor}\n         */\n        getEditor(id) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").get(id);\n        }\n        /**\n         * Add a new editor.\n         * @param {AnnotationEditor} editor\n         */\n        addEditor(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").set(editor.id, editor);\n        }\n        /**\n         * Remove an editor.\n         * @param {AnnotationEditor} editor\n         */\n        removeEditor(editor) {\n            var _a;\n            if (editor.div.contains(document.activeElement)) {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, \"f\")) {\n                    clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, \"f\"));\n                }\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, setTimeout(() => {\n                    // When the div is removed from DOM the focus can move on the\n                    // document.body, so we need to move it back to the main container.\n                    this.focusMainContainer();\n                    kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_focusMainContainerTimeoutId, null, \"f\");\n                }, 0), \"f\");\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").delete(editor.id);\n            this.unselect(editor);\n            if (!editor.annotationElementId ||\n                !kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_deletedAnnotationsElementIds, \"f\").has(editor.annotationElementId)) {\n                (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_annotationStorage, \"f\")) === null || _a === void 0 ? void 0 : _a.remove(editor.id);\n            }\n        }\n        /**\n         * The annotation element with the given id has been deleted.\n         * @param {AnnotationEditor} editor\n         */\n        addDeletedAnnotationElement(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_deletedAnnotationsElementIds, \"f\").add(editor.annotationElementId);\n            this.addChangedExistingAnnotation(editor);\n            editor.deleted = true;\n        }\n        /**\n         * Check if the annotation element with the given id has been deleted.\n         * @param {string} annotationElementId\n         * @returns {boolean}\n         */\n        isDeletedAnnotationElement(annotationElementId) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_deletedAnnotationsElementIds, \"f\").has(annotationElementId);\n        }\n        /**\n         * The annotation element with the given id have been restored.\n         * @param {AnnotationEditor} editor\n         */\n        removeDeletedAnnotationElement(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_deletedAnnotationsElementIds, \"f\").delete(editor.annotationElementId);\n            this.removeChangedExistingAnnotation(editor);\n            editor.deleted = false;\n        }\n        /**\n         * Set the given editor as the active one.\n         * @param {AnnotationEditor} editor\n         */\n        setActiveEditor(editor) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\") === editor) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_activeEditor, editor, \"f\");\n            if (editor) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, editor.propertiesToUpdate);\n            }\n        }\n        /**\n         * Update the UI of the active editor.\n         * @param {AnnotationEditor} editor\n         */\n        updateUI(editor) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"a\", _AnnotationEditorUIManager_lastSelectedEditor_get) === editor) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, editor.propertiesToUpdate);\n            }\n        }\n        /**\n         * Add or remove an editor the current selection.\n         * @param {AnnotationEditor} editor\n         */\n        toggleSelected(editor) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").has(editor)) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").delete(editor);\n                editor.unselect();\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                    hasSelectedEditor: this.hasSelection,\n                });\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").add(editor);\n            editor.select();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, editor.propertiesToUpdate);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSelectedEditor: true,\n            });\n        }\n        /**\n         * Set the last selected editor.\n         * @param {AnnotationEditor} editor\n         */\n        setSelected(editor) {\n            for (const selectedEditor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                if (selectedEditor !== editor) {\n                    selectedEditor.unselect();\n                }\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").add(editor);\n            editor.select();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, editor.propertiesToUpdate);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSelectedEditor: true,\n            });\n        }\n        /**\n         * Check if the editor is selected.\n         * @param {AnnotationEditor} editor\n         */\n        isSelected(editor) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").has(editor);\n        }\n        get firstSelectedEditor() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").values().next().value;\n        }\n        /**\n         * Unselect an editor.\n         * @param {AnnotationEditor} editor\n         */\n        unselect(editor) {\n            editor.unselect();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").delete(editor);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSelectedEditor: this.hasSelection,\n            });\n        }\n        get hasSelection() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").size !== 0;\n        }\n        get isEnterHandled() {\n            return (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").size === 1 &&\n                this.firstSelectedEditor.isEnterHandled);\n        }\n        /**\n         * Undo the last command.\n         */\n        undo() {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").undo();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSomethingToUndo: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").hasSomethingToUndo(),\n                hasSomethingToRedo: true,\n                isEmpty: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_isEmpty).call(this),\n            });\n        }\n        /**\n         * Redo the last undoed command.\n         */\n        redo() {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").redo();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSomethingToUndo: true,\n                hasSomethingToRedo: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").hasSomethingToRedo(),\n                isEmpty: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_isEmpty).call(this),\n            });\n        }\n        /**\n         * Add a command to execute (cmd) and another one to undo it.\n         * @param {Object} params\n         */\n        addCommands(params) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_commandManager, \"f\").add(params);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSomethingToUndo: true,\n                hasSomethingToRedo: false,\n                isEmpty: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_isEmpty).call(this),\n            });\n        }\n        /**\n         * Delete the current editor or all.\n         */\n        delete() {\n            this.commitOrRemove();\n            if (!this.hasSelection) {\n                return;\n            }\n            const editors = [...kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")];\n            const cmd = () => {\n                for (const editor of editors) {\n                    editor.remove();\n                }\n            };\n            const undo = () => {\n                for (const editor of editors) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_addEditorToLayer).call(this, editor);\n                }\n            };\n            this.addCommands({ cmd, undo, mustExec: true });\n        }\n        commitOrRemove() {\n            var _a;\n            // An editor is being edited so just commit it.\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\")) === null || _a === void 0 ? void 0 : _a.commitOrRemove();\n        }\n        hasSomethingToControl() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\") || this.hasSelection;\n        }\n        /**\n         * Select all the editors.\n         */\n        selectAll() {\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                editor.commit();\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_selectEditors).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values());\n        }\n        /**\n         * Unselect all the selected editors.\n         */\n        unselectAll() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\")) {\n                // An editor is being edited so just commit it.\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\").commitOrRemove();\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") !== kendo_pdfjs_loader_js.AnnotationEditorType.NONE) {\n                    // If the mode is NONE, we want to really unselect the editor, hence we\n                    // mustn't return here.\n                    return;\n                }\n            }\n            if (!this.hasSelection) {\n                return;\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                editor.unselect();\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                hasSelectedEditor: false,\n            });\n        }\n        translateSelectedEditors(x, y, noCommit = false) {\n            if (!noCommit) {\n                this.commitOrRemove();\n            }\n            if (!this.hasSelection) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translation, \"f\")[0] += x;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translation, \"f\")[1] += y;\n            const [totalX, totalY] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translation, \"f\");\n            const editors = [...kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")];\n            // We don't want to have an undo/redo for each translation so we wait a bit\n            // before adding the command to the command manager.\n            const TIME_TO_WAIT = 1000;\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translationTimeoutId, \"f\")) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translationTimeoutId, \"f\"));\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_translationTimeoutId, setTimeout(() => {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_translationTimeoutId, null, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translation, \"f\")[0] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_translation, \"f\")[1] = 0;\n                this.addCommands({\n                    cmd: () => {\n                        for (const editor of editors) {\n                            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").has(editor.id)) {\n                                editor.translateInPage(totalX, totalY);\n                            }\n                        }\n                    },\n                    undo: () => {\n                        for (const editor of editors) {\n                            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").has(editor.id)) {\n                                editor.translateInPage(-totalX, -totalY);\n                            }\n                        }\n                    },\n                    mustExec: false,\n                });\n            }, TIME_TO_WAIT), \"f\");\n            for (const editor of editors) {\n                editor.translateInPage(x, y);\n            }\n        }\n        /**\n         * Set up the drag session for moving the selected editors.\n         */\n        setUpDragSession() {\n            // // Note: don't use any references to the editor's parent which can be null\n            // // if the editor belongs to a destroyed page.\n            if (!this.hasSelection) {\n                return;\n            }\n            // Avoid to have spurious text selection in the text layer when dragging.\n            this.disableUserSelect(true);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_draggingEditors, new Map(), \"f\");\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_draggingEditors, \"f\").set(editor, {\n                    savedX: editor.x,\n                    savedY: editor.y,\n                    savedPageIndex: editor.pageIndex,\n                    newX: 0,\n                    newY: 0,\n                    newPageIndex: -1,\n                });\n            }\n        }\n        /**\n         * Ends the drag session.\n         * @returns {boolean} true if at least one editor has been moved.\n         */\n        endDragSession() {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_draggingEditors, \"f\")) {\n                return false;\n            }\n            this.disableUserSelect(false);\n            const map = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_draggingEditors, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_draggingEditors, null, \"f\");\n            let mustBeAddedInUndoStack = false;\n            for (const [{ x, y, pageIndex }, value] of map) {\n                value.newX = x;\n                value.newY = y;\n                value.newPageIndex = pageIndex;\n                mustBeAddedInUndoStack || (mustBeAddedInUndoStack = x !== value.savedX ||\n                    y !== value.savedY ||\n                    pageIndex !== value.savedPageIndex);\n            }\n            if (!mustBeAddedInUndoStack) {\n                return false;\n            }\n            const move = (editor, x, y, pageIndex) => {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").has(editor.id)) {\n                    // The editor can be undone/redone on a page which is not visible (and\n                    // which potentially has no annotation editor layer), hence we need to\n                    // use the pageIndex instead of the parent.\n                    const parent = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").get(pageIndex);\n                    if (parent) {\n                        editor._setParentAndPosition(parent, x, y);\n                    }\n                    else {\n                        editor.pageIndex = pageIndex;\n                        editor.x = x;\n                        editor.y = y;\n                    }\n                }\n            };\n            this.addCommands({\n                cmd: () => {\n                    for (const [editor, { newX, newY, newPageIndex }] of map) {\n                        move(editor, newX, newY, newPageIndex);\n                    }\n                },\n                undo: () => {\n                    for (const [editor, { savedX, savedY, savedPageIndex }] of map) {\n                        move(editor, savedX, savedY, savedPageIndex);\n                    }\n                },\n                mustExec: true,\n            });\n            return true;\n        }\n        /**\n         * Drag the set of selected editors.\n         * @param {number} tx\n         * @param {number} ty\n         */\n        dragSelectedEditors(tx, ty) {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_draggingEditors, \"f\")) {\n                return;\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_draggingEditors, \"f\").keys()) {\n                editor.drag(tx, ty);\n            }\n        }\n        /**\n         * Rebuild the editor (usually on undo/redo actions) on a potentially\n         * non-rendered page.\n         * @param {AnnotationEditor} editor\n         */\n        rebuild(editor) {\n            if (editor.parent === null) {\n                const parent = this.getLayer(editor.pageIndex);\n                if (parent) {\n                    parent.changeParent(editor);\n                    parent.addOrRebuild(editor);\n                }\n                else {\n                    this.addEditor(editor);\n                    this.addToAnnotationStorage(editor);\n                    editor.rebuild();\n                }\n            }\n            else {\n                editor.parent.addOrRebuild(editor);\n            }\n        }\n        // get isEditorHandlingKeyboard() {\n        //     return (\n        //         this.getActive()?.shouldGetKeyboardEvents() ||\n        //         (this.#selectedEditors.size === 1 &&\n        //             this.firstSelectedEditor.shouldGetKeyboardEvents())\n        //     );\n        // }\n        /**\n         * Is the current editor the one passed as argument?\n         * @param {AnnotationEditor} editor\n         * @returns\n         */\n        isActive(editor) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\") === editor;\n        }\n        /**\n         * Get the current active editor.\n         * @returns {AnnotationEditor|null}\n         */\n        getActive() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\");\n        }\n        getActiveEditor() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_activeEditor, \"f\");\n        }\n        /**\n         * Get the current editor mode.\n         * @returns {number}\n         */\n        getMode() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\");\n        }\n        // get imageManager() {\n        //     return shadow(this, \"imageManager\", new ImageManager());\n        // }\n        getSelectionBoxes(textLayer) {\n            if (!textLayer) {\n                return null;\n            }\n            const selection = document.getSelection();\n            for (let i = 0, ii = selection.rangeCount; i < ii; i++) {\n                if (!textLayer.contains(selection.getRangeAt(i).commonAncestorContainer)) {\n                    return null;\n                }\n            }\n            const { x: layerX, y: layerY, width: parentWidth, height: parentHeight, } = textLayer.getBoundingClientRect();\n            // We must rotate the boxes because we want to have them in the non-rotated\n            // page coordinates.\n            let rotator;\n            switch (textLayer.getAttribute(\"data-main-rotation\")) {\n                case \"90\":\n                    rotator = (x, y, w, h) => ({\n                        x: (y - layerY) / parentHeight,\n                        y: 1 - (x + w - layerX) / parentWidth,\n                        width: h / parentHeight,\n                        height: w / parentWidth,\n                    });\n                    break;\n                case \"180\":\n                    rotator = (x, y, w, h) => ({\n                        x: 1 - (x + w - layerX) / parentWidth,\n                        y: 1 - (y + h - layerY) / parentHeight,\n                        width: w / parentWidth,\n                        height: h / parentHeight,\n                    });\n                    break;\n                case \"270\":\n                    rotator = (x, y, w, h) => ({\n                        x: 1 - (y + h - layerY) / parentHeight,\n                        y: (x - layerX) / parentWidth,\n                        width: h / parentHeight,\n                        height: w / parentWidth,\n                    });\n                    break;\n                default:\n                    rotator = (x, y, w, h) => ({\n                        x: (x - layerX) / parentWidth,\n                        y: (y - layerY) / parentHeight,\n                        width: w / parentWidth,\n                        height: h / parentHeight,\n                    });\n                    break;\n            }\n            const boxes = [];\n            for (let i = 0, ii = selection.rangeCount; i < ii; i++) {\n                const range = selection.getRangeAt(i);\n                if (range.collapsed) {\n                    continue;\n                }\n                for (const { x, y, width, height } of range.getClientRects()) {\n                    if (width === 0 || height === 0) {\n                        continue;\n                    }\n                    boxes.push(rotator(x, y, width, height));\n                }\n            }\n            return boxes.length === 0 ? null : boxes;\n        }\n        addChangedExistingAnnotation({ annotationElementId, id }) {\n            (kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_changedExistingAnnotations, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_changedExistingAnnotations, \"f\") || new Map(), \"f\")).set(annotationElementId, id);\n        }\n        removeChangedExistingAnnotation({ annotationElementId }) {\n            var _a;\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_changedExistingAnnotations, \"f\")) === null || _a === void 0 ? void 0 : _a.delete(annotationElementId);\n        }\n        renderAnnotationElement(annotation) {\n            var _a;\n            const editorId = (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_changedExistingAnnotations, \"f\")) === null || _a === void 0 ? void 0 : _a.get(annotation.data.id);\n            if (!editorId) {\n                return;\n            }\n            const editor = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_annotationStorage, \"f\").getRawValue(editorId);\n            if (!editor) {\n                return;\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.NONE && !editor.hasBeenModified) {\n                return;\n            }\n            editor.renderAnnotationElement(annotation);\n        }\n    }\n    _AnnotationEditorUIManager_abortController = new WeakMap(), _AnnotationEditorUIManager_activeEditor = new WeakMap(), _AnnotationEditorUIManager_allEditors = new WeakMap(), _AnnotationEditorUIManager_allLayers = new WeakMap(), _AnnotationEditorUIManager_annotationStorage = new WeakMap(), _AnnotationEditorUIManager_changedExistingAnnotations = new WeakMap(), _AnnotationEditorUIManager_commandManager = new WeakMap(), _AnnotationEditorUIManager_currentPageIndex = new WeakMap(), _AnnotationEditorUIManager_deletedAnnotationsElementIds = new WeakMap(), _AnnotationEditorUIManager_draggingEditors = new WeakMap(), _AnnotationEditorUIManager_editorTypes = new WeakMap(), _AnnotationEditorUIManager_editorsToRescale = new WeakMap(), _AnnotationEditorUIManager_enableHighlightFloatingButton = new WeakMap(), _AnnotationEditorUIManager_focusMainContainerTimeoutId = new WeakMap(), _AnnotationEditorUIManager_focusManagerAC = new WeakMap(), _AnnotationEditorUIManager_highlightColors = new WeakMap(), _AnnotationEditorUIManager_highlightWhenShiftUp = new WeakMap(), _AnnotationEditorUIManager_highlightToolbar = new WeakMap(), _AnnotationEditorUIManager_idManager = new WeakMap(), _AnnotationEditorUIManager_isEnabled = new WeakMap(), _AnnotationEditorUIManager_isWaiting = new WeakMap(), _AnnotationEditorUIManager_lastActiveElement = new WeakMap(), _AnnotationEditorUIManager_mode = new WeakMap(), _AnnotationEditorUIManager_selectedEditors = new WeakMap(), _AnnotationEditorUIManager_selectedTextNode = new WeakMap(), _AnnotationEditorUIManager_showAllStates = new WeakMap(), _AnnotationEditorUIManager_previousStates = new WeakMap(), _AnnotationEditorUIManager_translation = new WeakMap(), _AnnotationEditorUIManager_translationTimeoutId = new WeakMap(), _AnnotationEditorUIManager_container = new WeakMap(), _AnnotationEditorUIManager_viewer = new WeakMap(), _AnnotationEditorUIManager_instances = new WeakSet(), _AnnotationEditorUIManager_getAnchorElementForSelection = function _AnnotationEditorUIManager_getAnchorElementForSelection({ anchorNode }) {\n        return anchorNode.nodeType === Node.TEXT_NODE\n            ? anchorNode.parentElement\n            : anchorNode;\n    }, _AnnotationEditorUIManager_getLayerForTextLayer = function _AnnotationEditorUIManager_getLayerForTextLayer(textLayer) {\n        const { currentLayer } = this;\n        if (currentLayer.hasTextLayer(textLayer)) {\n            return currentLayer;\n        }\n        for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n            if (layer.hasTextLayer(textLayer)) {\n                return layer;\n            }\n        }\n        return null;\n    }, _AnnotationEditorUIManager_displayHighlightToolbar = function _AnnotationEditorUIManager_displayHighlightToolbar() {\n        const selection = document.getSelection();\n        if (!selection || selection.isCollapsed) {\n            return;\n        }\n        const anchorElement = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_getAnchorElementForSelection).call(this, selection);\n        const textLayer = this.getTextLayerForAnchor(anchorElement);\n        const boxes = this.getSelectionBoxes(textLayer);\n        if (!boxes) {\n            return;\n        }\n        this.showEditorToolBar(anchorElement);\n        // this._eventBus.dispatch(\"showannotationeditorui\", {\n        //     source: this,\n        //     details: Object.assign(this.#previousStates, details),\n        // });\n        // this.#highlightToolbar ||= new HighlightToolbar(this);\n        // this.#highlightToolbar.show(textLayer, boxes, this.direction === \"ltr\");\n    }, _AnnotationEditorUIManager_selectionChange = function _AnnotationEditorUIManager_selectionChange() {\n        var _a, _b;\n        const selection = document.getSelection();\n        if (!selection || selection.isCollapsed) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedTextNode, \"f\")) {\n                // this.#highlightToolbar?.hide();\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_selectedTextNode, null, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                    hasSelectedText: false,\n                });\n            }\n            return;\n        }\n        const { anchorNode } = selection;\n        if (anchorNode === kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedTextNode, \"f\")) {\n            return;\n        }\n        const anchorElement = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_getAnchorElementForSelection).call(this, selection);\n        // const textLayer = anchorElement.closest(\".textLayer\");\n        const textLayer = this.getTextLayerForAnchor(anchorElement);\n        if (!textLayer) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedTextNode, \"f\")) {\n                (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_highlightToolbar, \"f\")) === null || _a === void 0 ? void 0 : _a.hide();\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_selectedTextNode, null, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n                    hasSelectedText: false,\n                });\n            }\n            return;\n        }\n        (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_highlightToolbar, \"f\")) === null || _b === void 0 ? void 0 : _b.hide();\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_selectedTextNode, anchorNode, \"f\");\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, {\n            hasSelectedText: true,\n        });\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") !== kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT && kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") !== kendo_pdfjs_loader_js.AnnotationEditorType.NONE) {\n            return;\n        }\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT) {\n            // this.showAllEditors(\"highlight\", true, /* updateButton = */ true);\n            this.showAllEditors(\"highlight\", true);\n        }\n        // this.#highlightWhenShiftUp = this.isShiftKeyDown;\n        if (!this.isShiftKeyDown) {\n            const activeLayer = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT\n                ? kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_getLayerForTextLayer).call(this, textLayer)\n                : null;\n            activeLayer === null || activeLayer === void 0 ? void 0 : activeLayer.toggleDrawing();\n            const abortController = new AbortController();\n            const signal = this.combinedSignal(abortController);\n            const pointerup = e => {\n                if (e.type === \"pointerup\" && e.button !== 0) {\n                    // Do nothing on right click.\n                    return;\n                }\n                abortController.abort();\n                activeLayer === null || activeLayer === void 0 ? void 0 : activeLayer.toggleDrawing(true);\n                if (e.type === \"pointerup\") {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_onSelectEnd).call(this, \"main_toolbar\");\n                }\n            };\n            window.removeEventListener(\"pointerup\", pointerup);\n            window.addEventListener(\"pointerup\", pointerup, { signal });\n            window.removeEventListener(\"blur\", pointerup);\n            window.addEventListener(\"blur\", pointerup, { signal });\n        }\n    }, _AnnotationEditorUIManager_onSelectEnd = function _AnnotationEditorUIManager_onSelectEnd(methodOfCreation = \"\") {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT) {\n            this.highlightSelection(methodOfCreation);\n        }\n        else if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_enableHighlightFloatingButton, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_displayHighlightToolbar).call(this);\n        }\n    }, _AnnotationEditorUIManager_addSelectionListener = function _AnnotationEditorUIManager_addSelectionListener() {\n        document.addEventListener(\"selectionchange\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_selectionChange).bind(this), { signal: this._signal });\n    }, _AnnotationEditorUIManager_addFocusManager = function _AnnotationEditorUIManager_addFocusManager() {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusManagerAC, \"f\")) {\n            return;\n        }\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_focusManagerAC, new AbortController(), \"f\");\n        const signal = this.combinedSignal(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusManagerAC, \"f\"));\n        window.addEventListener(\"focus\", this.focus.bind(this), { signal });\n        window.addEventListener(\"blur\", this.blur.bind(this), { signal });\n    }, _AnnotationEditorUIManager_removeFocusManager = function _AnnotationEditorUIManager_removeFocusManager() {\n        var _a;\n        (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_focusManagerAC, \"f\")) === null || _a === void 0 ? void 0 : _a.abort();\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_focusManagerAC, null, \"f\");\n    }, _AnnotationEditorUIManager_addKeyboardManager = function _AnnotationEditorUIManager_addKeyboardManager() {\n        //     if (this.#keyboardManagerAC) {\n        //         return;\n        //     }\n        //     this.#keyboardManagerAC = new AbortController();\n        //     const signal = this.combinedSignal(this.#keyboardManagerAC);\n        //     // The keyboard events are caught at the container level in order to be able\n        //     // to execute some callbacks even if the current page doesn't have focus.\n        //     window.addEventListener(\"keydown\", this.keydown.bind(this), { signal });\n        //     window.addEventListener(\"keyup\", this.keyup.bind(this), { signal });\n    }, _AnnotationEditorUIManager_removeKeyboardManager = function _AnnotationEditorUIManager_removeKeyboardManager() {\n        //     this.#keyboardManagerAC?.abort();\n        //     this.#keyboardManagerAC = null;\n    }, _AnnotationEditorUIManager_addCopyPasteListeners = function _AnnotationEditorUIManager_addCopyPasteListeners() {\n        //     if (this.#copyPasteAC) {\n        //         return;\n        //     }\n        //     this.#copyPasteAC = new AbortController();\n        //     const signal = this.combinedSignal(this.#copyPasteAC);\n        //     document.addEventListener(\"copy\", this.copy.bind(this), { signal });\n        //     document.addEventListener(\"cut\", this.cut.bind(this), { signal });\n        //     document.addEventListener(\"paste\", this.paste.bind(this), { signal });\n    }, _AnnotationEditorUIManager_removeCopyPasteListeners = function _AnnotationEditorUIManager_removeCopyPasteListeners() {\n        //     this.#copyPasteAC?.abort();\n        //     this.#copyPasteAC = null;\n    }, _AnnotationEditorUIManager_addDragAndDropListeners = function _AnnotationEditorUIManager_addDragAndDropListeners() {\n        const signal = this._signal;\n        document.addEventListener(\"dragover\", this.dragOver.bind(this), { signal });\n        document.addEventListener(\"drop\", this.drop.bind(this), { signal });\n    }, _AnnotationEditorUIManager_dispatchUpdateStates = function _AnnotationEditorUIManager_dispatchUpdateStates(details) {\n        if (!details) {\n            return;\n        }\n        const hasChanged = Object.entries(details).some(([key, value]) => kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_previousStates, \"f\")[key] !== value);\n        if (hasChanged) {\n            this._eventBus.dispatch(\"annotationeditorstateschanged\", {\n                source: this,\n                details: Object.assign(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_previousStates, \"f\"), details),\n            });\n            // We could listen on our own event but it sounds like a bit weird and\n            // it's a way to simpler to handle that stuff here instead of having to\n            // add something in every place where an editor can be unselected.\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_mode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT &&\n                details.hasSelectedEditor === false) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateUI).call(this, [\n                    [kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_FREE, true],\n                ]);\n            }\n        }\n    }, _AnnotationEditorUIManager_dispatchUpdateUI = function _AnnotationEditorUIManager_dispatchUpdateUI(details) {\n        this._eventBus.dispatch(\"annotationeditorparamschanged\", {\n            source: this,\n            details,\n        });\n    }, _AnnotationEditorUIManager_enableAll = function _AnnotationEditorUIManager_enableAll() {\n        if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_isEnabled, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_isEnabled, true, \"f\");\n            for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n                layer.enable();\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values()) {\n                editor.enable();\n            }\n        }\n    }, _AnnotationEditorUIManager_disableAll = function _AnnotationEditorUIManager_disableAll() {\n        this.unselectAll();\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_isEnabled, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorUIManager_isEnabled, false, \"f\");\n            for (const layer of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").values()) {\n                layer.disable();\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values()) {\n                editor.disable();\n            }\n        }\n    }, _AnnotationEditorUIManager_addEditorToLayer = function _AnnotationEditorUIManager_addEditorToLayer(editor) {\n        const layer = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allLayers, \"f\").get(editor.pageIndex);\n        if (layer) {\n            layer.addOrRebuild(editor);\n        }\n        else {\n            this.addEditor(editor);\n            this.addToAnnotationStorage(editor);\n        }\n    }, _AnnotationEditorUIManager_lastSelectedEditor_get = function _AnnotationEditorUIManager_lastSelectedEditor_get() {\n        let ed = null;\n        for (ed of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n            // Iterate to get the last element.\n        }\n        return ed;\n    }, _AnnotationEditorUIManager_isEmpty = function _AnnotationEditorUIManager_isEmpty() {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").size === 0) {\n            return true;\n        }\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").size === 1) {\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_allEditors, \"f\").values()) {\n                return editor.isEmpty();\n            }\n        }\n        return false;\n    }, _AnnotationEditorUIManager_selectEditors = function _AnnotationEditorUIManager_selectEditors(editors) {\n        for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\")) {\n            editor.unselect();\n        }\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").clear();\n        for (const editor of editors) {\n            if (editor.isEmpty()) {\n                continue;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_selectedEditors, \"f\").add(editor);\n            editor.select();\n        }\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorUIManager_instances, \"m\", _AnnotationEditorUIManager_dispatchUpdateStates).call(this, { hasSelectedEditor: this.hasSelection });\n    };\n    AnnotationEditorUIManager.TRANSLATE_SMALL = 1; // page units.\n    AnnotationEditorUIManager.TRANSLATE_BIG = 10; // page units.\n\n    /* Copyright 2012 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    // const WaitOnType = {\n    //     EVENT: \"event\",\n    //     TIMEOUT: \"timeout\",\n    // };\n    var _EventBus_listeners;\n    // /**\n    //  * @typedef {Object} WaitOnEventOrTimeoutParameters\n    //  * @property {Object} target - The event target, can for example be:\n    //  *   `window`, `document`, a DOM element, or an {EventBus} instance.\n    //  * @property {string} name - The name of the event.\n    //  * @property {number} delay - The delay, in milliseconds, after which the\n    //  *   timeout occurs (if the event wasn't already dispatched).\n    //  */\n    // /**\n    //  * Allows waiting for an event or a timeout, whichever occurs first.\n    //  * Can be used to ensure that an action always occurs, even when an event\n    //  * arrives late or not at all.\n    //  *\n    //  * @param {WaitOnEventOrTimeoutParameters}\n    //  * @returns {Promise} A promise that is resolved with a {WaitOnType} value.\n    //  */\n    // async function waitOnEventOrTimeout({ target, name, delay = 0 }) {\n    //     if (\n    //         typeof target !== \"object\" ||\n    //         !(name && typeof name === \"string\") ||\n    //         !(Number.isInteger(delay) && delay >= 0)\n    //     ) {\n    //         throw new Error(\"waitOnEventOrTimeout - invalid parameters.\");\n    //     }\n    //     const { promise, resolve } = Promise.withResolvers();\n    //     const ac = new AbortController();\n    //     function handler(type) {\n    //         ac.abort(); // Remove event listener.\n    //         clearTimeout(timeout);\n    //         resolve(type);\n    //     }\n    //     const evtMethod = target instanceof EventBus ? \"_on\" : \"addEventListener\";\n    //     target[evtMethod](name, handler.bind(null, WaitOnType.EVENT), {\n    //         signal: ac.signal,\n    //     });\n    //     const timeout = setTimeout(handler.bind(null, WaitOnType.TIMEOUT), delay);\n    //     return promise;\n    // }\n    /**\n     * Simple event bus for an application. Listeners are attached using the `on`\n     * and `off` methods. To raise an event, the `dispatch` method shall be used.\n     */\n    class EventBus {\n        constructor() {\n            _EventBus_listeners.set(this, Object.create(null));\n        }\n        /**\n         * @param {string} eventName\n         * @param {function} listener\n         * @param {Object} [options]\n         */\n        on(eventName, listener, options = null) {\n            this._on(eventName, listener, {\n                external: true,\n                once: options === null || options === void 0 ? void 0 : options.once,\n                signal: options === null || options === void 0 ? void 0 : options.signal,\n            });\n        }\n        /**\n         * @param {string} eventName\n         * @param {function} listener\n         * @param {Object} [options]\n         */\n        off(eventName, listener) {\n            this._off(eventName, listener);\n        }\n        /**\n         * @param {string} eventName\n         * @param {Object} data\n         */\n        dispatch(eventName, data) {\n            const eventListeners = kendo_dateinputsCommon_cmn_chunk_js.a(this, _EventBus_listeners, \"f\")[eventName];\n            if (!eventListeners || eventListeners.length === 0) {\n                return;\n            }\n            let externalListeners;\n            // Making copy of the listeners array in case if it will be modified\n            // during dispatch.\n            for (const { listener, external, once } of eventListeners.slice(0)) {\n                if (once) {\n                    this._off(eventName, listener);\n                }\n                if (external) {\n                    (externalListeners || (externalListeners = [])).push(listener);\n                    continue;\n                }\n                listener(data);\n            }\n            // Dispatch any \"external\" listeners *after* the internal ones, to give the\n            // viewer components time to handle events and update their state first.\n            if (externalListeners) {\n                for (const listener of externalListeners) {\n                    listener(data);\n                }\n                externalListeners = null;\n            }\n        }\n        /**\n         * @ignore\n         */\n        _on(eventName, listener, options = null) {\n            var _a;\n            let rmAbort = null;\n            if ((options === null || options === void 0 ? void 0 : options.signal) instanceof AbortSignal) {\n                const { signal } = options;\n                if (signal.aborted) {\n                    // console.error(\"Cannot use an `aborted` signal.\");\n                    return;\n                }\n                const onAbort = () => this._off(eventName, listener);\n                rmAbort = () => signal.removeEventListener(\"abort\", onAbort);\n                signal.addEventListener(\"abort\", onAbort);\n            }\n            const eventListeners = ((_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _EventBus_listeners, \"f\"))[eventName] || (_a[eventName] = []));\n            eventListeners.push({\n                listener,\n                external: (options === null || options === void 0 ? void 0 : options.external) === true,\n                once: (options === null || options === void 0 ? void 0 : options.once) === true,\n                rmAbort,\n            });\n        }\n        /**\n         * @ignore\n         */\n        _off(eventName, listener) {\n            var _a;\n            const eventListeners = kendo_dateinputsCommon_cmn_chunk_js.a(this, _EventBus_listeners, \"f\")[eventName];\n            if (!eventListeners) {\n                return;\n            }\n            for (let i = 0, ii = eventListeners.length; i < ii; i++) {\n                const evt = eventListeners[i];\n                if (evt.listener === listener) {\n                    (_a = evt.rmAbort) === null || _a === void 0 ? void 0 : _a.call(evt); // Ensure that the `AbortSignal` listener is removed.\n                    eventListeners.splice(i, 1);\n                    return;\n                }\n            }\n        }\n    }\n    _EventBus_listeners = new WeakMap();\n\n    /* Copyright 2012 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    // const DEFAULT_SCALE_VALUE = \"auto\";\n    const DEFAULT_SCALE = 1.0;\n    // const DEFAULT_SCALE_DELTA = 1.1;\n    // const MIN_SCALE = 0.1;\n    // const MAX_SCALE = 10.0;\n    // const UNKNOWN_SCALE = 0;\n    // const MAX_AUTO_SCALE = 1.25;\n    // const SCROLLBAR_PADDING = 40;\n    // const VERTICAL_PADDING = 5;\n    const RenderingStates = {\n        INITIAL: 0,\n        RUNNING: 1,\n        PAUSED: 2,\n        FINISHED: 3,\n    };\n    const PresentationModeState = {\n        UNKNOWN: 0,\n        NORMAL: 1,\n        CHANGING: 2,\n        FULLSCREEN: 3,\n    };\n    // const SidebarView = {\n    //   UNKNOWN: -1,\n    //   NONE: 0,\n    //   THUMBS: 1, // Default value.\n    //   OUTLINE: 2,\n    //   ATTACHMENTS: 3,\n    //   LAYERS: 4,\n    // };\n    const TextLayerMode = {\n        DISABLE: 0,\n        ENABLE: 1,\n        ENABLE_PERMISSIONS: 2,\n    };\n    const ScrollMode = {\n        UNKNOWN: -1,\n        VERTICAL: 0, // Default value.\n        HORIZONTAL: 1,\n        WRAPPED: 2,\n        PAGE: 3,\n    };\n    // const SpreadMode = {\n    //   UNKNOWN: -1,\n    //   NONE: 0, // Default value.\n    //   ODD: 1,\n    //   EVEN: 2,\n    // };\n    // const CursorTool = {\n    //   SELECT: 0, // The default value.\n    //   HAND: 1,\n    //   ZOOM: 2,\n    // };\n    // // Used by `PDFViewerApplication`, and by the API unit-tests.\n    // const AutoPrintRegExp = /\\bprint\\s*\\(/;\n    // /**\n    //  * Scale factors for the canvas, necessary with HiDPI displays.\n    //  */\n    // class OutputScale {\n    //   constructor() {\n    //     const pixelRatio = window.devicePixelRatio || 1;\n    //     /**\n    //      * @type {number} Horizontal scale.\n    //      */\n    //     this.sx = pixelRatio;\n    //     /**\n    //      * @type {number} Vertical scale.\n    //      */\n    //     this.sy = pixelRatio;\n    //   }\n    //   /**\n    //    * @type {boolean} Returns `true` when scaling is required, `false` otherwise.\n    //    */\n    //   get scaled() {\n    //     return this.sx !== 1 || this.sy !== 1;\n    //   }\n    // }\n    /**\n     * Scrolls specified element into view of its parent.\n     * @param {HTMLElement} element - The element to be visible.\n     * @param {Object} [spot] - An object with optional top and left properties,\n     *   specifying the offset from the top left edge.\n     * @param {number} [spot.left]\n     * @param {number} [spot.top]\n     * @param {boolean} [scrollMatches] - When scrolling search results into view,\n     *   ignore elements that either: Contains marked content identifiers,\n     *   or have the CSS-rule `overflow: hidden;` set. The default value is `false`.\n     */\n    function scrollIntoView(element, spot, scrollMatches = false) {\n        // Assuming offsetParent is available (it's not available when viewer is in\n        // hidden iframe or object). We have to scroll: if the offsetParent is not set\n        // producing the error. See also animationStarted.\n        let parent = element.offsetParent;\n        if (!parent) {\n            console.error(\"offsetParent is not set -- cannot scroll\");\n            return;\n        }\n        let offsetY = element.offsetTop + element.clientTop;\n        let offsetX = element.offsetLeft + element.clientLeft;\n        while ((parent.clientHeight === parent.scrollHeight &&\n            parent.clientWidth === parent.scrollWidth) ||\n            (scrollMatches &&\n                (parent.classList.contains(\"markedContent\") || parent.classList.contains(\"k-marked-content\") ||\n                    getComputedStyle(parent).overflow === \"hidden\"))) {\n            offsetY += parent.offsetTop;\n            offsetX += parent.offsetLeft;\n            parent = parent.offsetParent;\n            if (!parent) {\n                return; // no need to scroll\n            }\n        }\n        if (spot) {\n            if (spot.top !== undefined) {\n                offsetY += spot.top;\n            }\n            if (spot.left !== undefined) {\n                offsetX += spot.left;\n                parent.scrollLeft = offsetX;\n            }\n        }\n        parent.scrollTop = offsetY;\n    }\n    // /**\n    //  * Helper function to start monitoring the scroll event and converting them into\n    //  * PDF.js friendly one: with scroll debounce and scroll direction.\n    //  */\n    // function watchScroll(viewAreaElement, callback, abortSignal = undefined) {\n    //   const debounceScroll = function (evt) {\n    //     if (rAF) {\n    //       return;\n    //     }\n    //     // schedule an invocation of scroll for next animation frame.\n    //     rAF = window.requestAnimationFrame(function viewAreaElementScrolled() {\n    //       rAF = null;\n    //       const currentX = viewAreaElement.scrollLeft;\n    //       const lastX = state.lastX;\n    //       if (currentX !== lastX) {\n    //         state.right = currentX > lastX;\n    //       }\n    //       state.lastX = currentX;\n    //       const currentY = viewAreaElement.scrollTop;\n    //       const lastY = state.lastY;\n    //       if (currentY !== lastY) {\n    //         state.down = currentY > lastY;\n    //       }\n    //       state.lastY = currentY;\n    //       callback(state);\n    //     });\n    //   };\n    //   const state = {\n    //     right: true,\n    //     down: true,\n    //     lastX: viewAreaElement.scrollLeft,\n    //     lastY: viewAreaElement.scrollTop,\n    //     _eventHandler: debounceScroll,\n    //   };\n    //   let rAF = null;\n    //   viewAreaElement.addEventListener(\"scroll\", debounceScroll, {\n    //     useCapture: true,\n    //     signal: abortSignal,\n    //   });\n    //   abortSignal?.addEventListener(\n    //     \"abort\",\n    //     () => window.cancelAnimationFrame(rAF),\n    //     { once: true }\n    //   );\n    //   return state;\n    // }\n    /**\n     * Helper function to parse query string (e.g. ?param1=value&param2=...).\n     * @param {string} query\n     * @returns {Map}\n     */\n    function parseQueryString(query) {\n        const params = new Map();\n        const urlSearchParams = new URLSearchParams(query);\n        for (const [key, value] of urlSearchParams) {\n            // for (const [key, value] of new URLSearchParams(query)) {\n            params.set(key.toLowerCase(), value);\n        }\n        return params;\n    }\n    // const InvisibleCharsRegExp = /[\\x00-\\x1F]/g;\n    // /**\n    //  * @param {string} str\n    //  * @param {boolean} [replaceInvisible]\n    //  */\n    // function removeNullCharacters(str, replaceInvisible = false) {\n    //   if (!InvisibleCharsRegExp.test(str)) {\n    //     return str;\n    //   }\n    //   if (replaceInvisible) {\n    //     return str.replaceAll(InvisibleCharsRegExp, m => (m === \"\\x00\" ? \"\" : \" \"));\n    //   }\n    //   return str.replaceAll(\"\\x00\", \"\");\n    // }\n    /**\n     * Use binary search to find the index of the first item in a given array which\n     * passes a given condition. The items are expected to be sorted in the sense\n     * that if the condition is true for one item in the array, then it is also true\n     * for all following items.\n     *\n     * @returns {number} Index of the first array element to pass the test,\n     *                   or |items.length| if no such element exists.\n     */\n    function binarySearchFirstItem(items, condition, start = 0) {\n        let minIndex = start;\n        let maxIndex = items.length - 1;\n        if (maxIndex < 0 || !condition(items[maxIndex])) {\n            return items.length;\n        }\n        if (condition(items[minIndex])) {\n            return minIndex;\n        }\n        while (minIndex < maxIndex) {\n            const currentIndex = (minIndex + maxIndex) >> 1;\n            const currentItem = items[currentIndex];\n            if (condition(currentItem)) {\n                maxIndex = currentIndex;\n            }\n            else {\n                minIndex = currentIndex + 1;\n            }\n        }\n        return minIndex; /* === maxIndex */\n    }\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _TextAccessibilityManager_instances, _a$8, _TextAccessibilityManager_enabled, _TextAccessibilityManager_textChildren, _TextAccessibilityManager_textNodes, _TextAccessibilityManager_waitingElements, _TextAccessibilityManager_compareElementPositions, _TextAccessibilityManager_addIdToAriaOwns;\n    /**\n     * This class aims to provide some methods:\n     *  - to reorder elements in the DOM with respect to the visual order;\n     *  - to create a link, using aria-owns, between spans in the textLayer and\n     *    annotations in the annotationLayer. The goal is to help to know\n     *    where the annotations are in the text flow.\n     */\n    class TextAccessibilityManager {\n        constructor() {\n            _TextAccessibilityManager_instances.add(this);\n            _TextAccessibilityManager_enabled.set(this, false);\n            _TextAccessibilityManager_textChildren.set(this, null);\n            _TextAccessibilityManager_textNodes.set(this, new Map());\n            _TextAccessibilityManager_waitingElements.set(this, new Map());\n        }\n        setTextMapping(textDivs) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextAccessibilityManager_textChildren, textDivs, \"f\");\n        }\n        /**\n         * Function called when the text layer has finished rendering.\n         */\n        enable() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_enabled, \"f\")) {\n                // throw new Error(\"TextAccessibilityManager is already enabled.\");\n            }\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textChildren, \"f\")) {\n                throw new Error(\"Text divs and strings have not been set.\");\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextAccessibilityManager_enabled, true, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextAccessibilityManager_textChildren, kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textChildren, \"f\").slice(), \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textChildren, \"f\").sort(kendo_dateinputsCommon_cmn_chunk_js.a(_a$8, _a$8, \"m\", _TextAccessibilityManager_compareElementPositions));\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textNodes, \"f\").size > 0) {\n                // Some links have been made before this manager has been disabled, hence\n                // we restore them.\n                const textChildren = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textChildren, \"f\");\n                for (const [id, nodeIndex] of kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textNodes, \"f\")) {\n                    const element = document.getElementById(id);\n                    if (!element) {\n                        // If the page was *fully* reset the element no longer exists, and it\n                        // will be re-inserted later (i.e. when the annotationLayer renders).\n                        kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textNodes, \"f\").delete(id);\n                        continue;\n                    }\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_instances, \"m\", _TextAccessibilityManager_addIdToAriaOwns).call(this, id, textChildren[nodeIndex]);\n                }\n            }\n            for (const [element, isRemovable] of kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_waitingElements, \"f\")) {\n                this.addPointerInTextLayer(element, isRemovable);\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_waitingElements, \"f\").clear();\n        }\n        disable() {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_enabled, \"f\")) {\n                return;\n            }\n            // Don't clear this.#textNodes which is used to rebuild the aria-owns\n            // in case it's re-enabled at some point.\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_waitingElements, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextAccessibilityManager_textChildren, null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextAccessibilityManager_enabled, false, \"f\");\n        }\n        /**\n         * Remove an aria-owns id from a node in the text layer.\n         * @param {HTMLElement} element\n         */\n        removePointerInTextLayer(element) {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_enabled, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_waitingElements, \"f\").delete(element);\n                return;\n            }\n            const children = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textChildren, \"f\");\n            if (!children || children.length === 0) {\n                return;\n            }\n            const { id } = element;\n            const nodeIndex = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textNodes, \"f\").get(id);\n            if (nodeIndex === undefined) {\n                return;\n            }\n            const node = children[nodeIndex];\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textNodes, \"f\").delete(id);\n            let owns = node.getAttribute(\"aria-owns\");\n            if (owns === null || owns === void 0 ? void 0 : owns.includes(id)) {\n                owns = owns\n                    .split(\" \")\n                    .filter(x => x !== id)\n                    .join(\" \");\n                if (owns) {\n                    node.setAttribute(\"aria-owns\", owns);\n                }\n                else {\n                    node.removeAttribute(\"aria-owns\");\n                    node.setAttribute(\"role\", \"presentation\");\n                }\n            }\n        }\n        /**\n         * Find the text node which is the nearest and add an aria-owns attribute\n         * in order to correctly position this editor in the text flow.\n         * @param {HTMLElement} element\n         * @param {boolean} isRemovable\n         * @returns {string|null} The id in the struct tree if any.\n         */\n        addPointerInTextLayer(element, isRemovable) {\n            // todo: mocked highlight editor is null here\n            if (!element) {\n                console.warn(\"no element\");\n                return;\n            }\n            const { id } = element;\n            if (!id) {\n                return null;\n            }\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_enabled, \"f\")) {\n                // The text layer needs to be there, so we postpone the association.\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_waitingElements, \"f\").set(element, isRemovable);\n                return null;\n            }\n            if (isRemovable) {\n                this.removePointerInTextLayer(element);\n            }\n            const children = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textChildren, \"f\");\n            if (!children || children.length === 0) {\n                return null;\n            }\n            const index = binarySearchFirstItem(children, node => kendo_dateinputsCommon_cmn_chunk_js.a(_a$8, _a$8, \"m\", _TextAccessibilityManager_compareElementPositions).call(_a$8, element, node) < 0);\n            const nodeIndex = Math.max(0, index - 1);\n            const child = children[nodeIndex];\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_instances, \"m\", _TextAccessibilityManager_addIdToAriaOwns).call(this, id, child);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextAccessibilityManager_textNodes, \"f\").set(id, nodeIndex);\n            const parent = child.parentNode;\n            // return parent?.classList.contains(\"markedContent\") ? parent.id : null;\n            return (parent === null || parent === void 0 ? void 0 : parent.classList.contains(\"markedContent\")) ||\n                (parent === null || parent === void 0 ? void 0 : parent.classList.contains(\"k-marked-content\")) ? parent.id : null;\n        }\n        /**\n         * Move a div in the DOM in order to respect the visual order.\n         * @param {HTMLDivElement} element\n         * @returns {string|null} The id in the struct tree if any.\n         */\n        moveElementInDOM(container, element, contentElement, isRemovable) {\n            const id = this.addPointerInTextLayer(contentElement, isRemovable);\n            if (!container.hasChildNodes()) {\n                container.append(element);\n                return id;\n            }\n            // todo: use children to skip text nodes\n            // const children = Array.from(container.childNodes).filter(\n            const children = Array.from(container.children).filter(node => node !== element);\n            if (children.length === 0) {\n                return id;\n            }\n            const elementToCompare = contentElement || element;\n            const index = binarySearchFirstItem(children, node => kendo_dateinputsCommon_cmn_chunk_js.a(_a$8, _a$8, \"m\", _TextAccessibilityManager_compareElementPositions).call(_a$8, elementToCompare, node) < 0);\n            if (index === 0) {\n                children[0].before(element);\n            }\n            else {\n                children[index - 1].after(element);\n            }\n            return id;\n        }\n    }\n    _a$8 = TextAccessibilityManager, _TextAccessibilityManager_enabled = new WeakMap(), _TextAccessibilityManager_textChildren = new WeakMap(), _TextAccessibilityManager_textNodes = new WeakMap(), _TextAccessibilityManager_waitingElements = new WeakMap(), _TextAccessibilityManager_instances = new WeakSet(), _TextAccessibilityManager_compareElementPositions = function _TextAccessibilityManager_compareElementPositions(e1, e2) {\n        const rect1 = e1.getBoundingClientRect();\n        const rect2 = e2.getBoundingClientRect();\n        if (rect1.width === 0 && rect1.height === 0) {\n            return +1;\n        }\n        if (rect2.width === 0 && rect2.height === 0) {\n            return -1;\n        }\n        const top1 = rect1.y;\n        const bot1 = rect1.y + rect1.height;\n        const mid1 = rect1.y + rect1.height / 2;\n        const top2 = rect2.y;\n        const bot2 = rect2.y + rect2.height;\n        const mid2 = rect2.y + rect2.height / 2;\n        if (mid1 <= top2 && mid2 >= bot1) {\n            return -1;\n        }\n        if (mid2 <= top1 && mid1 >= bot2) {\n            return +1;\n        }\n        const centerX1 = rect1.x + rect1.width / 2;\n        const centerX2 = rect2.x + rect2.width / 2;\n        return centerX1 - centerX2;\n    }, _TextAccessibilityManager_addIdToAriaOwns = function _TextAccessibilityManager_addIdToAriaOwns(id, node) {\n        const owns = node.getAttribute(\"aria-owns\");\n        if (!(owns === null || owns === void 0 ? void 0 : owns.includes(id))) {\n            node.setAttribute(\"aria-owns\", owns ? `${owns} ${id}` : id);\n        }\n        node.removeAttribute(\"role\");\n    };\n\n    /* Copyright 2012 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _TextLayerBuilder_instances, _a$7, _TextLayerBuilder_onAppend, _TextLayerBuilder_textLayer, _TextLayerBuilder_textLayers, _TextLayerBuilder_selectionChangeAbortController, _TextLayerBuilder_bindMouse, _TextLayerBuilder_removeGlobalSelectionListener, _TextLayerBuilder_enableGlobalSelectionListener;\n    /**\n     * The text layer builder provides text selection functionality for the PDF.\n     * It does this by creating overlay divs over the PDF's text. These divs\n     * contain text that matches the PDF text they are overlaying.\n     */\n    class TextLayerBuilder {\n        constructor({ pdfPage, \n        // highlighter = null,\n        accessibilityManager, \n        // enablePermissions = false,\n        // todo: fix styles\n        styles, onAppend = null, }) {\n            _TextLayerBuilder_instances.add(this);\n            // todo: props\n            this.pdfPage = null;\n            // highlighter = null;\n            this.div = null;\n            this.accessibilityManager = null;\n            // todo: props\n            // #enablePermissions = false;\n            _TextLayerBuilder_onAppend.set(this, null);\n            // #renderingDone = false;\n            _TextLayerBuilder_textLayer.set(this, null);\n            this.pdfPage = pdfPage;\n            // this.highlighter = highlighter;\n            this.accessibilityManager = accessibilityManager;\n            // this.#enablePermissions = enablePermissions === true;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextLayerBuilder_onAppend, onAppend, \"f\");\n            this.div = document.createElement(\"div\");\n            this.div.tabIndex = 0;\n            // this.div.className = \"textLayer\";\n            // todo: fix classes\n            this.div.classList.add(\"k-text-layer\");\n            // todo: fix styles\n            Object.keys(styles).forEach((key) => (this.div.style[key] = styles[key]));\n        }\n        /**\n         * Renders the text layer.\n         * @param {PageViewport} viewport\n         * @param {Object} [textContentParams]\n         */\n        render(viewport_1) {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, arguments, void 0, function* (viewport, textContentParams = null) {\n                var _a, _b, _c;\n                // if (this.#renderingDone && this.#textLayer) {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_textLayer, \"f\")) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_textLayer, \"f\").update({\n                        viewport,\n                        onBefore: this.hide.bind(this),\n                    });\n                    this.show();\n                    return;\n                }\n                this.cancel();\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _TextLayerBuilder_textLayer, new kendo_pdfjs_loader_js.TextLayer({\n                    textContentSource: this.pdfPage.streamTextContent(textContentParams || {\n                        // includeMarkedContent: true,\n                        // setting this to false requires removing \"await\"\n                        // in page.ts when calling this.#renderTextLayer()\n                        includeMarkedContent: false,\n                        disableNormalization: true,\n                    }),\n                    container: this.div,\n                    viewport,\n                }), \"f\");\n                // const { textDivs, textContentItemsStr } = this.#textLayer;\n                const { textDivs } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_textLayer, \"f\");\n                // this.highlighter?.setTextMapping(textDivs, textContentItemsStr);\n                (_a = this.accessibilityManager) === null || _a === void 0 ? void 0 : _a.setTextMapping(textDivs);\n                yield kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_textLayer, \"f\").render();\n                // this.#renderingDone = true;\n                // todo: manually add \"k-marked-content\" class\n                // as pdf.js text layer cannot render it\n                const markedContentElements = Array.from(this.div.querySelectorAll(\".markedContent\") || []) || [];\n                markedContentElements.forEach(x => addClass(\"k-marked-content\", x));\n                if (markedContentElements && markedContentElements.length > 0) {\n                    const endOfContent = document.createElement(\"div\");\n                    endOfContent.className = \"endOfContent\";\n                    this.div.append(endOfContent);\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_instances, \"m\", _TextLayerBuilder_bindMouse).call(this, endOfContent);\n                }\n                // Ensure that the textLayer is appended to the DOM *before* handling\n                // e.g. a pending search operation.\n                (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_onAppend, \"f\")) === null || _b === void 0 ? void 0 : _b.call(this, this.div);\n                // this.highlighter?.enable();\n                (_c = this.accessibilityManager) === null || _c === void 0 ? void 0 : _c.enable();\n            });\n        }\n        hide() {\n            // if (!this.div.hidden && this.#renderingDone) {\n            if (!this.div.hidden) {\n                // We turn off the highlighter in order to avoid to scroll into view an\n                // element of the text layer which could be hidden.\n                // this.highlighter?.disable();\n                this.div.hidden = true;\n            }\n        }\n        show() {\n            // if (this.div.hidden && this.#renderingDone) {\n            if (this.div.hidden) {\n                this.div.hidden = false;\n                // this.highlighter?.enable();\n            }\n        }\n        /**\n         * Cancel rendering of the text layer.\n         */\n        cancel() {\n            var _b, _c;\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _TextLayerBuilder_textLayer, \"f\")) === null || _b === void 0 ? void 0 : _b.cancel();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _TextLayerBuilder_textLayer, null, \"f\");\n            // this.highlighter?.disable();\n            (_c = this.accessibilityManager) === null || _c === void 0 ? void 0 : _c.disable();\n            kendo_dateinputsCommon_cmn_chunk_js.a(_a$7, _a$7, \"m\", _TextLayerBuilder_removeGlobalSelectionListener).call(_a$7, this.div);\n        }\n    }\n    _a$7 = TextLayerBuilder, _TextLayerBuilder_onAppend = new WeakMap(), _TextLayerBuilder_textLayer = new WeakMap(), _TextLayerBuilder_instances = new WeakSet(), _TextLayerBuilder_bindMouse = function _TextLayerBuilder_bindMouse(end) {\n        const { div } = this;\n        // div.addEventListener(\"mousedown\", () => {\n        //     div.classList.add(\"selecting\");\n        // });\n        // div.addEventListener(\"copy\", event => {\n        //     if (!this.#enablePermissions) {\n        //         const selection = document.getSelection();\n        //         event.clipboardData.setData(\n        //             \"text/plain\",\n        //             removeNullCharacters(normalizeUnicode(selection.toString()))\n        //         );\n        //     }\n        //     event.preventDefault();\n        //     event.stopPropagation();\n        // });\n        kendo_dateinputsCommon_cmn_chunk_js.a(_a$7, _a$7, \"f\", _TextLayerBuilder_textLayers).set(div, end);\n        kendo_dateinputsCommon_cmn_chunk_js.a(_a$7, _a$7, \"m\", _TextLayerBuilder_enableGlobalSelectionListener).call(_a$7);\n    }, _TextLayerBuilder_removeGlobalSelectionListener = function _TextLayerBuilder_removeGlobalSelectionListener(textLayerDiv) {\n        var _b;\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _a$7, \"f\", _TextLayerBuilder_textLayers).delete(textLayerDiv);\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _a$7, \"f\", _TextLayerBuilder_textLayers).size === 0) {\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _a$7, \"f\", _TextLayerBuilder_selectionChangeAbortController)) === null || _b === void 0 ? void 0 : _b.abort();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _a$7, null, \"f\", _TextLayerBuilder_selectionChangeAbortController);\n        }\n    }, _TextLayerBuilder_enableGlobalSelectionListener = function _TextLayerBuilder_enableGlobalSelectionListener() {\n        // if (this.#selectionChangeAbortController) {\n        //     // document-level event listeners already installed\n        //     return;\n        // }\n        // this.#selectionChangeAbortController = new AbortController();\n        // const { signal } = this.#selectionChangeAbortController;\n        // const reset = (end, textLayer) => {\n        //     if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n        //         textLayer.append(end);\n        //         end.style.width = \"\";\n        //         end.style.height = \"\";\n        //     }\n        //     textLayer.classList.remove(\"selecting\");\n        // };\n        // let isPointerDown = false;\n        // document.addEventListener(\n        //     \"pointerdown\",\n        //     () => {\n        //         isPointerDown = true;\n        //     },\n        //     { signal }\n        // );\n        // document.addEventListener(\n        //     \"pointerup\",\n        //     () => {\n        //         isPointerDown = false;\n        //         this.#textLayers.forEach(reset);\n        //     },\n        //     { signal }\n        // );\n        // window.addEventListener(\n        //     \"blur\",\n        //     () => {\n        //         isPointerDown = false;\n        //         this.#textLayers.forEach(reset);\n        //     },\n        //     { signal }\n        // );\n        // document.addEventListener(\n        //     \"keyup\",\n        //     () => {\n        //         if (!isPointerDown) {\n        //             this.#textLayers.forEach(reset);\n        //         }\n        //     },\n        //     { signal }\n        // );\n        // if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n        //     // eslint-disable-next-line no-var\n        //     var isFirefox, prevRange;\n        // }\n        // document.addEventListener(\n        //     \"selectionchange\",\n        //     () => {\n        //         const selection = document.getSelection();\n        //         if (selection.rangeCount === 0) {\n        //             this.#textLayers.forEach(reset);\n        //             return;\n        //         }\n        //         // Even though the spec says that .rangeCount should be 0 or 1, Firefox\n        //         // creates multiple ranges when selecting across multiple pages.\n        //         // Make sure to collect all the .textLayer elements where the selection\n        //         // is happening.\n        //         const activeTextLayers = new Set();\n        //         for (let i = 0; i < selection.rangeCount; i++) {\n        //             const range = selection.getRangeAt(i);\n        //             for (const textLayerDiv of this.#textLayers.keys()) {\n        //                 if (\n        //                     !activeTextLayers.has(textLayerDiv) &&\n        //                     range.intersectsNode(textLayerDiv)\n        //                 ) {\n        //                     activeTextLayers.add(textLayerDiv);\n        //                 }\n        //             }\n        //         }\n        //         for (const [textLayerDiv, endDiv] of this.#textLayers) {\n        //             if (activeTextLayers.has(textLayerDiv)) {\n        //                 textLayerDiv.classList.add(\"selecting\");\n        //             } else {\n        //                 reset(endDiv, textLayerDiv);\n        //             }\n        //         }\n        //         if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n        //             return;\n        //         }\n        //         if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"CHROME\")) {\n        //             isFirefox ??=\n        //                 getComputedStyle(\n        //                     this.#textLayers.values().next().value\n        //                 ).getPropertyValue(\"-moz-user-select\") === \"none\";\n        //             if (isFirefox) {\n        //                 return;\n        //             }\n        //         }\n        //         // In non-Firefox browsers, when hovering over an empty space (thus,\n        //         // on .endOfContent), the selection will expand to cover all the\n        //         // text between the current selection and .endOfContent. By moving\n        //         // .endOfContent to right after (or before, depending on which side\n        //         // of the selection the user is moving), we limit the selection jump\n        //         // to at most cover the enteirety of the <span> where the selection\n        //         // is being modified.\n        //         const range = selection.getRangeAt(0);\n        //         const modifyStart =\n        //             prevRange &&\n        //             (range.compareBoundaryPoints(Range.END_TO_END, prevRange) === 0 ||\n        //                 range.compareBoundaryPoints(Range.START_TO_END, prevRange) === 0);\n        //         let anchor = modifyStart ? range.startContainer : range.endContainer;\n        //         if (anchor.nodeType === Node.TEXT_NODE) {\n        //             anchor = anchor.parentNode;\n        //         }\n        //         const parentTextLayer = anchor.parentElement.closest(\".textLayer\");\n        //         const endDiv = this.#textLayers.get(parentTextLayer);\n        //         if (endDiv) {\n        //             endDiv.style.width = parentTextLayer.style.width;\n        //             endDiv.style.height = parentTextLayer.style.height;\n        //             anchor.parentElement.insertBefore(\n        //                 endDiv,\n        //                 modifyStart ? anchor : anchor.nextSibling\n        //             );\n        //         }\n        //         prevRange = range.cloneRange();\n        //     },\n        //     { signal }\n        // );\n    };\n    _TextLayerBuilder_textLayers = { value: new Map() };\n    _TextLayerBuilder_selectionChangeAbortController = { value: null };\n\n    /* Copyright 2020 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    /**\n     * PLEASE NOTE: This file is currently imported in both the `../display/` and\n     *              `../scripting_api/` folders, hence be EXTREMELY careful about\n     *              introducing any dependencies here since that can lead to an\n     *              unexpected/unnecessary size increase of the *built* files.\n     */\n    function makeColorComp(n) {\n        return Math.floor(Math.max(0, Math.min(1, n)) * 255)\n            .toString(16)\n            .padStart(2, \"0\");\n    }\n    function scaleAndClamp(x) {\n        return Math.max(0, Math.min(255, 255 * x));\n    }\n    // PDF specifications section 10.3\n    class ColorConverters {\n        static CMYK_G([c, y, m, k]) {\n            return [\"G\", 1 - Math.min(1, 0.3 * c + 0.59 * m + 0.11 * y + k)];\n        }\n        static G_CMYK([g]) {\n            return [\"CMYK\", 0, 0, 0, 1 - g];\n        }\n        static G_RGB([g]) {\n            return [\"RGB\", g, g, g];\n        }\n        static G_rgb([g]) {\n            g = scaleAndClamp(g);\n            return [g, g, g];\n        }\n        static G_HTML([g]) {\n            const G = makeColorComp(g);\n            return `#${G}${G}${G}`;\n        }\n        static RGB_G([r, g, b]) {\n            return [\"G\", 0.3 * r + 0.59 * g + 0.11 * b];\n        }\n        static RGB_rgb(color) {\n            return color.map(scaleAndClamp);\n        }\n        static RGB_HTML(color) {\n            return `#${color.map(makeColorComp).join(\"\")}`;\n        }\n        static T_HTML() {\n            return \"#00000000\";\n        }\n        static T_rgb() {\n            return [null];\n        }\n        static CMYK_RGB([c, y, m, k]) {\n            return [\n                \"RGB\",\n                1 - Math.min(1, c + k),\n                1 - Math.min(1, m + k),\n                1 - Math.min(1, y + k),\n            ];\n        }\n        static CMYK_rgb([c, y, m, k]) {\n            return [\n                scaleAndClamp(1 - Math.min(1, c + k)),\n                scaleAndClamp(1 - Math.min(1, m + k)),\n                scaleAndClamp(1 - Math.min(1, y + k)),\n            ];\n        }\n        static CMYK_HTML(components) {\n            const rgb = this.CMYK_RGB(components).slice(1);\n            return this.RGB_HTML(rgb);\n        }\n        static RGB_CMYK([r, g, b]) {\n            const c = 1 - r;\n            const m = 1 - g;\n            const y = 1 - b;\n            const k = Math.min(c, m, y);\n            return [\"CMYK\", c, m, y, k];\n        }\n    }\n\n    /* Copyright 2014 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationElement_instances, _AnnotationElement_updates, _AnnotationElement_hasBorder, _AnnotationElement_popupElement, _AnnotationElement_setRectEdited, _LinkAnnotationElement_instances, _LinkAnnotationElement_setInternalLink, _LinkAnnotationElement_bindAttachment, _LinkAnnotationElement_bindSetOCGState, _PopupElement_instances, _PopupElement_boundKeyDown, _PopupElement_boundHide, _PopupElement_boundShow, _PopupElement_boundToggle, _PopupElement_color, _PopupElement_container, _PopupElement_contentsObj, _PopupElement_dateObj, _PopupElement_elements, _PopupElement_parent, _PopupElement_parentRect, _PopupElement_pinned, _PopupElement_popup, _PopupElement_position, _PopupElement_rect, _PopupElement_richText, _PopupElement_titleObj, _PopupElement_updates, _PopupElement_wasVisible, _PopupElement_html_get, _PopupElement_fontSize_get, _PopupElement_fontColor_get, _PopupElement_makePopupContent, _PopupElement_keyDown, _PopupElement_setPosition, _PopupElement_toggle, _PopupElement_show, _PopupElement_hide, _AnnotationLayer_instances, _AnnotationLayer_accessibilityManager, _AnnotationLayer_annotationCanvasMap, _AnnotationLayer_editableAnnotations, _AnnotationLayer_appendElement, _AnnotationLayer_setAnnotationCanvasMap;\n    // import { AnnotationStorage } from \"pdfjs-dist/types/src/display/annotation_storage\";\n    // import { AnnotationStorage } from \"pdfjs-dist/types/src/display/annotation_storage\";\n    // const DEFAULT_TAB_INDEX = 1000;\n    // it is unclear why the value 1000 is chosen by pdf.js\n    // kendo a11y tests fail if this is not 0\n    const DEFAULT_TAB_INDEX = 0;\n    const DEFAULT_FONT_SIZE = 9;\n    const GetElementsByNameSet = new WeakSet();\n    function getRectDims(rect) {\n        return {\n            width: rect[2] - rect[0],\n            height: rect[3] - rect[1],\n        };\n    }\n    class AnnotationElementFactory {\n        /**\n         * @param {AnnotationElementParameters} parameters\n         * @returns {AnnotationElement}\n         */\n        static create(parameters) {\n            const subtype = parameters.data.annotationType;\n            switch (subtype) {\n                case AnnotationType.LINK:\n                    return new LinkAnnotationElement(parameters);\n                // case AnnotationType.TEXT:\n                //     return new TextAnnotationElement(parameters);\n                // case AnnotationType.WIDGET:\n                //     const fieldType = parameters.data.fieldType;\n                //     switch (fieldType) {\n                //         case \"Tx\":\n                //             return new TextWidgetAnnotationElement(parameters);\n                //         case \"Btn\":\n                //             if (parameters.data.radioButton) {\n                //                 return new RadioButtonWidgetAnnotationElement(parameters);\n                //             } else if (parameters.data.checkBox) {\n                //                 return new CheckboxWidgetAnnotationElement(parameters);\n                //             }\n                //             return new PushButtonWidgetAnnotationElement(parameters);\n                //         case \"Ch\":\n                //             return new ChoiceWidgetAnnotationElement(parameters);\n                //         case \"Sig\":\n                //             return new SignatureWidgetAnnotationElement(parameters);\n                //         default: break;\n                //     }\n                //     return new WidgetAnnotationElement(parameters);\n                // case AnnotationType.POPUP:\n                //     return new PopupAnnotationElement(parameters);\n                case AnnotationType.FREETEXT:\n                    return new FreeTextAnnotationElement(parameters);\n                // case AnnotationType.LINE:\n                //     return new LineAnnotationElement(parameters);\n                // case AnnotationType.SQUARE:\n                //     return new SquareAnnotationElement(parameters);\n                // case AnnotationType.CIRCLE:\n                //     return new CircleAnnotationElement(parameters);\n                // case AnnotationType.POLYLINE:\n                //     return new PolylineAnnotationElement(parameters);\n                // case AnnotationType.CARET:\n                //     return new CaretAnnotationElement(parameters);\n                // case AnnotationType.INK:\n                //     return new InkAnnotationElement(parameters);\n                // case AnnotationType.POLYGON:\n                //     return new PolygonAnnotationElement(parameters);\n                case AnnotationType.HIGHLIGHT:\n                    return new HighlightAnnotationElement(parameters);\n                // case AnnotationType.UNDERLINE:\n                //     return new UnderlineAnnotationElement(parameters);\n                // case AnnotationType.SQUIGGLY:\n                //     return new SquigglyAnnotationElement(parameters);\n                // case AnnotationType.STRIKEOUT:\n                //     return new StrikeOutAnnotationElement(parameters);\n                // case AnnotationType.STAMP:\n                //     return new StampAnnotationElement(parameters);\n                // case AnnotationType.FILEATTACHMENT:\n                //     return new FileAttachmentAnnotationElement(parameters);\n                default:\n                    return new AnnotationElement(parameters);\n            }\n        }\n    }\n    class AnnotationElement {\n        constructor(parameters, { isRenderable = false, ignoreBorder = false, createQuadrilaterals = false, } = {}) {\n            _AnnotationElement_instances.add(this);\n            // todo: props\n            this.isRenderable = null;\n            this.data = null;\n            this.layer = null;\n            this.linkService = null;\n            this.downloadManager = null;\n            this.imageResourcesPath = null;\n            this.renderForms = null;\n            this.svgFactory = null;\n            this.annotationStorage = null;\n            this.enableScripting = null;\n            this.hasJSActions = null;\n            this._fieldObjects = null;\n            this.parent = null;\n            this.container = null;\n            this.popup = null;\n            this.annotationEditorType = null;\n            // todo: props\n            _AnnotationElement_updates.set(this, null);\n            _AnnotationElement_hasBorder.set(this, false);\n            _AnnotationElement_popupElement.set(this, null);\n            this.isRenderable = isRenderable;\n            this.data = parameters.data;\n            this.layer = parameters.layer;\n            this.linkService = parameters.linkService;\n            this.downloadManager = parameters.downloadManager;\n            this.imageResourcesPath = parameters.imageResourcesPath;\n            this.renderForms = parameters.renderForms;\n            this.svgFactory = parameters.svgFactory;\n            this.annotationStorage = parameters.annotationStorage;\n            this.enableScripting = parameters.enableScripting;\n            this.hasJSActions = parameters.hasJSActions;\n            this._fieldObjects = parameters.fieldObjects;\n            this.parent = parameters.parent;\n            if (isRenderable) {\n                this.container = this._createContainer(ignoreBorder);\n            }\n            if (createQuadrilaterals) {\n                this._createQuadrilaterals();\n            }\n        }\n        static _hasPopupData({ titleObj, contentsObj, richText }) {\n            return !!((titleObj === null || titleObj === void 0 ? void 0 : titleObj.str) || (contentsObj === null || contentsObj === void 0 ? void 0 : contentsObj.str) || (richText === null || richText === void 0 ? void 0 : richText.str));\n        }\n        get _isEditable() {\n            return this.data.isEditable;\n        }\n        get hasPopupData() {\n            return AnnotationElement._hasPopupData(this.data);\n        }\n        updateEdited(params) {\n            var _a;\n            if (!this.container) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationElement_updates, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_updates, \"f\") || {\n                rect: this.data.rect.slice(0),\n            }, \"f\");\n            const { rect } = params;\n            if (rect) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_instances, \"m\", _AnnotationElement_setRectEdited).call(this, rect);\n            }\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_popupElement, \"f\")) === null || _a === void 0 ? void 0 : _a.popup.updateEdited(params);\n        }\n        resetEdited() {\n            var _a;\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_updates, \"f\")) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_instances, \"m\", _AnnotationElement_setRectEdited).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_updates, \"f\").rect);\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_popupElement, \"f\")) === null || _a === void 0 ? void 0 : _a.popup.resetEdited();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationElement_updates, null, \"f\");\n        }\n        /**\n         * Create an empty container for the annotation's HTML element.\n         *\n         * @private\n         * @param {boolean} ignoreBorder\n         * @memberof AnnotationElement\n         * @returns {HTMLElement} A section element.\n         */\n        _createContainer(ignoreBorder) {\n            const { data, parent: { page, viewport }, } = this;\n            const container = document.createElement(\"section\");\n            container.setAttribute(\"data-annotation-id\", data.id);\n            if (!(this instanceof WidgetAnnotationElement)) {\n                container.tabIndex = DEFAULT_TAB_INDEX;\n            }\n            const { style } = container;\n            // The accessibility manager will move the annotation in the DOM in\n            // order to match the visual ordering.\n            // But if an annotation is above an other one, then we must draw it\n            // after the other one whatever the order is in the DOM, hence the\n            // use of the z-index.\n            style.zIndex = (this.parent.zIndex++).toString();\n            if (data.popupRef) {\n                container.setAttribute(\"aria-haspopup\", \"dialog\");\n            }\n            if (data.alternativeText) {\n                container.title = data.alternativeText;\n            }\n            if (data.noRotate) {\n                // container.classList.add(\"norotate\");\n            }\n            if (!data.rect || this instanceof PopupAnnotationElement) {\n                const { rotation: rotationValue } = data;\n                if (!data.hasOwnCanvas && rotationValue !== 0) {\n                    this.setRotation(rotationValue, container);\n                }\n                return container;\n            }\n            const { width, height } = getRectDims(data.rect);\n            if (!ignoreBorder && data.borderStyle.width > 0) {\n                style.borderWidth = `${data.borderStyle.width}px`;\n                const horizontalRadius = data.borderStyle.horizontalCornerRadius;\n                const verticalRadius = data.borderStyle.verticalCornerRadius;\n                if (horizontalRadius > 0 || verticalRadius > 0) {\n                    const radius = `calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`;\n                    style.borderRadius = radius;\n                }\n                else if (this instanceof RadioButtonWidgetAnnotationElement) {\n                    const radius = `calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`;\n                    style.borderRadius = radius;\n                }\n                switch (data.borderStyle.style) {\n                    case AnnotationBorderStyleType.SOLID:\n                        style.borderStyle = \"solid\";\n                        break;\n                    case AnnotationBorderStyleType.DASHED:\n                        style.borderStyle = \"dashed\";\n                        break;\n                    case AnnotationBorderStyleType.BEVELED:\n                        // warn(\"Unimplemented border style: beveled\");\n                        break;\n                    case AnnotationBorderStyleType.INSET:\n                        // warn(\"Unimplemented border style: inset\");\n                        break;\n                    case AnnotationBorderStyleType.UNDERLINE:\n                        style.borderBottomStyle = \"solid\";\n                        break;\n                    default:\n                        break;\n                }\n                const borderColor = data.borderColor || null;\n                if (borderColor) {\n                    kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationElement_hasBorder, true, \"f\");\n                    style.borderColor = kendo_pdfjs_loader_js.Util.makeHexColor(borderColor[0] | 0, borderColor[1] | 0, borderColor[2] | 0);\n                }\n                else {\n                    // Transparent (invisible) border, so do not draw it at all.\n                    style.borderWidth = (0).toString();\n                }\n            }\n            // Do *not* modify `data.rect`, since that will corrupt the annotation\n            // position on subsequent calls to `_createContainer` (see issue 6804).\n            const rect = kendo_pdfjs_loader_js.Util.normalizeRect([\n                data.rect[0],\n                page.view[3] - data.rect[1] + page.view[1],\n                data.rect[2],\n                page.view[3] - data.rect[3] + page.view[1],\n            ]);\n            const { pageWidth, pageHeight, pageX, pageY } = viewport.rawDims;\n            style.left = `${(100 * (rect[0] - pageX)) / pageWidth}%`;\n            style.top = `${(100 * (rect[1] - pageY)) / pageHeight}%`;\n            const { rotation } = data;\n            if (data.hasOwnCanvas || rotation === 0) {\n                style.width = `${(100 * width) / pageWidth}%`;\n                style.height = `${(100 * height) / pageHeight}%`;\n            }\n            else {\n                this.setRotation(rotation, container);\n            }\n            return container;\n        }\n        setRotation(angle, container = this.container) {\n            if (!this.data.rect) {\n                return;\n            }\n            const { pageWidth, pageHeight } = this.parent.viewport.rawDims;\n            const { width, height } = getRectDims(this.data.rect);\n            let elementWidth, elementHeight;\n            if (angle % 180 === 0) {\n                elementWidth = (100 * width) / pageWidth;\n                elementHeight = (100 * height) / pageHeight;\n            }\n            else {\n                elementWidth = (100 * height) / pageWidth;\n                elementHeight = (100 * width) / pageHeight;\n            }\n            container.style.width = `${elementWidth}%`;\n            container.style.height = `${elementHeight}%`;\n            container.setAttribute(\"data-main-rotation\", (360 - angle) % 360);\n        }\n        get _commonActions() {\n            const setColor = (jsName, styleName, event) => {\n                const color = event.detail[jsName];\n                const colorType = color[0];\n                const colorArray = color.slice(1);\n                event.target.style[styleName] =\n                    ColorConverters[`${colorType}_HTML`](colorArray);\n                this.annotationStorage.setValue(this.data.id, {\n                    [styleName]: ColorConverters[`${colorType}_rgb`](colorArray),\n                });\n            };\n            return kendo_pdfjs_loader_js.shadow(this, \"_commonActions\", {\n                display: event => {\n                    const { display } = event.detail;\n                    // See scripting/constants.js for the values of `Display`.\n                    // 0 = visible, 1 = hidden, 2 = noPrint and 3 = noView.\n                    const hidden = display % 2 === 1;\n                    this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n                    this.annotationStorage.setValue(this.data.id, {\n                        noView: hidden,\n                        noPrint: display === 1 || display === 2,\n                    });\n                },\n                print: event => {\n                    this.annotationStorage.setValue(this.data.id, {\n                        noPrint: !event.detail.print,\n                    });\n                },\n                hidden: event => {\n                    const { hidden } = event.detail;\n                    this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n                    this.annotationStorage.setValue(this.data.id, {\n                        noPrint: hidden,\n                        noView: hidden,\n                    });\n                },\n                focus: event => {\n                    setTimeout(() => event.target.focus({ preventScroll: false }), 0);\n                },\n                userName: event => {\n                    // tooltip\n                    event.target.title = event.detail.userName;\n                },\n                readonly: event => {\n                    event.target.disabled = event.detail.readonly;\n                },\n                required: event => {\n                    this._setRequired(event.target, event.detail.required);\n                },\n                bgColor: event => {\n                    setColor(\"bgColor\", \"backgroundColor\", event);\n                },\n                fillColor: event => {\n                    setColor(\"fillColor\", \"backgroundColor\", event);\n                },\n                fgColor: event => {\n                    setColor(\"fgColor\", \"color\", event);\n                },\n                textColor: event => {\n                    setColor(\"textColor\", \"color\", event);\n                },\n                borderColor: event => {\n                    setColor(\"borderColor\", \"borderColor\", event);\n                },\n                strokeColor: event => {\n                    setColor(\"strokeColor\", \"borderColor\", event);\n                },\n                rotation: event => {\n                    const angle = event.detail.rotation;\n                    this.setRotation(angle);\n                    this.annotationStorage.setValue(this.data.id, {\n                        rotation: angle,\n                    });\n                },\n            });\n        }\n        _dispatchEventFromSandbox(actions, jsEvent) {\n            const commonActions = this._commonActions;\n            for (const name of Object.keys(jsEvent.detail)) {\n                const action = actions[name] || commonActions[name];\n                action === null || action === void 0 ? void 0 : action(jsEvent);\n            }\n        }\n        _setDefaultPropertiesFromJS(element) {\n            if (!this.enableScripting) {\n                return;\n            }\n            // Some properties may have been updated thanks to JS.\n            const storedData = this.annotationStorage.getRawValue(this.data.id);\n            if (!storedData) {\n                return;\n            }\n            const commonActions = this._commonActions;\n            for (const [actionName, detail] of Object.entries(storedData)) {\n                const action = commonActions[actionName];\n                if (action) {\n                    const eventProxy = {\n                        detail: {\n                            [actionName]: detail,\n                        },\n                        target: element,\n                    };\n                    action(eventProxy);\n                    // The action has been consumed: no need to keep it.\n                    delete storedData[actionName];\n                }\n            }\n        }\n        /**\n         * Create quadrilaterals from the annotation's quadpoints.\n         *\n         * @private\n         * @memberof AnnotationElement\n         */\n        _createQuadrilaterals() {\n            if (!this.container) {\n                return;\n            }\n            const { quadPoints } = this.data;\n            if (!quadPoints) {\n                return;\n            }\n            const [rectBlX, rectBlY, rectTrX, rectTrY] = this.data.rect.map(x => Math.fround(x));\n            if (quadPoints.length === 8) {\n                const [trX, trY, blX, blY] = quadPoints.subarray(2, 6);\n                if (rectTrX === trX &&\n                    rectTrY === trY &&\n                    rectBlX === blX &&\n                    rectBlY === blY) {\n                    // The quadpoints cover the whole annotation rectangle, so no need to\n                    // create a quadrilateral.\n                    return;\n                }\n            }\n            const { style } = this.container;\n            let svgBuffer;\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_hasBorder, \"f\")) {\n                const { borderColor, borderWidth } = style;\n                style.borderWidth = 0;\n                svgBuffer = [\n                    \"url('data:image/svg+xml;utf8,\",\n                    `<svg xmlns=\"http://www.w3.org/2000/svg\"`,\n                    ` preserveAspectRatio=\"none\" viewBox=\"0 0 1 1\">`,\n                    `<g fill=\"transparent\" stroke=\"${borderColor}\" stroke-width=\"${borderWidth}\">`,\n                ];\n                // this.container.classList.add(\"hasBorder\");\n            }\n            // todo: debug\n            // if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n            // this.container.classList.add(\"hasClipPath\");\n            // }\n            const width = rectTrX - rectBlX;\n            const height = rectTrY - rectBlY;\n            const { svgFactory } = this;\n            const svg = svgFactory.createElement(\"svg\");\n            // svg.classList.add(\"quadrilateralsContainer\");\n            svg.setAttribute(\"width\", 0);\n            svg.setAttribute(\"height\", 0);\n            const defs = svgFactory.createElement(\"defs\");\n            svg.append(defs);\n            const clipPath = svgFactory.createElement(\"clipPath\");\n            const id = `clippath_${this.data.id}`;\n            clipPath.setAttribute(\"id\", id);\n            clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n            defs.append(clipPath);\n            for (let i = 2, ii = quadPoints.length; i < ii; i += 8) {\n                const trX = quadPoints[i];\n                const trY = quadPoints[i + 1];\n                const blX = quadPoints[i + 2];\n                const blY = quadPoints[i + 3];\n                const rect = svgFactory.createElement(\"rect\");\n                const x = (blX - rectBlX) / width;\n                const y = (rectTrY - trY) / height;\n                const rectWidth = (trX - blX) / width;\n                const rectHeight = (trY - blY) / height;\n                rect.setAttribute(\"x\", x);\n                rect.setAttribute(\"y\", y);\n                rect.setAttribute(\"width\", rectWidth);\n                rect.setAttribute(\"height\", rectHeight);\n                clipPath.append(rect);\n                svgBuffer === null || svgBuffer === void 0 ? void 0 : svgBuffer.push(`<rect vector-effect=\"non-scaling-stroke\" x=\"${x}\" y=\"${y}\" width=\"${rectWidth}\" height=\"${rectHeight}\"/>`);\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationElement_hasBorder, \"f\")) {\n                svgBuffer.push(`</g></svg>')`);\n                style.backgroundImage = svgBuffer.join(\"\");\n            }\n            this.container.append(svg);\n            this.container.style.clipPath = `url(#${id})`;\n        }\n        /**\n         * Create a popup for the annotation's HTML element. This is used for\n         * annotations that do not have a Popup entry in the dictionary, but\n         * are of a type that works with popups (such as Highlight annotations).\n         *\n         * @private\n         * @memberof AnnotationElement\n         */\n        _createPopup() {\n            // const { container, data } = this;\n            // container.setAttribute(\"aria-haspopup\", \"dialog\");\n            // const popup = (this.#popupElement = new PopupAnnotationElement({\n            //     data: {\n            //         color: data.color,\n            //         titleObj: data.titleObj,\n            //         modificationDate: data.modificationDate,\n            //         contentsObj: data.contentsObj,\n            //         richText: data.richText,\n            //         parentRect: data.rect,\n            //         borderStyle: 0,\n            //         id: `popup_${data.id}`,\n            //         rotation: data.rotation,\n            //     },\n            //     parent: this.parent,\n            //     elements: [this],\n            // }));\n            // this.parent.div.append(popup.render());\n        }\n        /**\n         * Render the annotation's HTML element(s).\n         *\n         * @public\n         * @memberof AnnotationElement\n         */\n        render() {\n            // unreachable(\"Abstract method `AnnotationElement.render` called\");\n        }\n        /**\n         * @private\n         * @returns {Array}\n         */\n        _getElementsByName(name, skipId = null) {\n            const fields = [];\n            if (this._fieldObjects) {\n                const fieldObj = this._fieldObjects[name];\n                if (fieldObj) {\n                    for (const { page, id, exportValues } of fieldObj) {\n                        if (page === -1) {\n                            continue;\n                        }\n                        if (id === skipId) {\n                            continue;\n                        }\n                        const exportValue = typeof exportValues === \"string\" ? exportValues : null;\n                        const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n                        if (domElement && !GetElementsByNameSet.has(domElement)) {\n                            // warn(`_getElementsByName - element not allowed: ${id}`);\n                            continue;\n                        }\n                        fields.push({ id, exportValue, domElement });\n                    }\n                }\n                return fields;\n            }\n            // Fallback to a regular DOM lookup, to ensure that the standalone\n            // viewer components won't break.\n            for (const domElement of document.getElementsByName(name)) {\n                const { exportValue } = domElement;\n                const id = domElement.getAttribute(\"data-element-id\");\n                if (id === skipId) {\n                    continue;\n                }\n                if (!GetElementsByNameSet.has(domElement)) {\n                    continue;\n                }\n                fields.push({ id, exportValue, domElement });\n            }\n            return fields;\n        }\n        show() {\n            var _a;\n            if (this.container) {\n                this.container.hidden = false;\n            }\n            (_a = this.popup) === null || _a === void 0 ? void 0 : _a.maybeShow();\n        }\n        hide() {\n            var _a;\n            if (this.container) {\n                this.container.hidden = true;\n            }\n            (_a = this.popup) === null || _a === void 0 ? void 0 : _a.forceHide();\n        }\n        /**\n         * Get the HTML element(s) which can trigger a popup when clicked or hovered.\n         *\n         * @public\n         * @memberof AnnotationElement\n         * @returns {Array<HTMLElement>|HTMLElement} An array of elements or an\n         *          element.\n         */\n        getElementsToTriggerPopup() {\n            return this.container;\n        }\n        addHighlightArea() {\n            const triggers = this.getElementsToTriggerPopup();\n            if (Array.isArray(triggers)) {\n                // for (const element of triggers) {\n                // element.classList.add(\"highlightArea\");\n                // }\n            }\n            else {\n                // triggers.classList.add(\"highlightArea\");\n            }\n        }\n        _editOnDoubleClick() {\n            if (!this._isEditable) {\n                return;\n            }\n            const { annotationEditorType: mode, data: { id: editId }, } = this;\n            this.container.addEventListener(\"dblclick\", () => {\n                var _a, _b;\n                (_b = (_a = this.linkService) === null || _a === void 0 ? void 0 : _a.eventBus) === null || _b === void 0 ? void 0 : _b.dispatch(\"switchannotationeditormode\", {\n                    source: this,\n                    mode,\n                    editId,\n                });\n            });\n        }\n        _setRequired(element, isRequired) {\n            if (isRequired) {\n                element.setAttribute(\"required\", true);\n            }\n            else {\n                element.removeAttribute(\"required\");\n            }\n            element.setAttribute(\"aria-required\", isRequired);\n        }\n    }\n    _AnnotationElement_updates = new WeakMap(), _AnnotationElement_hasBorder = new WeakMap(), _AnnotationElement_popupElement = new WeakMap(), _AnnotationElement_instances = new WeakSet(), _AnnotationElement_setRectEdited = function _AnnotationElement_setRectEdited(rect) {\n        const { container: { style }, data: { rect: currentRect, rotation }, parent: { viewport: { rawDims: { pageWidth, pageHeight, pageX, pageY }, }, }, } = this;\n        currentRect === null || currentRect === void 0 ? void 0 : currentRect.splice(0, 4, ...rect);\n        const { width, height } = getRectDims(rect);\n        style.left = `${(100 * (rect[0] - pageX)) / pageWidth}%`;\n        style.top = `${(100 * (pageHeight - rect[3] + pageY)) / pageHeight}%`;\n        if (rotation === 0) {\n            style.width = `${(100 * width) / pageWidth}%`;\n            style.height = `${(100 * height) / pageHeight}%`;\n        }\n        else {\n            this.setRotation(rotation);\n        }\n    };\n    class LinkAnnotationElement extends AnnotationElement {\n        constructor(parameters, options = null) {\n            super(parameters, {\n                isRenderable: true,\n                ignoreBorder: !!(options === null || options === void 0 ? void 0 : options.ignoreBorder),\n                createQuadrilaterals: true,\n            });\n            _LinkAnnotationElement_instances.add(this);\n            this.isTooltipOnly = false;\n            this.isTooltipOnly = parameters.data.isTooltipOnly;\n        }\n        render() {\n            const { data, linkService } = this;\n            const link = document.createElement(\"a\");\n            link.setAttribute(\"data-element-id\", data.id);\n            let isBound = false;\n            if (data.url) {\n                linkService.addLinkAttributes(link, data.url, data.newWindow);\n                isBound = true;\n            }\n            else if (data.action) {\n                this._bindNamedAction(link, data.action);\n                isBound = true;\n            }\n            else if (data.attachment) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_bindAttachment).call(this, link, data.attachment, data.attachmentDest);\n                isBound = true;\n            }\n            else if (data.setOCGState) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_bindSetOCGState).call(this, link, data.setOCGState);\n                isBound = true;\n            }\n            else if (data.dest) {\n                this._bindLink(link, data.dest);\n                isBound = true;\n            }\n            else {\n                if (data.actions &&\n                    (data.actions.Action ||\n                        data.actions[\"Mouse Up\"] ||\n                        data.actions[\"Mouse Down\"]) &&\n                    this.enableScripting &&\n                    this.hasJSActions) {\n                    this._bindJSAction(link, data);\n                    isBound = true;\n                }\n                if (data.resetForm) {\n                    this._bindResetFormAction(link, data.resetForm);\n                    isBound = true;\n                }\n                else if (this.isTooltipOnly && !isBound) {\n                    this._bindLink(link, \"\");\n                    isBound = true;\n                }\n            }\n            // todo: do not render the class as the rendering is yet to be determined\n            // this.container.classList.add(\"linkAnnotation\");\n            // this.container.classList.add(\"k-link-annotation\");\n            if (isBound) {\n                this.container.append(link);\n            }\n            return this.container;\n        }\n        /**\n         * Bind internal links to the link element.\n         *\n         * @private\n         * @param {Object} link\n         * @param {Object} destination\n         * @memberof LinkAnnotationElement\n         */\n        _bindLink(link, destination) {\n            link.href = this.linkService.getDestinationHash(destination);\n            link.onclick = () => {\n                if (destination) {\n                    this.linkService.goToDestination(destination);\n                }\n                return false;\n            };\n            if (destination || destination === /* isTooltipOnly = */ \"\") {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_setInternalLink).call(this);\n            }\n        }\n        /**\n         * Bind named actions to the link element.\n         *\n         * @private\n         * @param {Object} link\n         * @param {Object} action\n         * @memberof LinkAnnotationElement\n         */\n        _bindNamedAction(link, action) {\n            link.href = this.linkService.getAnchorUrl(\"\");\n            link.onclick = () => {\n                this.linkService.executeNamedAction(action);\n                return false;\n            };\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_setInternalLink).call(this);\n        }\n        /**\n         * Bind JS actions to the link element.\n         *\n         * @private\n         * @param {Object} link\n         * @param {Object} data\n         * @memberof LinkAnnotationElement\n         */\n        _bindJSAction(link, data) {\n            link.href = this.linkService.getAnchorUrl(\"\");\n            const map = new Map([\n                [\"Action\", \"onclick\"],\n                [\"Mouse Up\", \"onmouseup\"],\n                [\"Mouse Down\", \"onmousedown\"],\n            ]);\n            for (const name of Object.keys(data.actions)) {\n                const jsName = map.get(name);\n                if (!jsName) {\n                    continue;\n                }\n                link[jsName] = () => {\n                    var _a;\n                    (_a = this.linkService.eventBus) === null || _a === void 0 ? void 0 : _a.dispatch(\"dispatcheventinsandbox\", {\n                        source: this,\n                        detail: {\n                            id: data.id,\n                            name,\n                        },\n                    });\n                    return false;\n                };\n            }\n            if (!link.onclick) {\n                link.onclick = () => false;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_setInternalLink).call(this);\n        }\n        _bindResetFormAction(link, resetForm) {\n            const otherClickAction = link.onclick;\n            if (!otherClickAction) {\n                link.href = this.linkService.getAnchorUrl(\"\");\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_setInternalLink).call(this);\n            if (!this._fieldObjects) {\n                // warn(\n                //     `_bindResetFormAction - \"resetForm\" action not supported, ` +\n                //     \"ensure that the `fieldObjects` parameter is provided.\"\n                // );\n                if (!otherClickAction) {\n                    link.onclick = () => false;\n                }\n                return;\n            }\n            link.onclick = () => {\n                var _a;\n                otherClickAction === null || otherClickAction === void 0 ? void 0 : otherClickAction();\n                const { fields: resetFormFields, refs: resetFormRefs, include, } = resetForm;\n                const allFields = [];\n                if (resetFormFields.length !== 0 || resetFormRefs.length !== 0) {\n                    const fieldIds = new Set(resetFormRefs);\n                    for (const fieldName of resetFormFields) {\n                        const fields = this._fieldObjects[fieldName] || [];\n                        for (const { id } of fields) {\n                            fieldIds.add(id);\n                        }\n                    }\n                    for (const fields of Object.values(this._fieldObjects)) {\n                        for (const field of fields) {\n                            if (fieldIds.has(field.id) === include) {\n                                allFields.push(field);\n                            }\n                        }\n                    }\n                }\n                else {\n                    for (const fields of Object.values(this._fieldObjects)) {\n                        allFields.push(...fields);\n                    }\n                }\n                const storage = this.annotationStorage;\n                const allIds = [];\n                for (const field of allFields) {\n                    const { id } = field;\n                    allIds.push(id);\n                    switch (field.type) {\n                        case \"text\": {\n                            const value = field.defaultValue || \"\";\n                            storage.setValue(id, { value });\n                            break;\n                        }\n                        case \"checkbox\":\n                        case \"radiobutton\": {\n                            const value = field.defaultValue === field.exportValues;\n                            storage.setValue(id, { value });\n                            break;\n                        }\n                        case \"combobox\":\n                        case \"listbox\": {\n                            const value = field.defaultValue || \"\";\n                            storage.setValue(id, { value });\n                            break;\n                        }\n                        default:\n                            continue;\n                    }\n                    const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n                    if (!domElement) {\n                        continue;\n                    }\n                    else if (!GetElementsByNameSet.has(domElement)) {\n                        // warn(`_bindResetFormAction - element not allowed: ${id}`);\n                        continue;\n                    }\n                    domElement.dispatchEvent(new Event(\"resetform\"));\n                }\n                if (this.enableScripting) {\n                    // Update the values in the sandbox.\n                    (_a = this.linkService.eventBus) === null || _a === void 0 ? void 0 : _a.dispatch(\"dispatcheventinsandbox\", {\n                        source: this,\n                        detail: {\n                            id: \"app\",\n                            ids: allIds,\n                            name: \"ResetForm\",\n                        },\n                    });\n                }\n                return false;\n            };\n        }\n    }\n    _LinkAnnotationElement_instances = new WeakSet(), _LinkAnnotationElement_setInternalLink = function _LinkAnnotationElement_setInternalLink() {\n        this.container.setAttribute(\"data-internal-link\", \"\");\n    }, _LinkAnnotationElement_bindAttachment = function _LinkAnnotationElement_bindAttachment(link, attachment, dest = null) {\n        link.href = this.linkService.getAnchorUrl(\"\");\n        if (attachment.description) {\n            link.title = attachment.description;\n        }\n        link.onclick = () => {\n            var _a;\n            (_a = this.downloadManager) === null || _a === void 0 ? void 0 : _a.openOrDownloadData(attachment.content, attachment.filename, dest);\n            return false;\n        };\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_setInternalLink).call(this);\n    }, _LinkAnnotationElement_bindSetOCGState = function _LinkAnnotationElement_bindSetOCGState(link, action) {\n        link.href = this.linkService.getAnchorUrl(\"\");\n        link.onclick = () => {\n            this.linkService.executeSetOCGState(action);\n            return false;\n        };\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _LinkAnnotationElement_instances, \"m\", _LinkAnnotationElement_setInternalLink).call(this);\n    };\n    // class TextAnnotationElement extends AnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"textAnnotation\");\n    //         const image = document.createElement(\"img\");\n    //         image.src =\n    //             this.imageResourcesPath +\n    //             \"annotation-\" +\n    //             this.data.name.toLowerCase() +\n    //             \".svg\";\n    //         image.setAttribute(\"data-l10n-id\", \"pdfjs-text-annotation-type\");\n    //         image.setAttribute(\n    //             \"data-l10n-args\",\n    //             JSON.stringify({ type: this.data.name })\n    //         );\n    //         if (!this.data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         this.container.append(image);\n    //         return this.container;\n    //     }\n    // }\n    class WidgetAnnotationElement extends AnnotationElement {\n        render() {\n            // Show only the container for unsupported field types.\n            return this.container;\n        }\n        showElementAndHideCanvas(element) {\n            var _a;\n            if (this.data.hasOwnCanvas) {\n                if (((_a = element.previousSibling) === null || _a === void 0 ? void 0 : _a.nodeName) === \"CANVAS\") {\n                    element.previousSibling.hidden = true;\n                }\n                element.hidden = false;\n            }\n        }\n        _getKeyModifier(event) {\n            return kendo_pdfjs_loader_js.FeatureTest.platform.isMac ? event.metaKey : event.ctrlKey;\n        }\n        _setEventListener(element, elementData, baseName, eventName, valueGetter) {\n            if (baseName.includes(\"mouse\")) {\n                // Mouse events\n                element.addEventListener(baseName, event => {\n                    var _a;\n                    (_a = this.linkService.eventBus) === null || _a === void 0 ? void 0 : _a.dispatch(\"dispatcheventinsandbox\", {\n                        source: this,\n                        detail: {\n                            id: this.data.id,\n                            name: eventName,\n                            value: valueGetter(event),\n                            shift: event.shiftKey,\n                            modifier: this._getKeyModifier(event),\n                        },\n                    });\n                });\n            }\n            else {\n                // Non-mouse events\n                element.addEventListener(baseName, event => {\n                    var _a;\n                    if (baseName === \"blur\") {\n                        if (!elementData.focused || !event.relatedTarget) {\n                            return;\n                        }\n                        elementData.focused = false;\n                    }\n                    else if (baseName === \"focus\") {\n                        if (elementData.focused) {\n                            return;\n                        }\n                        elementData.focused = true;\n                    }\n                    if (!valueGetter) {\n                        return;\n                    }\n                    (_a = this.linkService.eventBus) === null || _a === void 0 ? void 0 : _a.dispatch(\"dispatcheventinsandbox\", {\n                        source: this,\n                        detail: {\n                            id: this.data.id,\n                            name: eventName,\n                            value: valueGetter(event),\n                        },\n                    });\n                });\n            }\n        }\n        _setEventListeners(element, elementData, names, getter) {\n            var _a, _b, _c;\n            for (const [baseName, eventName] of names) {\n                if (eventName === \"Action\" || ((_a = this.data.actions) === null || _a === void 0 ? void 0 : _a[eventName])) {\n                    if (eventName === \"Focus\" || eventName === \"Blur\") {\n                        elementData || (elementData = { focused: false });\n                    }\n                    this._setEventListener(element, elementData, baseName, eventName, getter);\n                    if (eventName === \"Focus\" && !((_b = this.data.actions) === null || _b === void 0 ? void 0 : _b.Blur)) {\n                        // Ensure that elementData will have the correct value.\n                        this._setEventListener(element, elementData, \"blur\", \"Blur\", null);\n                    }\n                    else if (eventName === \"Blur\" && !((_c = this.data.actions) === null || _c === void 0 ? void 0 : _c.Focus)) {\n                        this._setEventListener(element, elementData, \"focus\", \"Focus\", null);\n                    }\n                }\n            }\n        }\n        _setBackgroundColor(element) {\n            const color = this.data.backgroundColor || null;\n            element.style.backgroundColor =\n                color === null\n                    ? \"transparent\"\n                    : kendo_pdfjs_loader_js.Util.makeHexColor(color[0], color[1], color[2]);\n        }\n        /**\n         * Apply text styles to the text in the element.\n         *\n         * @private\n         * @param {HTMLDivElement} element\n         * @memberof TextWidgetAnnotationElement\n         */\n        _setTextStyle(element) {\n            const TEXT_ALIGNMENT = [\"left\", \"center\", \"right\"];\n            const { fontColor } = this.data.defaultAppearanceData;\n            const fontSize = this.data.defaultAppearanceData.fontSize || DEFAULT_FONT_SIZE;\n            const style = element.style;\n            // TODO: If the font-size is zero, calculate it based on the height and\n            //       width of the element.\n            // Not setting `style.fontSize` will use the default font-size for now.\n            // We don't use the font, as specified in the PDF document, for the <input>\n            // element. Hence using the original `fontSize` could look bad, which is why\n            // it's instead based on the field height.\n            // If the height is \"big\" then it could lead to a too big font size\n            // so in this case use the one we've in the pdf (hence the min).\n            let computedFontSize;\n            const BORDER_SIZE = 2;\n            const roundToOneDecimal = x => Math.round(10 * x) / 10;\n            if (this.data.multiLine) {\n                const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n                const numberOfLines = Math.round(height / (LINE_FACTOR * fontSize)) || 1;\n                const lineHeight = height / numberOfLines;\n                computedFontSize = Math.min(fontSize, roundToOneDecimal(lineHeight / LINE_FACTOR));\n            }\n            else {\n                const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n                computedFontSize = Math.min(fontSize, roundToOneDecimal(height / LINE_FACTOR));\n            }\n            style.fontSize = `calc(${computedFontSize}px * var(--scale-factor))`;\n            style.color = kendo_pdfjs_loader_js.Util.makeHexColor(fontColor[0], fontColor[1], fontColor[2]);\n            if (this.data.textAlignment !== null) {\n                style.textAlign = TEXT_ALIGNMENT[this.data.textAlignment];\n            }\n        }\n        _setRequired(element, isRequired) {\n            if (isRequired) {\n                element.setAttribute(\"required\", true);\n            }\n            else {\n                element.removeAttribute(\"required\");\n            }\n            element.setAttribute(\"aria-required\", isRequired);\n        }\n    }\n    // class TextWidgetAnnotationElement extends WidgetAnnotationElement {\n    //     constructor(parameters) {\n    //         const isRenderable =\n    //             parameters.renderForms ||\n    //             parameters.data.hasOwnCanvas ||\n    //             (!parameters.data.hasAppearance && !!parameters.data.fieldValue);\n    //         super(parameters, { isRenderable });\n    //     }\n    //     setPropertyOnSiblings(base, key, value, keyInStorage) {\n    //         const storage = this.annotationStorage;\n    //         for (const element of this._getElementsByName(\n    //             base.name,\n    //             /* skipId = */ base.id\n    //         )) {\n    //             if (element.domElement) {\n    //                 element.domElement[key] = value;\n    //             }\n    //             storage.setValue(element.id, { [keyInStorage]: value });\n    //         }\n    //     }\n    //     render() {\n    //         const storage = this.annotationStorage;\n    //         const id = this.data.id;\n    //         this.container.classList.add(\"textWidgetAnnotation\");\n    //         let element = null;\n    //         if (this.renderForms) {\n    //             // NOTE: We cannot set the values using `element.value` below, since it\n    //             //       prevents the AnnotationLayer rasterizer in `test/driver.js`\n    //             //       from parsing the elements correctly for the reference tests.\n    //             const storedData = storage.getValue(id, {\n    //                 value: this.data.fieldValue,\n    //             });\n    //             let textContent = storedData.value || \"\";\n    //             const maxLen = storage.getValue(id, {\n    //                 charLimit: this.data.maxLen,\n    //             }).charLimit;\n    //             if (maxLen && textContent.length > maxLen) {\n    //                 textContent = textContent.slice(0, maxLen);\n    //             }\n    //             let fieldFormattedValues =\n    //                 storedData.formattedValue || this.data.textContent?.join(\"\\n\") || null;\n    //             if (fieldFormattedValues && this.data.comb) {\n    //                 fieldFormattedValues = fieldFormattedValues.replaceAll(/\\s+/g, \"\");\n    //             }\n    //             const elementData = {\n    //                 userValue: textContent,\n    //                 formattedValue: fieldFormattedValues,\n    //                 lastCommittedValue: null,\n    //                 commitKey: 1,\n    //                 focused: false,\n    //             };\n    //             if (this.data.multiLine) {\n    //                 element = document.createElement(\"textarea\");\n    //                 element.textContent = fieldFormattedValues ?? textContent;\n    //                 if (this.data.doNotScroll) {\n    //                     element.style.overflowY = \"hidden\";\n    //                 }\n    //             } else {\n    //                 element = document.createElement(\"input\");\n    //                 element.type = \"text\";\n    //                 element.setAttribute(\"value\", fieldFormattedValues ?? textContent);\n    //                 if (this.data.doNotScroll) {\n    //                     element.style.overflowX = \"hidden\";\n    //                 }\n    //             }\n    //             if (this.data.hasOwnCanvas) {\n    //                 element.hidden = true;\n    //             }\n    //             GetElementsByNameSet.add(element);\n    //             element.setAttribute(\"data-element-id\", id);\n    //             element.disabled = this.data.readOnly;\n    //             element.name = this.data.fieldName;\n    //             element.tabIndex = DEFAULT_TAB_INDEX;\n    //             this._setRequired(element, this.data.required);\n    //             if (maxLen) {\n    //                 element.maxLength = maxLen;\n    //             }\n    //             element.addEventListener(\"input\", event => {\n    //                 storage.setValue(id, { value: event.target.value });\n    //                 this.setPropertyOnSiblings(\n    //                     element,\n    //                     \"value\",\n    //                     event.target.value,\n    //                     \"value\"\n    //                 );\n    //                 elementData.formattedValue = null;\n    //             });\n    //             element.addEventListener(\"resetform\", () => {\n    //                 const defaultValue = this.data.defaultFieldValue ?? \"\";\n    //                 element.value = elementData.userValue = defaultValue;\n    //                 elementData.formattedValue = null;\n    //             });\n    //             let blurListener = event => {\n    //                 const { formattedValue } = elementData;\n    //                 if (formattedValue !== null && formattedValue !== undefined) {\n    //                     event.target.value = formattedValue;\n    //                 }\n    //                 // Reset the cursor position to the start of the field (issue 12359).\n    //                 event.target.scrollLeft = 0;\n    //             };\n    //             if (this.enableScripting && this.hasJSActions) {\n    //                 element.addEventListener(\"focus\", event => {\n    //                     if (elementData.focused) {\n    //                         return;\n    //                     }\n    //                     const { target } = event;\n    //                     if (elementData.userValue) {\n    //                         target.value = elementData.userValue;\n    //                     }\n    //                     elementData.lastCommittedValue = target.value;\n    //                     elementData.commitKey = 1;\n    //                     if (!this.data.actions?.Focus) {\n    //                         elementData.focused = true;\n    //                     }\n    //                 });\n    //                 element.addEventListener(\"updatefromsandbox\", jsEvent => {\n    //                     this.showElementAndHideCanvas(jsEvent.target);\n    //                     const actions = {\n    //                         value(event) {\n    //                             elementData.userValue = event.detail.value ?? \"\";\n    //                             storage.setValue(id, { value: elementData.userValue.toString() });\n    //                             event.target.value = elementData.userValue;\n    //                         },\n    //                         formattedValue(event) {\n    //                             const { formattedValue } = event.detail;\n    //                             elementData.formattedValue = formattedValue;\n    //                             if (\n    //                                 formattedValue !== null &&\n    //                                 formattedValue !== undefined &&\n    //                                 event.target !== document.activeElement\n    //                             ) {\n    //                                 // Input hasn't the focus so display formatted string\n    //                                 event.target.value = formattedValue;\n    //                             }\n    //                             storage.setValue(id, {\n    //                                 formattedValue,\n    //                             });\n    //                         },\n    //                         selRange(event) {\n    //                             event.target.setSelectionRange(...event.detail.selRange);\n    //                         },\n    //                         charLimit: event => {\n    //                             const { charLimit } = event.detail;\n    //                             const { target } = event;\n    //                             if (charLimit === 0) {\n    //                                 target.removeAttribute(\"maxLength\");\n    //                                 return;\n    //                             }\n    //                             target.setAttribute(\"maxLength\", charLimit);\n    //                             let value = elementData.userValue;\n    //                             if (!value || value.length <= charLimit) {\n    //                                 return;\n    //                             }\n    //                             value = value.slice(0, charLimit);\n    //                             target.value = elementData.userValue = value;\n    //                             storage.setValue(id, { value });\n    //                             this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n    //                                 source: this,\n    //                                 detail: {\n    //                                     id,\n    //                                     name: \"Keystroke\",\n    //                                     value,\n    //                                     willCommit: true,\n    //                                     commitKey: 1,\n    //                                     selStart: target.selectionStart,\n    //                                     selEnd: target.selectionEnd,\n    //                                 },\n    //                             });\n    //                         },\n    //                     };\n    //                     this._dispatchEventFromSandbox(actions, jsEvent);\n    //                 });\n    //                 // Even if the field hasn't any actions\n    //                 // leaving it can still trigger some actions with Calculate\n    //                 element.addEventListener(\"keydown\", event => {\n    //                     elementData.commitKey = 1;\n    //                     // If the key is one of Escape, Enter then the data are committed.\n    //                     // If we've a Tab then data will be committed on blur.\n    //                     let commitKey = -1;\n    //                     if (event.key === \"Escape\") {\n    //                         commitKey = 0;\n    //                     } else if (event.key === \"Enter\" && !this.data.multiLine) {\n    //                         // When we've a multiline field, \"Enter\" key is a key as the other\n    //                         // hence we don't commit the data (Acrobat behaves the same way)\n    //                         // (see issue #15627).\n    //                         commitKey = 2;\n    //                     } else if (event.key === \"Tab\") {\n    //                         elementData.commitKey = 3;\n    //                     }\n    //                     if (commitKey === -1) {\n    //                         return;\n    //                     }\n    //                     const { value } = event.target;\n    //                     if (elementData.lastCommittedValue === value) {\n    //                         return;\n    //                     }\n    //                     elementData.lastCommittedValue = value;\n    //                     // Save the entered value\n    //                     elementData.userValue = value;\n    //                     this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n    //                         source: this,\n    //                         detail: {\n    //                             id,\n    //                             name: \"Keystroke\",\n    //                             value,\n    //                             willCommit: true,\n    //                             commitKey,\n    //                             selStart: event.target.selectionStart,\n    //                             selEnd: event.target.selectionEnd,\n    //                         },\n    //                     });\n    //                 });\n    //                 const _blurListener = blurListener;\n    //                 blurListener = null;\n    //                 element.addEventListener(\"blur\", event => {\n    //                     if (!elementData.focused || !event.relatedTarget) {\n    //                         return;\n    //                     }\n    //                     if (!this.data.actions?.Blur) {\n    //                         elementData.focused = false;\n    //                     }\n    //                     const { value } = event.target;\n    //                     elementData.userValue = value;\n    //                     if (elementData.lastCommittedValue !== value) {\n    //                         this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n    //                             source: this,\n    //                             detail: {\n    //                                 id,\n    //                                 name: \"Keystroke\",\n    //                                 value,\n    //                                 willCommit: true,\n    //                                 commitKey: elementData.commitKey,\n    //                                 selStart: event.target.selectionStart,\n    //                                 selEnd: event.target.selectionEnd,\n    //                             },\n    //                         });\n    //                     }\n    //                     _blurListener(event);\n    //                 });\n    //                 if (this.data.actions?.Keystroke) {\n    //                     element.addEventListener(\"beforeinput\", event => {\n    //                         elementData.lastCommittedValue = null;\n    //                         const { data, target } = event;\n    //                         const { value, selectionStart, selectionEnd } = target;\n    //                         let selStart = selectionStart,\n    //                             selEnd = selectionEnd;\n    //                         switch (event.inputType) {\n    //                             // https://rawgit.com/w3c/input-events/v1/index.html#interface-InputEvent-Attributes\n    //                             case \"deleteWordBackward\": {\n    //                                 const match = value\n    //                                     .substring(0, selectionStart)\n    //                                     .match(/\\w*[^\\w]*$/);\n    //                                 if (match) {\n    //                                     selStart -= match[0].length;\n    //                                 }\n    //                                 break;\n    //                             }\n    //                             case \"deleteWordForward\": {\n    //                                 const match = value\n    //                                     .substring(selectionStart)\n    //                                     .match(/^[^\\w]*\\w*/);\n    //                                 if (match) {\n    //                                     selEnd += match[0].length;\n    //                                 }\n    //                                 break;\n    //                             }\n    //                             case \"deleteContentBackward\":\n    //                                 if (selectionStart === selectionEnd) {\n    //                                     selStart -= 1;\n    //                                 }\n    //                                 break;\n    //                             case \"deleteContentForward\":\n    //                                 if (selectionStart === selectionEnd) {\n    //                                     selEnd += 1;\n    //                                 }\n    //                                 break;\n    //                             default: break;\n    //                         }\n    //                         // We handle the event ourselves.\n    //                         event.preventDefault();\n    //                         this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n    //                             source: this,\n    //                             detail: {\n    //                                 id,\n    //                                 name: \"Keystroke\",\n    //                                 value,\n    //                                 change: data || \"\",\n    //                                 willCommit: false,\n    //                                 selStart,\n    //                                 selEnd,\n    //                             },\n    //                         });\n    //                     });\n    //                 }\n    //                 this._setEventListeners(\n    //                     element,\n    //                     elementData,\n    //                     [\n    //                         [\"focus\", \"Focus\"],\n    //                         [\"blur\", \"Blur\"],\n    //                         [\"mousedown\", \"Mouse Down\"],\n    //                         [\"mouseenter\", \"Mouse Enter\"],\n    //                         [\"mouseleave\", \"Mouse Exit\"],\n    //                         [\"mouseup\", \"Mouse Up\"],\n    //                     ],\n    //                     event => event.target.value\n    //                 );\n    //             }\n    //             if (blurListener) {\n    //                 element.addEventListener(\"blur\", blurListener);\n    //             }\n    //             if (this.data.comb) {\n    //                 const fieldWidth = this.data.rect[2] - this.data.rect[0];\n    //                 const combWidth = fieldWidth / maxLen;\n    //                 element.classList.add(\"comb\");\n    //                 element.style.letterSpacing = `calc(${combWidth}px * var(--scale-factor) - 1ch)`;\n    //             }\n    //         } else {\n    //             element = document.createElement(\"div\");\n    //             element.textContent = this.data.fieldValue;\n    //             element.style.verticalAlign = \"middle\";\n    //             element.style.display = \"table-cell\";\n    //             if (this.data.hasOwnCanvas) {\n    //                 element.hidden = true;\n    //             }\n    //         }\n    //         this._setTextStyle(element);\n    //         this._setBackgroundColor(element);\n    //         this._setDefaultPropertiesFromJS(element);\n    //         this.container.append(element);\n    //         return this.container;\n    //     }\n    // }\n    // class SignatureWidgetAnnotationElement extends WidgetAnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: !!parameters.data.hasOwnCanvas });\n    //     }\n    // }\n    // class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: parameters.renderForms });\n    //     }\n    //     render() {\n    //         const storage = this.annotationStorage;\n    //         const data = this.data;\n    //         const id = data.id;\n    //         let value = storage.getValue(id, {\n    //             value: data.exportValue === data.fieldValue,\n    //         }).value;\n    //         if (typeof value === \"string\") {\n    //             // The value has been changed through js and set in annotationStorage.\n    //             value = value !== \"Off\";\n    //             storage.setValue(id, { value });\n    //         }\n    //         this.container.classList.add(\"buttonWidgetAnnotation\", \"checkBox\");\n    //         const element = document.createElement(\"input\");\n    //         GetElementsByNameSet.add(element);\n    //         element.setAttribute(\"data-element-id\", id);\n    //         element.disabled = data.readOnly;\n    //         this._setRequired(element, this.data.required);\n    //         element.type = \"checkbox\";\n    //         element.name = data.fieldName;\n    //         if (value) {\n    //             element.setAttribute(\"checked\", (true).toString());\n    //         }\n    //         element.setAttribute(\"exportValue\", data.exportValue);\n    //         element.tabIndex = DEFAULT_TAB_INDEX;\n    //         element.addEventListener(\"change\", event => {\n    //             const { name, checked } = event.target as any;\n    //             for (const checkbox of this._getElementsByName(name, /* skipId = */ id)) {\n    //                 const curChecked = checked && checkbox.exportValue === data.exportValue;\n    //                 if (checkbox.domElement) {\n    //                     checkbox.domElement.checked = curChecked;\n    //                 }\n    //                 storage.setValue(checkbox.id, { value: curChecked });\n    //             }\n    //             storage.setValue(id, { value: checked });\n    //         });\n    //         element.addEventListener(\"resetform\", event => {\n    //             const defaultValue = data.defaultFieldValue || \"Off\";\n    //             // @ts-expect-error(TS)\n    //             event.target.checked = defaultValue === data.exportValue;\n    //         });\n    //         if (this.enableScripting && this.hasJSActions) {\n    //             element.addEventListener(\"updatefromsandbox\", jsEvent => {\n    //                 const actions = {\n    //                     value(event) {\n    //                         event.target.checked = event.detail.value !== \"Off\";\n    //                         storage.setValue(id, { value: event.target.checked });\n    //                     },\n    //                 };\n    //                 this._dispatchEventFromSandbox(actions, jsEvent);\n    //             });\n    //             this._setEventListeners(\n    //                 element,\n    //                 null,\n    //                 [\n    //                     [\"change\", \"Validate\"],\n    //                     [\"change\", \"Action\"],\n    //                     [\"focus\", \"Focus\"],\n    //                     [\"blur\", \"Blur\"],\n    //                     [\"mousedown\", \"Mouse Down\"],\n    //                     [\"mouseenter\", \"Mouse Enter\"],\n    //                     [\"mouseleave\", \"Mouse Exit\"],\n    //                     [\"mouseup\", \"Mouse Up\"],\n    //                 ],\n    //                 event => event.target.checked\n    //             );\n    //         }\n    //         this._setBackgroundColor(element);\n    //         this._setDefaultPropertiesFromJS(element);\n    //         this.container.append(element);\n    //         return this.container;\n    //     }\n    // }\n    class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement {\n        constructor(parameters) {\n            super(parameters, { isRenderable: parameters.renderForms });\n        }\n        render() {\n            this.container.classList.add(\"buttonWidgetAnnotation\", \"radioButton\");\n            const storage = this.annotationStorage;\n            const data = this.data;\n            const id = data.id;\n            let value = storage.getValue(id, {\n                value: data.fieldValue === data.buttonValue,\n            }).value;\n            if (typeof value === \"string\") {\n                // The value has been changed through js and set in annotationStorage.\n                value = value !== data.buttonValue;\n                storage.setValue(id, { value });\n            }\n            if (value) {\n                // It's possible that multiple radio buttons are checked.\n                // So if this one is checked we just reset the other ones.\n                // (see bug 1864136). Then when the other ones will be rendered they will\n                // unchecked (because of their value in the storage).\n                // Consequently, the first checked radio button will be the only checked\n                // one.\n                for (const radio of this._getElementsByName(data.fieldName, \n                /* skipId = */ id)) {\n                    storage.setValue(radio.id, { value: false });\n                }\n            }\n            const element = document.createElement(\"input\");\n            GetElementsByNameSet.add(element);\n            element.setAttribute(\"data-element-id\", id);\n            element.disabled = data.readOnly;\n            this._setRequired(element, this.data.required);\n            element.type = \"radio\";\n            element.name = data.fieldName;\n            if (value) {\n                element.setAttribute(\"checked\", (true).toString());\n            }\n            element.tabIndex = DEFAULT_TAB_INDEX;\n            element.addEventListener(\"change\", event => {\n                const { name, checked } = event.target;\n                for (const radio of this._getElementsByName(name, /* skipId = */ id)) {\n                    storage.setValue(radio.id, { value: false });\n                }\n                storage.setValue(id, { value: checked });\n            });\n            element.addEventListener(\"resetform\", event => {\n                const defaultValue = data.defaultFieldValue;\n                // @ts-expect-error(TS)\n                event.target.checked =\n                    defaultValue !== null &&\n                        defaultValue !== undefined &&\n                        defaultValue === data.buttonValue;\n            });\n            if (this.enableScripting && this.hasJSActions) {\n                const pdfButtonValue = data.buttonValue;\n                element.addEventListener(\"updatefromsandbox\", jsEvent => {\n                    const actions = {\n                        value: event => {\n                            const checked = pdfButtonValue === event.detail.value;\n                            for (const radio of this._getElementsByName(event.target.name)) {\n                                const curChecked = checked && radio.id === id;\n                                if (radio.domElement) {\n                                    radio.domElement.checked = curChecked;\n                                }\n                                storage.setValue(radio.id, { value: curChecked });\n                            }\n                        },\n                    };\n                    this._dispatchEventFromSandbox(actions, jsEvent);\n                });\n                this._setEventListeners(element, null, [\n                    [\"change\", \"Validate\"],\n                    [\"change\", \"Action\"],\n                    [\"focus\", \"Focus\"],\n                    [\"blur\", \"Blur\"],\n                    [\"mousedown\", \"Mouse Down\"],\n                    [\"mouseenter\", \"Mouse Enter\"],\n                    [\"mouseleave\", \"Mouse Exit\"],\n                    [\"mouseup\", \"Mouse Up\"],\n                ], event => event.target.checked);\n            }\n            this._setBackgroundColor(element);\n            this._setDefaultPropertiesFromJS(element);\n            this.container.append(element);\n            return this.container;\n        }\n    }\n    // class PushButtonWidgetAnnotationElement extends LinkAnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { ignoreBorder: parameters.data.hasAppearance });\n    //     }\n    //     render() {\n    //         // The rendering and functionality of a push button widget annotation is\n    //         // equal to that of a link annotation, but may have more functionality, such\n    //         // as performing actions on form fields (resetting, submitting, et cetera).\n    //         const container = super.render();\n    //         container.classList.add(\"buttonWidgetAnnotation\", \"pushButton\");\n    //         const linkElement = container.lastChild;\n    //         if (this.enableScripting && this.hasJSActions && linkElement) {\n    //             this._setDefaultPropertiesFromJS(linkElement);\n    //             linkElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n    //                 this._dispatchEventFromSandbox({}, jsEvent);\n    //             });\n    //         }\n    //         return container;\n    //     }\n    // }\n    // class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: parameters.renderForms });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"choiceWidgetAnnotation\");\n    //         const storage = this.annotationStorage;\n    //         const id = this.data.id;\n    //         const storedData = storage.getValue(id, {\n    //             value: this.data.fieldValue,\n    //         });\n    //         const selectElement = document.createElement(\"select\");\n    //         GetElementsByNameSet.add(selectElement);\n    //         selectElement.setAttribute(\"data-element-id\", id);\n    //         selectElement.disabled = this.data.readOnly;\n    //         this._setRequired(selectElement, this.data.required);\n    //         selectElement.name = this.data.fieldName;\n    //         selectElement.tabIndex = DEFAULT_TAB_INDEX;\n    //         let addAnEmptyEntry = this.data.combo && this.data.options.length > 0;\n    //         if (!this.data.combo) {\n    //             // List boxes have a size and (optionally) multiple selection.\n    //             selectElement.size = this.data.options.length;\n    //             if (this.data.multiSelect) {\n    //                 selectElement.multiple = true;\n    //             }\n    //         }\n    //         selectElement.addEventListener(\"resetform\", () => {\n    //             const defaultValue = this.data.defaultFieldValue;\n    //             for (const option of (selectElement as any).options) {\n    //                 option.selected = option.value === defaultValue;\n    //             }\n    //         });\n    //         // Insert the options into the choice field.\n    //         for (const option of this.data.options) {\n    //             const optionElement = document.createElement(\"option\");\n    //             optionElement.textContent = option.displayValue;\n    //             optionElement.value = option.exportValue;\n    //             if (storedData.value.includes(option.exportValue)) {\n    //                 optionElement.setAttribute(\"selected\", (true).toString());\n    //                 addAnEmptyEntry = false;\n    //             }\n    //             selectElement.append(optionElement);\n    //         }\n    //         let removeEmptyEntry = null;\n    //         if (addAnEmptyEntry) {\n    //             const noneOptionElement = document.createElement(\"option\");\n    //             noneOptionElement.value = \" \";\n    //             noneOptionElement.setAttribute(\"hidden\", (true).toString());\n    //             noneOptionElement.setAttribute(\"selected\", (true).toString());\n    //             selectElement.prepend(noneOptionElement);\n    //             removeEmptyEntry = () => {\n    //                 noneOptionElement.remove();\n    //                 selectElement.removeEventListener(\"input\", removeEmptyEntry);\n    //                 removeEmptyEntry = null;\n    //             };\n    //             selectElement.addEventListener(\"input\", removeEmptyEntry);\n    //         }\n    //         const getValue = isExport => {\n    //             const name = isExport ? \"value\" : \"textContent\";\n    //             const { options, multiple } = selectElement;\n    //             if (!multiple) {\n    //                 return options.selectedIndex === -1\n    //                     ? null\n    //                     : options[options.selectedIndex][name];\n    //             }\n    //             return Array.prototype.filter\n    //                 .call(options, option => option.selected)\n    //                 .map(option => option[name]);\n    //         };\n    //         let selectedValues = getValue(/* isExport */ false);\n    //         const getItems = event => {\n    //             const options = event.target.options;\n    //             return Array.prototype.map.call(options, option => ({\n    //                 displayValue: option.textContent,\n    //                 exportValue: option.value,\n    //             }));\n    //         };\n    //         if (this.enableScripting && this.hasJSActions) {\n    //             selectElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n    //                 const actions = {\n    //                     value(event) {\n    //                         removeEmptyEntry?.();\n    //                         const value = event.detail.value;\n    //                         const values = new Set(Array.isArray(value) ? value : [value]);\n    //                         for (const option of (selectElement as any).options) {\n    //                             option.selected = values.has(option.value);\n    //                         }\n    //                         storage.setValue(id, {\n    //                             value: getValue(/* isExport */ true),\n    //                         });\n    //                         selectedValues = getValue(/* isExport */ false);\n    //                     },\n    //                     multipleSelection() {\n    //                         selectElement.multiple = true;\n    //                     },\n    //                     remove(event) {\n    //                         const options = selectElement.options;\n    //                         const index = event.detail.remove;\n    //                         options[index].selected = false;\n    //                         selectElement.remove(index);\n    //                         if (options.length > 0) {\n    //                             const i = Array.prototype.findIndex.call(\n    //                                 options,\n    //                                 option => option.selected\n    //                             );\n    //                             if (i === -1) {\n    //                                 options[0].selected = true;\n    //                             }\n    //                         }\n    //                         storage.setValue(id, {\n    //                             value: getValue(/* isExport */ true),\n    //                             items: getItems(event),\n    //                         });\n    //                         selectedValues = getValue(/* isExport */ false);\n    //                     },\n    //                     clear() {\n    //                         while (selectElement.length !== 0) {\n    //                             selectElement.remove(0);\n    //                         }\n    //                         storage.setValue(id, { value: null, items: [] });\n    //                         selectedValues = getValue(/* isExport */ false);\n    //                     },\n    //                     insert(event) {\n    //                         const { index, displayValue, exportValue } = event.detail.insert;\n    //                         const selectChild = selectElement.children[index];\n    //                         const optionElement = document.createElement(\"option\");\n    //                         optionElement.textContent = displayValue;\n    //                         optionElement.value = exportValue;\n    //                         if (selectChild) {\n    //                             selectChild.before(optionElement);\n    //                         } else {\n    //                             selectElement.append(optionElement);\n    //                         }\n    //                         storage.setValue(id, {\n    //                             value: getValue(/* isExport */ true),\n    //                             items: getItems(event),\n    //                         });\n    //                         selectedValues = getValue(/* isExport */ false);\n    //                     },\n    //                     items(event) {\n    //                         const { items } = event.detail;\n    //                         while (selectElement.length !== 0) {\n    //                             selectElement.remove(0);\n    //                         }\n    //                         for (const item of items) {\n    //                             const { displayValue, exportValue } = item;\n    //                             const optionElement = document.createElement(\"option\");\n    //                             optionElement.textContent = displayValue;\n    //                             optionElement.value = exportValue;\n    //                             selectElement.append(optionElement);\n    //                         }\n    //                         if (selectElement.options.length > 0) {\n    //                             selectElement.options[0].selected = true;\n    //                         }\n    //                         storage.setValue(id, {\n    //                             value: getValue(/* isExport */ true),\n    //                             items: getItems(event),\n    //                         });\n    //                         selectedValues = getValue(/* isExport */ false);\n    //                     },\n    //                     indices(event) {\n    //                         const indices = new Set(event.detail.indices);\n    //                         for (const option of event.target.options) {\n    //                             option.selected = indices.has(option.index);\n    //                         }\n    //                         storage.setValue(id, {\n    //                             value: getValue(/* isExport */ true),\n    //                         });\n    //                         selectedValues = getValue(/* isExport */ false);\n    //                     },\n    //                     editable(event) {\n    //                         event.target.disabled = !event.detail.editable;\n    //                     },\n    //                 };\n    //                 this._dispatchEventFromSandbox(actions, jsEvent);\n    //             });\n    //             selectElement.addEventListener(\"input\", event => {\n    //                 const exportValue = getValue(/* isExport */ true);\n    //                 const change = getValue(/* isExport */ false);\n    //                 storage.setValue(id, { value: exportValue });\n    //                 event.preventDefault();\n    //                 this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n    //                     source: this,\n    //                     detail: {\n    //                         id,\n    //                         name: \"Keystroke\",\n    //                         value: selectedValues,\n    //                         change,\n    //                         changeEx: exportValue,\n    //                         willCommit: false,\n    //                         commitKey: 1,\n    //                         keyDown: false,\n    //                     },\n    //                 });\n    //             });\n    //             this._setEventListeners(\n    //                 selectElement,\n    //                 null,\n    //                 [\n    //                     [\"focus\", \"Focus\"],\n    //                     [\"blur\", \"Blur\"],\n    //                     [\"mousedown\", \"Mouse Down\"],\n    //                     [\"mouseenter\", \"Mouse Enter\"],\n    //                     [\"mouseleave\", \"Mouse Exit\"],\n    //                     [\"mouseup\", \"Mouse Up\"],\n    //                     [\"input\", \"Action\"],\n    //                     [\"input\", \"Validate\"],\n    //                 ],\n    //                 event => event.target.value\n    //             );\n    //         } else {\n    //             selectElement.addEventListener(\"input\", function () {\n    //                 storage.setValue(id, { value: getValue(/* isExport */ true) });\n    //             });\n    //         }\n    //         if (this.data.combo) {\n    //             this._setTextStyle(selectElement);\n    //         } else {\n    //             // Just use the default font size...\n    //             // it's a bit hard to guess what is a good size.\n    //         }\n    //         this._setBackgroundColor(selectElement);\n    //         this._setDefaultPropertiesFromJS(selectElement);\n    //         this.container.append(selectElement);\n    //         return this.container;\n    //     }\n    // }\n    class PopupAnnotationElement extends AnnotationElement {\n        // todo: props\n        constructor(parameters) {\n            const { data, elements } = parameters;\n            super(parameters, { isRenderable: AnnotationElement._hasPopupData(data) });\n            // todo: props\n            this.elements = [];\n            this.elements = elements;\n            this.popup = null;\n        }\n        render() {\n            this.container.classList.add(\"popupAnnotation\");\n            const popup = (this.popup = new PopupElement({\n                container: this.container,\n                color: this.data.color,\n                titleObj: this.data.titleObj,\n                modificationDate: this.data.modificationDate,\n                contentsObj: this.data.contentsObj,\n                richText: this.data.richText,\n                rect: this.data.rect,\n                parentRect: this.data.parentRect || null,\n                parent: this.parent,\n                elements: this.elements,\n                open: this.data.open,\n            }));\n            const elementIds = [];\n            for (const element of this.elements) {\n                element.popup = popup;\n                elementIds.push(element.data.id);\n                element.addHighlightArea();\n            }\n            this.container.setAttribute(\"aria-controls\", elementIds.map(id => `${AnnotationPrefix}${id}`).join(\",\"));\n            return this.container;\n        }\n    }\n    class PopupElement {\n        constructor({ container, color, elements, titleObj, modificationDate, contentsObj, richText, parent, rect, parentRect, open, }) {\n            var _a;\n            _PopupElement_instances.add(this);\n            // todo: props\n            this.trigger = null;\n            // todo: props\n            _PopupElement_boundKeyDown.set(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_keyDown).bind(this));\n            _PopupElement_boundHide.set(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_hide).bind(this));\n            _PopupElement_boundShow.set(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_show).bind(this));\n            _PopupElement_boundToggle.set(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_toggle).bind(this));\n            _PopupElement_color.set(this, null);\n            _PopupElement_container.set(this, null);\n            _PopupElement_contentsObj.set(this, null);\n            _PopupElement_dateObj.set(this, null);\n            _PopupElement_elements.set(this, null);\n            _PopupElement_parent.set(this, null);\n            _PopupElement_parentRect.set(this, null);\n            _PopupElement_pinned.set(this, false);\n            _PopupElement_popup.set(this, null);\n            _PopupElement_position.set(this, null);\n            _PopupElement_rect.set(this, null);\n            _PopupElement_richText.set(this, null);\n            _PopupElement_titleObj.set(this, null);\n            _PopupElement_updates.set(this, null);\n            _PopupElement_wasVisible.set(this, false);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_container, container, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_titleObj, titleObj, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_contentsObj, contentsObj, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_richText, richText, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_parent, parent, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_color, color, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_rect, rect, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_parentRect, parentRect, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_elements, elements, \"f\");\n            // The modification date is shown in the popup instead of the creation\n            // date if it is available and can be parsed correctly, which is\n            // consistent with other viewers such as Adobe Acrobat.\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_dateObj, kendo_pdfjs_loader_js.PDFDateString.toDateObject(modificationDate), \"f\");\n            this.trigger = elements.flatMap(e => e.getElementsToTriggerPopup());\n            // Attach the event listeners to the trigger element.\n            for (const element of this.trigger) {\n                element.addEventListener(\"click\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundToggle, \"f\"));\n                element.addEventListener(\"mouseenter\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundShow, \"f\"));\n                element.addEventListener(\"mouseleave\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundHide, \"f\"));\n                element.classList.add(\"popupTriggerArea\");\n            }\n            // Attach the event listener to toggle the popup with the keyboard.\n            for (const element of elements) {\n                (_a = element.container) === null || _a === void 0 ? void 0 : _a.addEventListener(\"keydown\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundKeyDown, \"f\"));\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden = true;\n            if (open) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_toggle).call(this);\n            }\n            // if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n            // Since the popup is lazily created, we need to ensure that it'll be\n            // created and displayed during reference tests.\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_parent, \"f\").popupShow.push(() => kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_show).call(this);\n                }\n            }));\n            // }\n        }\n        render() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_popup, \"f\")) {\n                return;\n            }\n            const popup = (kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_popup, document.createElement(\"div\"), \"f\"));\n            popup.className = \"popup\";\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_color, \"f\")) {\n                const baseColor = (popup.style.outlineColor = kendo_pdfjs_loader_js.Util.makeHexColor(\n                // @ts-expect-error TS(2556):\n                ...kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_color, \"f\")));\n                if (\n                // (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n                CSS.supports(\"background-color\", \"color-mix(in srgb, red 30%, white)\")) {\n                    popup.style.backgroundColor = `color-mix(in srgb, ${baseColor} 30%, white)`;\n                }\n                else {\n                    // color-mix isn't supported in some browsers hence this version.\n                    // See https://developer.mozilla.org/en-US/docs/Web/CSS/color_value/color-mix#browser_compatibility\n                    // TODO: Use color-mix when it's supported everywhere.\n                    // Enlighten the color.\n                    const BACKGROUND_ENLIGHT = 0.7;\n                    popup.style.backgroundColor = kendo_pdfjs_loader_js.Util.makeHexColor(\n                    // @ts-expect-error TS(2556):\n                    ...kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_color, \"f\").map(c => Math.floor(BACKGROUND_ENLIGHT * (255 - c) + c)));\n                }\n            }\n            const header = document.createElement(\"span\");\n            header.className = \"header\";\n            const title = document.createElement(\"h1\");\n            header.append(title);\n            ({ dir: title.dir, str: title.textContent } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_titleObj, \"f\"));\n            popup.append(header);\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_dateObj, \"f\")) {\n                const modificationDate = document.createElement(\"span\");\n                modificationDate.classList.add(\"popupDate\");\n                modificationDate.setAttribute(\"data-l10n-id\", \"pdfjs-annotation-date-string\");\n                modificationDate.setAttribute(\"data-l10n-args\", JSON.stringify({\n                    date: kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_dateObj, \"f\").toLocaleDateString(),\n                    time: kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_dateObj, \"f\").toLocaleTimeString(),\n                }));\n                header.append(modificationDate);\n            }\n            const html = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"a\", _PopupElement_html_get);\n            if (html) {\n                // @ts-expect-error TS(2556):\n                kendo_pdfjs_loader_js.XfaLayer.render({\n                    xfaHtml: html,\n                    intent: \"richText\",\n                    div: popup,\n                });\n                // @ts-expect-error TS(2556):\n                popup.lastChild.classList.add(\"richText\", \"popupContent\");\n            }\n            else {\n                const contents = this._formatContents(kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_contentsObj, \"f\"));\n                popup.append(contents);\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").append(popup);\n        }\n        /**\n         * Format the contents of the popup by adding newlines where necessary.\n         *\n         * @private\n         * @param {Object<string, string>} contentsObj\n         * @memberof PopupElement\n         * @returns {HTMLParagraphElement}\n         */\n        _formatContents({ str, dir }) {\n            const p = document.createElement(\"p\");\n            p.classList.add(\"popupContent\");\n            p.dir = dir;\n            const lines = str.split(/(?:\\r\\n?|\\n)/);\n            for (let i = 0, ii = lines.length; i < ii; ++i) {\n                const line = lines[i];\n                p.append(document.createTextNode(line));\n                if (i < ii - 1) {\n                    p.append(document.createElement(\"br\"));\n                }\n            }\n            return p;\n        }\n        updateEdited({ rect, popupContent }) {\n            var _a;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_updates, kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_updates, \"f\") || {\n                contentsObj: kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_contentsObj, \"f\"),\n                richText: kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_richText, \"f\"),\n            }, \"f\");\n            if (rect) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_position, null, \"f\");\n            }\n            if (popupContent) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_richText, kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_makePopupContent).call(this, popupContent), \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_contentsObj, null, \"f\");\n            }\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_popup, \"f\")) === null || _a === void 0 ? void 0 : _a.remove();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_popup, null, \"f\");\n        }\n        resetEdited() {\n            var _a;\n            var _b, _c;\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_updates, \"f\")) {\n                return;\n            }\n            (_b = this, _c = this, { contentsObj: ({ set value(_a) { kendo_dateinputsCommon_cmn_chunk_js._(_b, _PopupElement_contentsObj, _a, \"f\"); } }).value, richText: ({ set value(_a) { kendo_dateinputsCommon_cmn_chunk_js._(_c, _PopupElement_richText, _a, \"f\"); } }).value } =\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_updates, \"f\"));\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_updates, null, \"f\");\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_popup, \"f\")) === null || _a === void 0 ? void 0 : _a.remove();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_popup, null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_position, null, \"f\");\n        }\n        forceHide() {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_wasVisible, this.isVisible, \"f\");\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_wasVisible, \"f\")) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden = true;\n        }\n        maybeShow() {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_wasVisible, \"f\")) {\n                return;\n            }\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_popup, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_show).call(this);\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_wasVisible, false, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden = false;\n        }\n        get isVisible() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden === false;\n        }\n    }\n    _PopupElement_boundKeyDown = new WeakMap(), _PopupElement_boundHide = new WeakMap(), _PopupElement_boundShow = new WeakMap(), _PopupElement_boundToggle = new WeakMap(), _PopupElement_color = new WeakMap(), _PopupElement_container = new WeakMap(), _PopupElement_contentsObj = new WeakMap(), _PopupElement_dateObj = new WeakMap(), _PopupElement_elements = new WeakMap(), _PopupElement_parent = new WeakMap(), _PopupElement_parentRect = new WeakMap(), _PopupElement_pinned = new WeakMap(), _PopupElement_popup = new WeakMap(), _PopupElement_position = new WeakMap(), _PopupElement_rect = new WeakMap(), _PopupElement_richText = new WeakMap(), _PopupElement_titleObj = new WeakMap(), _PopupElement_updates = new WeakMap(), _PopupElement_wasVisible = new WeakMap(), _PopupElement_instances = new WeakSet(), _PopupElement_html_get = function _PopupElement_html_get() {\n        const richText = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_richText, \"f\");\n        const contentsObj = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_contentsObj, \"f\");\n        if ((richText === null || richText === void 0 ? void 0 : richText.str) &&\n            (!(contentsObj === null || contentsObj === void 0 ? void 0 : contentsObj.str) || contentsObj.str === richText.str)) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_richText, \"f\").html || null;\n        }\n        return null;\n    }, _PopupElement_fontSize_get = function _PopupElement_fontSize_get() {\n        var _a, _b, _c;\n        return ((_c = (_b = (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"a\", _PopupElement_html_get)) === null || _a === void 0 ? void 0 : _a.attributes) === null || _b === void 0 ? void 0 : _b.style) === null || _c === void 0 ? void 0 : _c.fontSize) || 0;\n    }, _PopupElement_fontColor_get = function _PopupElement_fontColor_get() {\n        var _a, _b, _c;\n        return ((_c = (_b = (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"a\", _PopupElement_html_get)) === null || _a === void 0 ? void 0 : _a.attributes) === null || _b === void 0 ? void 0 : _b.style) === null || _c === void 0 ? void 0 : _c.color) || null;\n    }, _PopupElement_makePopupContent = function _PopupElement_makePopupContent(text) {\n        const popupLines = [];\n        const popupContent = {\n            str: text,\n            html: {\n                name: \"div\",\n                attributes: {\n                    dir: \"auto\",\n                },\n                children: [\n                    {\n                        name: \"p\",\n                        children: popupLines,\n                    },\n                ],\n            },\n        };\n        const lineAttributes = {\n            style: {\n                color: kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"a\", _PopupElement_fontColor_get),\n                fontSize: kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"a\", _PopupElement_fontSize_get)\n                    ? `calc(${kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"a\", _PopupElement_fontSize_get)}px * var(--scale-factor))`\n                    : \"\",\n            },\n        };\n        for (const line of text.split(\"\\n\")) {\n            popupLines.push({\n                name: \"span\",\n                value: line,\n                attributes: lineAttributes,\n            });\n        }\n        return popupContent;\n    }, _PopupElement_keyDown = function _PopupElement_keyDown(event) {\n        if (event.altKey || event.shiftKey || event.ctrlKey || event.metaKey) {\n            return;\n        }\n        if (event.key === \"Enter\" || (event.key === \"Escape\" && kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_pinned, \"f\"))) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_toggle).call(this);\n        }\n    }, _PopupElement_setPosition = function _PopupElement_setPosition() {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_position, \"f\") !== null) {\n            return;\n        }\n        const { page: { view }, viewport: { rawDims: { pageWidth, pageHeight, pageX, pageY }, }, } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_parent, \"f\");\n        let useParentRect = !!kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_parentRect, \"f\");\n        let rect = useParentRect ? kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_parentRect, \"f\") : kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_rect, \"f\");\n        for (const element of kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_elements, \"f\")) {\n            if (!rect || kendo_pdfjs_loader_js.Util.intersect(element.data.rect, rect) !== null) {\n                rect = element.data.rect;\n                useParentRect = true;\n                break;\n            }\n        }\n        const normalizedRect = kendo_pdfjs_loader_js.Util.normalizeRect([\n            rect[0],\n            view[3] - rect[1] + view[1],\n            rect[2],\n            view[3] - rect[3] + view[1],\n        ]);\n        const HORIZONTAL_SPACE_AFTER_ANNOTATION = 5;\n        const parentWidth = useParentRect\n            ? rect[2] - rect[0] + HORIZONTAL_SPACE_AFTER_ANNOTATION\n            : 0;\n        const popupLeft = normalizedRect[0] + parentWidth;\n        const popupTop = normalizedRect[1];\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_position, [\n            (100 * (popupLeft - pageX)) / pageWidth,\n            (100 * (popupTop - pageY)) / pageHeight,\n        ], \"f\");\n        const { style } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\");\n        style.left = `${kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_position, \"f\")[0]}%`;\n        style.top = `${kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_position, \"f\")[1]}%`;\n    }, _PopupElement_toggle = function _PopupElement_toggle() {\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _PopupElement_pinned, !kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_pinned, \"f\"), \"f\");\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_pinned, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_show).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").addEventListener(\"click\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundToggle, \"f\"));\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").addEventListener(\"keydown\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundKeyDown, \"f\"));\n        }\n        else {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_hide).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").removeEventListener(\"click\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundToggle, \"f\"));\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").removeEventListener(\"keydown\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_boundKeyDown, \"f\"));\n        }\n    }, _PopupElement_show = function _PopupElement_show() {\n        if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_popup, \"f\")) {\n            this.render();\n        }\n        if (!this.isVisible) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_instances, \"m\", _PopupElement_setPosition).call(this);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden = false;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").style.zIndex = (parseInt(kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").style.zIndex, 10) + 1000).toString();\n        }\n        else if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_pinned, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").classList.add(\"focused\");\n        }\n    }, _PopupElement_hide = function _PopupElement_hide() {\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").classList.remove(\"focused\");\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_pinned, \"f\") || !this.isVisible) {\n            return;\n        }\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").hidden = true;\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").style.zIndex = (parseInt(kendo_dateinputsCommon_cmn_chunk_js.a(this, _PopupElement_container, \"f\").style.zIndex, 10) - 1000).toString();\n    };\n    class FreeTextAnnotationElement extends AnnotationElement {\n        // todo: props\n        constructor(parameters) {\n            super(parameters, { isRenderable: true, ignoreBorder: true });\n            // todo: props\n            this.textContent = null;\n            this.textPosition = null;\n            this.textContent = parameters.data.textContent;\n            this.textPosition = parameters.data.textPosition;\n            this.annotationEditorType = kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT;\n        }\n        render() {\n            // this.container.classList.add(\"freeTextAnnotation\");\n            // this.container.classList.add(\"freeTextAnnotation\");\n            this.container.classList.add(\"k-free-text-annotation\");\n            if (this.textContent) {\n                const content = document.createElement(\"div\");\n                // content.classList.add(\"annotationTextContent\");\n                content.classList.add(\"k-annotation-text-content\");\n                content.setAttribute(\"role\", \"comment\");\n                for (const line of this.textContent) {\n                    const lineSpan = document.createElement(\"span\");\n                    lineSpan.textContent = line;\n                    content.append(lineSpan);\n                }\n                this.container.append(content);\n            }\n            // if (!this.data.popupRef && this.hasPopupData) {\n            //     this._createPopup();\n            // }\n            this._editOnDoubleClick();\n            return this.container;\n        }\n    }\n    // class LineAnnotationElement extends AnnotationElement {\n    //     #line = null;\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"lineAnnotation\");\n    //         // Create an invisible line with the same starting and ending coordinates\n    //         // that acts as the trigger for the popup. Only the line itself should\n    //         // trigger the popup, not the entire container.\n    //         const data = this.data;\n    //         const { width, height } = getRectDims(data.rect);\n    //         const svg = this.svgFactory.create(\n    //             width,\n    //             height,\n    //             /* skipDimensions = */ true\n    //         );\n    //         // PDF coordinates are calculated from a bottom left origin, so transform\n    //         // the line coordinates to a top left origin for the SVG element.\n    //         const line = (this.#line = this.svgFactory.createElement(\"svg:line\"));\n    //         line.setAttribute(\"x1\", data.rect[2] - data.lineCoordinates[0]);\n    //         line.setAttribute(\"y1\", data.rect[3] - data.lineCoordinates[1]);\n    //         line.setAttribute(\"x2\", data.rect[2] - data.lineCoordinates[2]);\n    //         line.setAttribute(\"y2\", data.rect[3] - data.lineCoordinates[3]);\n    //         // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    //         // won't be possible to open/close the popup (note e.g. issue 11122).\n    //         line.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    //         line.setAttribute(\"stroke\", \"transparent\");\n    //         line.setAttribute(\"fill\", \"transparent\");\n    //         svg.append(line);\n    //         this.container.append(svg);\n    //         // Create the popup ourselves so that we can bind it to the line instead\n    //         // of to the entire container (which is the default).\n    //         if (!data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         return this.container;\n    //     }\n    //     getElementsToTriggerPopup() {\n    //         return this.#line;\n    //     }\n    //     addHighlightArea() {\n    //         this.container.classList.add(\"highlightArea\");\n    //     }\n    // }\n    // class SquareAnnotationElement extends AnnotationElement {\n    //     #square = null;\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"squareAnnotation\");\n    //         // Create an invisible square with the same rectangle that acts as the\n    //         // trigger for the popup. Only the square itself should trigger the\n    //         // popup, not the entire container.\n    //         const data = this.data;\n    //         const { width, height } = getRectDims(data.rect);\n    //         const svg = this.svgFactory.create(\n    //             width,\n    //             height,\n    //             /* skipDimensions = */ true\n    //         );\n    //         // The browser draws half of the borders inside the square and half of\n    //         // the borders outside the square by default. This behavior cannot be\n    //         // changed programmatically, so correct for that here.\n    //         const borderWidth = data.borderStyle.width;\n    //         const square = (this.#square = this.svgFactory.createElement(\"svg:rect\"));\n    //         square.setAttribute(\"x\", borderWidth / 2);\n    //         square.setAttribute(\"y\", borderWidth / 2);\n    //         square.setAttribute(\"width\", width - borderWidth);\n    //         square.setAttribute(\"height\", height - borderWidth);\n    //         // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    //         // won't be possible to open/close the popup (note e.g. issue 11122).\n    //         square.setAttribute(\"stroke-width\", borderWidth || 1);\n    //         square.setAttribute(\"stroke\", \"transparent\");\n    //         square.setAttribute(\"fill\", \"transparent\");\n    //         svg.append(square);\n    //         this.container.append(svg);\n    //         // Create the popup ourselves so that we can bind it to the square instead\n    //         // of to the entire container (which is the default).\n    //         if (!data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         return this.container;\n    //     }\n    //     getElementsToTriggerPopup() {\n    //         return this.#square;\n    //     }\n    //     addHighlightArea() {\n    //         this.container.classList.add(\"highlightArea\");\n    //     }\n    // }\n    // class CircleAnnotationElement extends AnnotationElement {\n    //     #circle = null;\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"circleAnnotation\");\n    //         // Create an invisible circle with the same ellipse that acts as the\n    //         // trigger for the popup. Only the circle itself should trigger the\n    //         // popup, not the entire container.\n    //         const data = this.data;\n    //         const { width, height } = getRectDims(data.rect);\n    //         const svg = this.svgFactory.create(\n    //             width,\n    //             height,\n    //             /* skipDimensions = */ true\n    //         );\n    //         // The browser draws half of the borders inside the circle and half of\n    //         // the borders outside the circle by default. This behavior cannot be\n    //         // changed programmatically, so correct for that here.\n    //         const borderWidth = data.borderStyle.width;\n    //         const circle = (this.#circle =\n    //             this.svgFactory.createElement(\"svg:ellipse\"));\n    //         circle.setAttribute(\"cx\", width / 2);\n    //         circle.setAttribute(\"cy\", height / 2);\n    //         circle.setAttribute(\"rx\", width / 2 - borderWidth / 2);\n    //         circle.setAttribute(\"ry\", height / 2 - borderWidth / 2);\n    //         // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    //         // won't be possible to open/close the popup (note e.g. issue 11122).\n    //         circle.setAttribute(\"stroke-width\", borderWidth || 1);\n    //         circle.setAttribute(\"stroke\", \"transparent\");\n    //         circle.setAttribute(\"fill\", \"transparent\");\n    //         svg.append(circle);\n    //         this.container.append(svg);\n    //         // Create the popup ourselves so that we can bind it to the circle instead\n    //         // of to the entire container (which is the default).\n    //         if (!data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         return this.container;\n    //     }\n    //     getElementsToTriggerPopup() {\n    //         return this.#circle;\n    //     }\n    //     addHighlightArea() {\n    //         this.container.classList.add(\"highlightArea\");\n    //     }\n    // }\n    // class PolylineAnnotationElement extends AnnotationElement {\n    //     // todo: props\n    //     containerClassName: any = null;\n    //     svgElementName: any = null;\n    //     // todo: props\n    //     #polyline = null;\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //         this.containerClassName = \"polylineAnnotation\";\n    //         this.svgElementName = \"svg:polyline\";\n    //     }\n    //     render() {\n    //         this.container.classList.add(this.containerClassName);\n    //         // Create an invisible polyline with the same points that acts as the\n    //         // trigger for the popup. Only the polyline itself should trigger the\n    //         // popup, not the entire container.\n    //         const {\n    //             data: { rect, vertices, borderStyle, popupRef },\n    //         } = this;\n    //         if (!vertices) {\n    //             return this.container;\n    //         }\n    //         const { width, height } = getRectDims(rect);\n    //         const svg = this.svgFactory.create(\n    //             width,\n    //             height,\n    //             /* skipDimensions = */ true\n    //         );\n    //         // Convert the vertices array to a single points string that the SVG\n    //         // polyline element expects (\"x1,y1 x2,y2 ...\"). PDF coordinates are\n    //         // calculated from a bottom left origin, so transform the polyline\n    //         // coordinates to a top left origin for the SVG element.\n    //         const pointsArray = [];\n    //         for (let i = 0, ii = vertices.length; i < ii; i += 2) {\n    //             const x = vertices[i] - rect[0];\n    //             const y = rect[3] - vertices[i + 1];\n    //             pointsArray.push(`${x},${y}`);\n    //         }\n    //         const points = pointsArray.join(\" \");\n    //         const polyline = (this.#polyline = this.svgFactory.createElement(\n    //             this.svgElementName\n    //         ));\n    //         polyline.setAttribute(\"points\", points);\n    //         // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    //         // won't be possible to open/close the popup (note e.g. issue 11122).\n    //         polyline.setAttribute(\"stroke-width\", borderStyle.width || 1);\n    //         polyline.setAttribute(\"stroke\", \"transparent\");\n    //         polyline.setAttribute(\"fill\", \"transparent\");\n    //         svg.append(polyline);\n    //         this.container.append(svg);\n    //         // Create the popup ourselves so that we can bind it to the polyline\n    //         // instead of to the entire container (which is the default).\n    //         if (!popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         return this.container;\n    //     }\n    //     getElementsToTriggerPopup() {\n    //         return this.#polyline;\n    //     }\n    //     addHighlightArea() {\n    //         this.container.classList.add(\"highlightArea\");\n    //     }\n    // }\n    // class PolygonAnnotationElement extends PolylineAnnotationElement {\n    //     constructor(parameters) {\n    //         // Polygons are specific forms of polylines, so reuse their logic.\n    //         super(parameters);\n    //         this.containerClassName = \"polygonAnnotation\";\n    //         this.svgElementName = \"svg:polygon\";\n    //     }\n    // }\n    // class CaretAnnotationElement extends AnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"caretAnnotation\");\n    //         if (!this.data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         return this.container;\n    //     }\n    // }\n    // class InkAnnotationElement extends AnnotationElement {\n    //     // todo: props\n    //     containerClassName: any = null;\n    //     svgElementName: any = null;\n    //     // todo: props\n    //     #polylines = [];\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //         this.containerClassName = \"inkAnnotation\";\n    //         // Use the polyline SVG element since it allows us to use coordinates\n    //         // directly and to draw both straight lines and curves.\n    //         this.svgElementName = \"svg:polyline\";\n    //         this.annotationEditorType = AnnotationEditorType.INK;\n    //     }\n    //     render() {\n    //         this.container.classList.add(this.containerClassName);\n    //         // Create an invisible polyline with the same points that acts as the\n    //         // trigger for the popup.\n    //         const {\n    //             data: { rect, inkLists, borderStyle, popupRef },\n    //         } = this;\n    //         const { width, height } = getRectDims(rect);\n    //         const svg = this.svgFactory.create(\n    //             width,\n    //             height,\n    //             /* skipDimensions = */ true\n    //         );\n    //         for (const inkList of inkLists) {\n    //             // Convert the ink list to a single points string that the SVG\n    //             // polyline element expects (\"x1,y1 x2,y2 ...\"). PDF coordinates are\n    //             // calculated from a bottom left origin, so transform the polyline\n    //             // coordinates to a top left origin for the SVG element.\n    //             const pointsArray = [];\n    //             for (let i = 0, ii = inkList.length; i < ii; i += 2) {\n    //                 const x = inkList[i] - rect[0];\n    //                 const y = rect[3] - inkList[i + 1];\n    //                 pointsArray.push(`${x},${y}`);\n    //             }\n    //             const points = pointsArray.join(\" \");\n    //             const polyline = this.svgFactory.createElement(this.svgElementName);\n    //             this.#polylines.push(polyline);\n    //             polyline.setAttribute(\"points\", points);\n    //             // Ensure that the 'stroke-width' is always non-zero, since otherwise it\n    //             // won't be possible to open/close the popup (note e.g. issue 11122).\n    //             polyline.setAttribute(\"stroke-width\", borderStyle.width || 1);\n    //             polyline.setAttribute(\"stroke\", \"transparent\");\n    //             polyline.setAttribute(\"fill\", \"transparent\");\n    //             // Create the popup ourselves so that we can bind it to the polyline\n    //             // instead of to the entire container (which is the default).\n    //             if (!popupRef && this.hasPopupData) {\n    //                 this._createPopup();\n    //             }\n    //             svg.append(polyline);\n    //         }\n    //         this.container.append(svg);\n    //         return this.container;\n    //     }\n    //     getElementsToTriggerPopup() {\n    //         return this.#polylines;\n    //     }\n    //     addHighlightArea() {\n    //         this.container.classList.add(\"highlightArea\");\n    //     }\n    // }\n    class HighlightAnnotationElement extends AnnotationElement {\n        constructor(parameters) {\n            super(parameters, {\n                isRenderable: true,\n                ignoreBorder: true,\n                createQuadrilaterals: true,\n            });\n        }\n        render() {\n            // if (!this.data.popupRef && this.hasPopupData) {\n            //     this._createPopup();\n            // }\n            // this.container.classList.add(\"highlightAnnotation\");\n            this.container.classList.add(\"k-highlight-annotation\");\n            return this.container;\n        }\n    }\n    // class UnderlineAnnotationElement extends AnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, {\n    //             isRenderable: true,\n    //             ignoreBorder: true,\n    //             createQuadrilaterals: true,\n    //         });\n    //     }\n    //     render() {\n    //         if (!this.data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         this.container.classList.add(\"underlineAnnotation\");\n    //         return this.container;\n    //     }\n    // }\n    // class SquigglyAnnotationElement extends AnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, {\n    //             isRenderable: true,\n    //             ignoreBorder: true,\n    //             createQuadrilaterals: true,\n    //         });\n    //     }\n    //     render() {\n    //         if (!this.data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         this.container.classList.add(\"squigglyAnnotation\");\n    //         return this.container;\n    //     }\n    // }\n    // class StrikeOutAnnotationElement extends AnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, {\n    //             isRenderable: true,\n    //             ignoreBorder: true,\n    //             createQuadrilaterals: true,\n    //         });\n    //     }\n    //     render() {\n    //         if (!this.data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         this.container.classList.add(\"strikeoutAnnotation\");\n    //         return this.container;\n    //     }\n    // }\n    // class StampAnnotationElement extends AnnotationElement {\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true, ignoreBorder: true });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"stampAnnotation\");\n    //         if (!this.data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         }\n    //         return this.container;\n    //     }\n    // }\n    // class FileAttachmentAnnotationElement extends AnnotationElement {\n    //     // todo: props\n    //     filename: any = null;\n    //     content: any = null;\n    //     // todo: props\n    //     #trigger = null;\n    //     constructor(parameters) {\n    //         super(parameters, { isRenderable: true });\n    //         const { file } = this.data;\n    //         this.filename = file.filename;\n    //         this.content = file.content;\n    //         this.linkService.eventBus?.dispatch(\"fileattachmentannotation\", {\n    //             source: this,\n    //             ...file,\n    //         });\n    //     }\n    //     render() {\n    //         this.container.classList.add(\"fileAttachmentAnnotation\");\n    //         const { container, data } = this;\n    //         let trigger;\n    //         if (data.hasAppearance || data.fillAlpha === 0) {\n    //             trigger = document.createElement(\"div\");\n    //         } else {\n    //             // Unfortunately it seems that it's not clearly specified exactly what\n    //             // names are actually valid, since Table 184 contains:\n    //             //   Conforming readers shall provide predefined icon appearances for at\n    //             //   least the following standard names: GraphPushPin, PaperclipTag.\n    //             //   Additional names may be supported as well. Default value: PushPin.\n    //             trigger = document.createElement(\"img\");\n    //             trigger.src = `${this.imageResourcesPath}annotation-${/paperclip/i.test(data.name) ?\n    //                 \"paperclip\" : \"pushpin\"}.svg`;\n    //             if (data.fillAlpha && data.fillAlpha < 1) {\n    //                 trigger.style = `filter: opacity(${Math.round(\n    //                     data.fillAlpha * 100\n    //                 )}%);`;\n    //                 // todo: debug\n    //                 // if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n    //                 //     this.container.classList.add(\"hasFillAlpha\");\n    //                 // }\n    //             }\n    //         }\n    //         trigger.addEventListener(\"dblclick\", this.#download.bind(this));\n    //         this.#trigger = trigger;\n    //         const { isMac } = FeatureTest.platform;\n    //         container.addEventListener(\"keydown\", evt => {\n    //             if (evt.key === \"Enter\" && (isMac ? evt.metaKey : evt.ctrlKey)) {\n    //                 this.#download();\n    //             }\n    //         });\n    //         if (!data.popupRef && this.hasPopupData) {\n    //             this._createPopup();\n    //         } else {\n    //             trigger.classList.add(\"popupTriggerArea\");\n    //         }\n    //         container.append(trigger);\n    //         return container;\n    //     }\n    //     getElementsToTriggerPopup() {\n    //         return this.#trigger;\n    //     }\n    //     addHighlightArea() {\n    //         this.container.classList.add(\"highlightArea\");\n    //     }\n    //     /**\n    //      * Download the file attachment associated with this annotation.\n    //      */\n    //     #download() {\n    //         this.downloadManager?.openOrDownloadData(this.content, this.filename);\n    //     }\n    // }\n    /**\n     * Manage the layer containing all the annotations.\n     */\n    class AnnotationLayer {\n        constructor({ div, accessibilityManager, annotationCanvasMap, annotationEditorUIManager, page, viewport }) {\n            _AnnotationLayer_instances.add(this);\n            this.div = null;\n            this.page = null;\n            this.viewport = null;\n            this.zIndex = null;\n            this._annotationEditorUIManager = null;\n            _AnnotationLayer_accessibilityManager.set(this, null);\n            _AnnotationLayer_annotationCanvasMap.set(this, null);\n            _AnnotationLayer_editableAnnotations.set(this, new Map());\n            this.div = div;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationLayer_accessibilityManager, accessibilityManager, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationLayer_annotationCanvasMap, annotationCanvasMap, \"f\");\n            this.page = page;\n            this.viewport = viewport;\n            this.zIndex = 0;\n            this._annotationEditorUIManager = annotationEditorUIManager;\n            // if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n            //     // For testing purposes.\n            //     Object.defineProperty(this, \"showPopups\", {\n            //         value: async () => {\n            //             for (const show of this.popupShow) {\n            //                 await show();\n            //             }\n            //         },\n            //     });\n            //     this.popupShow = [];\n            // }\n        }\n        // todo: ported from AnnotationLayerBuilder\n        hide() {\n            if (!this.div) {\n                return;\n            }\n            this.div.hidden = true;\n        }\n        // todo: ported from AnnotationLayerBuilder\n        hasEditableAnnotations() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_editableAnnotations, \"f\").size > 0;\n        }\n        /**\n         * Render a new annotation layer with all annotation elements.\n         *\n         * @param {AnnotationLayerParameters} params\n         * @memberof AnnotationLayer\n         */\n        // async render(params) {\n        render(params) {\n            var _a;\n            const { annotations } = params;\n            const layer = this.div;\n            kendo_pdfjs_loader_js.setLayerDimensions(layer, this.viewport);\n            const popupToElements = new Map();\n            const elementParams = {\n                data: null,\n                layer,\n                linkService: params.linkService,\n                downloadManager: params.downloadManager,\n                imageResourcesPath: params.imageResourcesPath || \"\",\n                renderForms: params.renderForms !== false,\n                svgFactory: new kendo_pdfjs_loader_js.DOMSVGFactory(),\n                annotationStorage: params.annotationStorage,\n                enableScripting: params.enableScripting === true,\n                hasJSActions: params.hasJSActions,\n                fieldObjects: params.fieldObjects,\n                parent: this,\n                elements: null,\n            };\n            for (const data of annotations) {\n                if (data.noHTML) {\n                    continue;\n                }\n                const isPopupAnnotation = data.annotationType === AnnotationType.POPUP;\n                if (!isPopupAnnotation) {\n                    const { width, height } = getRectDims(data.rect);\n                    if (width <= 0 || height <= 0) {\n                        continue; // Ignore empty annotations.\n                    }\n                }\n                else {\n                    const elements = popupToElements.get(data.id);\n                    if (!elements) {\n                        // Ignore popup annotations without a corresponding annotation.\n                        continue;\n                    }\n                    elementParams.elements = elements;\n                }\n                elementParams.data = data;\n                const element = AnnotationElementFactory.create(elementParams);\n                if (!element.isRenderable) {\n                    continue;\n                }\n                if (!isPopupAnnotation && data.popupRef) {\n                    const elements = popupToElements.get(data.popupRef);\n                    if (!elements) {\n                        popupToElements.set(data.popupRef, [element]);\n                    }\n                    else {\n                        elements.push(element);\n                    }\n                }\n                const rendered = element.render();\n                if (data.hidden) {\n                    rendered.style.visibility = \"hidden\";\n                }\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_instances, \"m\", _AnnotationLayer_appendElement).call(this, rendered, data.id);\n                if (element._isEditable) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_editableAnnotations, \"f\").set(element.data.id, element);\n                    (_a = this._annotationEditorUIManager) === null || _a === void 0 ? void 0 : _a.renderAnnotationElement(element);\n                }\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_instances, \"m\", _AnnotationLayer_setAnnotationCanvasMap).call(this);\n        }\n        /**\n         * Update the annotation elements on existing annotation layer.\n         *\n         * @param {AnnotationLayerParameters} viewport\n         * @memberof AnnotationLayer\n         */\n        update({ viewport }) {\n            const layer = this.div;\n            this.viewport = viewport;\n            // setLayerDimensions(layer, { rotation: viewport.rotation });\n            kendo_pdfjs_loader_js.setLayerDimensions(layer, viewport);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_instances, \"m\", _AnnotationLayer_setAnnotationCanvasMap).call(this);\n            layer.hidden = false;\n        }\n        getEditableAnnotations() {\n            return Array.from(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_editableAnnotations, \"f\").values());\n        }\n        getEditableAnnotation(id) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_editableAnnotations, \"f\").get(id);\n        }\n    }\n    _AnnotationLayer_accessibilityManager = new WeakMap(), _AnnotationLayer_annotationCanvasMap = new WeakMap(), _AnnotationLayer_editableAnnotations = new WeakMap(), _AnnotationLayer_instances = new WeakSet(), _AnnotationLayer_appendElement = function _AnnotationLayer_appendElement(element, id) {\n        var _a;\n        const contentElement = element.firstChild || element;\n        contentElement.id = `${AnnotationPrefix}${id}`;\n        this.div.append(element);\n        (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_accessibilityManager, \"f\")) === null || _a === void 0 ? void 0 : _a.moveElementInDOM(this.div, element, contentElement, \n        /* isRemovable = */ false);\n    }, _AnnotationLayer_setAnnotationCanvasMap = function _AnnotationLayer_setAnnotationCanvasMap() {\n        if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_annotationCanvasMap, \"f\")) {\n            return;\n        }\n        const layer = this.div;\n        for (const [id, canvas] of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_annotationCanvasMap, \"f\")) {\n            const element = layer.querySelector(`[data-annotation-id=\"${id}\"]`);\n            if (!element) {\n                continue;\n            }\n            canvas.className = \"annotationContent k-annotation-content\";\n            const { firstChild } = element;\n            if (!firstChild) {\n                element.append(canvas);\n            }\n            else if (firstChild.nodeName === \"CANVAS\") {\n                firstChild.replaceWith(canvas);\n            }\n            else if (!firstChild.classList.contains(\"annotationContent\") ||\n                !firstChild.classList.contains(\"k-annotation-content \")) {\n                firstChild.before(canvas);\n            }\n            else {\n                firstChild.after(canvas);\n            }\n        }\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayer_annotationCanvasMap, \"f\").clear();\n    };\n\n    /* Copyright 2014 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationLayerBuilder_instances, _AnnotationLayerBuilder_onAppend, _AnnotationLayerBuilder_eventAbortController, _AnnotationLayerBuilder_updatePresentationModeState;\n    // import { PresentationModeState } from \"./shared/ui_utils\";\n    /**\n     * @typedef {Object} AnnotationLayerBuilderOptions\n     * @property {PDFPageProxy} pdfPage\n     * @property {AnnotationStorage} [annotationStorage]\n     * @property {string} [imageResourcesPath] - Path for image resources, mainly\n     *   for annotation icons. Include trailing slash.\n     * @property {boolean} renderForms\n     * @property {IPDFLinkService} linkService\n     * @property {IDownloadManager} [downloadManager]\n     * @property {boolean} [enableScripting]\n     * @property {Promise<boolean>} [hasJSActionsPromise]\n     * @property {Promise<Object<string, Array<Object>> | null>}\n     *   [fieldObjectsPromise]\n     * @property {Map<string, HTMLCanvasElement>} [annotationCanvasMap]\n     * @property {TextAccessibilityManager} [accessibilityManager]\n     * @property {AnnotationEditorUIManager} [annotationEditorUIManager]\n     * @property {function} [onAppend]\n     */\n    class AnnotationLayerBuilder {\n        /**\n         * @param {AnnotationLayerBuilderOptions} options\n         */\n        constructor({ pdfPage, eventBus, linkService = null, \n        // downloadManager,\n        annotationStorage = null, \n        // imageResourcesPath = \"\",\n        // renderForms = true,\n        // enableScripting = false,\n        // hasJSActionsPromise = null,\n        // fieldObjectsPromise = null,\n        annotationCanvasMap = null, accessibilityManager = null, annotationEditorUIManager = null, onAppend = null, }) {\n            _AnnotationLayerBuilder_instances.add(this);\n            // todo: props ported from pdf.js\n            this.annotationLayer = null;\n            this.pdfPage = null;\n            this.linkService = null;\n            this.annotationStorage = null;\n            this._annotationCanvasMap = null;\n            this._annotationEditorUIManager = null;\n            this.div = null;\n            this._cancelled = null;\n            this._eventBus = null;\n            this._accessibilityManager = null;\n            // todo: props ported from pdf.js\n            _AnnotationLayerBuilder_onAppend.set(this, null);\n            _AnnotationLayerBuilder_eventAbortController.set(this, null);\n            this.pdfPage = pdfPage;\n            this.linkService = linkService;\n            // this.downloadManager = downloadManager;\n            // this.imageResourcesPath = imageResourcesPath;\n            // this.renderForms = renderForms;\n            this.annotationStorage = annotationStorage;\n            // this.enableScripting = enableScripting;\n            // this._hasJSActionsPromise = hasJSActionsPromise || Promise.resolve(false);\n            // this._fieldObjectsPromise = fieldObjectsPromise || Promise.resolve(null);\n            this._annotationCanvasMap = annotationCanvasMap;\n            this._accessibilityManager = accessibilityManager;\n            this._annotationEditorUIManager = annotationEditorUIManager;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationLayerBuilder_onAppend, onAppend, \"f\");\n            this.annotationLayer = null;\n            this.div = null;\n            this._cancelled = false;\n            this._eventBus = (linkService === null || linkService === void 0 ? void 0 : linkService.eventBus) || eventBus;\n        }\n        /**\n         * @param {PageViewport} viewport\n         * @param {string} intent (default value is 'display')\n         * @returns {Promise<void>} A promise that is resolved when rendering of the\n         *   annotations is complete.\n         */\n        render(viewport_1) {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, arguments, void 0, function* (viewport, intent = \"display\") {\n                var _a, _b, _c;\n                if (this.div) {\n                    if (this._cancelled || !this.annotationLayer) {\n                        return;\n                    }\n                    // If an annotationLayer already exists, refresh its children's\n                    // transformation matrices.\n                    this.annotationLayer.update({\n                        viewport: viewport.clone({ dontFlip: true }),\n                    });\n                    return;\n                }\n                // const [annotations, hasJSActions, fieldObjects] = await Promise.all([\n                const [annotations] = yield Promise.all([\n                    this.pdfPage.getAnnotations({ intent }),\n                    // this._hasJSActionsPromise,\n                    // this._fieldObjectsPromise,\n                ]);\n                if (this._cancelled) {\n                    return;\n                }\n                // Create an annotation layer div and render the annotations\n                // if there is at least one annotation.\n                // const div = (this.div = document.createElement(\"div\"));\n                // div.className = \"annotationLayer\";\n                // this.#onAppend?.(div);\n                if (annotations.length === 0) {\n                    this.hide();\n                    return;\n                }\n                const page = this.pdfPage;\n                const pageView = (_a = page._pageInfo) === null || _a === void 0 ? void 0 : _a.view;\n                const pageWidthAnnotationLayer = (pageView[2] || 0) + \"px\";\n                const pageHeightAnnotationLayer = (pageView[3] || 0) + \"px\";\n                const div = convertToHtml(`\n            <div class=\"k-annotation-layer annotationLayer\" data-main-rotation=\"0\"\n                 style=\"width: round(var(--scale-factor) * ${pageWidthAnnotationLayer}, 1px);\n                        height: round(var(--scale-factor) * ${pageHeightAnnotationLayer}, 1px);\">\n            </div>\n        `);\n                this.div = div;\n                (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayerBuilder_onAppend, \"f\")) === null || _b === void 0 ? void 0 : _b.call(this, div);\n                this.annotationLayer = new AnnotationLayer({\n                    div,\n                    // accessibilityManager: this._accessibilityManager,\n                    accessibilityManager: null,\n                    annotationCanvasMap: this._annotationCanvasMap,\n                    annotationEditorUIManager: this._annotationEditorUIManager,\n                    page: this.pdfPage,\n                    viewport: viewport.clone({ dontFlip: true }),\n                });\n                yield this.annotationLayer.render({\n                    annotations,\n                    // imageResourcesPath: this.imageResourcesPath,\n                    // renderForms: this.renderForms,\n                    linkService: this.linkService,\n                    // downloadManager: this.downloadManager,\n                    // annotationStorage: this.annotationStorage,\n                    // enableScripting: this.enableScripting,\n                    // hasJSActions,\n                    // fieldObjects,\n                });\n                // Ensure that interactive form elements in the annotationLayer are\n                // disabled while PresentationMode is active (see issue 12232).\n                if (this.linkService.isInPresentationMode) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayerBuilder_instances, \"m\", _AnnotationLayerBuilder_updatePresentationModeState).call(this, PresentationModeState.FULLSCREEN);\n                }\n                if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayerBuilder_eventAbortController, \"f\")) {\n                    kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationLayerBuilder_eventAbortController, new AbortController(), \"f\");\n                    (_c = this._eventBus) === null || _c === void 0 ? void 0 : _c._on(\"presentationmodechanged\", evt => {\n                        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayerBuilder_instances, \"m\", _AnnotationLayerBuilder_updatePresentationModeState).call(this, evt.state);\n                    }, { signal: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayerBuilder_eventAbortController, \"f\").signal });\n                }\n            });\n        }\n        cancel() {\n            var _a;\n            this._cancelled = true;\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationLayerBuilder_eventAbortController, \"f\")) === null || _a === void 0 ? void 0 : _a.abort();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationLayerBuilder_eventAbortController, null, \"f\");\n        }\n        hide() {\n            if (!this.div) {\n                return;\n            }\n            this.div.hidden = true;\n        }\n        hasEditableAnnotations() {\n            var _a;\n            return !!((_a = this.annotationLayer) === null || _a === void 0 ? void 0 : _a.hasEditableAnnotations());\n        }\n    }\n    _AnnotationLayerBuilder_onAppend = new WeakMap(), _AnnotationLayerBuilder_eventAbortController = new WeakMap(), _AnnotationLayerBuilder_instances = new WeakSet(), _AnnotationLayerBuilder_updatePresentationModeState = function _AnnotationLayerBuilder_updatePresentationModeState(state) {\n        if (!this.div) {\n            return;\n        }\n        let disableFormElements = false;\n        switch (state) {\n            case PresentationModeState.FULLSCREEN:\n                disableFormElements = true;\n                break;\n            case PresentationModeState.NORMAL:\n                break;\n            default:\n                return;\n        }\n        for (const section of this.div.childNodes) {\n            if (section.hasAttribute(\"data-internal-link\")) {\n                continue;\n            }\n            section.inert = disableFormElements;\n        }\n    };\n\n    /* Copyright 2023 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _DrawLayer_instances, _a$6, _DrawLayer_parent, _DrawLayer_id, _DrawLayer_mapping, _DrawLayer_toUpdate, _DrawLayer_setBox, _DrawLayer_createSVG, _DrawLayer_createClipPath;\n    /**\n     * Manage the SVGs drawn on top of the page canvas.\n     * It's important to have them directly on top of the canvas because we want to\n     * be able to use mix-blend-mode for some of them.\n     */\n    class DrawLayer {\n        constructor({ pageIndex }) {\n            _DrawLayer_instances.add(this);\n            // todo: props\n            this.pageIndex = 0;\n            // todo: props\n            _DrawLayer_parent.set(this, null);\n            _DrawLayer_id.set(this, 0);\n            _DrawLayer_mapping.set(this, new Map());\n            _DrawLayer_toUpdate.set(this, new Map());\n            this.pageIndex = pageIndex;\n        }\n        setParent(parent) {\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_parent, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayer_parent, parent, \"f\");\n                return;\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_parent, \"f\") !== parent) {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").size > 0) {\n                    for (const root of kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").values()) {\n                        root.remove();\n                        parent.append(root);\n                    }\n                }\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayer_parent, parent, \"f\");\n            }\n        }\n        static get _svgFactory() {\n            return kendo_pdfjs_loader_js.shadow(this, \"_svgFactory\", new kendo_pdfjs_loader_js.DOMSVGFactory());\n        }\n        highlight(outlines, color, opacity, isPathUpdatable = false) {\n            var _b, _c;\n            const id = (kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayer_id, (_c = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_id, \"f\"), _b = _c++, _c), \"f\"), _b);\n            const root = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_instances, \"m\", _DrawLayer_createSVG).call(this, outlines.box);\n            // root.classList.add(\"highlight\");\n            root.classList.add(\"k-highlight\");\n            if (outlines.free) {\n                // root.classList.add(\"free\");\n            }\n            const defs = _a$6._svgFactory.createElement(\"defs\");\n            root.append(defs);\n            const path = _a$6._svgFactory.createElement(\"path\");\n            defs.append(path);\n            const pathId = `path_p${this.pageIndex}_${id}`;\n            path.setAttribute(\"id\", pathId);\n            path.setAttribute(\"d\", outlines.toSVGPath());\n            if (isPathUpdatable) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_toUpdate, \"f\").set(id, path);\n            }\n            // Create the clipping path for the editor div.\n            const clipPathId = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_instances, \"m\", _DrawLayer_createClipPath).call(this, defs, pathId);\n            const use = _a$6._svgFactory.createElement(\"use\");\n            root.append(use);\n            root.setAttribute(\"fill\", color);\n            root.setAttribute(\"fill-opacity\", opacity);\n            use.setAttribute(\"href\", `#${pathId}`);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").set(id, root);\n            return { id, clipPathId: `url(#${clipPathId})` };\n        }\n        highlightOutline(outlines) {\n            var _b, _c;\n            // We cannot draw the outline directly in the SVG for highlights because\n            // it composes with its parent with mix-blend-mode: multiply.\n            // But the outline has a different mix-blend-mode, so we need to draw it in\n            // its own SVG.\n            const id = (kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayer_id, (_c = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_id, \"f\"), _b = _c++, _c), \"f\"), _b);\n            const root = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_instances, \"m\", _DrawLayer_createSVG).call(this, outlines.box);\n            // root.classList.add(\"highlightOutline\");\n            root.classList.add(\"k-highlight-outline\");\n            const defs = _a$6._svgFactory.createElement(\"defs\");\n            root.append(defs);\n            const path = _a$6._svgFactory.createElement(\"path\");\n            defs.append(path);\n            const pathId = `path_p${this.pageIndex}_${id}`;\n            path.setAttribute(\"id\", pathId);\n            path.setAttribute(\"d\", outlines.toSVGPath());\n            path.setAttribute(\"vector-effect\", \"non-scaling-stroke\");\n            let maskId;\n            if (outlines.free) {\n                // root.classList.add(\"free\");\n                const mask = _a$6._svgFactory.createElement(\"mask\");\n                defs.append(mask);\n                maskId = `mask_p${this.pageIndex}_${id}`;\n                mask.setAttribute(\"id\", maskId);\n                mask.setAttribute(\"maskUnits\", \"objectBoundingBox\");\n                const rect = _a$6._svgFactory.createElement(\"rect\");\n                mask.append(rect);\n                rect.setAttribute(\"width\", \"1\");\n                rect.setAttribute(\"height\", \"1\");\n                rect.setAttribute(\"fill\", \"white\");\n                const use = _a$6._svgFactory.createElement(\"use\");\n                mask.append(use);\n                use.setAttribute(\"href\", `#${pathId}`);\n                use.setAttribute(\"stroke\", \"none\");\n                use.setAttribute(\"fill\", \"black\");\n                use.setAttribute(\"fill-rule\", \"nonzero\");\n                // use.classList.add(\"mask\");\n            }\n            const use1 = _a$6._svgFactory.createElement(\"use\");\n            root.append(use1);\n            use1.setAttribute(\"href\", `#${pathId}`);\n            if (maskId) {\n                use1.setAttribute(\"mask\", `url(#${maskId})`);\n            }\n            const use2 = use1.cloneNode();\n            root.append(use2);\n            // use1.classList.add(\"mainOutline\");\n            // use2.classList.add(\"secondaryOutline\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").set(id, root);\n            return id;\n        }\n        finalizeLine(id, line) {\n            const path = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_toUpdate, \"f\").get(id);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_toUpdate, \"f\").delete(id);\n            this.updateBox(id, line.box);\n            path.setAttribute(\"d\", line.toSVGPath());\n        }\n        updateLine(id, line) {\n            const root = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id);\n            const defs = root.firstChild;\n            const path = defs.firstChild;\n            path.setAttribute(\"d\", line.toSVGPath());\n        }\n        removeFreeHighlight(id) {\n            this.remove(id);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_toUpdate, \"f\").delete(id);\n        }\n        updatePath(id, line) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_toUpdate, \"f\").get(id).setAttribute(\"d\", line.toSVGPath());\n        }\n        updateBox(id, box) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(_a$6, _a$6, \"m\", _DrawLayer_setBox).call(_a$6, kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id), box);\n        }\n        show(id, visible) {\n            // this.#mapping.get(id).classList.toggle(\"hidden\", !visible);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).classList.toggle(\"k-hidden\", !visible);\n        }\n        rotate(id, angle) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).setAttribute(\"data-main-rotation\", angle);\n        }\n        changeColor(id, color) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).setAttribute(\"fill\", color);\n        }\n        changeOpacity(id, opacity) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).setAttribute(\"fill-opacity\", opacity);\n        }\n        addClass(id, className) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).classList.add(className);\n        }\n        removeClass(id, className) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).classList.remove(className);\n        }\n        remove(id) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_parent, \"f\") === null) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").get(id).remove();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").delete(id);\n        }\n        destroy() {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayer_parent, null, \"f\");\n            for (const root of kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").values()) {\n                root.remove();\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_mapping, \"f\").clear();\n        }\n    }\n    _a$6 = DrawLayer, _DrawLayer_parent = new WeakMap(), _DrawLayer_id = new WeakMap(), _DrawLayer_mapping = new WeakMap(), _DrawLayer_toUpdate = new WeakMap(), _DrawLayer_instances = new WeakSet(), _DrawLayer_setBox = function _DrawLayer_setBox(element, { x = 0, y = 0, width = 1, height = 1 } = {}) {\n        const { style } = element;\n        style.top = `${100 * y}%`;\n        style.left = `${100 * x}%`;\n        // style.width = `${100 * width}%`;\n        // style.height = `${100 * height}%`;\n        // todo: reduce the dimensions, so that the annotation editor toolbar\n        // does not overlap the outline\n        style.width = `${100 * width - 0.2}%`;\n        style.height = `${100 * height - 0.2}%`;\n    }, _DrawLayer_createSVG = function _DrawLayer_createSVG(box) {\n        const svg = _a$6._svgFactory.create(1, 1, /* skipDimensions = */ true);\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayer_parent, \"f\").append(svg);\n        svg.setAttribute(\"aria-hidden\", true);\n        kendo_dateinputsCommon_cmn_chunk_js.a(_a$6, _a$6, \"m\", _DrawLayer_setBox).call(_a$6, svg, box);\n        return svg;\n    }, _DrawLayer_createClipPath = function _DrawLayer_createClipPath(defs, pathId) {\n        const clipPath = _a$6._svgFactory.createElement(\"clipPath\");\n        defs.append(clipPath);\n        const clipPathId = `clip_${pathId}`;\n        clipPath.setAttribute(\"id\", clipPathId);\n        clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n        const clipPathUse = _a$6._svgFactory.createElement(\"use\");\n        clipPath.append(clipPathUse);\n        clipPathUse.setAttribute(\"href\", `#${pathId}`);\n        // clipPathUse.classList.add(\"clip\");\n        return clipPathId;\n    };\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _DrawLayerBuilder_drawLayer;\n    /**\n     * @typedef {Object} DrawLayerBuilderOptions\n     * @property {number} pageIndex\n     */\n    class DrawLayerBuilder {\n        /**\n         * @param {DrawLayerBuilderOptions} options\n         */\n        constructor(options) {\n            // todo: props\n            this.pageIndex = null;\n            this._cancelled = null;\n            // todo: props\n            _DrawLayerBuilder_drawLayer.set(this, null);\n            this.pageIndex = options.pageIndex;\n        }\n        /**\n         * @param {string} intent (default value is 'display')\n         */\n        render() {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, arguments, void 0, function* (intent = \"display\") {\n                // if (intent !== \"display\" || this.#drawLayer || this._cancelled) {\n                if (intent !== \"display\" || kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayerBuilder_drawLayer, \"f\")) {\n                    return;\n                }\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayerBuilder_drawLayer, new DrawLayer({\n                    pageIndex: this.pageIndex,\n                }), \"f\");\n            });\n        }\n        cancel() {\n            // this._cancelled = true;\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayerBuilder_drawLayer, \"f\")) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayerBuilder_drawLayer, \"f\").destroy();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _DrawLayerBuilder_drawLayer, null, \"f\");\n        }\n        setParent(parent) {\n            var _a;\n            (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayerBuilder_drawLayer, \"f\")) === null || _a === void 0 ? void 0 : _a.setParent(parent);\n        }\n        getDrawLayer() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _DrawLayerBuilder_drawLayer, \"f\");\n        }\n    }\n    _DrawLayerBuilder_drawLayer = new WeakMap();\n\n    /* Copyright 2015 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    // import {\n    //     BaseCanvasFactory,\n    //     BaseCMapReaderFactory,\n    //     BaseFilterFactory,\n    //     BaseStandardFontDataFactory,\n    //     BaseSVGFactory,\n    // } from \"./base_factory.js\";\n    // import {\n    //     BaseException,\n    //     FeatureTest,\n    //     shadow,\n    //     stringToBytes,\n    //     Util,\n    //     warn,\n    // } from \"../shared/util.js\";\n    // const SVG_NS = \"http://www.w3.org/2000/svg\";\n    // class PixelsPerInch {\n    //     static CSS = 96.0;\n    //     static PDF = 72.0;\n    //     static PDF_TO_CSS_UNITS = this.CSS / this.PDF;\n    // }\n    // /**\n    //  * FilterFactory aims to create some SVG filters we can use when drawing an\n    //  * image (or whatever) on a canvas.\n    //  * Filters aren't applied with ctx.putImageData because it just overwrites the\n    //  * underlying pixels.\n    //  * With these filters, it's possible for example to apply some transfer maps on\n    //  * an image without the need to apply them on the pixel arrays: the renderer\n    //  * does the magic for us.\n    //  */\n    // class DOMFilterFactory extends BaseFilterFactory {\n    //     #baseUrl;\n    //     #_cache;\n    //     #_defs;\n    //     #docId;\n    //     #document;\n    //     #_hcmCache;\n    //     #id = 0;\n    //     constructor({ docId, ownerDocument = globalThis.document } = {}) {\n    //         super();\n    //         this.#docId = docId;\n    //         this.#document = ownerDocument;\n    //     }\n    //     get #cache() {\n    //         return (this.#_cache ||= new Map());\n    //     }\n    //     get #hcmCache() {\n    //         return (this.#_hcmCache ||= new Map());\n    //     }\n    //     get #defs() {\n    //         if (!this.#_defs) {\n    //             const div = this.#document.createElement(\"div\");\n    //             const { style } = div;\n    //             style.visibility = \"hidden\";\n    //             style.contain = \"strict\";\n    //             style.width = style.height = 0;\n    //             style.position = \"absolute\";\n    //             style.top = style.left = 0;\n    //             style.zIndex = -1;\n    //             const svg = this.#document.createElementNS(SVG_NS, \"svg\");\n    //             svg.setAttribute(\"width\", 0);\n    //             svg.setAttribute(\"height\", 0);\n    //             this.#_defs = this.#document.createElementNS(SVG_NS, \"defs\");\n    //             div.append(svg);\n    //             svg.append(this.#_defs);\n    //             this.#document.body.append(div);\n    //         }\n    //         return this.#_defs;\n    //     }\n    //     #createTables(maps) {\n    //         if (maps.length === 1) {\n    //             const mapR = maps[0];\n    //             const buffer = new Array(256);\n    //             for (let i = 0; i < 256; i++) {\n    //                 buffer[i] = mapR[i] / 255;\n    //             }\n    //             const table = buffer.join(\",\");\n    //             return [table, table, table];\n    //         }\n    //         const [mapR, mapG, mapB] = maps;\n    //         const bufferR = new Array(256);\n    //         const bufferG = new Array(256);\n    //         const bufferB = new Array(256);\n    //         for (let i = 0; i < 256; i++) {\n    //             bufferR[i] = mapR[i] / 255;\n    //             bufferG[i] = mapG[i] / 255;\n    //             bufferB[i] = mapB[i] / 255;\n    //         }\n    //         return [bufferR.join(\",\"), bufferG.join(\",\"), bufferB.join(\",\")];\n    //     }\n    //     #createUrl(id) {\n    //         if (this.#baseUrl === undefined) {\n    //             // Unless a `<base>`-element is present a relative URL should work.\n    //             this.#baseUrl = \"\";\n    //             const url = this.#document.URL;\n    //             if (url !== this.#document.baseURI) {\n    //                 if (isDataScheme(url)) {\n    //                     warn('#createUrl: ignore \"data:\"-URL for performance reasons.');\n    //                 } else {\n    //                     this.#baseUrl = url.split(\"#\", 1)[0];\n    //                 }\n    //             }\n    //         }\n    //         return `url(${this.#baseUrl}#${id})`;\n    //     }\n    //     addFilter(maps) {\n    //         if (!maps) {\n    //             return \"none\";\n    //         }\n    //         // When a page is zoomed the page is re-drawn but the maps are likely\n    //         // the same.\n    //         let value = this.#cache.get(maps);\n    //         if (value) {\n    //             return value;\n    //         }\n    //         const [tableR, tableG, tableB] = this.#createTables(maps);\n    //         const key = maps.length === 1 ? tableR : `${tableR}${tableG}${tableB}`;\n    //         value = this.#cache.get(key);\n    //         if (value) {\n    //             this.#cache.set(maps, value);\n    //             return value;\n    //         }\n    //         // We create a SVG filter: feComponentTransferElement\n    //         //  https://www.w3.org/TR/SVG11/filters.html#feComponentTransferElement\n    //         const id = `g_${this.#docId}_transfer_map_${this.#id++}`;\n    //         const url = this.#createUrl(id);\n    //         this.#cache.set(maps, url);\n    //         this.#cache.set(key, url);\n    //         const filter = this.#createFilter(id);\n    //         this.#addTransferMapConversion(tableR, tableG, tableB, filter);\n    //         return url;\n    //     }\n    //     addHCMFilter(fgColor, bgColor) {\n    //         const key = `${fgColor}-${bgColor}`;\n    //         const filterName = \"base\";\n    //         let info = this.#hcmCache.get(filterName);\n    //         if (info?.key === key) {\n    //             return info.url;\n    //         }\n    //         if (info) {\n    //             info.filter?.remove();\n    //             info.key = key;\n    //             info.url = \"none\";\n    //             info.filter = null;\n    //         } else {\n    //             info = {\n    //                 key,\n    //                 url: \"none\",\n    //                 filter: null,\n    //             };\n    //             this.#hcmCache.set(filterName, info);\n    //         }\n    //         if (!fgColor || !bgColor) {\n    //             return info.url;\n    //         }\n    //         const fgRGB = this.#getRGB(fgColor);\n    //         fgColor = Util.makeHexColor(...fgRGB);\n    //         const bgRGB = this.#getRGB(bgColor);\n    //         bgColor = Util.makeHexColor(...bgRGB);\n    //         this.#defs.style.color = \"\";\n    //         if (\n    //             (fgColor === \"#000000\" && bgColor === \"#ffffff\") ||\n    //             fgColor === bgColor\n    //         ) {\n    //             return info.url;\n    //         }\n    //         // https://developer.mozilla.org/en-US/docs/Web/Accessibility/Understanding_Colors_and_Luminance\n    //         //\n    //         // Relative luminance:\n    //         // https://www.w3.org/TR/WCAG20/#relativeluminancedef\n    //         //\n    //         // We compute the rounded luminance of the default background color.\n    //         // Then for every color in the pdf, if its rounded luminance is the\n    //         // same as the background one then it's replaced by the new\n    //         // background color else by the foreground one.\n    //         const map = new Array(256);\n    //         for (let i = 0; i <= 255; i++) {\n    //             const x = i / 255;\n    //             map[i] = x <= 0.03928 ? x / 12.92 : ((x + 0.055) / 1.055) ** 2.4;\n    //         }\n    //         const table = map.join(\",\");\n    //         const id = `g_${this.#docId}_hcm_filter`;\n    //         const filter = (info.filter = this.#createFilter(id));\n    //         this.#addTransferMapConversion(table, table, table, filter);\n    //         this.#addGrayConversion(filter);\n    //         const getSteps = (c, n) => {\n    //             const start = fgRGB[c] / 255;\n    //             const end = bgRGB[c] / 255;\n    //             const arr = new Array(n + 1);\n    //             for (let i = 0; i <= n; i++) {\n    //                 arr[i] = start + (i / n) * (end - start);\n    //             }\n    //             return arr.join(\",\");\n    //         };\n    //         this.#addTransferMapConversion(\n    //             getSteps(0, 5),\n    //             getSteps(1, 5),\n    //             getSteps(2, 5),\n    //             filter\n    //         );\n    //         info.url = this.#createUrl(id);\n    //         return info.url;\n    //     }\n    //     addAlphaFilter(map) {\n    //         // When a page is zoomed the page is re-drawn but the maps are likely\n    //         // the same.\n    //         let value = this.#cache.get(map);\n    //         if (value) {\n    //             return value;\n    //         }\n    //         const [tableA] = this.#createTables([map]);\n    //         const key = `alpha_${tableA}`;\n    //         value = this.#cache.get(key);\n    //         if (value) {\n    //             this.#cache.set(map, value);\n    //             return value;\n    //         }\n    //         const id = `g_${this.#docId}_alpha_map_${this.#id++}`;\n    //         const url = this.#createUrl(id);\n    //         this.#cache.set(map, url);\n    //         this.#cache.set(key, url);\n    //         const filter = this.#createFilter(id);\n    //         this.#addTransferMapAlphaConversion(tableA, filter);\n    //         return url;\n    //     }\n    //     addLuminosityFilter(map) {\n    //         // When a page is zoomed the page is re-drawn but the maps are likely\n    //         // the same.\n    //         let value = this.#cache.get(map || \"luminosity\");\n    //         if (value) {\n    //             return value;\n    //         }\n    //         let tableA, key;\n    //         if (map) {\n    //             [tableA] = this.#createTables([map]);\n    //             key = `luminosity_${tableA}`;\n    //         } else {\n    //             key = \"luminosity\";\n    //         }\n    //         value = this.#cache.get(key);\n    //         if (value) {\n    //             this.#cache.set(map, value);\n    //             return value;\n    //         }\n    //         const id = `g_${this.#docId}_luminosity_map_${this.#id++}`;\n    //         const url = this.#createUrl(id);\n    //         this.#cache.set(map, url);\n    //         this.#cache.set(key, url);\n    //         const filter = this.#createFilter(id);\n    //         this.#addLuminosityConversion(filter);\n    //         if (map) {\n    //             this.#addTransferMapAlphaConversion(tableA, filter);\n    //         }\n    //         return url;\n    //     }\n    //     addHighlightHCMFilter(filterName, fgColor, bgColor, newFgColor, newBgColor) {\n    //         const key = `${fgColor}-${bgColor}-${newFgColor}-${newBgColor}`;\n    //         let info = this.#hcmCache.get(filterName);\n    //         if (info?.key === key) {\n    //             return info.url;\n    //         }\n    //         if (info) {\n    //             info.filter?.remove();\n    //             info.key = key;\n    //             info.url = \"none\";\n    //             info.filter = null;\n    //         } else {\n    //             info = {\n    //                 key,\n    //                 url: \"none\",\n    //                 filter: null,\n    //             };\n    //             this.#hcmCache.set(filterName, info);\n    //         }\n    //         if (!fgColor || !bgColor) {\n    //             return info.url;\n    //         }\n    //         const [fgRGB, bgRGB] = [fgColor, bgColor].map(this.#getRGB.bind(this));\n    //         let fgGray = Math.round(\n    //             0.2126 * fgRGB[0] + 0.7152 * fgRGB[1] + 0.0722 * fgRGB[2]\n    //         );\n    //         let bgGray = Math.round(\n    //             0.2126 * bgRGB[0] + 0.7152 * bgRGB[1] + 0.0722 * bgRGB[2]\n    //         );\n    //         let [newFgRGB, newBgRGB] = [newFgColor, newBgColor].map(\n    //             this.#getRGB.bind(this)\n    //         );\n    //         if (bgGray < fgGray) {\n    //             [fgGray, bgGray, newFgRGB, newBgRGB] = [\n    //                 bgGray,\n    //                 fgGray,\n    //                 newBgRGB,\n    //                 newFgRGB,\n    //             ];\n    //         }\n    //         this.#defs.style.color = \"\";\n    //         // Now we can create the filters to highlight some canvas parts.\n    //         // The colors in the pdf will almost be Canvas and CanvasText, hence we\n    //         // want to filter them to finally get Highlight and HighlightText.\n    //         // Since we're in HCM the background color and the foreground color should\n    //         // be really different when converted to grayscale (if they're not then it\n    //         // means that we've a poor contrast). Once the canvas colors are converted\n    //         // to grayscale we can easily map them on their new colors.\n    //         // The grayscale step is important because if we've something like:\n    //         //   fgColor = #FF....\n    //         //   bgColor = #FF....\n    //         //   then we are enable to map the red component on the new red components\n    //         //   which can be different.\n    //         const getSteps = (fg, bg, n) => {\n    //             const arr = new Array(256);\n    //             const step = (bgGray - fgGray) / n;\n    //             const newStart = fg / 255;\n    //             const newStep = (bg - fg) / (255 * n);\n    //             let prev = 0;\n    //             for (let i = 0; i <= n; i++) {\n    //                 const k = Math.round(fgGray + i * step);\n    //                 const value = newStart + i * newStep;\n    //                 for (let j = prev; j <= k; j++) {\n    //                     arr[j] = value;\n    //                 }\n    //                 prev = k + 1;\n    //             }\n    //             for (let i = prev; i < 256; i++) {\n    //                 arr[i] = arr[prev - 1];\n    //             }\n    //             return arr.join(\",\");\n    //         };\n    //         const id = `g_${this.#docId}_hcm_${filterName}_filter`;\n    //         const filter = (info.filter = this.#createFilter(id));\n    //         this.#addGrayConversion(filter);\n    //         this.#addTransferMapConversion(\n    //             getSteps(newFgRGB[0], newBgRGB[0], 5),\n    //             getSteps(newFgRGB[1], newBgRGB[1], 5),\n    //             getSteps(newFgRGB[2], newBgRGB[2], 5),\n    //             filter\n    //         );\n    //         info.url = this.#createUrl(id);\n    //         return info.url;\n    //     }\n    //     destroy(keepHCM = false) {\n    //         if (keepHCM && this.#hcmCache.size !== 0) {\n    //             return;\n    //         }\n    //         if (this.#_defs) {\n    //             this.#_defs.parentNode.parentNode.remove();\n    //             this.#_defs = null;\n    //         }\n    //         if (this.#_cache) {\n    //             this.#_cache.clear();\n    //             this.#_cache = null;\n    //         }\n    //         this.#id = 0;\n    //     }\n    //     #addLuminosityConversion(filter) {\n    //         const feColorMatrix = this.#document.createElementNS(\n    //             SVG_NS,\n    //             \"feColorMatrix\"\n    //         );\n    //         feColorMatrix.setAttribute(\"type\", \"matrix\");\n    //         feColorMatrix.setAttribute(\n    //             \"values\",\n    //             \"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0\"\n    //         );\n    //         filter.append(feColorMatrix);\n    //     }\n    //     #addGrayConversion(filter) {\n    //         const feColorMatrix = this.#document.createElementNS(\n    //             SVG_NS,\n    //             \"feColorMatrix\"\n    //         );\n    //         feColorMatrix.setAttribute(\"type\", \"matrix\");\n    //         feColorMatrix.setAttribute(\n    //             \"values\",\n    //             \"0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0\"\n    //         );\n    //         filter.append(feColorMatrix);\n    //     }\n    //     #createFilter(id) {\n    //         const filter = this.#document.createElementNS(SVG_NS, \"filter\");\n    //         filter.setAttribute(\"color-interpolation-filters\", \"sRGB\");\n    //         filter.setAttribute(\"id\", id);\n    //         this.#defs.append(filter);\n    //         return filter;\n    //     }\n    //     #appendFeFunc(feComponentTransfer, func, table) {\n    //         const feFunc = this.#document.createElementNS(SVG_NS, func);\n    //         feFunc.setAttribute(\"type\", \"discrete\");\n    //         feFunc.setAttribute(\"tableValues\", table);\n    //         feComponentTransfer.append(feFunc);\n    //     }\n    //     #addTransferMapConversion(rTable, gTable, bTable, filter) {\n    //         const feComponentTransfer = this.#document.createElementNS(\n    //             SVG_NS,\n    //             \"feComponentTransfer\"\n    //         );\n    //         filter.append(feComponentTransfer);\n    //         this.#appendFeFunc(feComponentTransfer, \"feFuncR\", rTable);\n    //         this.#appendFeFunc(feComponentTransfer, \"feFuncG\", gTable);\n    //         this.#appendFeFunc(feComponentTransfer, \"feFuncB\", bTable);\n    //     }\n    //     #addTransferMapAlphaConversion(aTable, filter) {\n    //         const feComponentTransfer = this.#document.createElementNS(\n    //             SVG_NS,\n    //             \"feComponentTransfer\"\n    //         );\n    //         filter.append(feComponentTransfer);\n    //         this.#appendFeFunc(feComponentTransfer, \"feFuncA\", aTable);\n    //     }\n    //     #getRGB(color) {\n    //         this.#defs.style.color = color;\n    //         return getRGB(getComputedStyle(this.#defs).getPropertyValue(\"color\"));\n    //     }\n    // }\n    // class DOMCanvasFactory extends BaseCanvasFactory {\n    //     constructor({ ownerDocument = globalThis.document, enableHWA = false } = {}) {\n    //         super({ enableHWA });\n    //         this._document = ownerDocument;\n    //     }\n    //     /**\n    //      * @ignore\n    //      */\n    //     _createCanvas(width, height) {\n    //         const canvas = this._document.createElement(\"canvas\");\n    //         canvas.width = width;\n    //         canvas.height = height;\n    //         return canvas;\n    //     }\n    // }\n    // async function fetchData(url, type = \"text\") {\n    //     if (\n    //         (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) ||\n    //         isValidFetchUrl(url, document.baseURI)\n    //     ) {\n    //         const response = await fetch(url);\n    //         if (!response.ok) {\n    //             throw new Error(response.statusText);\n    //         }\n    //         switch (type) {\n    //             case \"arraybuffer\":\n    //                 return response.arrayBuffer();\n    //             case \"blob\":\n    //                 return response.blob();\n    //             case \"json\":\n    //                 return response.json();\n    //         }\n    //         return response.text();\n    //     }\n    //     // The Fetch API is not supported.\n    //     return new Promise((resolve, reject) => {\n    //         const request = new XMLHttpRequest();\n    //         request.open(\"GET\", url, /* async = */ true);\n    //         request.responseType = type;\n    //         request.onreadystatechange = () => {\n    //             if (request.readyState !== XMLHttpRequest.DONE) {\n    //                 return;\n    //             }\n    //             if (request.status === 200 || request.status === 0) {\n    //                 switch (type) {\n    //                     case \"arraybuffer\":\n    //                     case \"blob\":\n    //                     case \"json\":\n    //                         resolve(request.response);\n    //                         return;\n    //                 }\n    //                 resolve(request.responseText);\n    //                 return;\n    //             }\n    //             reject(new Error(request.statusText));\n    //         };\n    //         request.send(null);\n    //     });\n    // }\n    // class DOMCMapReaderFactory extends BaseCMapReaderFactory {\n    //     /**\n    //      * @ignore\n    //      */\n    //     _fetchData(url, compressionType) {\n    //         return fetchData(\n    //             url,\n    //         /* type = */ this.isCompressed ? \"arraybuffer\" : \"text\"\n    //         ).then(data => ({\n    //             cMapData:\n    //                 data instanceof ArrayBuffer\n    //                     ? new Uint8Array(data)\n    //                     : stringToBytes(data),\n    //             compressionType,\n    //         }));\n    //     }\n    // }\n    // class DOMStandardFontDataFactory extends BaseStandardFontDataFactory {\n    //     /**\n    //      * @ignore\n    //      */\n    //     _fetchData(url) {\n    //         return fetchData(url, /* type = */ \"arraybuffer\").then(\n    //             data => new Uint8Array(data)\n    //         );\n    //     }\n    // }\n    // class DOMSVGFactory extends BaseSVGFactory {\n    //     /**\n    //      * @ignore\n    //      */\n    //     _createSVG(type) {\n    //         return document.createElementNS(SVG_NS, type);\n    //     }\n    // }\n    // /**\n    //  * @typedef {Object} PageViewportParameters\n    //  * @property {Array<number>} viewBox - The xMin, yMin, xMax and\n    //  *   yMax coordinates.\n    //  * @property {number} scale - The scale of the viewport.\n    //  * @property {number} rotation - The rotation, in degrees, of the viewport.\n    //  * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset. The\n    //  *   default value is `0`.\n    //  * @property {number} [offsetY] - The vertical, i.e. y-axis, offset. The\n    //  *   default value is `0`.\n    //  * @property {boolean} [dontFlip] - If true, the y-axis will not be flipped.\n    //  *   The default value is `false`.\n    //  */\n    // /**\n    //  * @typedef {Object} PageViewportCloneParameters\n    //  * @property {number} [scale] - The scale, overriding the one in the cloned\n    //  *   viewport. The default value is `this.scale`.\n    //  * @property {number} [rotation] - The rotation, in degrees, overriding the one\n    //  *   in the cloned viewport. The default value is `this.rotation`.\n    //  * @property {number} [offsetX] - The horizontal, i.e. x-axis, offset.\n    //  *   The default value is `this.offsetX`.\n    //  * @property {number} [offsetY] - The vertical, i.e. y-axis, offset.\n    //  *   The default value is `this.offsetY`.\n    //  * @property {boolean} [dontFlip] - If true, the x-axis will not be flipped.\n    //  *   The default value is `false`.\n    //  */\n    // /**\n    //  * PDF page viewport created based on scale, rotation and offset.\n    //  */\n    // class PageViewport {\n    //     /**\n    //      * @param {PageViewportParameters}\n    //      */\n    //     constructor({\n    //         viewBox,\n    //         scale,\n    //         rotation,\n    //         offsetX = 0,\n    //         offsetY = 0,\n    //         dontFlip = false,\n    //     }) {\n    //         this.viewBox = viewBox;\n    //         this.scale = scale;\n    //         this.rotation = rotation;\n    //         this.offsetX = offsetX;\n    //         this.offsetY = offsetY;\n    //         // creating transform to convert pdf coordinate system to the normal\n    //         // canvas like coordinates taking in account scale and rotation\n    //         const centerX = (viewBox[2] + viewBox[0]) / 2;\n    //         const centerY = (viewBox[3] + viewBox[1]) / 2;\n    //         let rotateA, rotateB, rotateC, rotateD;\n    //         // Normalize the rotation, by clamping it to the [0, 360) range.\n    //         rotation %= 360;\n    //         if (rotation < 0) {\n    //             rotation += 360;\n    //         }\n    //         switch (rotation) {\n    //             case 180:\n    //                 rotateA = -1;\n    //                 rotateB = 0;\n    //                 rotateC = 0;\n    //                 rotateD = 1;\n    //                 break;\n    //             case 90:\n    //                 rotateA = 0;\n    //                 rotateB = 1;\n    //                 rotateC = 1;\n    //                 rotateD = 0;\n    //                 break;\n    //             case 270:\n    //                 rotateA = 0;\n    //                 rotateB = -1;\n    //                 rotateC = -1;\n    //                 rotateD = 0;\n    //                 break;\n    //             case 0:\n    //                 rotateA = 1;\n    //                 rotateB = 0;\n    //                 rotateC = 0;\n    //                 rotateD = -1;\n    //                 break;\n    //             default:\n    //                 throw new Error(\n    //                     \"PageViewport: Invalid rotation, must be a multiple of 90 degrees.\"\n    //                 );\n    //         }\n    //         if (dontFlip) {\n    //             rotateC = -rotateC;\n    //             rotateD = -rotateD;\n    //         }\n    //         let offsetCanvasX, offsetCanvasY;\n    //         let width, height;\n    //         if (rotateA === 0) {\n    //             offsetCanvasX = Math.abs(centerY - viewBox[1]) * scale + offsetX;\n    //             offsetCanvasY = Math.abs(centerX - viewBox[0]) * scale + offsetY;\n    //             width = (viewBox[3] - viewBox[1]) * scale;\n    //             height = (viewBox[2] - viewBox[0]) * scale;\n    //         } else {\n    //             offsetCanvasX = Math.abs(centerX - viewBox[0]) * scale + offsetX;\n    //             offsetCanvasY = Math.abs(centerY - viewBox[1]) * scale + offsetY;\n    //             width = (viewBox[2] - viewBox[0]) * scale;\n    //             height = (viewBox[3] - viewBox[1]) * scale;\n    //         }\n    //         // creating transform for the following operations:\n    //         // translate(-centerX, -centerY), rotate and flip vertically,\n    //         // scale, and translate(offsetCanvasX, offsetCanvasY)\n    //         this.transform = [\n    //             rotateA * scale,\n    //             rotateB * scale,\n    //             rotateC * scale,\n    //             rotateD * scale,\n    //             offsetCanvasX - rotateA * scale * centerX - rotateC * scale * centerY,\n    //             offsetCanvasY - rotateB * scale * centerX - rotateD * scale * centerY,\n    //         ];\n    //         this.width = width;\n    //         this.height = height;\n    //     }\n    //     /**\n    //      * The original, un-scaled, viewport dimensions.\n    //      * @type {Object}\n    //      */\n    //     get rawDims() {\n    //         const { viewBox } = this;\n    //         return shadow(this, \"rawDims\", {\n    //             pageWidth: viewBox[2] - viewBox[0],\n    //             pageHeight: viewBox[3] - viewBox[1],\n    //             pageX: viewBox[0],\n    //             pageY: viewBox[1],\n    //         });\n    //     }\n    //     /**\n    //      * Clones viewport, with optional additional properties.\n    //      * @param {PageViewportCloneParameters} [params]\n    //      * @returns {PageViewport} Cloned viewport.\n    //      */\n    //     clone({\n    //         scale = this.scale,\n    //         rotation = this.rotation,\n    //         offsetX = this.offsetX,\n    //         offsetY = this.offsetY,\n    //         dontFlip = false,\n    //     } = {}) {\n    //         return new PageViewport({\n    //             viewBox: this.viewBox.slice(),\n    //             scale,\n    //             rotation,\n    //             offsetX,\n    //             offsetY,\n    //             dontFlip,\n    //         });\n    //     }\n    //     /**\n    //      * Converts PDF point to the viewport coordinates. For examples, useful for\n    //      * converting PDF location into canvas pixel coordinates.\n    //      * @param {number} x - The x-coordinate.\n    //      * @param {number} y - The y-coordinate.\n    //      * @returns {Array} Array containing `x`- and `y`-coordinates of the\n    //      *   point in the viewport coordinate space.\n    //      * @see {@link convertToPdfPoint}\n    //      * @see {@link convertToViewportRectangle}\n    //      */\n    //     convertToViewportPoint(x, y) {\n    //         return Util.applyTransform([x, y], this.transform);\n    //     }\n    //     /**\n    //      * Converts PDF rectangle to the viewport coordinates.\n    //      * @param {Array} rect - The xMin, yMin, xMax and yMax coordinates.\n    //      * @returns {Array} Array containing corresponding coordinates of the\n    //      *   rectangle in the viewport coordinate space.\n    //      * @see {@link convertToViewportPoint}\n    //      */\n    //     convertToViewportRectangle(rect) {\n    //         const topLeft = Util.applyTransform([rect[0], rect[1]], this.transform);\n    //         const bottomRight = Util.applyTransform([rect[2], rect[3]], this.transform);\n    //         return [topLeft[0], topLeft[1], bottomRight[0], bottomRight[1]];\n    //     }\n    //     /**\n    //      * Converts viewport coordinates to the PDF location. For examples, useful\n    //      * for converting canvas pixel location into PDF one.\n    //      * @param {number} x - The x-coordinate.\n    //      * @param {number} y - The y-coordinate.\n    //      * @returns {Array} Array containing `x`- and `y`-coordinates of the\n    //      *   point in the PDF coordinate space.\n    //      * @see {@link convertToViewportPoint}\n    //      */\n    //     convertToPdfPoint(x, y) {\n    //         return Util.applyInverseTransform([x, y], this.transform);\n    //     }\n    // }\n    // class RenderingCancelledException extends BaseException {\n    //     constructor(msg, extraDelay = 0) {\n    //         super(msg, \"RenderingCancelledException\");\n    //         this.extraDelay = extraDelay;\n    //     }\n    // }\n    // function isDataScheme(url) {\n    //     const ii = url.length;\n    //     let i = 0;\n    //     while (i < ii && url[i].trim() === \"\") {\n    //         i++;\n    //     }\n    //     return url.substring(i, i + 5).toLowerCase() === \"data:\";\n    // }\n    // function isPdfFile(filename) {\n    //     return typeof filename === \"string\" && /\\.pdf$/i.test(filename);\n    // }\n    // /**\n    //  * Gets the filename from a given URL.\n    //  * @param {string} url\n    //  * @returns {string}\n    //  */\n    // function getFilenameFromUrl(url) {\n    //     [url] = url.split(/[#?]/, 1);\n    //     return url.substring(url.lastIndexOf(\"/\") + 1);\n    // }\n    // /**\n    //  * Returns the filename or guessed filename from the url (see issue 3455).\n    //  * @param {string} url - The original PDF location.\n    //  * @param {string} defaultFilename - The value returned if the filename is\n    //  *   unknown, or the protocol is unsupported.\n    //  * @returns {string} Guessed PDF filename.\n    //  */\n    // function getPdfFilenameFromUrl(url, defaultFilename = \"document.pdf\") {\n    //     if (typeof url !== \"string\") {\n    //         return defaultFilename;\n    //     }\n    //     if (isDataScheme(url)) {\n    //         warn('getPdfFilenameFromUrl: ignore \"data:\"-URL for performance reasons.');\n    //         return defaultFilename;\n    //     }\n    //     const reURI = /^(?:(?:[^:]+:)?\\/\\/[^/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n    //     //              SCHEME        HOST        1.PATH  2.QUERY   3.REF\n    //     // Pattern to get last matching NAME.pdf\n    //     const reFilename = /[^/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n    //     const splitURI = reURI.exec(url);\n    //     let suggestedFilename =\n    //         reFilename.exec(splitURI[1]) ||\n    //         reFilename.exec(splitURI[2]) ||\n    //         reFilename.exec(splitURI[3]);\n    //     if (suggestedFilename) {\n    //         suggestedFilename = suggestedFilename[0];\n    //         if (suggestedFilename.includes(\"%\")) {\n    //             // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n    //             try {\n    //                 suggestedFilename = reFilename.exec(\n    //                     decodeURIComponent(suggestedFilename)\n    //                 )[0];\n    //             } catch {\n    //                 // Possible (extremely rare) errors:\n    //                 // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n    //                 // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n    //             }\n    //         }\n    //     }\n    //     return suggestedFilename || defaultFilename;\n    // }\n    // class StatTimer {\n    //     started = Object.create(null);\n    //     times = [];\n    //     time(name) {\n    //         if (name in this.started) {\n    //             warn(`Timer is already running for ${name}`);\n    //         }\n    //         this.started[name] = Date.now();\n    //     }\n    //     timeEnd(name) {\n    //         if (!(name in this.started)) {\n    //             warn(`Timer has not been started for ${name}`);\n    //         }\n    //         this.times.push({\n    //             name,\n    //             start: this.started[name],\n    //             end: Date.now(),\n    //         });\n    //         // Remove timer from started so it can be called again.\n    //         delete this.started[name];\n    //     }\n    //     toString() {\n    //         // Find the longest name for padding purposes.\n    //         const outBuf = [];\n    //         let longest = 0;\n    //         for (const { name } of this.times) {\n    //             longest = Math.max(name.length, longest);\n    //         }\n    //         for (const { name, start, end } of this.times) {\n    //             outBuf.push(`${name.padEnd(longest)} ${end - start}ms\\n`);\n    //         }\n    //         return outBuf.join(\"\");\n    //     }\n    // }\n    // function isValidFetchUrl(url, baseUrl) {\n    //     if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"MOZCENTRAL\")) {\n    //         throw new Error(\"Not implemented: isValidFetchUrl\");\n    //     }\n    //     try {\n    //         const { protocol } = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    //         // The Fetch API only supports the http/https protocols, and not file/ftp.\n    //         return protocol === \"http:\" || protocol === \"https:\";\n    //     } catch {\n    //         return false; // `new URL()` will throw on incorrect data.\n    //     }\n    // }\n    /**\n     * Event handler to suppress context menu.\n     */\n    function noContextMenu(e) {\n        e.preventDefault();\n    }\n    // // Deprecated API function -- display regardless of the `verbosity` setting.\n    // function deprecated(details) {\n    //     console.log(\"Deprecated API usage: \" + details);\n    // }\n    // let pdfDateStringRegex;\n    // class PDFDateString {\n    //     /**\n    //      * Convert a PDF date string to a JavaScript `Date` object.\n    //      *\n    //      * The PDF date string format is described in section 7.9.4 of the official\n    //      * PDF 32000-1:2008 specification. However, in the PDF 1.7 reference (sixth\n    //      * edition) Adobe describes the same format including a trailing apostrophe.\n    //      * This syntax in incorrect, but Adobe Acrobat creates PDF files that contain\n    //      * them. We ignore all apostrophes as they are not necessary for date parsing.\n    //      *\n    //      * Moreover, Adobe Acrobat doesn't handle changing the date to universal time\n    //      * and doesn't use the user's time zone (effectively ignoring the HH' and mm'\n    //      * parts of the date string).\n    //      *\n    //      * @param {string} input\n    //      * @returns {Date|null}\n    //      */\n    //     static toDateObject(input) {\n    //         if (!input || typeof input !== \"string\") {\n    //             return null;\n    //         }\n    //         // Lazily initialize the regular expression.\n    //         pdfDateStringRegex ||= new RegExp(\n    //             \"^D:\" + // Prefix (required)\n    //             \"(\\\\d{4})\" + // Year (required)\n    //             \"(\\\\d{2})?\" + // Month (optional)\n    //             \"(\\\\d{2})?\" + // Day (optional)\n    //             \"(\\\\d{2})?\" + // Hour (optional)\n    //             \"(\\\\d{2})?\" + // Minute (optional)\n    //             \"(\\\\d{2})?\" + // Second (optional)\n    //             \"([Z|+|-])?\" + // Universal time relation (optional)\n    //             \"(\\\\d{2})?\" + // Offset hour (optional)\n    //             \"'?\" + // Splitting apostrophe (optional)\n    //             \"(\\\\d{2})?\" + // Offset minute (optional)\n    //             \"'?\" // Trailing apostrophe (optional)\n    //         );\n    //         // Optional fields that don't satisfy the requirements from the regular\n    //         // expression (such as incorrect digit counts or numbers that are out of\n    //         // range) will fall back the defaults from the specification.\n    //         const matches = pdfDateStringRegex.exec(input);\n    //         if (!matches) {\n    //             return null;\n    //         }\n    //         // JavaScript's `Date` object expects the month to be between 0 and 11\n    //         // instead of 1 and 12, so we have to correct for that.\n    //         const year = parseInt(matches[1], 10);\n    //         let month = parseInt(matches[2], 10);\n    //         month = month >= 1 && month <= 12 ? month - 1 : 0;\n    //         let day = parseInt(matches[3], 10);\n    //         day = day >= 1 && day <= 31 ? day : 1;\n    //         let hour = parseInt(matches[4], 10);\n    //         hour = hour >= 0 && hour <= 23 ? hour : 0;\n    //         let minute = parseInt(matches[5], 10);\n    //         minute = minute >= 0 && minute <= 59 ? minute : 0;\n    //         let second = parseInt(matches[6], 10);\n    //         second = second >= 0 && second <= 59 ? second : 0;\n    //         const universalTimeRelation = matches[7] || \"Z\";\n    //         let offsetHour = parseInt(matches[8], 10);\n    //         offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;\n    //         let offsetMinute = parseInt(matches[9], 10) || 0;\n    //         offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;\n    //         // Universal time relation 'Z' means that the local time is equal to the\n    //         // universal time, whereas the relations '+'/'-' indicate that the local\n    //         // time is later respectively earlier than the universal time. Every date\n    //         // is normalized to universal time.\n    //         if (universalTimeRelation === \"-\") {\n    //             hour += offsetHour;\n    //             minute += offsetMinute;\n    //         } else if (universalTimeRelation === \"+\") {\n    //             hour -= offsetHour;\n    //             minute -= offsetMinute;\n    //         }\n    //         return new Date(Date.UTC(year, month, day, hour, minute, second));\n    //     }\n    // }\n    // /**\n    //  * NOTE: This is (mostly) intended to support printing of XFA forms.\n    //  */\n    // function getXfaPageViewport(xfaPage, { scale = 1, rotation = 0 }) {\n    //     const { width, height } = xfaPage.attributes.style;\n    //     const viewBox = [0, 0, parseInt(width), parseInt(height)];\n    //     return new PageViewport({\n    //         viewBox,\n    //         scale,\n    //         rotation,\n    //     });\n    // }\n    function getRGB(color) {\n        if (color.startsWith(\"#\")) {\n            const colorRGB = parseInt(color.slice(1), 16);\n            return [\n                (colorRGB & 0xff0000) >> 16,\n                (colorRGB & 0x00ff00) >> 8,\n                colorRGB & 0x0000ff\n            ];\n        }\n        if (color.startsWith(\"rgb(\")) {\n            // getComputedStyle(...).color returns a `rgb(R, G, B)` color.\n            return color\n                .slice(/* \"rgb(\".length */ 4, -1) // Strip out \"rgb(\" and \")\".\n                .split(\",\")\n                .map(x => parseInt(x, 10));\n        }\n        if (color.startsWith(\"rgba(\")) {\n            return color\n                .slice(/* \"rgba(\".length */ 5, -1) // Strip out \"rgba(\" and \")\".\n                .split(\",\")\n                .map(x => parseInt(x, 10))\n                .slice(0, 3);\n        }\n        // warn(`Not a valid color format: \"${color}\"`);\n        return [0, 0, 0];\n    }\n    function getColorValues(colors) {\n        const span = document.createElement(\"span\");\n        span.style.visibility = \"hidden\";\n        document.body.append(span);\n        for (const name of colors.keys()) {\n            span.style.color = name;\n            const computedColor = window.getComputedStyle(span).color;\n            colors.set(name, getRGB(computedColor));\n        }\n        span.remove();\n    }\n    // function getCurrentTransform(ctx) {\n    //     const { a, b, c, d, e, f } = ctx.getTransform();\n    //     return [a, b, c, d, e, f];\n    // }\n    // function getCurrentTransformInverse(ctx) {\n    //     const { a, b, c, d, e, f } = ctx.getTransform().invertSelf();\n    //     return [a, b, c, d, e, f];\n    // }\n    // /**\n    //  * @param {HTMLDivElement} div\n    //  * @param {PageViewport} viewport\n    //  * @param {boolean} mustFlip\n    //  * @param {boolean} mustRotate\n    //  */\n    // function setLayerDimensions(\n    //     div,\n    //     viewport,\n    //     mustFlip = false,\n    //     mustRotate = true\n    // ) {\n    //     if (viewport instanceof PageViewport) {\n    //         const { pageWidth, pageHeight } = viewport.rawDims;\n    //         const { style } = div;\n    //         const useRound = FeatureTest.isCSSRoundSupported;\n    //         const w = `var(--scale-factor) * ${pageWidth}px`,\n    //             h = `var(--scale-factor) * ${pageHeight}px`;\n    //         const widthStr = useRound ? `round(${w}, 1px)` : `calc(${w})`,\n    //             heightStr = useRound ? `round(${h}, 1px)` : `calc(${h})`;\n    //         if (!mustFlip || viewport.rotation % 180 === 0) {\n    //             style.width = widthStr;\n    //             style.height = heightStr;\n    //         } else {\n    //             style.width = heightStr;\n    //             style.height = widthStr;\n    //         }\n    //     }\n    //     if (mustRotate) {\n    //         div.setAttribute(\"data-main-rotation\", viewport.rotation);\n    //     }\n    // }\n    // export {\n    //     // deprecated,\n    //     // DOMCanvasFactory,\n    //     // DOMCMapReaderFactory,\n    //     // DOMFilterFactory,\n    //     // DOMStandardFontDataFactory,\n    //     // DOMSVGFactory,\n    //     // fetchData,\n    //     // getColorValues,\n    //     // getCurrentTransform,\n    //     // getCurrentTransformInverse,\n    //     // getFilenameFromUrl,\n    //     // getPdfFilenameFromUrl,\n    //     // getRGB,\n    //     // getXfaPageViewport,\n    //     // isDataScheme,\n    //     // isPdfFile,\n    //     // isValidFetchUrl,\n    //     // noContextMenu,\n    //     // PageViewport,\n    //     // PDFDateString,\n    //     // PixelsPerInch,\n    //     // RenderingCancelledException,\n    //     setLayerDimensions,\n    //     // StatTimer,\n    // };\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    class ColorManager {\n        get _colors() {\n            if (\n            // typeof PDFJSDev !== \"undefined\" &&\n            // PDFJSDev.test(\"LIB\") &&\n            typeof document === \"undefined\") {\n                return shadow(this, \"_colors\", ColorManager._colorsMapping);\n            }\n            const colors = new Map([\n                [\"CanvasText\", null],\n                [\"Canvas\", null]\n            ]);\n            getColorValues(colors);\n            return shadow(this, \"_colors\", colors);\n        }\n        /*\n         * In High Contrast Mode, the color on the screen is not always the\n         * real color used in the pdf.\n         * For example in some cases white can appear to be black but when saving\n         * we want to have white.\n         * @param {string} color\n         * @returns {Array<number>}\n         */\n        convert(color) {\n            const rgb = getRGB(color);\n            if (!window.matchMedia(\"(forced-colors: active)\").matches) {\n                return rgb;\n            }\n            for (const [name, RGB] of this._colors) {\n                if (RGB.every((x, i) => x === rgb[i])) {\n                    return ColorManager._colorsMapping.get(name);\n                }\n            }\n            return rgb;\n        }\n        /*\n         * An input element must have its color value as a hex string\n         * and not as color name.\n         * So this function converts a name into an hex string.\n         * @param {string} name\n         * @returns {string}\n         */\n        getHexCode(name) {\n            const rgb = this._colors.get(name);\n            if (!rgb) {\n                return name;\n            }\n            // @ts-expect-error TS(2556):\n            return Util.makeHexColor(...rgb);\n        }\n    }\n    ColorManager._colorsMapping = new Map([\n        [\"CanvasText\", [0, 0, 0]],\n        [\"Canvas\", [255, 255, 255]]\n    ]);\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    function bindEvents(obj, element, names) {\n        for (const name of names) {\n            element.addEventListener(name, obj[name].bind(obj));\n        }\n    }\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationEditor_instances, _a$5, _AnnotationEditor_x, _AnnotationEditor_y, _AnnotationEditor_disabled, _AnnotationEditor_keepAspectRatio, _AnnotationEditor_focusAC, _AnnotationEditor_hasBeenClicked, _AnnotationEditor_initialPosition, _AnnotationEditor_isEditing, _AnnotationEditor_isInEditMode, _AnnotationEditor_moveInDOMTimeout, _AnnotationEditor_prevDragX, _AnnotationEditor_prevDragY, _AnnotationEditor_isDraggable, _AnnotationEditor_zIndex, _AnnotationEditor_translate, _AnnotationEditor_rotatePoint, _AnnotationEditor_selectOnPointerEvent, _AnnotationEditor_setUpDragSession, _AnnotationEditor_addFocusListeners, _AnnotationEditor_stopResizing;\n    class AnnotationEditor {\n        constructor(parameters) {\n            // if (this.constructor === AnnotationEditor) {\n            //     unreachable(\"Cannot initialize AnnotationEditor.\");\n            // }\n            _AnnotationEditor_instances.add(this);\n            // todo: properties\n            this.parent = null;\n            this.id = null;\n            this.width = null;\n            this.height = null;\n            this.pageIndex = 0;\n            this.name = \"\";\n            this.div = null;\n            this.annotationElementId = null;\n            this._willKeepAspectRatio = false;\n            // _initialOptions = {};\n            this._structTreeParentId = null;\n            this.rotation = 0;\n            this.pageRotation = 0;\n            this.pageDimensions = [];\n            this.pageTranslation = [];\n            // x = 0;\n            // y = 0;\n            _AnnotationEditor_x.set(this, 0);\n            _AnnotationEditor_y.set(this, 0);\n            this.isAttachedToDOM = false;\n            this.deleted = false;\n            // todo: end\n            // #accessibilityData = null;\n            // #allResizerDivs = null;\n            // #altText = null;\n            _AnnotationEditor_disabled.set(this, false);\n            _AnnotationEditor_keepAspectRatio.set(this, false);\n            // #resizersDiv = null;\n            // #savedDimensions = null;\n            _AnnotationEditor_focusAC.set(this, null);\n            // #focusedResizerName = \"\";\n            _AnnotationEditor_hasBeenClicked.set(this, false);\n            _AnnotationEditor_initialPosition.set(this, null);\n            _AnnotationEditor_isEditing.set(this, false);\n            _AnnotationEditor_isInEditMode.set(this, false);\n            // #isResizerEnabledForKeyboard = false;\n            _AnnotationEditor_moveInDOMTimeout.set(this, null);\n            _AnnotationEditor_prevDragX.set(this, 0);\n            _AnnotationEditor_prevDragY.set(this, 0);\n            // #telemetryTimeouts = null;\n            this._editToolbar = null;\n            this._initialOptions = Object.create(null);\n            this._isVisible = true;\n            this._uiManager = null;\n            this._focusEventsAllowed = true;\n            this._l10nPromise = null;\n            _AnnotationEditor_isDraggable.set(this, false);\n            _AnnotationEditor_zIndex.set(this, _a$5._zIndex++);\n            this.parent = parameters.parent;\n            this.id = parameters.id || _a$5.idManager.id;\n            this.width = this.height = null;\n            this.pageIndex = parameters.parent.pageIndex;\n            this.name = parameters.name;\n            this.div = null;\n            this._uiManager = parameters.uiManager;\n            this.annotationElementId = null;\n            this._willKeepAspectRatio = false;\n            this._initialOptions.isCentered = parameters.isCentered;\n            this._structTreeParentId = null;\n            const { rotation, rawDims: { pageWidth, pageHeight, pageX, pageY } } = this.parent.viewport;\n            this.rotation = rotation;\n            this.pageRotation =\n                (360 + rotation - this._uiManager.viewParameters.rotation) % 360;\n            this.pageDimensions = [pageWidth, pageHeight];\n            this.pageTranslation = [pageX, pageY];\n            const [width, height] = this.parentDimensions;\n            this.x = parameters.x / width;\n            this.y = parameters.y / height;\n            this.isAttachedToDOM = false;\n            this.deleted = false;\n        }\n        get x() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_x, \"f\");\n        }\n        set x(value) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_x, value, \"f\");\n        }\n        get y() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_y, \"f\");\n        }\n        set y(value) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_y, value, \"f\");\n        }\n        get editorType() {\n            return Object.getPrototypeOf(this).constructor._type;\n        }\n        static get _defaultLineColor() {\n            return kendo_pdfjs_loader_js.shadow(this, \"_defaultLineColor\", this._colorManager.getHexCode(\"CanvasText\"));\n        }\n        static deleteAnnotationElement(editor) {\n            const fakeEditor = new FakeEditor({\n                id: editor.parent.getNextId(),\n                parent: editor.parent,\n                uiManager: editor._uiManager,\n            });\n            fakeEditor.annotationElementId = editor.annotationElementId;\n            fakeEditor.deleted = true;\n            fakeEditor._uiManager.addToAnnotationStorage(fakeEditor);\n        }\n        static initialize(l10n, _uiManager, options) {\n            if (!l10n || !_uiManager || !options) {\n                return;\n            }\n            // static initialize() {\n            // AnnotationEditor._l10nPromise ||= new Map(\n            //     [\n            //         \"pdfjs-editor-alt-text-button-label\",\n            //         \"pdfjs-editor-alt-text-edit-button-label\",\n            //         \"pdfjs-editor-alt-text-decorative-tooltip\",\n            //         \"pdfjs-editor-new-alt-text-added-button-label\",\n            //         \"pdfjs-editor-new-alt-text-missing-button-label\",\n            //         \"pdfjs-editor-new-alt-text-to-review-button-label\",\n            //         \"pdfjs-editor-resizer-label-topLeft\",\n            //         \"pdfjs-editor-resizer-label-topMiddle\",\n            //         \"pdfjs-editor-resizer-label-topRight\",\n            //         \"pdfjs-editor-resizer-label-middleRight\",\n            //         \"pdfjs-editor-resizer-label-bottomRight\",\n            //         \"pdfjs-editor-resizer-label-bottomMiddle\",\n            //         \"pdfjs-editor-resizer-label-bottomLeft\",\n            //         \"pdfjs-editor-resizer-label-middleLeft\",\n            //     ].map(str => [\n            //         str,\n            //         l10n.get(str.replaceAll(/([A-Z])/g, c => `-${c.toLowerCase()}`)),\n            //     ])\n            // );\n            // // The string isn't in the above list because the string has a parameter\n            // // (i.e. the guessed text) and we must pass it to the l10n function to get\n            // // the correct translation.\n            // AnnotationEditor._l10nPromise.set(\n            //     \"pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer\",\n            //     l10n.get.bind(\n            //         l10n,\n            //         \"pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer\"\n            //     )\n            // );\n            // if (options?.strings) {\n            //     for (const str of options.strings) {\n            //         AnnotationEditor._l10nPromise.set(str, l10n.get(str));\n            //     }\n            // }\n            // if (AnnotationEditor._borderLineWidth !== -1) {\n            //     return;\n            // }\n            // const style = getComputedStyle(document.documentElement);\n            // AnnotationEditor._borderLineWidth =\n            //     parseFloat(style.getPropertyValue(\"--outline-width\")) || 0;\n        }\n        /**\n         * Update the default parameters for this type of editor.\n         * @param {number} _type\n         * @param {*} _value\n         */\n        static updateDefaultParams(_type, _value) {\n            if (!_type || !_value) {\n                return;\n            }\n        }\n        /**\n         * Get the default properties to set in the UI for this type of editor.\n         * @returns {Array}\n         */\n        static get defaultPropertiesToUpdate() {\n            return [];\n        }\n        /**\n         * Check if this kind of editor is able to handle the given mime type for\n         * pasting.\n         * @param {string} mime\n         * @returns {boolean}\n         */\n        static isHandlingMimeForPasting(mime) {\n            if (!mime) {\n                return;\n            }\n            return false;\n        }\n        /**\n         * Extract the data from the clipboard item and delegate the creation of the\n         * editor to the parent.\n         * @param {DataTransferItem} item\n         * @param {AnnotationEditorLayer} parent\n         */\n        static paste(item, parent) {\n            if (!item || !parent) {\n                return;\n            }\n            // unreachable(\"Not implemented\");\n        }\n        /**\n         * Get the properties to update in the UI for this editor.\n         * @returns {Array}\n         */\n        get propertiesToUpdate() {\n            return [];\n        }\n        get _isDraggable() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_isDraggable, \"f\");\n        }\n        set _isDraggable(value) {\n            var _b;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_isDraggable, value, \"f\");\n            // this.div?.classList.toggle(\"draggable\", value);\n            (_b = this.div) === null || _b === void 0 ? void 0 : _b.classList.toggle(\"k-draggable\", value);\n        }\n        /**\n         * @returns {boolean} true if the editor handles the Enter key itself.\n         */\n        get isEnterHandled() {\n            return true;\n        }\n        center() {\n            const [pageWidth, pageHeight] = this.pageDimensions;\n            switch (this.parentRotation) {\n                case 90:\n                    this.x -= (this.height * pageHeight) / (pageWidth * 2);\n                    this.y += (this.width * pageWidth) / (pageHeight * 2);\n                    break;\n                case 180:\n                    this.x += this.width / 2;\n                    this.y += this.height / 2;\n                    break;\n                case 270:\n                    this.x += (this.height * pageHeight) / (pageWidth * 2);\n                    this.y -= (this.width * pageWidth) / (pageHeight * 2);\n                    break;\n                default:\n                    this.x -= this.width / 2;\n                    this.y -= this.height / 2;\n                    break;\n            }\n            this.fixAndSetPosition();\n        }\n        /**\n         * Add some commands into the CommandManager (undo/redo stuff).\n         * @param {Object} params\n         */\n        addCommands(params) {\n            this._uiManager.addCommands(params);\n        }\n        get currentLayer() {\n            return this._uiManager.currentLayer;\n        }\n        /**\n         * This editor will be behind the others.\n         */\n        setInBackground() {\n            this.div.style.zIndex = 0;\n        }\n        /**\n         * This editor will be in the foreground.\n         */\n        setInForeground() {\n            this.div.style.zIndex = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_zIndex, \"f\");\n        }\n        setParent(parent) {\n            if (parent !== null) {\n                this.pageIndex = parent.pageIndex;\n                this.pageDimensions = parent.pageDimensions;\n            }\n            else {\n                // The editor is being removed from the DOM, so we need to stop resizing.\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_stopResizing).call(this);\n            }\n            this.parent = parent;\n        }\n        /**\n         * onfocus callback.\n         */\n        focusin(event) {\n            if (!event) {\n                return;\n            }\n            if (!this._focusEventsAllowed) {\n                return;\n            }\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_hasBeenClicked, \"f\")) {\n                this.parent.setSelected(this);\n            }\n            else {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_hasBeenClicked, false, \"f\");\n            }\n        }\n        /**\n         * onblur callback.\n         * @param {FocusEvent} event\n         */\n        focusout(event) {\n            var _b;\n            if (!this._focusEventsAllowed) {\n                return;\n            }\n            if (!this.isAttachedToDOM) {\n                return;\n            }\n            // In case of focusout, the relatedTarget is the element which\n            // is grabbing the focus.\n            // So if the related target is an element under the div for this\n            // editor, then the editor isn't unactive.\n            const target = event.relatedTarget;\n            if (target === null || target === void 0 ? void 0 : target.closest(`#${this.id}`)) {\n                return;\n            }\n            event.preventDefault();\n            if (!((_b = this.parent) === null || _b === void 0 ? void 0 : _b.isMultipleSelection)) {\n                this.commitOrRemove();\n            }\n        }\n        commitOrRemove() {\n            if (this.isEmpty()) {\n                this.remove();\n            }\n            else {\n                this.commit();\n            }\n        }\n        /**\n         * Commit the data contained in this editor.\n         */\n        commit() {\n            this.addToAnnotationStorage();\n        }\n        addToAnnotationStorage() {\n            this._uiManager.addToAnnotationStorage(this);\n        }\n        /**\n         * Set the editor position within its parent.\n         * @param {number} x\n         * @param {number} y\n         * @param {number} tx - x-translation in screen coordinates.\n         * @param {number} ty - y-translation in screen coordinates.\n         */\n        setAt(x, y, tx, ty) {\n            const [width, height] = this.parentDimensions;\n            [tx, ty] = this.screenToPageTranslation(tx, ty);\n            this.x = (x + tx) / width;\n            this.y = (y + ty) / height;\n            this.fixAndSetPosition();\n        }\n        /**\n         * Translate the editor position within its parent.\n         * @param {number} x - x-translation in screen coordinates.\n         * @param {number} y - y-translation in screen coordinates.\n         */\n        translate(x, y) {\n            // We don't change the initial position because the move here hasn't been\n            // done by the user.\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_translate).call(this, this.parentDimensions, x, y);\n        }\n        /**\n         * Translate the editor position within its page and adjust the scroll\n         * in order to have the editor in the view.\n         * @param {number} x - x-translation in page coordinates.\n         * @param {number} y - y-translation in page coordinates.\n         */\n        translateInPage(x, y) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_initialPosition, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_initialPosition, \"f\") || [this.x, this.y], \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_translate).call(this, this.pageDimensions, x, y);\n            this.div.scrollIntoView({ block: \"nearest\" });\n        }\n        drag(tx, ty) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_initialPosition, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_initialPosition, \"f\") || [this.x, this.y], \"f\");\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            this.x += tx / parentWidth;\n            this.y += ty / parentHeight;\n            if (this.parent && (this.x < 0 || this.x > 1 || this.y < 0 || this.y > 1)) {\n                // It's possible to not have a parent: for example, when the user is\n                // dragging all the selected editors but this one on a page which has been\n                // destroyed.\n                // It's why we need to check for it. In such a situation, it isn't really\n                // a problem to not find a new parent: it's something which is related to\n                // what the user is seeing, hence it depends on how pages are layed out.\n                // The element will be outside of its parent so change the parent.\n                const { x: xValue, y: yValue } = this.div.getBoundingClientRect();\n                if (this.parent.findNewParent(this, xValue, yValue)) {\n                    this.x -= Math.floor(this.x);\n                    this.y -= Math.floor(this.y);\n                }\n            }\n            // The editor can be moved wherever the user wants, so we don't need to fix\n            // the position: it'll be done when the user will release the mouse button.\n            let { x, y } = this;\n            const [bx, by] = this.getBaseTranslation();\n            x += bx;\n            y += by;\n            this.div.style.left = `${(100 * x).toFixed(2)}%`;\n            this.div.style.top = `${(100 * y).toFixed(2)}%`;\n            this.div.scrollIntoView({ block: \"nearest\" });\n        }\n        get _hasBeenMoved() {\n            return (!!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_initialPosition, \"f\") &&\n                (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_initialPosition, \"f\")[0] !== this.x ||\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_initialPosition, \"f\")[1] !== this.y));\n        }\n        /**\n         * Get the translation to take into account the editor border.\n         * The CSS engine positions the element by taking the border into account so\n         * we must apply the opposite translation to have the editor in the right\n         * position.\n         * @returns {Array<number>}\n         */\n        getBaseTranslation() {\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            const { _borderLineWidth } = _a$5;\n            const x = _borderLineWidth / parentWidth;\n            const y = _borderLineWidth / parentHeight;\n            switch (this.rotation) {\n                case 90:\n                    return [-x, y];\n                case 180:\n                    return [x, y];\n                case 270:\n                    return [x, -y];\n                default:\n                    return [-x, -y];\n            }\n        }\n        /**\n         * @returns {boolean} true if position must be fixed (i.e. make the x and y\n         * living in the page).\n         */\n        get _mustFixPosition() {\n            return true;\n        }\n        /**\n         * Fix the position of the editor in order to keep it inside its parent page.\n         * @param {number} [rotation] - the rotation of the page.\n         */\n        fixAndSetPosition(rotation = this.rotation) {\n            if (rotation === undefined) {\n                return;\n            }\n            const [pageWidth, pageHeight] = this.pageDimensions;\n            let { x, y, width, height } = this;\n            width *= pageWidth;\n            height *= pageHeight;\n            x *= pageWidth;\n            y *= pageHeight;\n            if (this._mustFixPosition) {\n                switch (rotation) {\n                    case 0:\n                        x = Math.max(0, Math.min(pageWidth - width, x));\n                        y = Math.max(0, Math.min(pageHeight - height, y));\n                        break;\n                    case 90:\n                        x = Math.max(0, Math.min(pageWidth - height, x));\n                        y = Math.min(pageHeight, Math.max(width, y));\n                        break;\n                    case 180:\n                        x = Math.min(pageWidth, Math.max(width, x));\n                        y = Math.min(pageHeight, Math.max(height, y));\n                        break;\n                    case 270:\n                        x = Math.min(pageWidth, Math.max(height, x));\n                        y = Math.max(0, Math.min(pageHeight - width, y));\n                        break;\n                    default: break;\n                }\n            }\n            this.x = x /= pageWidth;\n            this.y = y /= pageHeight;\n            const [bx, by] = this.getBaseTranslation();\n            x += bx;\n            y += by;\n            const { style } = this.div;\n            style.left = `${(100 * x).toFixed(2)}%`;\n            style.top = `${(100 * y).toFixed(2)}%`;\n            this.moveInDOM();\n        }\n        /**\n         * Convert a screen translation into a page one.\n         * @param {number} x\n         * @param {number} y\n         */\n        screenToPageTranslation(x, y) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(_a$5, _a$5, \"m\", _AnnotationEditor_rotatePoint).call(_a$5, x, y, this.parentRotation);\n        }\n        /**\n         * Convert a page translation into a screen one.\n         * @param {number} x\n         * @param {number} y\n         */\n        pageTranslationToScreen(x, y) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(_a$5, _a$5, \"m\", _AnnotationEditor_rotatePoint).call(_a$5, x, y, 360 - this.parentRotation);\n        }\n        // #getRotationMatrix(rotation) {\n        //     switch (rotation) {\n        //         case 90: {\n        //             const [pageWidth, pageHeight] = this.pageDimensions;\n        //             return [0, -pageWidth / pageHeight, pageHeight / pageWidth, 0];\n        //         }\n        //         case 180:\n        //             return [-1, 0, 0, -1];\n        //         case 270: {\n        //             const [pageWidth, pageHeight] = this.pageDimensions;\n        //             return [0, pageWidth / pageHeight, -pageHeight / pageWidth, 0];\n        //         }\n        //         default:\n        //             return [1, 0, 0, 1];\n        //     }\n        // }\n        get parentScale() {\n            return this._uiManager.viewParameters.realScale;\n        }\n        get parentRotation() {\n            return (this._uiManager.viewParameters.rotation + this.pageRotation) % 360;\n        }\n        get parentDimensions() {\n            const { parentScale, pageDimensions: [pageWidth, pageHeight] } = this;\n            const scaledWidth = pageWidth * parentScale;\n            const scaledHeight = pageHeight * parentScale;\n            return kendo_pdfjs_loader_js.FeatureTest.isCSSRoundSupported\n                ? [Math.round(scaledWidth), Math.round(scaledHeight)]\n                : [scaledWidth, scaledHeight];\n        }\n        /**\n         * Set the dimensions of this editor.\n         * @param {number} width\n         * @param {number} height\n         */\n        setDims(width, height) {\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            this.div.style.width = `${((100 * width) / parentWidth).toFixed(2)}%`;\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_keepAspectRatio, \"f\")) {\n                this.div.style.height = `${((100 * height) / parentHeight).toFixed(2)}%`;\n            }\n        }\n        fixDims() {\n            //     const { style } = this.div;\n            //     const { height, width } = style;\n            //     const widthPercent = width.endsWith(\"%\");\n            //     const heightPercent = !this.#keepAspectRatio && height.endsWith(\"%\");\n            //     if (widthPercent && heightPercent) {\n            //         return;\n            //     }\n            //     const [parentWidth, parentHeight] = this.parentDimensions;\n            //     if (!widthPercent) {\n            //         style.width = `${((100 * parseFloat(width)) / parentWidth).toFixed(2)}%`;\n            //     }\n            //     if (!this.#keepAspectRatio && !heightPercent) {\n            //         style.height = `${((100 * parseFloat(height)) / parentHeight).toFixed(\n            //             2\n            //         )}%`;\n            //     }\n        }\n        /**\n         * Get the translation used to position this editor when it's created.\n         * @returns {Array<number>}\n         */\n        getInitialTranslation() {\n            return [0, 0];\n        }\n        // #createResizers() {\n        //     if (this.#resizersDiv) {\n        //         return;\n        //     }\n        //     this.#resizersDiv = document.createElement(\"div\");\n        //     this.#resizersDiv.classList.add(\"resizers\");\n        //     // When the resizers are used with the keyboard, they're focusable, hence\n        //     // we want to have them in this order (top left, top middle, top right, ...)\n        //     // in the DOM to have the focus order correct.\n        //     const classes = this._willKeepAspectRatio\n        //         ? [\"topLeft\", \"topRight\", \"bottomRight\", \"bottomLeft\"]\n        //         : [\n        //             \"topLeft\",\n        //             \"topMiddle\",\n        //             \"topRight\",\n        //             \"middleRight\",\n        //             \"bottomRight\",\n        //             \"bottomMiddle\",\n        //             \"bottomLeft\",\n        //             \"middleLeft\",\n        //         ];\n        //     const signal = this._uiManager._signal;\n        //     for (const name of classes) {\n        //         const div = document.createElement(\"div\");\n        //         this.#resizersDiv.append(div);\n        //         div.classList.add(\"resizer\", name);\n        //         div.setAttribute(\"data-resizer-name\", name);\n        //         div.addEventListener(\n        //             \"pointerdown\",\n        //             this.#resizerPointerdown.bind(this, name),\n        //             { signal }\n        //         );\n        //         div.addEventListener(\"contextmenu\", noContextMenu, { signal });\n        //         div.tabIndex = -1;\n        //     }\n        //     this.div.prepend(this.#resizersDiv);\n        // }\n        // #resizerPointerdown(name, event) {\n        //     event.preventDefault();\n        //     const { isMac } = FeatureTest.platform;\n        //     if (event.button !== 0 || (event.ctrlKey && isMac)) {\n        //         return;\n        //     }\n        //     this.#altText?.toggle(false);\n        //     const savedDraggable = this._isDraggable;\n        //     this._isDraggable = false;\n        //     const ac = new AbortController();\n        //     const signal = this._uiManager.combinedSignal(ac);\n        //     this.parent.togglePointerEvents(false);\n        //     window.addEventListener(\n        //         \"pointermove\",\n        //         this.#resizerPointermove.bind(this, name),\n        //         { passive: true, capture: true, signal }\n        //     );\n        //     window.addEventListener(\"contextmenu\", noContextMenu, { signal });\n        //     const savedX = this.x;\n        //     const savedY = this.y;\n        //     const savedWidth = this.width;\n        //     const savedHeight = this.height;\n        //     const savedParentCursor = this.parent.div.style.cursor;\n        //     const savedCursor = this.div.style.cursor;\n        //     this.div.style.cursor = this.parent.div.style.cursor =\n        //         window.getComputedStyle(event.target).cursor;\n        //     const pointerUpCallback = () => {\n        //         ac.abort();\n        //         this.parent.togglePointerEvents(true);\n        //         this.#altText?.toggle(true);\n        //         this._isDraggable = savedDraggable;\n        //         this.parent.div.style.cursor = savedParentCursor;\n        //         this.div.style.cursor = savedCursor;\n        //         this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n        //     };\n        //     window.addEventListener(\"pointerup\", pointerUpCallback, { signal });\n        //     // If the user switches to another window (with alt+tab), then we end the\n        //     // resize session.\n        //     window.addEventListener(\"blur\", pointerUpCallback, { signal });\n        // }\n        // #addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight) {\n        //     const newX = this.x;\n        //     const newY = this.y;\n        //     const newWidth = this.width;\n        //     const newHeight = this.height;\n        //     if (\n        //         newX === savedX &&\n        //         newY === savedY &&\n        //         newWidth === savedWidth &&\n        //         newHeight === savedHeight\n        //     ) {\n        //         return;\n        //     }\n        //     this.addCommands({\n        //         cmd: () => {\n        //             this.width = newWidth;\n        //             this.height = newHeight;\n        //             this.x = newX;\n        //             this.y = newY;\n        //             const [parentWidth, parentHeight] = this.parentDimensions;\n        //             this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n        //             this.fixAndSetPosition();\n        //         },\n        //         undo: () => {\n        //             this.width = savedWidth;\n        //             this.height = savedHeight;\n        //             this.x = savedX;\n        //             this.y = savedY;\n        //             const [parentWidth, parentHeight] = this.parentDimensions;\n        //             this.setDims(parentWidth * savedWidth, parentHeight * savedHeight);\n        //             this.fixAndSetPosition();\n        //         },\n        //         mustExec: true,\n        //     });\n        // }\n        // #resizerPointermove(name, event) {\n        //     const [parentWidth, parentHeight] = this.parentDimensions;\n        //     const savedX = this.x;\n        //     const savedY = this.y;\n        //     const savedWidth = this.width;\n        //     const savedHeight = this.height;\n        //     const minWidth = AnnotationEditor.MIN_SIZE / parentWidth;\n        //     const minHeight = AnnotationEditor.MIN_SIZE / parentHeight;\n        //     // 10000 because we multiply by 100 and use toFixed(2) in fixAndSetPosition.\n        //     // Without rounding, the positions of the corners other than the top left\n        //     // one can be slightly wrong.\n        //     const round = x => Math.round(x * 10000) / 10000;\n        //     const rotationMatrix = this.#getRotationMatrix(this.rotation);\n        //     const transf = (x, y) => [\n        //         rotationMatrix[0] * x + rotationMatrix[2] * y,\n        //         rotationMatrix[1] * x + rotationMatrix[3] * y,\n        //     ];\n        //     const invRotationMatrix = this.#getRotationMatrix(360 - this.rotation);\n        //     const invTransf = (x, y) => [\n        //         invRotationMatrix[0] * x + invRotationMatrix[2] * y,\n        //         invRotationMatrix[1] * x + invRotationMatrix[3] * y,\n        //     ];\n        //     let getPoint;\n        //     let getOpposite;\n        //     let isDiagonal = false;\n        //     let isHorizontal = false;\n        //     switch (name) {\n        //         case \"topLeft\":\n        //             isDiagonal = true;\n        //             getPoint = (w, h) => [0, 0];\n        //             getOpposite = (w, h) => [w, h];\n        //             break;\n        //         case \"topMiddle\":\n        //             getPoint = (w, h) => [w / 2, 0];\n        //             getOpposite = (w, h) => [w / 2, h];\n        //             break;\n        //         case \"topRight\":\n        //             isDiagonal = true;\n        //             getPoint = (w, h) => [w, 0];\n        //             getOpposite = (w, h) => [0, h];\n        //             break;\n        //         case \"middleRight\":\n        //             isHorizontal = true;\n        //             getPoint = (w, h) => [w, h / 2];\n        //             getOpposite = (w, h) => [0, h / 2];\n        //             break;\n        //         case \"bottomRight\":\n        //             isDiagonal = true;\n        //             getPoint = (w, h) => [w, h];\n        //             getOpposite = (w, h) => [0, 0];\n        //             break;\n        //         case \"bottomMiddle\":\n        //             getPoint = (w, h) => [w / 2, h];\n        //             getOpposite = (w, h) => [w / 2, 0];\n        //             break;\n        //         case \"bottomLeft\":\n        //             isDiagonal = true;\n        //             getPoint = (w, h) => [0, h];\n        //             getOpposite = (w, h) => [w, 0];\n        //             break;\n        //         case \"middleLeft\":\n        //             isHorizontal = true;\n        //             getPoint = (w, h) => [0, h / 2];\n        //             getOpposite = (w, h) => [w, h / 2];\n        //             break;\n        //     }\n        //     const point = getPoint(savedWidth, savedHeight);\n        //     const oppositePoint = getOpposite(savedWidth, savedHeight);\n        //     let transfOppositePoint = transf(...oppositePoint);\n        //     const oppositeX = round(savedX + transfOppositePoint[0]);\n        //     const oppositeY = round(savedY + transfOppositePoint[1]);\n        //     let ratioX = 1;\n        //     let ratioY = 1;\n        //     let [deltaX, deltaY] = this.screenToPageTranslation(\n        //         event.movementX,\n        //         event.movementY\n        //     );\n        //     [deltaX, deltaY] = invTransf(deltaX / parentWidth, deltaY / parentHeight);\n        //     if (isDiagonal) {\n        //         const oldDiag = Math.hypot(savedWidth, savedHeight);\n        //         ratioX = ratioY = Math.max(\n        //             Math.min(\n        //                 Math.hypot(\n        //                     oppositePoint[0] - point[0] - deltaX,\n        //                     oppositePoint[1] - point[1] - deltaY\n        //                 ) / oldDiag,\n        //                 // Avoid the editor to be larger than the page.\n        //                 1 / savedWidth,\n        //                 1 / savedHeight\n        //             ),\n        //             // Avoid the editor to be smaller than the minimum size.\n        //             minWidth / savedWidth,\n        //             minHeight / savedHeight\n        //         );\n        //     } else if (isHorizontal) {\n        //         ratioX =\n        //             Math.max(\n        //                 minWidth,\n        //                 Math.min(1, Math.abs(oppositePoint[0] - point[0] - deltaX))\n        //             ) / savedWidth;\n        //     } else {\n        //         ratioY =\n        //             Math.max(\n        //                 minHeight,\n        //                 Math.min(1, Math.abs(oppositePoint[1] - point[1] - deltaY))\n        //             ) / savedHeight;\n        //     }\n        //     const newWidth = round(savedWidth * ratioX);\n        //     const newHeight = round(savedHeight * ratioY);\n        //     transfOppositePoint = transf(...getOpposite(newWidth, newHeight));\n        //     const newX = oppositeX - transfOppositePoint[0];\n        //     const newY = oppositeY - transfOppositePoint[1];\n        //     this.width = newWidth;\n        //     this.height = newHeight;\n        //     this.x = newX;\n        //     this.y = newY;\n        //     this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n        //     this.fixAndSetPosition();\n        // }\n        // /**\n        //  * Called when the alt text dialog is closed.\n        //  */\n        // altTextFinish() {\n        //     this.#altText?.finish();\n        // }\n        // /**\n        //  * Add a toolbar for this editor.\n        //  * @returns {Promise<EditorToolbar|null>}\n        //  */\n        // async addEditToolbar() {\n        addEditToolbar() {\n            var _b;\n            (_b = this._uiManager) === null || _b === void 0 ? void 0 : _b.showEditorToolBar(this.div);\n            // if (this._editToolbar || this.#isInEditMode) {\n            //     return this._editToolbar;\n            // }\n            // this._editToolbar = new EditorToolbar(this);\n            // this.div.append(this._editToolbar.render());\n            // if (this.#altText) {\n            //     this._editToolbar.addAltTextButton(await this.#altText.render());\n            // }\n            // return this._editToolbar;\n        }\n        removeEditToolbar() {\n            this._uiManager.hideEditorToolBar();\n            // if (!this._editToolbar) {\n            //     return;\n            // }\n            // this._editToolbar.remove();\n            // this._editToolbar = null;\n            // // We destroy the alt text but we don't null it because we want to be able\n            // // to restore it in case the user undoes the deletion.\n            // this.#altText?.destroy();\n        }\n        getClientDimensions() {\n            return this.div.getBoundingClientRect();\n        }\n        // async addAltTextButton() {\n        //     if (this.#altText) {\n        //         return;\n        //     }\n        //     AltText.initialize(AnnotationEditor._l10nPromise);\n        //     this.#altText = new AltText(this);\n        //     if (this.#accessibilityData) {\n        //         this.#altText.data = this.#accessibilityData;\n        //         this.#accessibilityData = null;\n        //     }\n        //     await this.addEditToolbar();\n        // }\n        // get altTextData() {\n        //     return this.#altText?.data;\n        // }\n        // /**\n        //  * Set the alt text data.\n        //  */\n        // set altTextData(data) {\n        //     if (!this.#altText) {\n        //         return;\n        //     }\n        //     this.#altText.data = data;\n        // }\n        // get guessedAltText() {\n        //     return this.#altText?.guessedText;\n        // }\n        // async setGuessedAltText(text) {\n        //     await this.#altText?.setGuessedText(text);\n        // }\n        // serializeAltText(isForCopying) {\n        //     return this.#altText?.serialize(isForCopying);\n        // }\n        // hasAltText() {\n        //     return !!this.#altText && !this.#altText.isEmpty();\n        // }\n        // hasAltTextData() {\n        //     return this.#altText?.hasData() ?? false;\n        // }\n        /**\n         * Render this editor in a div.\n         * @returns {HTMLDivElement | null}\n         */\n        render() {\n            this.div = document.createElement(\"div\");\n            this.div.setAttribute(\"data-editor-rotation\", (360 - this.rotation) % 360);\n            this.div.className = this.name;\n            this.div.setAttribute(\"id\", this.id);\n            this.div.tabIndex = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_disabled, \"f\") ? -1 : 0;\n            if (!this._isVisible) {\n                // this.div.classList.add(\"hidden\");\n                this.div.classList.add(\"k-hidden\");\n            }\n            this.setInForeground();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_addFocusListeners).call(this);\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            if (this.parentRotation % 180 !== 0) {\n                this.div.style.maxWidth = `${((100 * parentHeight) / parentWidth).toFixed(2)}%`;\n                this.div.style.maxHeight = `${((100 * parentWidth) /\n                parentHeight).toFixed(2)}%`;\n            }\n            const [tx, ty] = this.getInitialTranslation();\n            this.translate(tx, ty);\n            bindEvents(this, this.div, [\"pointerdown\"]);\n            return this.div;\n        }\n        /**\n         * Onpointerdown callback.\n         * @param {PointerEvent} event\n         */\n        pointerdown(event) {\n            var _b;\n            const { isMac } = kendo_pdfjs_loader_js.FeatureTest.platform;\n            if (event.button !== 0 || (event.ctrlKey && isMac)) {\n                // Avoid to focus this editor because of a non-left click.\n                event.preventDefault();\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_hasBeenClicked, true, \"f\");\n            if (this._isDraggable) {\n                (_b = this._uiManager) === null || _b === void 0 ? void 0 : _b.hideEditorToolBar();\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_setUpDragSession).call(this, event);\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_selectOnPointerEvent).call(this, event);\n        }\n        moveInDOM() {\n            // Moving the editor in the DOM can be expensive, so we wait a bit before.\n            // It's important to not block the UI (for example when changing the font\n            // size in a FreeText).\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_moveInDOMTimeout, \"f\")) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_moveInDOMTimeout, \"f\"));\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_moveInDOMTimeout, setTimeout(() => {\n                var _b;\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_moveInDOMTimeout, null, \"f\");\n                (_b = this.parent) === null || _b === void 0 ? void 0 : _b.moveEditorInDOM(this);\n            }, 0), \"f\");\n        }\n        _setParentAndPosition(parent, x, y) {\n            parent.changeParent(this);\n            this.x = x;\n            this.y = y;\n            this.fixAndSetPosition();\n        }\n        /*\n         * Convert the current rect into a page one.\n         * @param {number} tx - x-translation in screen coordinates.\n         * @param {number} ty - y-translation in screen coordinates.\n         * @param {number} [rotation] - the rotation of the page.\n         */\n        getRect(tx, ty, rotation = this.rotation) {\n            const scale = this.parentScale;\n            const [pageWidth, pageHeight] = this.pageDimensions;\n            const [pageX, pageY] = this.pageTranslation;\n            const shiftX = tx / scale;\n            const shiftY = ty / scale;\n            const x = this.x * pageWidth;\n            const y = this.y * pageHeight;\n            const width = this.width * pageWidth;\n            const height = this.height * pageHeight;\n            switch (rotation) {\n                case 0:\n                    return [\n                        x + shiftX + pageX,\n                        pageHeight - y - shiftY - height + pageY,\n                        x + shiftX + width + pageX,\n                        pageHeight - y - shiftY + pageY\n                    ];\n                case 90:\n                    return [\n                        x + shiftY + pageX,\n                        pageHeight - y + shiftX + pageY,\n                        x + shiftY + height + pageX,\n                        pageHeight - y + shiftX + width + pageY\n                    ];\n                case 180:\n                    return [\n                        x - shiftX - width + pageX,\n                        pageHeight - y + shiftY + pageY,\n                        x - shiftX + pageX,\n                        pageHeight - y + shiftY + height + pageY\n                    ];\n                case 270:\n                    return [\n                        x - shiftY - height + pageX,\n                        pageHeight - y - shiftX - width + pageY,\n                        x - shiftY + pageX,\n                        pageHeight - y - shiftX + pageY\n                    ];\n                default:\n                    throw new Error(\"Invalid rotation\");\n            }\n        }\n        getRectInCurrentCoords(rect, pageHeight) {\n            const [x1, y1, x2, y2] = rect;\n            const width = x2 - x1;\n            const height = y2 - y1;\n            switch (this.rotation) {\n                case 0:\n                    return [x1, pageHeight - y2, width, height];\n                case 90:\n                    return [x1, pageHeight - y1, height, width];\n                case 180:\n                    return [x2, pageHeight - y1, width, height];\n                case 270:\n                    return [x2, pageHeight - y2, height, width];\n                default:\n                    // throw new Error(\"Invalid rotation\");\n                    break;\n            }\n        }\n        // /**\n        //  * Executed once this editor has been rendered.\n        //  */\n        onceAdded() { }\n        // /**\n        //  * Check if the editor contains something.\n        //  * @returns {boolean}\n        //  */\n        isEmpty() {\n            return false;\n        }\n        /**\n         * Enable edit mode.\n         */\n        enableEditMode() {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_isInEditMode, true, \"f\");\n        }\n        /**\n         * Disable edit mode.\n         */\n        disableEditMode() {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_isInEditMode, false, \"f\");\n        }\n        /**\n         * Check if the editor is edited.\n         * @returns {boolean}\n         */\n        isInEditMode() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_isInEditMode, \"f\");\n        }\n        // /**\n        //  * If it returns true, then this editor handles the keyboard\n        //  * events itself.\n        //  * @returns {boolean}\n        //  */\n        // shouldGetKeyboardEvents() {\n        //     return this.#isResizerEnabledForKeyboard;\n        // }\n        /**\n         * Check if this editor needs to be rebuilt or not.\n         * @returns {boolean}\n         */\n        needsToBeRebuilt() {\n            return this.div && !this.isAttachedToDOM;\n        }\n        /**\n         * Rebuild the editor in case it has been removed on undo.\n         *\n         * To implement in subclasses.\n         */\n        rebuild() {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_addFocusListeners).call(this);\n        }\n        /**\n         * Rotate the editor.\n         * @param {number} angle\n         */\n        rotate(angle) {\n            if (angle === undefined || angle === null) {\n                return;\n            }\n        }\n        /**\n         * Serialize the editor.\n         * The result of the serialization will be used to construct a\n         * new annotation to add to the pdf document.\n         *\n         * To implement in subclasses.\n         * @param {boolean} [isForCopying]\n         * @param {Object | null} [context]\n         * @returns {Object | null}\n         */\n        // @ts-expect-error (TS)\n        // eslint-disable-next-line\n        serialize(isForCopying = false, context = null) {\n            // serialize() {\n        }\n        /**\n         * Deserialize the editor.\n         * The result of the deserialization is a new editor.\n         *\n         * @param {Object} data\n         * @param {AnnotationEditorLayer} parent\n         * @param {AnnotationEditorUIManager} uiManager\n         * @returns {AnnotationEditor | null}\n         */\n        static deserialize(data, parent, uiManager) {\n            // @ts-expect-error TS(2556):\n            const editor = new this.prototype.constructor({\n                parent,\n                id: parent.getNextId(),\n                uiManager,\n            });\n            editor.rotation = data.rotation;\n            // editor.#accessibilityData = data.accessibilityData;\n            const [pageWidth, pageHeight] = editor.pageDimensions;\n            const [x, y, width, height] = editor.getRectInCurrentCoords(data.rect, pageHeight);\n            editor.x = x / pageWidth;\n            editor.y = y / pageHeight;\n            editor.width = width / pageWidth;\n            editor.height = height / pageHeight;\n            return editor;\n        }\n        /**\n         * Check if an existing annotation associated with this editor has been\n         * modified.\n         * @returns {boolean}\n         */\n        get hasBeenModified() {\n            return (!!this.annotationElementId && (this.deleted || this.serialize() !== null));\n        }\n        /**\n         * Remove this editor.\n         * It's used on ctrl+backspace action.\n         */\n        remove() {\n            var _b;\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_focusAC, \"f\")) === null || _b === void 0 ? void 0 : _b.abort();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_focusAC, null, \"f\");\n            if (!this.isEmpty()) {\n                // The editor is removed but it can be back at some point thanks to\n                // undo/redo so we must commit it before.\n                this.commit();\n            }\n            if (this.parent) {\n                this.parent.remove(this);\n            }\n            else {\n                this._uiManager.removeEditor(this);\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_moveInDOMTimeout, \"f\")) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_moveInDOMTimeout, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_moveInDOMTimeout, null, \"f\");\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_stopResizing).call(this);\n            this.removeEditToolbar();\n            // if (this.#telemetryTimeouts) {\n            //     for (const timeout of this.#telemetryTimeouts.values()) {\n            //         clearTimeout(timeout);\n            //     }\n            //     this.#telemetryTimeouts = null;\n            // }\n            this.parent = null;\n        }\n        /**\n         * @returns {boolean} true if this editor can be resized.\n         */\n        get isResizable() {\n            return false;\n        }\n        /**\n         * Add the resizers to this editor.\n         */\n        makeResizable() {\n            //     if (this.isResizable) {\n            //         this.#createResizers();\n            //         this.#resizersDiv.classList.remove(\"hidden\");\n            //         this.#resizersDiv.classList.remove(\"k-hidden\");\n            //         bindEvents(this, this.div, [\"keydown\"]);\n            //     }\n        }\n        get toolbarPosition() {\n            return null;\n        }\n        _stopResizingWithKeyboard() {\n            //     this.#stopResizing();\n            //     this.div.focus();\n        }\n        /**\n         * Select this editor.\n         */\n        select() {\n            var _b;\n            // this.makeResizable();\n            // this.div?.classList.add(\"selectedEditor\");\n            (_b = this.div) === null || _b === void 0 ? void 0 : _b.classList.add(\"k-selected\");\n            // todo: manually show annotation toolbar\n            this.addEditToolbar();\n            // if (!this._editToolbar) {\n            //     this.addEditToolbar().then(() => {\n            //         if (this.div?.classList.contains(\"k-selected selectedEditor\")) {\n            //             // The editor can have been unselected while we were waiting for the\n            //             // edit toolbar to be created, hence we want to be sure that this\n            //             // editor is still selected.\n            //             this._editToolbar?.show();\n            //         }\n            //     });\n            //     return;\n            // }\n            // this._editToolbar?.show();\n            // this.#altText?.toggleAltTextBadge(false);\n        }\n        /**\n         * Unselect this editor.\n         */\n        unselect() {\n            var _b, _c;\n            // this.#resizersDiv?.classList.add(\"hidden\");\n            // this.div?.classList.remove(\"selectedEditor\");\n            (_b = this.div) === null || _b === void 0 ? void 0 : _b.classList.remove(\"k-selected\");\n            if ((_c = this.div) === null || _c === void 0 ? void 0 : _c.contains(document.activeElement)) {\n                // Don't use this.div.blur() because we don't know where the focus will\n                // go.\n                this._uiManager.currentLayer.div.focus({\n                    preventScroll: true,\n                });\n            }\n            // this._editToolbar?.hide();\n            // this.#altText?.toggleAltTextBadge(true);\n        }\n        /**\n         * Update some parameters which have been changed through the UI.\n         * @param {number} type\n         * @param {*} value\n         */\n        updateParams(type, value) {\n            if (type === undefined || !value) {\n                return;\n            }\n        }\n        /**\n         * When the user disables the editing mode some editors can change some of\n         * their properties.\n         */\n        disableEditing() { }\n        /**\n         * When the user enables the editing mode some editors can change some of\n         * their properties.\n         */\n        enableEditing() { }\n        /**\n         * The editor is about to be edited.\n         */\n        enterInEditMode() { }\n        /**\n         * @returns {HTMLElement | null} the element requiring an alt text.\n         */\n        getImageForAltText() {\n            return null;\n        }\n        /**\n         * Get the div which really contains the displayed content.\n         * @returns {HTMLDivElement | undefined}\n         */\n        get contentDiv() {\n            return this.div;\n        }\n        /**\n         * If true then the editor is currently edited.\n         * @type {boolean}\n         */\n        get isEditing() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_isEditing, \"f\");\n        }\n        /**\n         * When set to true, it means that this editor is currently edited.\n         * @param {boolean} value\n         */\n        set isEditing(value) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_isEditing, value, \"f\");\n            if (!this.parent) {\n                return;\n            }\n            if (value) {\n                this.parent.setSelected(this);\n                this.parent.setActiveEditor(this);\n            }\n            else {\n                this.parent.setActiveEditor(null);\n            }\n        }\n        /**\n         * Set the aspect ratio to use when resizing.\n         * @param {number} width\n         * @param {number} height\n         */\n        setAspectRatio(width, height) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_keepAspectRatio, true, \"f\");\n            const aspectRatio = width / height;\n            const { style } = this.div;\n            style.aspectRatio = aspectRatio;\n            style.height = \"auto\";\n        }\n        static get MIN_SIZE() {\n            return 16;\n        }\n        static canCreateNewEmptyEditor() {\n            return true;\n        }\n        /**\n         * Get the data to report to the telemetry when the editor is added.\n         * @returns {Object}\n         */\n        get telemetryInitialData() {\n            return { action: \"added\" };\n        }\n        /**\n         * The telemetry data to use when saving/printing.\n         * @returns {Object|null}\n         */\n        get telemetryFinalData() {\n            return null;\n        }\n        _reportTelemetry() {\n        }\n        // _reportTelemetry(data, mustWait = false) {\n        //     if (mustWait) {\n        //         this.#telemetryTimeouts ||= new Map();\n        //         const { action } = data;\n        //         let timeout = this.#telemetryTimeouts.get(action);\n        //         if (timeout) {\n        //             clearTimeout(timeout);\n        //         }\n        //         timeout = setTimeout(() => {\n        //             this._reportTelemetry(data);\n        //             this.#telemetryTimeouts.delete(action);\n        //             if (this.#telemetryTimeouts.size === 0) {\n        //                 this.#telemetryTimeouts = null;\n        //             }\n        //         }, AnnotationEditor._telemetryTimeout);\n        //         this.#telemetryTimeouts.set(action, timeout);\n        //         return;\n        //     }\n        //     data.type ||= this.editorType;\n        //     this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n        //         source: this,\n        //         details: {\n        //             type: \"editing\",\n        //             data,\n        //         },\n        //     });\n        // }\n        /**\n         * Show or hide this editor.\n         * @param {boolean|undefined} visible\n         */\n        show(visible = this._isVisible) {\n            // this.div.classList.toggle(\"hidden\", !visible);\n            this.div.classList.toggle(\"k-hidden\", !visible);\n            this._isVisible = visible;\n        }\n        enable() {\n            if (this.div) {\n                this.div.tabIndex = 0;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_disabled, false, \"f\");\n        }\n        disable() {\n            if (this.div) {\n                this.div.tabIndex = -1;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_disabled, true, \"f\");\n        }\n        /**\n         * Render an annotation in the annotation layer.\n         * @param {Object} annotation\n         * @returns {HTMLElement}\n         */\n        renderAnnotationElement(annotation) {\n            let content = annotation.container.querySelector(\".annotationContent\") ||\n                annotation.container.querySelector(\".k-annotation-content \");\n            if (!content) {\n                content = document.createElement(\"div\");\n                // content.classList.add(\"annotationContent\", this.editorType);\n                content.classList.add(\"k-annotation-content \", this.editorType);\n                annotation.container.prepend(content);\n            }\n            else if (content.nodeName === \"CANVAS\") {\n                const canvas = content;\n                content = document.createElement(\"div\");\n                // content.classList.add(\"annotationContent\", this.editorType);\n                content.classList.add(\"k-annotation-content \", this.editorType);\n                canvas.before(content);\n            }\n            return content;\n        }\n        resetAnnotationElement(annotation) {\n            const { firstChild } = annotation.container;\n            if (firstChild.nodeName === \"DIV\" &&\n                (firstChild.classList.contains(\"annotationContent\") ||\n                    firstChild.classList.contains(\"k-annotation-content \"))) {\n                firstChild.remove();\n            }\n        }\n    }\n    _a$5 = AnnotationEditor, _AnnotationEditor_x = new WeakMap(), _AnnotationEditor_y = new WeakMap(), _AnnotationEditor_disabled = new WeakMap(), _AnnotationEditor_keepAspectRatio = new WeakMap(), _AnnotationEditor_focusAC = new WeakMap(), _AnnotationEditor_hasBeenClicked = new WeakMap(), _AnnotationEditor_initialPosition = new WeakMap(), _AnnotationEditor_isEditing = new WeakMap(), _AnnotationEditor_isInEditMode = new WeakMap(), _AnnotationEditor_moveInDOMTimeout = new WeakMap(), _AnnotationEditor_prevDragX = new WeakMap(), _AnnotationEditor_prevDragY = new WeakMap(), _AnnotationEditor_isDraggable = new WeakMap(), _AnnotationEditor_zIndex = new WeakMap(), _AnnotationEditor_instances = new WeakSet(), _AnnotationEditor_translate = function _AnnotationEditor_translate([width, height], x, y) {\n        [x, y] = this.screenToPageTranslation(x, y);\n        this.x += x / width;\n        this.y += y / height;\n        this.fixAndSetPosition();\n    }, _AnnotationEditor_rotatePoint = function _AnnotationEditor_rotatePoint(x, y, angle) {\n        switch (angle) {\n            case 90:\n                return [y, -x];\n            case 180:\n                return [-x, -y];\n            case 270:\n                return [-y, x];\n            default:\n                return [x, y];\n        }\n    }, _AnnotationEditor_selectOnPointerEvent = function _AnnotationEditor_selectOnPointerEvent(event) {\n        const { isMac } = kendo_pdfjs_loader_js.FeatureTest.platform;\n        const highlightEditor = event.target.closest(\".k-highlight-editor\");\n        const freeTextEditor = event.target.closest(\".k-free-text-editor\");\n        const annotationEditorMode = this._uiManager.getMode();\n        // todo: manually prevent selecting a highlight annotation in freetext mode\n        if ((annotationEditorMode === AnnotationEditorType.HIGHLIGHT && !highlightEditor) ||\n            (annotationEditorMode === AnnotationEditorType.FREETEXT && !freeTextEditor)) {\n            return;\n        }\n        if ((event.ctrlKey && !isMac) ||\n            event.shiftKey ||\n            (event.metaKey && isMac)) {\n            this.parent.toggleSelected(this);\n        }\n        else {\n            this.parent.setSelected(this);\n        }\n    }, _AnnotationEditor_setUpDragSession = function _AnnotationEditor_setUpDragSession(event) {\n        const isSelected = this._uiManager.isSelected(this);\n        this._uiManager.setUpDragSession();\n        const ac = new AbortController();\n        const signal = this._uiManager.combinedSignal(ac);\n        if (isSelected) {\n            // this.div.classList.add(\"moving\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_prevDragX, event.clientX, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_prevDragY, event.clientY, \"f\");\n            const pointerMoveCallback = e => {\n                const { clientX: x, clientY: y } = e;\n                const [tx, ty] = this.screenToPageTranslation(x - kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_prevDragX, \"f\"), y - kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_prevDragY, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_prevDragX, x, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_prevDragY, y, \"f\");\n                this._uiManager.dragSelectedEditors(tx, ty);\n            };\n            window.addEventListener(\"pointermove\", pointerMoveCallback, {\n                passive: true,\n                capture: true,\n                signal,\n            });\n        }\n        const pointerUpCallback = () => {\n            ac.abort();\n            if (isSelected) {\n                this.div.classList.remove(\"moving\");\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_hasBeenClicked, false, \"f\");\n            if (!this._uiManager.endDragSession()) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_instances, \"m\", _AnnotationEditor_selectOnPointerEvent).call(this, event);\n            }\n        };\n        window.addEventListener(\"pointerup\", pointerUpCallback, { signal });\n        // If the user is using alt+tab during the dragging session, the pointerup\n        // event could be not fired, but a blur event is fired so we can use it in\n        // order to interrupt the dragging session.\n        window.addEventListener(\"blur\", pointerUpCallback, { signal });\n    }, _AnnotationEditor_addFocusListeners = function _AnnotationEditor_addFocusListeners() {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_focusAC, \"f\") || !this.div) {\n            return;\n        }\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditor_focusAC, new AbortController(), \"f\");\n        const signal = this._uiManager.combinedSignal(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditor_focusAC, \"f\"));\n        this.div.addEventListener(\"focusin\", this.focusin.bind(this), { signal });\n        this.div.addEventListener(\"focusout\", this.focusout.bind(this), { signal });\n    }, _AnnotationEditor_stopResizing = function _AnnotationEditor_stopResizing() {\n        // this.#isResizerEnabledForKeyboard = false;\n        // this.#setResizerTabIndex(-1);\n        // if (this.#savedDimensions) {\n        //     const { savedX, savedY, savedWidth, savedHeight } = this.#savedDimensions;\n        //     this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n        //     this.#savedDimensions = null;\n        // }\n    };\n    AnnotationEditor.idManager = new IdManager(\"annotation_editor_id_\");\n    AnnotationEditor._borderLineWidth = -1;\n    AnnotationEditor._colorManager = new ColorManager();\n    AnnotationEditor._zIndex = 1;\n    // Time to wait (in ms) before sending the telemetry data.\n    // We wait a bit to avoid sending too many requests when changing something\n    // like the thickness of a line.\n    AnnotationEditor._telemetryTimeout = 1000;\n    // This class is used to fake an editor which has been deleted.\n    class FakeEditor extends AnnotationEditor {\n        constructor(params) {\n            super(params);\n            this.annotationElementId = params.annotationElementId;\n            this.deleted = true;\n        }\n        serialize() {\n            return {\n                id: this.annotationElementId,\n                deleted: true,\n                pageIndex: this.pageIndex,\n            };\n        }\n    }\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _FreeTextEditor_instances, _a$4, _FreeTextEditor_color, _FreeTextEditor_content, _FreeTextEditor_editorDivId, _FreeTextEditor_editModeAC, _FreeTextEditor_fontSize, _FreeTextEditor_initialData, _FreeTextEditor_updateFontSize, _FreeTextEditor_updateColor, _FreeTextEditor_extractText, _FreeTextEditor_setEditorDimensions, _FreeTextEditor_getNodeContent, _FreeTextEditor_setContent, _FreeTextEditor_serializeContent, _FreeTextEditor_deserializeContent, _FreeTextEditor_hasElementChanged;\n    // import { FreeTextAnnotationElement } from \"../annotation-layer\";\n    const EOL_PATTERN = /\\r\\n?|\\n/g;\n    class FreeTextEditor extends AnnotationEditor {\n        constructor(params) {\n            super(Object.assign(Object.assign({}, params), { name: \"k-free-text-editor freeTextEditor\" }));\n            _FreeTextEditor_instances.add(this);\n            // todo: props\n            this.editorDiv = null;\n            this.overlayDiv = null;\n            // todo: props\n            _FreeTextEditor_color.set(this, void 0);\n            _FreeTextEditor_content.set(this, \"\");\n            _FreeTextEditor_editorDivId.set(this, `${this.id}-editor`);\n            _FreeTextEditor_editModeAC.set(this, null);\n            _FreeTextEditor_fontSize.set(this, void 0);\n            _FreeTextEditor_initialData.set(this, null);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_color, params.color ||\n                _a$4._defaultColor ||\n                AnnotationEditor._defaultLineColor, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_fontSize, params.fontSize || _a$4._defaultFontSize, \"f\");\n        }\n        /** @inheritdoc */\n        static initialize(l10n, uiManager) {\n            AnnotationEditor.initialize(l10n, uiManager, {\n                strings: [\"pdfjs-free-text-default-content\"],\n            });\n            const style = getComputedStyle(document.documentElement);\n            // if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n            //     const lineHeight = parseFloat(\n            //         style.getPropertyValue(\"--freetext-line-height\")\n            //     );\n            //     assert(\n            //         lineHeight === LINE_FACTOR,\n            //         \"Update the CSS variable to agree with the constant.\"\n            //     );\n            // }\n            // todo: read the variable\n            this._internalPadding = parseFloat(style.getPropertyValue(\"--freetext-padding\")) || 2;\n        }\n        /** @inheritdoc */\n        static updateDefaultParams(type, value) {\n            switch (type) {\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_SIZE:\n                    _a$4._defaultFontSize = value;\n                    break;\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_COLOR:\n                    _a$4._defaultColor = value;\n                    break;\n                default: break;\n            }\n        }\n        /** @inheritdoc */\n        updateParams(type, value) {\n            switch (type) {\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_SIZE:\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_updateFontSize).call(this, value);\n                    break;\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_COLOR:\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_updateColor).call(this, value);\n                    break;\n                default: break;\n            }\n        }\n        /** @inheritdoc */\n        static get defaultPropertiesToUpdate() {\n            return [\n                [\n                    kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_SIZE,\n                    _a$4._defaultFontSize,\n                ],\n                [\n                    kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_COLOR,\n                    _a$4._defaultColor || AnnotationEditor._defaultLineColor,\n                ],\n            ];\n        }\n        /** @inheritdoc */\n        get propertiesToUpdate() {\n            return [\n                [kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_SIZE, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\")],\n                [kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_COLOR, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_color, \"f\")],\n            ];\n        }\n        /**\n         * Helper to translate the editor with the keyboard when it's empty.\n         * @param {number} x in page units.\n         * @param {number} y in page units.\n         */\n        _translateEmpty(x, y) {\n            this._uiManager.translateSelectedEditors(x, y, /* noCommit = */ true);\n        }\n        getInitialTranslation() {\n            // The start of the base line is where the user clicked.\n            const scale = this.parentScale;\n            return [\n                -_a$4._internalPadding * scale,\n                -(_a$4._internalPadding + kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\")) * scale,\n            ];\n        }\n        /** @inheritdoc */\n        rebuild() {\n            if (!this.parent) {\n                return;\n            }\n            super.rebuild();\n            if (this.div === null) {\n                return;\n            }\n            if (!this.isAttachedToDOM) {\n                // At some point this editor was removed and we're rebuilting it,\n                // hence we must add it to its parent.\n                this.parent.add(this);\n            }\n        }\n        enableEditMode() {\n            if (this.isInEditMode()) {\n                return;\n            }\n            this.parent.setEditingState(false);\n            this.parent.updateToolbar(kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT);\n            super.enableEditMode();\n            this.overlayDiv.classList.remove(\"enabled\");\n            this.editorDiv.contentEditable = true;\n            this._isDraggable = false;\n            this.div.removeAttribute(\"aria-activedescendant\");\n            // if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"TESTING\")) {\n            //     assert(\n            //         !this.#editModeAC,\n            //         \"No `this.#editModeAC` AbortController should exist.\"\n            //     );\n            // }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_editModeAC, new AbortController(), \"f\");\n            const signal = this._uiManager.combinedSignal(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_editModeAC, \"f\"));\n            this.editorDiv.addEventListener(\"keydown\", this.editorDivKeydown.bind(this), { signal });\n            this.editorDiv.addEventListener(\"focus\", this.editorDivFocus.bind(this), {\n                signal,\n            });\n            this.editorDiv.addEventListener(\"blur\", this.editorDivBlur.bind(this), {\n                signal,\n            });\n            this.editorDiv.addEventListener(\"input\", this.editorDivInput.bind(this), {\n                signal,\n            });\n            this.editorDiv.addEventListener(\"paste\", this.editorDivPaste.bind(this), {\n                signal,\n            });\n        }\n        disableEditMode() {\n            var _b;\n            if (!this.isInEditMode()) {\n                return;\n            }\n            this.parent.setEditingState(true);\n            super.disableEditMode();\n            // this.overlayDiv.classList.add(\"enabled\");\n            this.editorDiv.contentEditable = false;\n            this.div.setAttribute(\"aria-activedescendant\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_editorDivId, \"f\"));\n            this._isDraggable = true;\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_editModeAC, \"f\")) === null || _b === void 0 ? void 0 : _b.abort();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_editModeAC, null, \"f\");\n            // On Chrome, the focus is given to <body> when contentEditable is set to\n            // false, hence we focus the div.\n            this.div.focus({\n                preventScroll: true /* See issue #15744 */,\n            });\n            // In case the blur callback hasn't been called.\n            this.isEditing = false;\n            // this.parent.div.classList.add(\"freetextEditing\");\n        }\n        focusin(event) {\n            var _b;\n            if (!this._focusEventsAllowed) {\n                return;\n            }\n            if (((_b = this._uiManager) === null || _b === void 0 ? void 0 : _b.getMode()) !== kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT) {\n                // prevent focusing the freetext editor while in highlight mode\n                // in pdf.js this situation does free highlight annotation isntead\n                // which is not currently implemented\n                return;\n            }\n            super.focusin(event);\n            if (event.target !== this.editorDiv) {\n                this.editorDiv.focus();\n            }\n        }\n        /** @inheritdoc */\n        onceAdded() {\n            var _b;\n            if (this.width) {\n                // The editor was created in using ctrl+c.\n                return;\n            }\n            this.enableEditMode();\n            this.editorDiv.focus();\n            if ((_b = this._initialOptions) === null || _b === void 0 ? void 0 : _b.isCentered) {\n                this.center();\n            }\n            this._initialOptions = null;\n        }\n        /** @inheritdoc */\n        isEmpty() {\n            var _b, _c;\n            return !this.editorDiv || ((_c = (_b = this.editorDiv) === null || _b === void 0 ? void 0 : _b.innerText) === null || _c === void 0 ? void 0 : _c.trim()) === \"\";\n        }\n        /** @inheritdoc */\n        remove() {\n            this.isEditing = false;\n            if (this.parent) {\n                this.parent.setEditingState(true);\n                // this.parent.div.classList.add(\"freetextEditing\");\n            }\n            super.remove();\n        }\n        /**\n         * Commit the content we have in this editor.\n         * @returns {undefined}\n         */\n        commit() {\n            if (!this.isInEditMode()) {\n                return;\n            }\n            super.commit();\n            this.disableEditMode();\n            const savedText = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_content, \"f\");\n            const newText = (kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_content, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_extractText).call(this).trimEnd(), \"f\"));\n            if (savedText === newText) {\n                return;\n            }\n            const setText = text => {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_content, text, \"f\");\n                if (!text) {\n                    this.remove();\n                    return;\n                }\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_setContent).call(this);\n                this._uiManager.rebuild(this);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_setEditorDimensions).call(this);\n            };\n            this.addCommands({\n                cmd: () => {\n                    setText(newText);\n                },\n                undo: () => {\n                    setText(savedText);\n                },\n                mustExec: false,\n            });\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_setEditorDimensions).call(this);\n        }\n        /** @inheritdoc */\n        shouldGetKeyboardEvents() {\n            return this.isInEditMode();\n        }\n        /** @inheritdoc */\n        enterInEditMode() {\n            this.enableEditMode();\n            this.editorDiv.focus();\n        }\n        /**\n         * ondblclick callback.\n         * @param {MouseEvent} event\n         */\n        dblclick(event) {\n            if (!event) {\n                return;\n            }\n            this.enterInEditMode();\n        }\n        /**\n         * onkeydown callback.\n         * @param {KeyboardEvent} event\n         */\n        keydown(event) {\n            if (event.target === this.div && event.key === \"Enter\") {\n                this.enterInEditMode();\n                // Avoid to add an unwanted new line.\n                event.preventDefault();\n            }\n        }\n        editorDivKeydown() {\n            // FreeTextEditor._keyboardManager.exec(this, event);\n        }\n        editorDivFocus() {\n            this.isEditing = true;\n        }\n        editorDivBlur() {\n            this.isEditing = false;\n        }\n        editorDivInput() {\n            // this.parent.div.classList.toggle(\"freetextEditing\", this.isEmpty());\n        }\n        /** @inheritdoc */\n        disableEditing() {\n            this.editorDiv.setAttribute(\"role\", \"comment\");\n            this.editorDiv.removeAttribute(\"aria-multiline\");\n        }\n        /** @inheritdoc */\n        enableEditing() {\n            this.editorDiv.setAttribute(\"role\", \"textbox\");\n            this.editorDiv.setAttribute(\"aria-multiline\", true);\n        }\n        /** @inheritdoc */\n        render() {\n            var _b;\n            if (this.div) {\n                return this.div;\n            }\n            let baseX, baseY;\n            if (this.width) {\n                baseX = this.x;\n                baseY = this.y;\n            }\n            super.render();\n            this.editorDiv = document.createElement(\"div\");\n            this.editorDiv.className = \"k-internal internal\";\n            // todo: move to CSS\n            // this.editorDiv.style.position = \"absolute\";\n            // this.div.style.position = \"absolute\";\n            this.editorDiv.setAttribute(\"id\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_editorDivId, \"f\"));\n            this.editorDiv.setAttribute(\"data-l10n-id\", \"pdfjs-free-text\");\n            this.enableEditing();\n            // AnnotationEditor._l10nPromise\n            //     .get(\"pdfjs-free-text-default-content\")\n            //     .then(msg => this.editorDiv?.setAttribute(\"default-content\", msg));\n            // todo: fix localization\n            (_b = this.editorDiv) === null || _b === void 0 ? void 0 : _b.setAttribute(\"default-content\", this._uiManager.pdfViewer.options.messages.freeTextEditorPlaceholder);\n            this.editorDiv.contentEditable = true;\n            const { style } = this.editorDiv;\n            style.fontSize = `calc(${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\")}px * var(--scale-factor))`;\n            style.color = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_color, \"f\");\n            this.div.append(this.editorDiv);\n            this.overlayDiv = document.createElement(\"div\");\n            // this.overlayDiv.classList.add(\"overlay\", \"enabled\");\n            this.div.append(this.overlayDiv);\n            bindEvents(this, this.div, [\"dblclick\", \"keydown\"]);\n            if (this.width) {\n                // This editor was created in using copy (ctrl+c).\n                const [parentWidth, parentHeight] = this.parentDimensions;\n                if (this.annotationElementId) {\n                    // This stuff is hard to test: if something is changed here, please\n                    // test with the following PDF file:\n                    //  - freetexts.pdf\n                    //  - rotated_freetexts.pdf\n                    // Only small variations between the original annotation and its editor\n                    // are allowed.\n                    // position is the position of the first glyph in the annotation\n                    // and it's relative to its container.\n                    const { position } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_initialData, \"f\");\n                    let [tx, ty] = this.getInitialTranslation();\n                    [tx, ty] = this.pageTranslationToScreen(tx, ty);\n                    const [pageWidth, pageHeight] = this.pageDimensions;\n                    const [pageX, pageY] = this.pageTranslation;\n                    let posX, posY;\n                    switch (this.rotation) {\n                        case 0:\n                            posX = baseX + (position[0] - pageX) / pageWidth;\n                            posY = baseY + this.height - (position[1] - pageY) / pageHeight;\n                            break;\n                        case 90:\n                            posX = baseX + (position[0] - pageX) / pageWidth;\n                            posY = baseY - (position[1] - pageY) / pageHeight;\n                            [tx, ty] = [ty, -tx];\n                            break;\n                        case 180:\n                            posX = baseX - this.width + (position[0] - pageX) / pageWidth;\n                            posY = baseY - (position[1] - pageY) / pageHeight;\n                            [tx, ty] = [-tx, -ty];\n                            break;\n                        case 270:\n                            posX =\n                                baseX +\n                                    (position[0] - pageX - this.height * pageHeight) / pageWidth;\n                            posY =\n                                baseY +\n                                    (position[1] - pageY - this.width * pageWidth) / pageHeight;\n                            [tx, ty] = [-ty, tx];\n                            break;\n                        default: break;\n                    }\n                    this.setAt(posX * parentWidth, posY * parentHeight, tx, ty);\n                }\n                else {\n                    this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n                }\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_setContent).call(this);\n                this._isDraggable = true;\n                this.editorDiv.contentEditable = false;\n            }\n            else {\n                this._isDraggable = false;\n                this.editorDiv.contentEditable = true;\n            }\n            // if (typeof PDFJSDev !== \"undefined\" && PDFJSDev.test(\"TESTING\")) {\n            //     this.div.setAttribute(\"annotation-id\", this.annotationElementId);\n            // }\n            return this.div;\n        }\n        editorDivPaste(event) {\n            // @ts-expect-error TS(2551):\n            const clipboardData = event.clipboardData || window.clipboardData;\n            const { types } = clipboardData;\n            if (types.length === 1 && types[0] === \"text/plain\") {\n                return;\n            }\n            event.preventDefault();\n            const paste = kendo_dateinputsCommon_cmn_chunk_js.a(_a$4, _a$4, \"m\", _FreeTextEditor_deserializeContent).call(_a$4, clipboardData.getData(\"text\") || \"\").replaceAll(EOL_PATTERN, \"\\n\");\n            if (!paste) {\n                return;\n            }\n            const selection = window.getSelection();\n            if (!selection.rangeCount) {\n                return;\n            }\n            this.editorDiv.normalize();\n            selection.deleteFromDocument();\n            const range = selection.getRangeAt(0);\n            if (!paste.includes(\"\\n\")) {\n                range.insertNode(document.createTextNode(paste));\n                this.editorDiv.normalize();\n                selection.collapseToStart();\n                return;\n            }\n            // Collect the text before and after the caret.\n            const { startContainer, startOffset } = range;\n            const bufferBefore = [];\n            const bufferAfter = [];\n            if (startContainer.nodeType === Node.TEXT_NODE) {\n                const parent = startContainer.parentElement;\n                bufferAfter.push(\n                // @ts-expect-error TS(2556):\n                startContainer.nodeValue.slice(startOffset).replaceAll(EOL_PATTERN, \"\"));\n                if (parent !== this.editorDiv) {\n                    let buffer = bufferBefore;\n                    for (const child of this.editorDiv.childNodes) {\n                        if (child === parent) {\n                            buffer = bufferAfter;\n                            continue;\n                        }\n                        buffer.push(kendo_dateinputsCommon_cmn_chunk_js.a(_a$4, _a$4, \"m\", _FreeTextEditor_getNodeContent).call(_a$4, child));\n                    }\n                }\n                bufferBefore.push(startContainer.nodeValue\n                    .slice(0, startOffset)\n                    // @ts-expect-error TS(2556):\n                    .replaceAll(EOL_PATTERN, \"\"));\n            }\n            else if (startContainer === this.editorDiv) {\n                let buffer = bufferBefore;\n                let i = 0;\n                for (const child of this.editorDiv.childNodes) {\n                    if (i++ === startOffset) {\n                        buffer = bufferAfter;\n                    }\n                    buffer.push(kendo_dateinputsCommon_cmn_chunk_js.a(_a$4, _a$4, \"m\", _FreeTextEditor_getNodeContent).call(_a$4, child));\n                }\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_content, `${bufferBefore.join(\"\\n\")}${paste}${bufferAfter.join(\"\\n\")}`, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_setContent).call(this);\n            // Set the caret at the right position.\n            const newRange = new Range();\n            let beforeLength = bufferBefore.reduce((acc, line) => acc + line.length, 0);\n            for (const { firstChild } of this.editorDiv.childNodes) {\n                // Each child is either a div with a text node or a br element.\n                if (firstChild.nodeType === Node.TEXT_NODE) {\n                    const length = firstChild.nodeValue.length;\n                    if (beforeLength <= length) {\n                        newRange.setStart(firstChild, beforeLength);\n                        newRange.setEnd(firstChild, beforeLength);\n                        break;\n                    }\n                    beforeLength -= length;\n                }\n            }\n            selection.removeAllRanges();\n            selection.addRange(newRange);\n        }\n        /** @inheritdoc */\n        get contentDiv() {\n            return this.editorDiv;\n        }\n        /** @inheritdoc */\n        static deserialize(data, parent, uiManager) {\n            let initialData = null;\n            if (data instanceof FreeTextAnnotationElement) {\n                const { data: { defaultAppearanceData: { fontSize, fontColor }, rect, rotation, id, }, textContent, textPosition, parent: { page: { pageNumber }, }, } = data;\n                // textContent is supposed to be an array of strings containing each line\n                // of text. However, it can be null or empty.\n                if (!textContent || textContent.length === 0) {\n                    // Empty annotation.\n                    return null;\n                }\n                initialData = data = {\n                    annotationType: kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT,\n                    color: Array.from(fontColor),\n                    fontSize,\n                    value: textContent.join(\"\\n\"),\n                    position: textPosition,\n                    pageIndex: pageNumber - 1,\n                    rect: rect.slice(0),\n                    rotation,\n                    id,\n                    deleted: false,\n                };\n            }\n            const editor = super.deserialize(data, parent, uiManager);\n            kendo_dateinputsCommon_cmn_chunk_js._(editor, _FreeTextEditor_fontSize, data.fontSize, \"f\");\n            // @ts-expect-error TS(2556):\n            kendo_dateinputsCommon_cmn_chunk_js._(editor, _FreeTextEditor_color, kendo_pdfjs_loader_js.Util.makeHexColor(...data.color), \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(editor, _FreeTextEditor_content, kendo_dateinputsCommon_cmn_chunk_js.a(_a$4, _a$4, \"m\", _FreeTextEditor_deserializeContent).call(_a$4, data.value), \"f\");\n            editor.annotationElementId = data.id || null;\n            kendo_dateinputsCommon_cmn_chunk_js._(editor, _FreeTextEditor_initialData, initialData, \"f\");\n            return editor;\n        }\n        /** @inheritdoc */\n        serialize(isForCopying = false) {\n            if (this.isEmpty()) {\n                return null;\n            }\n            if (this.deleted) {\n                return {\n                    pageIndex: this.pageIndex,\n                    id: this.annotationElementId,\n                    deleted: true,\n                };\n            }\n            const padding = _a$4._internalPadding * this.parentScale;\n            const rect = this.getRect(padding, padding);\n            const color = AnnotationEditor._colorManager.convert(this.isAttachedToDOM\n                ? getComputedStyle(this.editorDiv).color\n                : kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_color, \"f\"));\n            const serialized = {\n                annotationType: kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT,\n                color,\n                fontSize: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\"),\n                value: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_serializeContent).call(this),\n                pageIndex: this.pageIndex,\n                rect,\n                rotation: this.rotation,\n                structTreeParentId: this._structTreeParentId,\n            };\n            if (isForCopying) {\n                // Don't add the id when copying because the pasted editor mustn't be\n                // linked to an existing annotation.\n                return serialized;\n            }\n            if (this.annotationElementId && !kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_hasElementChanged).call(this, serialized)) {\n                return null;\n            }\n            // @ts-expect-error TS(2556):\n            serialized.id = this.annotationElementId;\n            return serialized;\n        }\n        /** @inheritdoc */\n        renderAnnotationElement(annotation) {\n            const content = super.renderAnnotationElement(annotation);\n            if (this.deleted) {\n                return content;\n            }\n            const { style } = content;\n            style.fontSize = `calc(${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\")}px * var(--scale-factor))`;\n            style.color = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_color, \"f\");\n            content.replaceChildren();\n            for (const line of kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_content, \"f\").split(\"\\n\")) {\n                const div = document.createElement(\"div\");\n                div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n                content.append(div);\n            }\n            const padding = _a$4._internalPadding * this.parentScale;\n            annotation.updateEdited({\n                rect: this.getRect(padding, padding),\n                popupContent: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_content, \"f\"),\n            });\n            return content;\n        }\n        resetAnnotationElement(annotation) {\n            super.resetAnnotationElement(annotation);\n            annotation.resetEdited();\n        }\n        // todo: this is necessary\n        // saveDocument() has checks that test \"editor instanceof AnnotationEditor\", but they fail\n        // because AnnotationEditor from \"pdfjs-dist/legacy/build/pdf.mjs\" is not exported\n        // thus replace instances of editors with their serialized version\n        toJSON() {\n            const data = this.serialize();\n            return data;\n        }\n    }\n    _a$4 = FreeTextEditor, _FreeTextEditor_color = new WeakMap(), _FreeTextEditor_content = new WeakMap(), _FreeTextEditor_editorDivId = new WeakMap(), _FreeTextEditor_editModeAC = new WeakMap(), _FreeTextEditor_fontSize = new WeakMap(), _FreeTextEditor_initialData = new WeakMap(), _FreeTextEditor_instances = new WeakSet(), _FreeTextEditor_updateFontSize = function _FreeTextEditor_updateFontSize(fontSize) {\n        const setFontsize = size => {\n            this.editorDiv.style.fontSize = `calc(${size}px * var(--scale-factor))`;\n            this.translate(0, -(size - kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\")) * this.parentScale);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_fontSize, size, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_instances, \"m\", _FreeTextEditor_setEditorDimensions).call(this);\n        };\n        const savedFontsize = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_fontSize, \"f\");\n        this.addCommands({\n            cmd: setFontsize.bind(this, fontSize),\n            undo: setFontsize.bind(this, savedFontsize),\n            post: this._uiManager.updateUI.bind(this._uiManager, this),\n            mustExec: true,\n            type: kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_SIZE,\n            overwriteIfSameType: true,\n            keepUndo: true,\n        });\n    }, _FreeTextEditor_updateColor = function _FreeTextEditor_updateColor(color) {\n        const setColor = col => {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeTextEditor_color, this.editorDiv.style.color = col, \"f\");\n        };\n        const savedColor = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_color, \"f\");\n        this.addCommands({\n            cmd: setColor.bind(this, color),\n            undo: setColor.bind(this, savedColor),\n            post: this._uiManager.updateUI.bind(this._uiManager, this),\n            mustExec: true,\n            type: kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_COLOR,\n            overwriteIfSameType: true,\n            keepUndo: true,\n        });\n    }, _FreeTextEditor_extractText = function _FreeTextEditor_extractText() {\n        // We don't use innerText because there are some bugs with line breaks.\n        const buffer = [];\n        this.editorDiv.normalize();\n        for (const child of this.editorDiv.childNodes) {\n            buffer.push(kendo_dateinputsCommon_cmn_chunk_js.a(_a$4, _a$4, \"m\", _FreeTextEditor_getNodeContent).call(_a$4, child));\n        }\n        return buffer.join(\"\\n\");\n    }, _FreeTextEditor_setEditorDimensions = function _FreeTextEditor_setEditorDimensions() {\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        let rect;\n        if (this.isAttachedToDOM) {\n            rect = this.div.getBoundingClientRect();\n        }\n        else {\n            // This editor isn't on screen but we need to get its dimensions, so\n            // we just insert it in the DOM, get its bounding box and then remove it.\n            const { currentLayer, div } = this;\n            const savedDisplay = div.style.display;\n            const savedVisibility = div.classList.contains(\"hidden\") || div.classList.contains(\"k-hidden\");\n            div.classList.remove(\"hidden\");\n            div.classList.remove(\"k-hidden\");\n            div.style.display = \"hidden\";\n            currentLayer.div.append(this.div);\n            rect = div.getBoundingClientRect();\n            div.remove();\n            div.style.display = savedDisplay;\n            // div.classList.toggle(\"hidden\", savedVisibility);\n            div.classList.toggle(\"k-hidden\", savedVisibility);\n        }\n        // The dimensions are relative to the rotation of the page, hence we need to\n        // take that into account (see issue #16636).\n        if (this.rotation % 180 === this.parentRotation % 180) {\n            this.width = rect.width / parentWidth;\n            this.height = rect.height / parentHeight;\n        }\n        else {\n            this.width = rect.height / parentWidth;\n            this.height = rect.width / parentHeight;\n        }\n        this.fixAndSetPosition();\n    }, _FreeTextEditor_getNodeContent = function _FreeTextEditor_getNodeContent(node) {\n        return (node.nodeType === Node.TEXT_NODE ? node.nodeValue : node.innerText).replaceAll(EOL_PATTERN, \"\");\n    }, _FreeTextEditor_setContent = function _FreeTextEditor_setContent() {\n        this.editorDiv.replaceChildren();\n        if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_content, \"f\")) {\n            return;\n        }\n        for (const line of kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_content, \"f\").split(\"\\n\")) {\n            const div = document.createElement(\"div\");\n            div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n            this.editorDiv.append(div);\n        }\n    }, _FreeTextEditor_serializeContent = function _FreeTextEditor_serializeContent() {\n        // @ts-expect-error TS(2556):\n        return kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_content, \"f\").replaceAll(\"\\xa0\", \" \");\n    }, _FreeTextEditor_deserializeContent = function _FreeTextEditor_deserializeContent(content) {\n        return content.replaceAll(\" \", \"\\xa0\");\n    }, _FreeTextEditor_hasElementChanged = function _FreeTextEditor_hasElementChanged(serialized) {\n        const { value, fontSize, color, pageIndex } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeTextEditor_initialData, \"f\");\n        return (this._hasBeenMoved ||\n            serialized.value !== value ||\n            serialized.fontSize !== fontSize ||\n            serialized.color.some((c, i) => c !== color[i]) ||\n            serialized.pageIndex !== pageIndex);\n    };\n    FreeTextEditor._freeTextDefaultContent = \"\";\n    FreeTextEditor._internalPadding = 0;\n    // static _defaultColor = null;\n    FreeTextEditor._defaultColor = \"#000000\";\n    FreeTextEditor._defaultFontSize = 10;\n    // static get _keyboardManager() {\n    //     const proto = FreeTextEditor.prototype;\n    //     const arrowChecker = self => self.isEmpty();\n    //     const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    //     const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n    //     return shadow(\n    //         this,\n    //         \"_keyboardManager\",\n    //         new KeyboardManager([\n    //             [\n    //                 // Commit the text in case the user use ctrl+s to save the document.\n    //                 // The event must bubble in order to be caught by the viewer.\n    //                 // See bug 1831574.\n    //                 [\"ctrl+s\", \"mac+meta+s\", \"ctrl+p\", \"mac+meta+p\"],\n    //                 proto.commitOrRemove,\n    //                 { bubbles: true },\n    //             ],\n    //             [\n    //                 [\"ctrl+Enter\", \"mac+meta+Enter\", \"Escape\", \"mac+Escape\"],\n    //                 proto.commitOrRemove,\n    //             ],\n    //             [\n    //                 [\"ArrowLeft\", \"mac+ArrowLeft\"],\n    //                 proto._translateEmpty,\n    //                 { args: [-small, 0], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"],\n    //                 proto._translateEmpty,\n    //                 { args: [-big, 0], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ArrowRight\", \"mac+ArrowRight\"],\n    //                 proto._translateEmpty,\n    //                 { args: [small, 0], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"],\n    //                 proto._translateEmpty,\n    //                 { args: [big, 0], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ArrowUp\", \"mac+ArrowUp\"],\n    //                 proto._translateEmpty,\n    //                 { args: [0, -small], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"],\n    //                 proto._translateEmpty,\n    //                 { args: [0, -big], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ArrowDown\", \"mac+ArrowDown\"],\n    //                 proto._translateEmpty,\n    //                 { args: [0, small], checker: arrowChecker },\n    //             ],\n    //             [\n    //                 [\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"],\n    //                 proto._translateEmpty,\n    //                 { args: [0, big], checker: arrowChecker },\n    //             ],\n    //         ])\n    //     );\n    // }\n    FreeTextEditor._type = \"freetext\";\n    FreeTextEditor._editorType = kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT;\n\n    /* Copyright 2023 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _Outliner_instances, _Outliner_box, _Outliner_verticalEdges, _Outliner_intervals, _Outliner_getOutlines, _Outliner_binarySearch, _Outliner_insert, _Outliner_remove, _Outliner_breakEdge, _HighlightOutline_box, _HighlightOutline_outlines, _FreeOutliner_instances, _a$3, _FreeOutliner_box, _FreeOutliner_bottom, _FreeOutliner_innerMargin, _FreeOutliner_isLTR, _FreeOutliner_top, _FreeOutliner_last, _FreeOutliner_lastX, _FreeOutliner_lastY, _FreeOutliner_min, _FreeOutliner_min_dist, _FreeOutliner_scaleFactor, _FreeOutliner_thickness, _FreeOutliner_points, _FreeOutliner_MIN_DIST, _FreeOutliner_MIN_DIFF, _FreeOutliner_MIN, _FreeOutliner_getLastCoords, _FreeHighlightOutline_instances, _FreeHighlightOutline_box, _FreeHighlightOutline_bbox, _FreeHighlightOutline_innerMargin, _FreeHighlightOutline_isLTR, _FreeHighlightOutline_points, _FreeHighlightOutline_scaleFactor, _FreeHighlightOutline_outline, _FreeHighlightOutline_rescale, _FreeHighlightOutline_rescaleAndSwap, _FreeHighlightOutline_computeMinMax;\n    // import { Util } from \"../../shared/utils\";\n    class Outliner {\n        /*\n         * Construct an outliner.\n         * @param {Array<Object>} boxes - An array of axis-aligned rectangles.\n         * @param {number} borderWidth - The width of the border of the boxes, it\n         *   allows to make the boxes bigger (or smaller).\n         * @param {number} innerMargin - The margin between the boxes and the\n         *   outlines. It's important to not have a null innerMargin when we want to\n         *   draw the outline else the stroked outline could be clipped because of its\n         *   width.\n         * @param {boolean} isLTR - true if we're in LTR mode. It's used to determine\n         *   the last point of the boxes.\n         */\n        constructor(boxes, borderWidth = 0, innerMargin = 0, isLTR = true) {\n            _Outliner_instances.add(this);\n            _Outliner_box.set(this, void 0);\n            _Outliner_verticalEdges.set(this, []);\n            _Outliner_intervals.set(this, []);\n            let minX = Infinity;\n            let maxX = -Infinity;\n            let minY = Infinity;\n            let maxY = -Infinity;\n            // We round the coordinates to slightly reduce the number of edges in the\n            // final outlines.\n            const NUMBER_OF_DIGITS = 4;\n            const EPSILON = Math.pow(10, -NUMBER_OF_DIGITS);\n            // The coordinates of the boxes are in the page coordinate system.\n            for (const { x, y, width, height } of boxes) {\n                const x1 = Math.floor((x - borderWidth) / EPSILON) * EPSILON;\n                const x2 = Math.ceil((x + width + borderWidth) / EPSILON) * EPSILON;\n                const y1 = Math.floor((y - borderWidth) / EPSILON) * EPSILON;\n                const y2 = Math.ceil((y + height + borderWidth) / EPSILON) * EPSILON;\n                const left = [x1, y1, y2, true];\n                const right = [x2, y1, y2, false];\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_verticalEdges, \"f\").push(left, right);\n                minX = Math.min(minX, x1);\n                maxX = Math.max(maxX, x2);\n                minY = Math.min(minY, y1);\n                maxY = Math.max(maxY, y2);\n            }\n            const bboxWidth = maxX - minX + 2 * innerMargin;\n            const bboxHeight = maxY - minY + 2 * innerMargin;\n            const shiftedMinX = minX - innerMargin;\n            const shiftedMinY = minY - innerMargin;\n            const lastEdge = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_verticalEdges, \"f\").at(isLTR ? -1 : -2);\n            const lastPoint = [lastEdge[0], lastEdge[2]];\n            // Convert the coordinates of the edges into box coordinates.\n            for (const edge of kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_verticalEdges, \"f\")) {\n                const [x, y1, y2] = edge;\n                edge[0] = (x - shiftedMinX) / bboxWidth;\n                edge[1] = (y1 - shiftedMinY) / bboxHeight;\n                edge[2] = (y2 - shiftedMinY) / bboxHeight;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _Outliner_box, {\n                x: shiftedMinX,\n                y: shiftedMinY,\n                width: bboxWidth,\n                height: bboxHeight,\n                lastPoint\n            }, \"f\");\n        }\n        getOutlines() {\n            // We begin to sort lexicographically the vertical edges by their abscissa,\n            // and then by their ordinate.\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_verticalEdges, \"f\").sort((a, b) => a[0] - b[0] || a[1] - b[1] || a[2] - b[2]);\n            // We're now using a sweep line algorithm to find the outlines.\n            // We start with the leftmost vertical edge, and we're going to iterate\n            // over all the vertical edges from left to right.\n            // Each time we encounter a left edge, we're going to insert the interval\n            // [y1, y2] in the set of intervals.\n            // This set of intervals is used to break the vertical edges into chunks:\n            // we only take the part of the vertical edge that isn't in the union of\n            // the intervals.\n            const outlineVerticalEdges = [];\n            for (const edge of kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_verticalEdges, \"f\")) {\n                if (edge[3]) {\n                    // Left edge.\n                    outlineVerticalEdges.push(...kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_breakEdge).call(this, edge));\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_insert).call(this, edge);\n                }\n                else {\n                    // Right edge.\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_remove).call(this, edge);\n                    outlineVerticalEdges.push(...kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_breakEdge).call(this, edge));\n                }\n            }\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_getOutlines).call(this, outlineVerticalEdges);\n        }\n    }\n    _Outliner_box = new WeakMap(), _Outliner_verticalEdges = new WeakMap(), _Outliner_intervals = new WeakMap(), _Outliner_instances = new WeakSet(), _Outliner_getOutlines = function _Outliner_getOutlines(outlineVerticalEdges) {\n        const edges = [];\n        const allEdges = new Set();\n        for (const edge of outlineVerticalEdges) {\n            const [x, y1, y2] = edge;\n            edges.push([x, y1, edge], [x, y2, edge]);\n        }\n        // We sort lexicographically the vertices of each edge by their ordinate and\n        // by their abscissa.\n        // Every pair (v_2i, v_{2i + 1}) of vertices defines a horizontal edge.\n        // So for every vertical edge, we're going to add the two vertical edges\n        // which are connected to it through a horizontal edge.\n        edges.sort((a, b) => a[1] - b[1] || a[0] - b[0]);\n        for (let i = 0, ii = edges.length; i < ii; i += 2) {\n            const edge1 = edges[i][2];\n            const edge2 = edges[i + 1][2];\n            edge1.push(edge2);\n            edge2.push(edge1);\n            allEdges.add(edge1);\n            allEdges.add(edge2);\n        }\n        const outlines = [];\n        let outline;\n        while (allEdges.size > 0) {\n            const edge = allEdges.values().next().value;\n            let [x, y1, y2, edge1, edge2] = edge;\n            allEdges.delete(edge);\n            let lastPointX = x;\n            let lastPointY = y1;\n            outline = [x, y2];\n            outlines.push(outline);\n            while (true) {\n                let e;\n                if (allEdges.has(edge1)) {\n                    e = edge1;\n                }\n                else if (allEdges.has(edge2)) {\n                    e = edge2;\n                }\n                else {\n                    break;\n                }\n                allEdges.delete(e);\n                [x, y1, y2, edge1, edge2] = e;\n                if (lastPointX !== x) {\n                    outline.push(lastPointX, lastPointY, x, lastPointY === y1 ? y1 : y2);\n                    lastPointX = x;\n                }\n                lastPointY = lastPointY === y1 ? y2 : y1;\n            }\n            outline.push(lastPointX, lastPointY);\n        }\n        return new HighlightOutline(outlines, kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_box, \"f\"));\n    }, _Outliner_binarySearch = function _Outliner_binarySearch(y) {\n        const array = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\");\n        let start = 0;\n        let end = array.length - 1;\n        while (start <= end) {\n            const middle = (start + end) >> 1;\n            const y1 = array[middle][0];\n            if (y1 === y) {\n                return middle;\n            }\n            if (y1 < y) {\n                start = middle + 1;\n            }\n            else {\n                end = middle - 1;\n            }\n        }\n        return end + 1;\n    }, _Outliner_insert = function _Outliner_insert([, y1, y2]) {\n        const index = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_binarySearch).call(this, y1);\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\").splice(index, 0, [y1, y2]);\n    }, _Outliner_remove = function _Outliner_remove([, y1, y2]) {\n        const index = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_binarySearch).call(this, y1);\n        for (let i = index; i < kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\").length; i++) {\n            const [start, end] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\")[i];\n            if (start !== y1) {\n                break;\n            }\n            if (start === y1 && end === y2) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\").splice(i, 1);\n                return;\n            }\n        }\n        for (let i = index - 1; i >= 0; i--) {\n            const [start, end] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\")[i];\n            if (start !== y1) {\n                break;\n            }\n            if (start === y1 && end === y2) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\").splice(i, 1);\n                return;\n            }\n        }\n    }, _Outliner_breakEdge = function _Outliner_breakEdge(edge) {\n        const [x, y1, y2] = edge;\n        const results = [[x, y1, y2]];\n        const index = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_instances, \"m\", _Outliner_binarySearch).call(this, y2);\n        for (let i = 0; i < index; i++) {\n            const [start, end] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Outliner_intervals, \"f\")[i];\n            for (let j = 0, jj = results.length; j < jj; j++) {\n                const [, y3, y4] = results[j];\n                if (end <= y3 || y4 <= start) {\n                    // There is no intersection between the interval and the edge, hence\n                    // we keep it as is.\n                    continue;\n                }\n                if (y3 >= start) {\n                    if (y4 > end) {\n                        results[j][1] = end;\n                    }\n                    else {\n                        if (jj === 1) {\n                            return [];\n                        }\n                        // The edge is included in the interval, hence we remove it.\n                        results.splice(j, 1);\n                        j--;\n                        jj--;\n                    }\n                    continue;\n                }\n                results[j][2] = start;\n                if (y4 > end) {\n                    results.push([x, end, y4]);\n                }\n            }\n        }\n        return results;\n    };\n    class Outline {\n        /**\n         * @returns {string} The SVG path of the outline.\n         */\n        toSVGPath() {\n            throw new Error(\"Abstract method `toSVGPath` must be implemented.\");\n        }\n        /**\n         * @type {Object|null} The bounding box of the outline.\n         */\n        get box() {\n            throw new Error(\"Abstract getter `box` must be implemented.\");\n        }\n        // serialize() {\n        // serialize(_bbox, _rotation) {\n        serialize([blX, blY, trX, trY]) {\n            // throw new Error(\"Abstract method `serialize` must be implemented.\");\n            if (!blX || !blY || !trX || !trY) {\n                return;\n            }\n        }\n        get free() {\n            return this instanceof FreeHighlightOutline;\n            // return false;\n        }\n    }\n    class HighlightOutline extends Outline {\n        constructor(outlines, box) {\n            super();\n            _HighlightOutline_box.set(this, void 0);\n            _HighlightOutline_outlines.set(this, void 0);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightOutline_outlines, outlines, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightOutline_box, box, \"f\");\n        }\n        toSVGPath() {\n            const buffer = [];\n            for (const polygon of kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightOutline_outlines, \"f\")) {\n                let [prevX, prevY] = polygon;\n                buffer.push(`M${prevX} ${prevY}`);\n                for (let i = 2; i < polygon.length; i += 2) {\n                    const x = polygon[i];\n                    const y = polygon[i + 1];\n                    if (x === prevX) {\n                        buffer.push(`V${y}`);\n                        prevY = y;\n                    }\n                    else if (y === prevY) {\n                        buffer.push(`H${x}`);\n                        prevX = x;\n                    }\n                }\n                buffer.push(\"Z\");\n            }\n            return buffer.join(\" \");\n        }\n        /*\n         * Serialize the outlines into the PDF page coordinate system.\n         * @param {Array<number>} _bbox - the bounding box of the annotation.\n         * @param {number} _rotation - the rotation of the annotation.\n         * @returns {Array<Array<number>>}\n         */\n        // serialize([blX, blY, trX, trY], _rotation) {\n        serialize([blX, blY, trX, trY]) {\n            const outlines = [];\n            const width = trX - blX;\n            const height = trY - blY;\n            for (const outline of kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightOutline_outlines, \"f\")) {\n                const points = new Array(outline.length);\n                for (let i = 0; i < outline.length; i += 2) {\n                    points[i] = blX + outline[i] * width;\n                    points[i + 1] = trY - outline[i + 1] * height;\n                }\n                outlines.push(points);\n            }\n            return outlines;\n        }\n        get box() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightOutline_box, \"f\");\n        }\n    }\n    _HighlightOutline_box = new WeakMap(), _HighlightOutline_outlines = new WeakMap();\n    class FreeOutliner {\n        constructor({ x, y }, box, scaleFactor, thickness, isLTR, innerMargin = 0) {\n            _FreeOutliner_instances.add(this);\n            _FreeOutliner_box.set(this, void 0);\n            _FreeOutliner_bottom.set(this, []);\n            _FreeOutliner_innerMargin.set(this, void 0);\n            _FreeOutliner_isLTR.set(this, void 0);\n            _FreeOutliner_top.set(this, []);\n            // The first 6 elements are the last 3 points of the top part of the outline.\n            // The next 6 elements are the last 3 points of the line.\n            // The next 6 elements are the last 3 points of the bottom part of the\n            // outline.\n            // We track the last 3 points in order to be able to:\n            //  - compute the normal of the line,\n            //  - compute the control points of the quadratic Bzier curve.\n            _FreeOutliner_last.set(this, new Float64Array(18));\n            _FreeOutliner_lastX.set(this, void 0);\n            _FreeOutliner_lastY.set(this, void 0);\n            _FreeOutliner_min.set(this, void 0);\n            _FreeOutliner_min_dist.set(this, void 0);\n            _FreeOutliner_scaleFactor.set(this, void 0);\n            _FreeOutliner_thickness.set(this, void 0);\n            _FreeOutliner_points.set(this, []);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_box, box, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_thickness, thickness * scaleFactor, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_isLTR, isLTR, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([NaN, NaN, NaN, NaN, x, y], 6);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_innerMargin, innerMargin, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_min_dist, kendo_dateinputsCommon_cmn_chunk_js.a(_a$3, _a$3, \"f\", _FreeOutliner_MIN_DIST) * scaleFactor, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_min, kendo_dateinputsCommon_cmn_chunk_js.a(_a$3, _a$3, \"f\", _FreeOutliner_MIN) * scaleFactor, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_scaleFactor, scaleFactor, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_points, \"f\").push(x, y);\n        }\n        get free() {\n            return true;\n        }\n        isEmpty() {\n            // When we add a second point then this.#last.slice(6) will be something\n            // like [NaN, NaN, firstX, firstY, secondX, secondY,...] so having a NaN\n            // at index 8 means that we've only one point.\n            return isNaN(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[8]);\n        }\n        add({ x, y }) {\n            var _b;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_lastX, x, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeOutliner_lastY, y, \"f\");\n            const [layerX, layerY, layerWidth, layerHeight] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_box, \"f\");\n            let [x1, y1, x2, y2] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(8, 12);\n            const diffX = x - x2;\n            const diffY = y - y2;\n            const d = Math.hypot(diffX, diffY);\n            if (d < kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_min, \"f\")) {\n                // The idea is to avoid garbage points around the last point.\n                // When the points are too close, it just leads to bad normal vectors and\n                // control points.\n                return false;\n            }\n            const diffD = d - kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_min_dist, \"f\");\n            const K = diffD / d;\n            const shiftX = K * diffX;\n            const shiftY = K * diffY;\n            // We update the last 3 points of the line.\n            let x0 = x1;\n            let y0 = y1;\n            x1 = x2;\n            y1 = y2;\n            x2 += shiftX;\n            y2 += shiftY;\n            // We keep track of the points in order to be able to compute the focus\n            // outline.\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_points, \"f\")) === null || _b === void 0 ? void 0 : _b.push(x, y);\n            // Create the normal unit vector.\n            // |(shiftX, shiftY)| = |K| * |(diffX, diffY)| = |K| * d = diffD.\n            const nX = -shiftY / diffD;\n            const nY = shiftX / diffD;\n            const thX = nX * kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_thickness, \"f\");\n            const thY = nY * kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_thickness, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(2, 8), 0);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([x2 + thX, y2 + thY], 4);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(14, 18), 12);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([x2 - thX, y2 - thY], 16);\n            if (isNaN(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[6])) {\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\").length === 0) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([x1 + thX, y1 + thY], 2);\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\").push(NaN, NaN, NaN, NaN, (x1 + thX - layerX) / layerWidth, (y1 + thY - layerY) / layerHeight);\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([x1 - thX, y1 - thY], 14);\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_bottom, \"f\").push(NaN, NaN, NaN, NaN, (x1 - thX - layerX) / layerWidth, (y1 - thY - layerY) / layerHeight);\n                }\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([x0, y0, x1, y1, x2, y2], 6);\n                return !this.isEmpty();\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").set([x0, y0, x1, y1, x2, y2], 6);\n            const angle = Math.abs(Math.atan2(y0 - y1, x0 - x1) - Math.atan2(shiftY, shiftX));\n            if (angle < Math.PI / 2) {\n                // In order to avoid some possible artifacts, we're going to use the a\n                // straight line instead of a quadratic Bzier curve.\n                [x1, y1, x2, y2] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(2, 6);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\").push(NaN, NaN, NaN, NaN, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n                [x1, y1, x0, y0] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(14, 18);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_bottom, \"f\").push(NaN, NaN, NaN, NaN, ((x0 + x1) / 2 - layerX) / layerWidth, ((y0 + y1) / 2 - layerY) / layerHeight);\n                return true;\n            }\n            // Control points and the final point for the quadratic Bzier curve.\n            [x0, y0, x1, y1, x2, y2] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(0, 6);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\").push(((x0 + 5 * x1) / 6 - layerX) / layerWidth, ((y0 + 5 * y1) / 6 - layerY) / layerHeight, ((5 * x1 + x2) / 6 - layerX) / layerWidth, ((5 * y1 + y2) / 6 - layerY) / layerHeight, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n            [x2, y2, x1, y1, x0, y0] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(12, 18);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_bottom, \"f\").push(((x0 + 5 * x1) / 6 - layerX) / layerWidth, ((y0 + 5 * y1) / 6 - layerY) / layerHeight, ((5 * x1 + x2) / 6 - layerX) / layerWidth, ((5 * y1 + y2) / 6 - layerY) / layerHeight, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n            return true;\n        }\n        toSVGPath() {\n            if (this.isEmpty()) {\n                // We've only one point.\n                return \"\";\n            }\n            const top = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\");\n            const bottom = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_bottom, \"f\");\n            const lastTop = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(4, 6);\n            const lastBottom = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(16, 18);\n            const [x, y, width, height] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_box, \"f\");\n            const [lastTopX, lastTopY, lastBottomX, lastBottomY] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_instances, \"m\", _FreeOutliner_getLastCoords).call(this);\n            if (isNaN(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[6]) && !this.isEmpty()) {\n                // We've only two points.\n                return `M${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[2] - x) / width} ${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[3] - y) / height} L${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[4] - x) / width} ${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[5] - y) / height} L${lastTopX} ${lastTopY} L${lastBottomX} ${lastBottomY} L${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[16] - x) / width} ${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[17] - y) / height} L${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[14] - x) / width} ${(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\")[15] - y) / height} Z`;\n            }\n            const buffer = [];\n            buffer.push(`M${top[4]} ${top[5]}`);\n            for (let i = 6; i < top.length; i += 6) {\n                if (isNaN(top[i])) {\n                    buffer.push(`L${top[i + 4]} ${top[i + 5]}`);\n                }\n                else {\n                    buffer.push(`C${top[i]} ${top[i + 1]} ${top[i + 2]} ${top[i + 3]} ${top[i + 4]} ${top[i + 5]}`);\n                }\n            }\n            buffer.push(`L${(lastTop[0] - x) / width} ${(lastTop[1] - y) / height} L${lastTopX} ${lastTopY} L${lastBottomX} ${lastBottomY} L${(lastBottom[0] - x) / width} ${(lastBottom[1] - y) / height}`);\n            for (let i = bottom.length - 6; i >= 6; i -= 6) {\n                if (isNaN(bottom[i])) {\n                    buffer.push(`L${bottom[i + 4]} ${bottom[i + 5]}`);\n                }\n                else {\n                    buffer.push(`C${bottom[i]} ${bottom[i + 1]} ${bottom[i + 2]} ${bottom[i + 3]} ${bottom[i + 4]} ${bottom[i + 5]}`);\n                }\n            }\n            buffer.push(`L${bottom[4]} ${bottom[5]} Z`);\n            return buffer.join(\" \");\n        }\n        getOutlines() {\n            var _b, _c;\n            const top = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\");\n            const bottom = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_bottom, \"f\");\n            const last = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\");\n            const lastTop = last.subarray(4, 6);\n            const lastBottom = last.subarray(16, 18);\n            const [layerX, layerY, layerWidth, layerHeight] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_box, \"f\");\n            const points = new Float64Array(((_c = (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_points, \"f\")) === null || _b === void 0 ? void 0 : _b.length) !== null && _c !== void 0 ? _c : 0) + 2);\n            for (let i = 0, ii = points.length - 2; i < ii; i += 2) {\n                points[i] = (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_points, \"f\")[i] - layerX) / layerWidth;\n                points[i + 1] = (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_points, \"f\")[i + 1] - layerY) / layerHeight;\n            }\n            points[points.length - 2] = (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_lastX, \"f\") - layerX) / layerWidth;\n            points[points.length - 1] = (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_lastY, \"f\") - layerY) / layerHeight;\n            const [lastTopX, lastTopY, lastBottomX, lastBottomY] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_instances, \"m\", _FreeOutliner_getLastCoords).call(this);\n            if (isNaN(last[6]) && !this.isEmpty()) {\n                // We've only two points.\n                const outlineObj = new Float64Array(36);\n                outlineObj.set([\n                    NaN,\n                    NaN,\n                    NaN,\n                    NaN,\n                    (last[2] - layerX) / layerWidth,\n                    (last[3] - layerY) / layerHeight,\n                    NaN,\n                    NaN,\n                    NaN,\n                    NaN,\n                    (last[4] - layerX) / layerWidth,\n                    (last[5] - layerY) / layerHeight,\n                    NaN,\n                    NaN,\n                    NaN,\n                    NaN,\n                    lastTopX,\n                    lastTopY,\n                    NaN,\n                    NaN,\n                    NaN,\n                    NaN,\n                    lastBottomX,\n                    lastBottomY,\n                    NaN,\n                    NaN,\n                    NaN,\n                    NaN,\n                    (last[16] - layerX) / layerWidth,\n                    (last[17] - layerY) / layerHeight,\n                    NaN,\n                    NaN,\n                    NaN,\n                    NaN,\n                    (last[14] - layerX) / layerWidth,\n                    (last[15] - layerY) / layerHeight,\n                ], 0);\n                return new FreeHighlightOutline(outlineObj, points, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_box, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_scaleFactor, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_innerMargin, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_isLTR, \"f\"));\n            }\n            const outline = new Float64Array(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_top, \"f\").length + 24 + kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_bottom, \"f\").length);\n            let N = top.length;\n            for (let i = 0; i < N; i += 2) {\n                if (isNaN(top[i])) {\n                    outline[i] = outline[i + 1] = NaN;\n                    continue;\n                }\n                outline[i] = top[i];\n                outline[i + 1] = top[i + 1];\n            }\n            outline.set([\n                NaN,\n                NaN,\n                NaN,\n                NaN,\n                (lastTop[0] - layerX) / layerWidth,\n                (lastTop[1] - layerY) / layerHeight,\n                NaN,\n                NaN,\n                NaN,\n                NaN,\n                lastTopX,\n                lastTopY,\n                NaN,\n                NaN,\n                NaN,\n                NaN,\n                lastBottomX,\n                lastBottomY,\n                NaN,\n                NaN,\n                NaN,\n                NaN,\n                (lastBottom[0] - layerX) / layerWidth,\n                (lastBottom[1] - layerY) / layerHeight,\n            ], N);\n            N += 24;\n            for (let i = bottom.length - 6; i >= 6; i -= 6) {\n                for (let j = 0; j < 6; j += 2) {\n                    if (isNaN(bottom[i + j])) {\n                        outline[N] = outline[N + 1] = NaN;\n                        N += 2;\n                        continue;\n                    }\n                    outline[N] = bottom[i + j];\n                    outline[N + 1] = bottom[i + j + 1];\n                    N += 2;\n                }\n            }\n            outline.set([NaN, NaN, NaN, NaN, bottom[4], bottom[5]], N);\n            return new FreeHighlightOutline(outline, points, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_box, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_scaleFactor, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_innerMargin, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_isLTR, \"f\"));\n        }\n    }\n    _a$3 = FreeOutliner, _FreeOutliner_box = new WeakMap(), _FreeOutliner_bottom = new WeakMap(), _FreeOutliner_innerMargin = new WeakMap(), _FreeOutliner_isLTR = new WeakMap(), _FreeOutliner_top = new WeakMap(), _FreeOutliner_last = new WeakMap(), _FreeOutliner_lastX = new WeakMap(), _FreeOutliner_lastY = new WeakMap(), _FreeOutliner_min = new WeakMap(), _FreeOutliner_min_dist = new WeakMap(), _FreeOutliner_scaleFactor = new WeakMap(), _FreeOutliner_thickness = new WeakMap(), _FreeOutliner_points = new WeakMap(), _FreeOutliner_instances = new WeakSet(), _FreeOutliner_getLastCoords = function _FreeOutliner_getLastCoords() {\n        const lastTop = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(4, 6);\n        const lastBottom = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_last, \"f\").subarray(16, 18);\n        const [x, y, width, height] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_box, \"f\");\n        return [\n            (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_lastX, \"f\") + (lastTop[0] - lastBottom[0]) / 2 - x) / width,\n            (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_lastY, \"f\") + (lastTop[1] - lastBottom[1]) / 2 - y) / height,\n            (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_lastX, \"f\") + (lastBottom[0] - lastTop[0]) / 2 - x) / width,\n            (kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeOutliner_lastY, \"f\") + (lastBottom[1] - lastTop[1]) / 2 - y) / height,\n        ];\n    };\n    _FreeOutliner_MIN_DIST = { value: 8 };\n    _FreeOutliner_MIN_DIFF = { value: 2 };\n    _FreeOutliner_MIN = { value: kendo_dateinputsCommon_cmn_chunk_js.a(_a$3, _a$3, \"f\", _FreeOutliner_MIN_DIST) + kendo_dateinputsCommon_cmn_chunk_js.a(_a$3, _a$3, \"f\", _FreeOutliner_MIN_DIFF) };\n    class FreeHighlightOutline extends Outline {\n        constructor(outline, points, box, scaleFactor, innerMargin, isLTR) {\n            super();\n            _FreeHighlightOutline_instances.add(this);\n            _FreeHighlightOutline_box.set(this, void 0);\n            _FreeHighlightOutline_bbox.set(this, null);\n            _FreeHighlightOutline_innerMargin.set(this, void 0);\n            _FreeHighlightOutline_isLTR.set(this, void 0);\n            _FreeHighlightOutline_points.set(this, void 0);\n            _FreeHighlightOutline_scaleFactor.set(this, void 0);\n            _FreeHighlightOutline_outline.set(this, void 0);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_outline, outline, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_points, points, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_box, box, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_scaleFactor, scaleFactor, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_innerMargin, innerMargin, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_isLTR, isLTR, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_computeMinMax).call(this, isLTR);\n            const { x, y, width, height } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_bbox, \"f\");\n            for (let i = 0, ii = outline.length; i < ii; i += 2) {\n                outline[i] = (outline[i] - x) / width;\n                outline[i + 1] = (outline[i + 1] - y) / height;\n            }\n            for (let i = 0, ii = points.length; i < ii; i += 2) {\n                points[i] = (points[i] - x) / width;\n                points[i + 1] = (points[i + 1] - y) / height;\n            }\n        }\n        toSVGPath() {\n            const buffer = [`M${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[4]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[5]}`];\n            for (let i = 6, ii = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\").length; i < ii; i += 6) {\n                if (isNaN(kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i])) {\n                    buffer.push(`L${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 4]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 5]}`);\n                    continue;\n                }\n                buffer.push(`C${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 1]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 2]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 3]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 4]} ${kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\")[i + 5]}`);\n            }\n            buffer.push(\"Z\");\n            return buffer.join(\" \");\n        }\n        // @ts-expect-error(TS:2556)\n        serialize([blX, blY, trX, trY], rotation) {\n            const width = trX - blX;\n            const height = trY - blY;\n            let outline;\n            let points;\n            switch (rotation) {\n                case 0:\n                    outline = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescale).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\"), blX, trY, width, -height);\n                    points = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescale).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\"), blX, trY, width, -height);\n                    break;\n                case 90:\n                    outline = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescaleAndSwap).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\"), blX, blY, width, height);\n                    points = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescaleAndSwap).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\"), blX, blY, width, height);\n                    break;\n                case 180:\n                    outline = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescale).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\"), trX, blY, -width, height);\n                    points = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescale).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\"), trX, blY, -width, height);\n                    break;\n                case 270:\n                    outline = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescaleAndSwap).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\"), trX, trY, -width, -height);\n                    points = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_instances, \"m\", _FreeHighlightOutline_rescaleAndSwap).call(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\"), trX, trY, -width, -height);\n                    break;\n                default: break;\n            }\n            return { outline: Array.from(outline), points: [Array.from(points)] };\n        }\n        get box() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_bbox, \"f\");\n        }\n        getNewOutline(thickness, innerMargin) {\n            // Build the outline of the highlight to use as the focus outline.\n            const { x, y, width, height } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_bbox, \"f\");\n            const [layerX, layerY, layerWidth, layerHeight] = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_box, \"f\");\n            const sx = width * layerWidth;\n            const sy = height * layerHeight;\n            const tx = x * layerWidth + layerX;\n            const ty = y * layerHeight + layerY;\n            const outliner = new FreeOutliner({\n                x: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\")[0] * sx + tx,\n                y: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\")[1] * sy + ty,\n            }, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_box, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_scaleFactor, \"f\"), thickness, kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_isLTR, \"f\"), innerMargin !== null && innerMargin !== void 0 ? innerMargin : kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_innerMargin, \"f\"));\n            for (let i = 2; i < kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\").length; i += 2) {\n                outliner.add({\n                    x: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\")[i] * sx + tx,\n                    y: kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_points, \"f\")[i + 1] * sy + ty,\n                });\n            }\n            return outliner.getOutlines();\n        }\n    }\n    _FreeHighlightOutline_box = new WeakMap(), _FreeHighlightOutline_bbox = new WeakMap(), _FreeHighlightOutline_innerMargin = new WeakMap(), _FreeHighlightOutline_isLTR = new WeakMap(), _FreeHighlightOutline_points = new WeakMap(), _FreeHighlightOutline_scaleFactor = new WeakMap(), _FreeHighlightOutline_outline = new WeakMap(), _FreeHighlightOutline_instances = new WeakSet(), _FreeHighlightOutline_rescale = function _FreeHighlightOutline_rescale(src, tx, ty, sx, sy) {\n        const dest = new Float64Array(src.length);\n        for (let i = 0, ii = src.length; i < ii; i += 2) {\n            dest[i] = tx + src[i] * sx;\n            dest[i + 1] = ty + src[i + 1] * sy;\n        }\n        return dest;\n    }, _FreeHighlightOutline_rescaleAndSwap = function _FreeHighlightOutline_rescaleAndSwap(src, tx, ty, sx, sy) {\n        const dest = new Float64Array(src.length);\n        for (let i = 0, ii = src.length; i < ii; i += 2) {\n            dest[i] = tx + src[i + 1] * sx;\n            dest[i + 1] = ty + src[i] * sy;\n        }\n        return dest;\n    }, _FreeHighlightOutline_computeMinMax = function _FreeHighlightOutline_computeMinMax(isLTR) {\n        const outline = kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_outline, \"f\");\n        let lastX = outline[4];\n        let lastY = outline[5];\n        let minX = lastX;\n        let minY = lastY;\n        let maxX = lastX;\n        let maxY = lastY;\n        let lastPointX = lastX;\n        let lastPointY = lastY;\n        const ltrCallback = isLTR ? Math.max : Math.min;\n        for (let i = 6, ii = outline.length; i < ii; i += 6) {\n            if (isNaN(outline[i])) {\n                minX = Math.min(minX, outline[i + 4]);\n                minY = Math.min(minY, outline[i + 5]);\n                maxX = Math.max(maxX, outline[i + 4]);\n                maxY = Math.max(maxY, outline[i + 5]);\n                if (lastPointY < outline[i + 5]) {\n                    lastPointX = outline[i + 4];\n                    lastPointY = outline[i + 5];\n                }\n                else if (lastPointY === outline[i + 5]) {\n                    lastPointX = ltrCallback(lastPointX, outline[i + 4]);\n                }\n            }\n            else {\n                const bbox = kendo_pdfjs_loader_js.Util.bezierBoundingBox(lastX, lastY, \n                // @ts-expect-error(TS:2556)\n                ...outline.slice(i, i + 6));\n                minX = Math.min(minX, bbox[0]);\n                minY = Math.min(minY, bbox[1]);\n                maxX = Math.max(maxX, bbox[2]);\n                maxY = Math.max(maxY, bbox[3]);\n                if (lastPointY < bbox[3]) {\n                    lastPointX = bbox[2];\n                    lastPointY = bbox[3];\n                }\n                else if (lastPointY === bbox[3]) {\n                    lastPointX = ltrCallback(lastPointX, bbox[2]);\n                }\n            }\n            lastX = outline[i + 4];\n            lastY = outline[i + 5];\n        }\n        const x = minX - kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_innerMargin, \"f\"), y = minY - kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_innerMargin, \"f\"), width = maxX - minX + 2 * kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_innerMargin, \"f\"), height = maxY - minY + 2 * kendo_dateinputsCommon_cmn_chunk_js.a(this, _FreeHighlightOutline_innerMargin, \"f\");\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _FreeHighlightOutline_bbox, { x, y, width, height, lastPoint: [lastPointX, lastPointY] }, \"f\");\n    };\n    // export { Outliner };\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _HighlightEditor_instances, _a$2, _HighlightEditor_anchorNode, _HighlightEditor_anchorOffset, _HighlightEditor_boxes, _HighlightEditor_clipPathId, _HighlightEditor_focusOutlines, _HighlightEditor_focusNode, _HighlightEditor_focusOffset, _HighlightEditor_highlightDiv, _HighlightEditor_highlightOutlines, _HighlightEditor_id, _HighlightEditor_isFreeHighlight, _HighlightEditor_lastPoint, _HighlightEditor_opacity, _HighlightEditor_outlineId, _HighlightEditor_text, _HighlightEditor_thickness, _HighlightEditor_methodOfCreation, _HighlightEditor_createOutlines, _HighlightEditor_createFreeOutlines, _HighlightEditor_updateColor, _HighlightEditor_updateThickness, _HighlightEditor_cleanDrawLayer, _HighlightEditor_addToDrawLayer, _HighlightEditor_rotateBbox, _HighlightEditor_keydown, _HighlightEditor_setCaret, _HighlightEditor_getRotation, _HighlightEditor_serializeBoxes, _HighlightEditor_serializeOutlines, _HighlightEditor_highlightMove, _HighlightEditor_endHighlight;\n    // import { ColorPicker } from \"./color_picker.js\";\n    // import { noContextMenu } from \"../../shared/display_utils\";\n    /**\n     * Basic draw editor in order to generate an Highlight annotation.\n     */\n    class HighlightEditor extends AnnotationEditor {\n        // static get _keyboardManager() {\n        //     const proto = HighlightEditor.prototype;\n        //     return shadow(\n        //         this,\n        //         \"_keyboardManager\",\n        //         new KeyboardManager([\n        //             [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto._moveCaret, { args: [0] }],\n        //             [[\"ArrowRight\", \"mac+ArrowRight\"], proto._moveCaret, { args: [1] }],\n        //             [[\"ArrowUp\", \"mac+ArrowUp\"], proto._moveCaret, { args: [2] }],\n        //             [[\"ArrowDown\", \"mac+ArrowDown\"], proto._moveCaret, { args: [3] }],\n        //         ])\n        //     );\n        // }\n        constructor(params) {\n            super(Object.assign(Object.assign({}, params), { name: \"k-highlight-editor highlightEditor\" }));\n            _HighlightEditor_instances.add(this);\n            // todo: props\n            this.color = \"\";\n            // parent = null;\n            // width = null;\n            // height = null;\n            // x = null;\n            // y = null;\n            // todo: props\n            _HighlightEditor_anchorNode.set(this, null);\n            _HighlightEditor_anchorOffset.set(this, 0);\n            _HighlightEditor_boxes.set(this, void 0);\n            _HighlightEditor_clipPathId.set(this, null);\n            // #colorPicker = null;\n            _HighlightEditor_focusOutlines.set(this, null);\n            _HighlightEditor_focusNode.set(this, null);\n            _HighlightEditor_focusOffset.set(this, 0);\n            _HighlightEditor_highlightDiv.set(this, null);\n            _HighlightEditor_highlightOutlines.set(this, null);\n            _HighlightEditor_id.set(this, null);\n            _HighlightEditor_isFreeHighlight.set(this, false);\n            _HighlightEditor_lastPoint.set(this, null);\n            _HighlightEditor_opacity.set(this, void 0);\n            _HighlightEditor_outlineId.set(this, null);\n            _HighlightEditor_text.set(this, \"\");\n            _HighlightEditor_thickness.set(this, void 0);\n            _HighlightEditor_methodOfCreation.set(this, \"\");\n            this.color = params.color || _a$2._defaultColor;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_thickness, params.thickness || _a$2._defaultThickness, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_opacity, params.opacity || _a$2._defaultOpacity, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_boxes, params.boxes || null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_methodOfCreation, params.methodOfCreation || \"\", \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_text, params.text || \"\", \"f\");\n            this._isDraggable = false;\n            if (params.highlightId > -1) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_isFreeHighlight, true, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_createFreeOutlines).call(this, params);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_addToDrawLayer).call(this);\n            }\n            else {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_anchorNode, params.anchorNode, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_anchorOffset, params.anchorOffset, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_focusNode, params.focusNode, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_focusOffset, params.focusOffset, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_createOutlines).call(this);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_addToDrawLayer).call(this);\n                this.rotate(this.rotation);\n            }\n        }\n        /** @inheritdoc */\n        get telemetryInitialData() {\n            return {\n                action: \"added\",\n                type: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\") ? \"free_highlight\" : \"highlight\",\n                color: this._uiManager.highlightColorNames.get(this.color),\n                thickness: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_thickness, \"f\"),\n                methodOfCreation: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_methodOfCreation, \"f\"),\n            };\n        }\n        /** @inheritdoc */\n        get telemetryFinalData() {\n            return {\n                type: \"highlight\",\n                color: this._uiManager.highlightColorNames.get(this.color),\n            };\n        }\n        static computeTelemetryFinalData(data) {\n            // We want to know how many colors have been used.\n            return { numberOfColors: data.get(\"color\").size };\n        }\n        /** @inheritdoc */\n        static initialize(l10n, uiManager) {\n            var _b, _c, _d, _e;\n            AnnotationEditor.initialize(l10n, uiManager, {});\n            _a$2._defaultColor || (_a$2._defaultColor = \n            // uiManager.highlightColors?.values().next().value || \"#fff066\";\n            // uiManager.highlightColors?.values().next().value || \"#ffff00\";\n            ((_e = (_d = (_c = (_b = uiManager.viewer) === null || _b === void 0 ? void 0 : _b.options) === null || _c === void 0 ? void 0 : _c.annotations) === null || _d === void 0 ? void 0 : _d.highlight) === null || _e === void 0 ? void 0 : _e.color) || \"#ffff00\");\n        }\n        /** @inheritdoc */\n        static updateDefaultParams(type, value) {\n            switch (type) {\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:\n                    _a$2._defaultColor = value;\n                    break;\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:\n                    _a$2._defaultThickness = value;\n                    break;\n                default: break;\n            }\n        }\n        /** @inheritdoc */\n        // translateInPage(x, y) { }\n        translateInPage() { }\n        /** @inheritdoc */\n        get toolbarPosition() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_lastPoint, \"f\");\n        }\n        /** @inheritdoc */\n        updateParams(type, value) {\n            switch (type) {\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_COLOR:\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_updateColor).call(this, value);\n                    break;\n                case kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_updateThickness).call(this, value);\n                    break;\n                default: break;\n            }\n        }\n        static get defaultPropertiesToUpdate() {\n            return [\n                [\n                    kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,\n                    _a$2._defaultColor,\n                ],\n                [\n                    kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,\n                    _a$2._defaultThickness,\n                ],\n            ];\n        }\n        /** @inheritdoc */\n        get propertiesToUpdate() {\n            return [\n                [\n                    kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_COLOR,\n                    this.color || _a$2._defaultColor,\n                ],\n                [\n                    kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_thickness, \"f\") || _a$2._defaultThickness,\n                ],\n                [kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_FREE, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\")],\n            ];\n        }\n        /** @inheritdoc */\n        // async addEditToolbar() {\n        //     // const toolbar = await super.addEditToolbar();\n        //     // if (!toolbar) {\n        //     //     return null;\n        //     // }\n        //     // if (this._uiManager.highlightColors) {\n        //     //     // this.#colorPicker = new ColorPicker({ editor: this });\n        //     //     // toolbar.addColorPicker(this.#colorPicker);\n        //     // }\n        //     // return toolbar;\n        // }\n        /** @inheritdoc */\n        disableEditing() {\n            super.disableEditing();\n            this.div.classList.toggle(\"disabled\", true);\n            // this.div.classList.toggle(\"k-disabled\", true);\n        }\n        /** @inheritdoc */\n        enableEditing() {\n            super.enableEditing();\n            this.div.classList.toggle(\"disabled\", false);\n            // this.div.classList.toggle(\"k-disabled\", false);\n        }\n        /** @inheritdoc */\n        fixAndSetPosition() {\n            return super.fixAndSetPosition(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_getRotation).call(this));\n        }\n        /** @inheritdoc */\n        getBaseTranslation() {\n            // The editor itself doesn't have any CSS border (we're drawing one\n            // ourselves in using SVG).\n            return [0, 0];\n        }\n        /** @inheritdoc */\n        getRect(tx, ty) {\n            return super.getRect(tx, ty, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_getRotation).call(this));\n        }\n        /** @inheritdoc */\n        onceAdded() {\n            this.parent.addUndoableEditor(this);\n            this.div.focus();\n        }\n        /** @inheritdoc */\n        remove() {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_cleanDrawLayer).call(this);\n            // this._reportTelemetry({\n            //     action: \"deleted\",\n            // });\n            super.remove();\n        }\n        /** @inheritdoc */\n        rebuild() {\n            if (!this.parent) {\n                return;\n            }\n            super.rebuild();\n            if (this.div === null) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_addToDrawLayer).call(this);\n            if (!this.isAttachedToDOM) {\n                // At some point this editor was removed and we're rebuilding it,\n                // hence we must add it to its parent.\n                this.parent.add(this);\n            }\n        }\n        setParent(parent) {\n            var _b, _c;\n            let mustBeSelected = false;\n            if (this.parent && !parent) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_cleanDrawLayer).call(this);\n            }\n            else if (parent) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_addToDrawLayer).call(this, parent);\n                // If mustBeSelected is true it means that this editor was selected\n                // when its parent has been destroyed, hence we must select it again.\n                mustBeSelected =\n                    !this.parent &&\n                        (((_b = this.div) === null || _b === void 0 ? void 0 : _b.classList.contains(\"selectedEditor\")) ||\n                            ((_c = this.div) === null || _c === void 0 ? void 0 : _c.classList.contains(\"k-selected\")));\n            }\n            super.setParent(parent);\n            this.show(this._isVisible);\n            if (mustBeSelected) {\n                // We select it after the parent has been set.\n                this.select();\n            }\n        }\n        /** @inheritdoc */\n        rotate(angle) {\n            // We need to rotate the svgs because of the coordinates system.\n            const { drawLayer } = this.parent;\n            let box;\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\")) {\n                angle = (angle - this.rotation + 360) % 360;\n                box = kendo_dateinputsCommon_cmn_chunk_js.a(_a$2, _a$2, \"m\", _HighlightEditor_rotateBbox).call(_a$2, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightOutlines, \"f\").box, angle);\n            }\n            else {\n                // An highlight annotation is always drawn horizontally.\n                box = kendo_dateinputsCommon_cmn_chunk_js.a(_a$2, _a$2, \"m\", _HighlightEditor_rotateBbox).call(_a$2, this, angle);\n            }\n            drawLayer.rotate(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"), angle);\n            drawLayer.rotate(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), angle);\n            drawLayer.updateBox(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"), box);\n            drawLayer.updateBox(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(_a$2, _a$2, \"m\", _HighlightEditor_rotateBbox).call(_a$2, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\").box, angle));\n        }\n        /** @inheritdoc */\n        render() {\n            if (this.div) {\n                return this.div;\n            }\n            const div = super.render();\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_text, \"f\")) {\n                div.setAttribute(\"aria-label\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_text, \"f\"));\n                div.setAttribute(\"role\", \"mark\");\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\")) {\n                div.classList.add(\"free\");\n            }\n            else {\n                this.div.addEventListener(\"keydown\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_keydown).bind(this), {\n                    signal: this._uiManager._signal,\n                });\n            }\n            const highlightDiv = (kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_highlightDiv, document.createElement(\"div\"), \"f\"));\n            div.append(highlightDiv);\n            highlightDiv.setAttribute(\"aria-hidden\", \"true\");\n            highlightDiv.className = \"k-internal internal\";\n            highlightDiv.style.clipPath = kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_clipPathId, \"f\");\n            const [parentWidth, parentHeight] = this.parentDimensions;\n            this.setDims(this.width * parentWidth, this.height * parentHeight);\n            bindEvents(this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightDiv, \"f\"), [\"pointerover\", \"pointerleave\"]);\n            this.enableEditing();\n            return div;\n        }\n        pointerover() {\n            this.parent.drawLayer.addClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"hovered\");\n        }\n        pointerleave() {\n            this.parent.drawLayer.removeClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"hovered\");\n        }\n        _moveCaret(direction) {\n            this.parent.unselect(this);\n            switch (direction) {\n                case 0 /* left */:\n                case 2 /* up */:\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_setCaret).call(this, /* start = */ true);\n                    break;\n                case 1 /* right */:\n                case 3 /* down */:\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_setCaret).call(this, /* start = */ false);\n                    break;\n                default: break;\n            }\n        }\n        /** @inheritdoc */\n        select() {\n            var _b, _c, _d;\n            super.select();\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\")) {\n                return;\n            }\n            (_b = this.parent) === null || _b === void 0 ? void 0 : _b.drawLayer.removeClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"hovered\");\n            (_c = this.parent) === null || _c === void 0 ? void 0 : _c.drawLayer.addClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"selected\");\n            (_d = this.parent) === null || _d === void 0 ? void 0 : _d.drawLayer.addClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"k-selected\");\n        }\n        /** @inheritdoc */\n        unselect() {\n            var _b, _c;\n            super.unselect();\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\")) {\n                return;\n            }\n            (_b = this.parent) === null || _b === void 0 ? void 0 : _b.drawLayer.removeClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"selected\");\n            (_c = this.parent) === null || _c === void 0 ? void 0 : _c.drawLayer.removeClass(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), \"k-selected\");\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_setCaret).call(this, /* start = */ false);\n            }\n        }\n        /** @inheritdoc */\n        get _mustFixPosition() {\n            return !kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\");\n        }\n        /** @inheritdoc */\n        show(visible = this._isVisible) {\n            super.show(visible);\n            if (this.parent) {\n                this.parent.drawLayer.show(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"), visible);\n                this.parent.drawLayer.show(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), visible);\n            }\n        }\n        static startHighlighting(parent, isLTR, { target: textLayer, x, y }) {\n            const { x: layerX, y: layerY, width: parentWidth, height: parentHeight, } = textLayer.getBoundingClientRect();\n            const ac = new AbortController();\n            const signal = parent.combinedSignal(ac);\n            const pointerDown = e => {\n                // Avoid to have undesired clicks during the drawing.\n                e.preventDefault();\n                e.stopPropagation();\n            };\n            const pointerUpCallback = e => {\n                ac.abort();\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _a$2, \"m\", _HighlightEditor_endHighlight).call(this, parent, e);\n            };\n            window.addEventListener(\"blur\", pointerUpCallback, { signal });\n            window.addEventListener(\"pointerup\", pointerUpCallback, { signal });\n            window.addEventListener(\"pointerdown\", pointerDown, {\n                capture: true,\n                passive: false,\n                signal,\n            });\n            window.addEventListener(\"contextmenu\", kendo_pdfjs_loader_js.noContextMenu, { signal });\n            textLayer.addEventListener(\"pointermove\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _a$2, \"m\", _HighlightEditor_highlightMove).bind(this, parent), { signal });\n            this._freeHighlight = new FreeOutliner({ x, y }, [layerX, layerY, parentWidth, parentHeight], parent.scale, this._defaultThickness / 2, isLTR, \n            /* innerMargin = */ 0.001);\n            ({ id: this._freeHighlightId, clipPathId: this._freeHighlightClipId } =\n                parent.drawLayer.highlight(this._freeHighlight, this._defaultColor, this._defaultOpacity, \n                /* isPathUpdatable = */ true));\n        }\n        /** @inheritdoc */\n        static deserialize(data, parent, uiManager) {\n            const editor = super.deserialize(data, parent, uiManager);\n            const { rect: [blX, blY, trX, trY], color, quadPoints, } = data;\n            // @ts-expect-error TS()\n            editor.color = kendo_pdfjs_loader_js.Util.makeHexColor(...color);\n            kendo_dateinputsCommon_cmn_chunk_js._(editor, _HighlightEditor_opacity, data.opacity, \"f\");\n            const [pageWidth, pageHeight] = editor.pageDimensions;\n            editor.width = (trX - blX) / pageWidth;\n            editor.height = (trY - blY) / pageHeight;\n            const boxes = (kendo_dateinputsCommon_cmn_chunk_js._(editor, _HighlightEditor_boxes, [], \"f\"));\n            for (let i = 0; i < quadPoints.length; i += 8) {\n                boxes.push({\n                    x: (quadPoints[4] - trX) / pageWidth,\n                    y: (trY - (1 - quadPoints[i + 5])) / pageHeight,\n                    width: (quadPoints[i + 2] - quadPoints[i]) / pageWidth,\n                    height: (quadPoints[i + 5] - quadPoints[i + 1]) / pageHeight,\n                });\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(editor, _HighlightEditor_instances, \"m\", _HighlightEditor_createOutlines).call(editor);\n            return editor;\n        }\n        /** @inheritdoc */\n        serialize(isForCopying = false) {\n            // It doesn't make sense to copy/paste a highlight annotation.\n            if (this.isEmpty() || isForCopying) {\n                return null;\n            }\n            const rect = this.getRect(0, 0);\n            const color = AnnotationEditor._colorManager.convert(this.color);\n            return {\n                annotationType: kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT,\n                color,\n                opacity: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_opacity, \"f\"),\n                thickness: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_thickness, \"f\"),\n                quadPoints: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_serializeBoxes).call(this),\n                outlines: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_serializeOutlines).call(this, rect),\n                pageIndex: this.pageIndex,\n                rect,\n                rotation: kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_getRotation).call(this),\n                structTreeParentId: this._structTreeParentId,\n            };\n        }\n        static canCreateNewEmptyEditor() {\n            return false;\n        }\n        // todo: this is necessary\n        // saveDocument() has checks that test \"editor instanceof AnnotationEditor\", but they fail\n        // because AnnotationEditor from \"pdfjs-dist/legacy/build/pdf.mjs\" is not exported\n        // thus replace instances of editors with their serialized version\n        toJSON() {\n            const data = this.serialize();\n            return data;\n        }\n    }\n    _a$2 = HighlightEditor, _HighlightEditor_anchorNode = new WeakMap(), _HighlightEditor_anchorOffset = new WeakMap(), _HighlightEditor_boxes = new WeakMap(), _HighlightEditor_clipPathId = new WeakMap(), _HighlightEditor_focusOutlines = new WeakMap(), _HighlightEditor_focusNode = new WeakMap(), _HighlightEditor_focusOffset = new WeakMap(), _HighlightEditor_highlightDiv = new WeakMap(), _HighlightEditor_highlightOutlines = new WeakMap(), _HighlightEditor_id = new WeakMap(), _HighlightEditor_isFreeHighlight = new WeakMap(), _HighlightEditor_lastPoint = new WeakMap(), _HighlightEditor_opacity = new WeakMap(), _HighlightEditor_outlineId = new WeakMap(), _HighlightEditor_text = new WeakMap(), _HighlightEditor_thickness = new WeakMap(), _HighlightEditor_methodOfCreation = new WeakMap(), _HighlightEditor_instances = new WeakSet(), _HighlightEditor_createOutlines = function _HighlightEditor_createOutlines() {\n        const outliner = new Outliner(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_boxes, \"f\"), /* borderWidth = */ 0.001);\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_highlightOutlines, outliner.getOutlines(), \"f\");\n        ({\n            x: this.x,\n            y: this.y,\n            width: this.width,\n            height: this.height,\n        } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightOutlines, \"f\").box);\n        const outlinerForOutline = new Outliner(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_boxes, \"f\"), \n        /* borderWidth = */ 0.0025, \n        /* innerMargin = */ 0.001, this._uiManager.direction === \"ltr\");\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_focusOutlines, outlinerForOutline.getOutlines(), \"f\");\n        // The last point is in the pages coordinate system.\n        const { lastPoint } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\").box;\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_lastPoint, [\n            (lastPoint[0] - this.x) / this.width,\n            (lastPoint[1] - this.y) / this.height,\n        ], \"f\");\n    }, _HighlightEditor_createFreeOutlines = function _HighlightEditor_createFreeOutlines({ highlightOutlines, highlightId, clipPathId }) {\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_highlightOutlines, highlightOutlines, \"f\");\n        const extraThickness = 1.5;\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_focusOutlines, highlightOutlines.getNewOutline(\n        /* Slightly bigger than the highlight in order to have a little\n           space between the highlight and the outline. */\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_thickness, \"f\") / 2 + extraThickness, \n        /* innerMargin = */ 0.0025), \"f\");\n        if (highlightId >= 0) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_id, highlightId, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_clipPathId, clipPathId, \"f\");\n            // We need to redraw the highlight because we change the coordinates to be\n            // in the box coordinate system.\n            this.parent.drawLayer.finalizeLine(highlightId, highlightOutlines);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_outlineId, this.parent.drawLayer.highlightOutline(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\")), \"f\");\n        }\n        else if (this.parent) {\n            const angle = this.parent.viewport.rotation;\n            this.parent.drawLayer.updateLine(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"), highlightOutlines);\n            this.parent.drawLayer.updateBox(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(_a$2, _a$2, \"m\", _HighlightEditor_rotateBbox).call(_a$2, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightOutlines, \"f\").box, (angle - this.rotation + 360) % 360));\n            this.parent.drawLayer.updateLine(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\"));\n            this.parent.drawLayer.updateBox(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(_a$2, _a$2, \"m\", _HighlightEditor_rotateBbox).call(_a$2, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\").box, angle));\n        }\n        const { x, y, width, height } = highlightOutlines.box;\n        switch (this.rotation) {\n            case 0:\n                this.x = x;\n                this.y = y;\n                this.width = width;\n                this.height = height;\n                break;\n            case 90: {\n                const [pageWidth, pageHeight] = this.parentDimensions;\n                this.x = y;\n                this.y = 1 - x;\n                this.width = (width * pageHeight) / pageWidth;\n                this.height = (height * pageWidth) / pageHeight;\n                break;\n            }\n            case 180:\n                this.x = 1 - x;\n                this.y = 1 - y;\n                this.width = width;\n                this.height = height;\n                break;\n            case 270: {\n                const [pageWidth, pageHeight] = this.parentDimensions;\n                this.x = 1 - y;\n                this.y = x;\n                this.width = (width * pageHeight) / pageWidth;\n                this.height = (height * pageWidth) / pageHeight;\n                break;\n            }\n            default: break;\n        }\n        const { lastPoint } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\").box;\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_lastPoint, [(lastPoint[0] - x) / width, (lastPoint[1] - y) / height], \"f\");\n    }, _HighlightEditor_updateColor = function _HighlightEditor_updateColor(color) {\n        if (!color) {\n            return;\n        }\n        const setColor = col => {\n            var _b;\n            this.color = col;\n            (_b = this.parent) === null || _b === void 0 ? void 0 : _b.drawLayer.changeColor(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"), col);\n            // this.#colorPicker?.updateColor(col);\n        };\n        const savedColor = this.color;\n        this.addCommands({\n            cmd: setColor.bind(this, color),\n            undo: setColor.bind(this, savedColor),\n            post: this._uiManager.updateUI.bind(this._uiManager, this),\n            mustExec: true,\n            type: kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_COLOR,\n            overwriteIfSameType: true,\n            keepUndo: true,\n        });\n        // this._reportTelemetry(\n        //     {\n        //         action: \"color_changed\",\n        //         color: this._uiManager.highlightColorNames.get(color),\n        //     },\n        //     /* mustWait = */ true\n        // );\n    }, _HighlightEditor_updateThickness = function _HighlightEditor_updateThickness(thickness) {\n        if (!thickness) {\n            return;\n        }\n        // const savedThickness = this.#thickness;\n        // const setThickness = th => {\n        //     this.#thickness = th;\n        //     this.#changeThickness(th);\n        // };\n        // this.addCommands({\n        //     cmd: setThickness.bind(this, thickness),\n        //     undo: setThickness.bind(this, savedThickness),\n        //     post: this._uiManager.updateUI.bind(this._uiManager, this),\n        //     mustExec: true,\n        //     type: AnnotationEditorParamsType.INK_THICKNESS,\n        //     overwriteIfSameType: true,\n        //     keepUndo: true,\n        // });\n        // this._reportTelemetry(\n        //     { action: \"thickness_changed\", thickness },\n        // /* mustWait = */ true\n        // );\n    }, _HighlightEditor_cleanDrawLayer = function _HighlightEditor_cleanDrawLayer() {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\") === null || !this.parent) {\n            return;\n        }\n        this.parent.drawLayer.remove(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\"));\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_id, null, \"f\");\n        this.parent.drawLayer.remove(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_outlineId, \"f\"));\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_outlineId, null, \"f\");\n    }, _HighlightEditor_addToDrawLayer = function _HighlightEditor_addToDrawLayer(parent = this.parent) {\n        var _b, _c;\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_id, \"f\") !== null) {\n            return;\n        }\n        (_b = this, _c = this, { id: ({ set value(_a) { kendo_dateinputsCommon_cmn_chunk_js._(_b, _HighlightEditor_id, _a, \"f\"); } }).value, clipPathId: ({ set value(_a) { kendo_dateinputsCommon_cmn_chunk_js._(_c, _HighlightEditor_clipPathId, _a, \"f\"); } }).value } =\n            parent.drawLayer.highlight(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightOutlines, \"f\"), this.color, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_opacity, \"f\")));\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _HighlightEditor_outlineId, parent.drawLayer.highlightOutline(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOutlines, \"f\")), \"f\");\n        // // todo: manually set styles, so that SVG elements are properly displayed\n        // if (parent.drawLayer.parent) {\n        //     Array.from(parent.drawLayer.parent.querySelectorAll(\".highlight\")).forEach(x => {\n        //         const element = x as any;\n        //         element.style[\"--blend-mode\"] = \"multiply\";\n        //         element.style.position = \"absolute\";\n        //         element.style[\"mix-blend-mode\"] = \"var(--blend-mode)\";\n        //         element.style.transform = \"none\";\n        //     });\n        // }\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightDiv, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightDiv, \"f\").style.clipPath = kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_clipPathId, \"f\");\n        }\n    }, _HighlightEditor_rotateBbox = function _HighlightEditor_rotateBbox({ x, y, width, height }, angle) {\n        switch (angle) {\n            case 90:\n                return {\n                    x: 1 - y - height,\n                    y: x,\n                    width: height,\n                    height: width,\n                };\n            case 180:\n                return {\n                    x: 1 - x - width,\n                    y: 1 - y - height,\n                    width,\n                    height,\n                };\n            case 270:\n                return {\n                    x: y,\n                    y: 1 - x - width,\n                    width: height,\n                    height: width,\n                };\n            default: break;\n        }\n        return {\n            x,\n            y,\n            width,\n            height,\n        };\n    }, _HighlightEditor_keydown = function _HighlightEditor_keydown(event) {\n        if (!event) {\n            return;\n        }\n        // HighlightEditor._keyboardManager.exec(this, event);\n    }, _HighlightEditor_setCaret = function _HighlightEditor_setCaret(start) {\n        if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_anchorNode, \"f\")) {\n            return;\n        }\n        const selection = window.getSelection();\n        if (start) {\n            selection.setPosition(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_anchorNode, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_anchorOffset, \"f\"));\n        }\n        else {\n            selection.setPosition(kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusNode, \"f\"), kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_focusOffset, \"f\"));\n        }\n    }, _HighlightEditor_getRotation = function _HighlightEditor_getRotation() {\n        // Highlight annotations are always drawn horizontally but if\n        // a free highlight annotation can be rotated.\n        return kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\") ? this.rotation : 0;\n    }, _HighlightEditor_serializeBoxes = function _HighlightEditor_serializeBoxes() {\n        if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_isFreeHighlight, \"f\")) {\n            return null;\n        }\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        const [pageX, pageY] = this.pageTranslation;\n        const boxes = kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_boxes, \"f\");\n        const quadPoints = new Float32Array(boxes.length * 8);\n        let i = 0;\n        for (const { x, y, width, height } of boxes) {\n            const sx = x * pageWidth + pageX;\n            const sy = (1 - y - height) * pageHeight + pageY;\n            // The specifications say that the rectangle should start from the bottom\n            // left corner and go counter-clockwise.\n            // But when opening the file in Adobe Acrobat it appears that this isn't\n            // correct hence the 4th and 6th numbers are just swapped.\n            quadPoints[i] = quadPoints[i + 4] = sx;\n            quadPoints[i + 1] = quadPoints[i + 3] = sy;\n            quadPoints[i + 2] = quadPoints[i + 6] = sx + width * pageWidth;\n            quadPoints[i + 5] = quadPoints[i + 7] = sy + height * pageHeight;\n            i += 8;\n        }\n        return quadPoints;\n    }, _HighlightEditor_serializeOutlines = function _HighlightEditor_serializeOutlines(rect) {\n        return kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_highlightOutlines, \"f\").serialize(rect, kendo_dateinputsCommon_cmn_chunk_js.a(this, _HighlightEditor_instances, \"m\", _HighlightEditor_getRotation).call(this));\n    }, _HighlightEditor_highlightMove = function _HighlightEditor_highlightMove(parent, event) {\n        if (this._freeHighlight.add(event)) {\n            // Redraw only if the point has been added.\n            parent.drawLayer.updatePath(this._freeHighlightId, this._freeHighlight);\n        }\n    }, _HighlightEditor_endHighlight = function _HighlightEditor_endHighlight(parent, event) {\n        if (!this._freeHighlight.isEmpty()) {\n            parent.createAndAddNewEditor(event, false, {\n                highlightId: this._freeHighlightId,\n                highlightOutlines: this._freeHighlight.getOutlines(),\n                clipPathId: this._freeHighlightClipId,\n                methodOfCreation: \"main_toolbar\",\n            });\n        }\n        else {\n            parent.drawLayer.removeFreeHighlight(this._freeHighlightId);\n        }\n        this._freeHighlightId = -1;\n        this._freeHighlight = null;\n        this._freeHighlightClipId = \"\";\n    };\n    HighlightEditor._defaultColor = null;\n    HighlightEditor._defaultOpacity = 1;\n    HighlightEditor._defaultThickness = 12;\n    HighlightEditor._type = \"highlight\";\n    HighlightEditor._editorType = kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT;\n    HighlightEditor._freeHighlightId = -1;\n    HighlightEditor._freeHighlight = null;\n    HighlightEditor._freeHighlightClipId = \"\";\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationEditorLayer_instances, _a$1, _AnnotationEditorLayer_accessibilityManager, _AnnotationEditorLayer_allowClick, _AnnotationEditorLayer_annotationLayer, _AnnotationEditorLayer_clickAC, _AnnotationEditorLayer_editorFocusTimeoutId, _AnnotationEditorLayer_editors, _AnnotationEditorLayer_hadPointerDown, _AnnotationEditorLayer_isCleaningUp, _AnnotationEditorLayer_isDisabling, _AnnotationEditorLayer_textLayer, _AnnotationEditorLayer_textSelectionAC, _AnnotationEditorLayer_uiManager, _AnnotationEditorLayer_editorTypes, _AnnotationEditorLayer_textLayerPointerDown, _AnnotationEditorLayer_currentEditorType_get, _AnnotationEditorLayer_createNewEditor, _AnnotationEditorLayer_getCenterPoint, _AnnotationEditorLayer_cleanup;\n    class AnnotationEditorLayer {\n        /**\n         * @param {AnnotationEditorLayerOptions} options\n         */\n        constructor({ uiManager, pageIndex, div, accessibilityManager, annotationLayer, drawLayer, textLayer, viewport\n        // l10n\n         }) {\n            _AnnotationEditorLayer_instances.add(this);\n            // todo: props\n            this.drawLayer = null;\n            this.pageIndex = 0;\n            this.div = null;\n            this.viewport = null;\n            // todo: props\n            _AnnotationEditorLayer_accessibilityManager.set(this, void 0);\n            _AnnotationEditorLayer_allowClick.set(this, false);\n            _AnnotationEditorLayer_annotationLayer.set(this, null);\n            _AnnotationEditorLayer_clickAC.set(this, null);\n            _AnnotationEditorLayer_editorFocusTimeoutId.set(this, null);\n            _AnnotationEditorLayer_editors.set(this, new Map());\n            _AnnotationEditorLayer_hadPointerDown.set(this, false);\n            _AnnotationEditorLayer_isCleaningUp.set(this, false);\n            _AnnotationEditorLayer_isDisabling.set(this, false);\n            _AnnotationEditorLayer_textLayer.set(this, null);\n            _AnnotationEditorLayer_textSelectionAC.set(this, null);\n            _AnnotationEditorLayer_uiManager.set(this, null);\n            const editorTypes = [...kendo_dateinputsCommon_cmn_chunk_js.a(_a$1, _a$1, \"f\", _AnnotationEditorLayer_editorTypes).values()];\n            if (!_a$1._initialized) {\n                _a$1._initialized = true;\n                for (const editorType of editorTypes) {\n                    // editorType.initialize(l10n, uiManager);\n                    editorType.initialize({}, uiManager);\n                }\n            }\n            uiManager.registerEditorTypes(editorTypes);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_uiManager, uiManager, \"f\");\n            this.pageIndex = pageIndex;\n            this.div = div;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_accessibilityManager, accessibilityManager, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_annotationLayer, annotationLayer, \"f\");\n            this.viewport = viewport;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_textLayer, textLayer, \"f\");\n            this.drawLayer = drawLayer;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addLayer(this);\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\") || !kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\")) {\n                return;\n            }\n        }\n        // todo: ported from AnnotationEditorLayerBuilder\n        hide() {\n            if (!this.div) {\n                return;\n            }\n            this.div.hidden = true;\n        }\n        show() {\n            if (!this.div || this.isInvisible) {\n                return;\n            }\n            this.div.hidden = false;\n        }\n        // todo: ported from AnnotationEditorLayerBuilder\n        get isEmpty() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").size === 0;\n        }\n        get isInvisible() {\n            return (this.isEmpty && kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode() === kendo_pdfjs_loader_js.AnnotationEditorType.NONE);\n        }\n        /**\n         * Update the toolbar if it's required to reflect the tool currently used.\n         * @param {number} mode\n         */\n        // updateToolbar(mode) {\n        updateToolbar() {\n            // this.#uiManager.updateToolbar(mode);\n        }\n        /**\n         * The mode has changed: it must be updated.\n         * @param {number} mode\n         */\n        updateMode(mode = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode()) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_cleanup).call(this);\n            switch (mode) {\n                case kendo_pdfjs_loader_js.AnnotationEditorType.NONE:\n                    this.disableTextSelection();\n                    this.togglePointerEvents(false);\n                    this.toggleAnnotationLayerPointerEvents(true);\n                    this.disableClick();\n                    return;\n                case kendo_pdfjs_loader_js.AnnotationEditorType.INK:\n                    // We always want to have an ink editor ready to draw in.\n                    this.addInkEditorIfNeeded(false);\n                    this.disableTextSelection();\n                    this.togglePointerEvents(true);\n                    this.disableClick();\n                    break;\n                case kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT:\n                    this.enableTextSelection();\n                    this.togglePointerEvents(false);\n                    this.disableClick();\n                    break;\n                default:\n                    this.disableTextSelection();\n                    this.togglePointerEvents(true);\n                    this.enableClick();\n            }\n            this.toggleAnnotationLayerPointerEvents(false);\n            const { classList } = this.div;\n            for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(_a$1, _a$1, \"f\", _AnnotationEditorLayer_editorTypes).values()) {\n                classList.toggle(`${editorType._type}Editing`, mode === editorType._editorType);\n            }\n            this.div.hidden = false;\n        }\n        hasTextLayer(textLayer) {\n            var _b;\n            return textLayer === ((_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\")) === null || _b === void 0 ? void 0 : _b.div);\n            // return textLayer === this.#textLayer || textLayer === this.#textLayer?.div;\n        }\n        addInkEditorIfNeeded(isCommitting) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode() !== kendo_pdfjs_loader_js.AnnotationEditorType.INK) {\n                // We don't want to add an ink editor if we're not in ink mode!\n                return;\n            }\n            if (!isCommitting) {\n                // We're removing an editor but an empty one can already exist so in this\n                // case we don't need to create a new one.\n                for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").values()) {\n                    if (editor.isEmpty()) {\n                        editor.setInBackground();\n                        return;\n                    }\n                }\n            }\n            const newEditor = this.createAndAddNewEditor({ offsetX: 0, offsetY: 0 }, \n            /* isCentered = */ false);\n            newEditor.setInBackground();\n        }\n        /**\n         * Set the editing state.\n         * @param {boolean} isEditing\n         */\n        setEditingState(isEditing) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").setEditingState(isEditing);\n        }\n        /**\n         * Add some commands into the CommandManager (undo/redo stuff).\n         * @param {Object} params\n         */\n        addCommands(params) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addCommands(params);\n        }\n        toggleDrawing(enabled = false) {\n            this.div.classList.toggle(\"drawing\", !enabled);\n            // this.div.classList.toggle(\"k-drawing\", !enabled);\n        }\n        togglePointerEvents(enabled = false) {\n            // this.div.classList.toggle(\"disabled\", !enabled);\n            this.div.classList.toggle(\"k-annotation-editor-layer-disabled\", !enabled);\n        }\n        toggleAnnotationLayerPointerEvents(enabled = false) {\n            var _b;\n            // this.#annotationLayer?.div.classList.toggle(\"disabled\", !enabled);\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\")) === null || _b === void 0 ? void 0 : _b.div.classList.toggle(\"k-annotation-editor-layer-disabled\", !enabled);\n        }\n        /**\n         * Enable pointer events on the main div in order to enable\n         * editor creation.\n         */\n        enable() {\n            this.div.tabIndex = 0;\n            this.togglePointerEvents(true);\n            const annotationElementIds = new Set();\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").values()) {\n                editor.enableEditing();\n                editor.show(true);\n                if (editor.annotationElementId) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").removeChangedExistingAnnotation(editor);\n                    annotationElementIds.add(editor.annotationElementId);\n                }\n            }\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\")) {\n                return;\n            }\n            const editables = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\").getEditableAnnotations();\n            for (const editable of editables) {\n                // The element must be hidden whatever its state is.\n                editable.hide();\n                if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").isDeletedAnnotationElement(editable.data.id)) {\n                    continue;\n                }\n                if (annotationElementIds.has(editable.data.id)) {\n                    continue;\n                }\n                const editor = this.deserialize(editable);\n                if (!editor) {\n                    continue;\n                }\n                this.addOrRebuild(editor);\n                editor.enableEditing();\n            }\n        }\n        /**\n         * Disable editor creation.\n         */\n        disable() {\n            var _b;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_isDisabling, true, \"f\");\n            this.div.tabIndex = -1;\n            this.togglePointerEvents(false);\n            const changedAnnotations = new Map();\n            const resetAnnotations = new Map();\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").values()) {\n                editor.disableEditing();\n                if (!editor.annotationElementId) {\n                    continue;\n                }\n                if (editor.serialize() !== null) {\n                    changedAnnotations.set(editor.annotationElementId, editor);\n                    continue;\n                }\n                else {\n                    resetAnnotations.set(editor.annotationElementId, editor);\n                }\n                (_b = this.getEditableAnnotation(editor.annotationElementId)) === null || _b === void 0 ? void 0 : _b.show();\n                editor.remove();\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\")) {\n                // Show the annotations that were hidden in enable().\n                const editables = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\").getEditableAnnotations();\n                for (const editable of editables) {\n                    const { id } = editable.data;\n                    if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").isDeletedAnnotationElement(id)) {\n                        continue;\n                    }\n                    let editor = resetAnnotations.get(id);\n                    if (editor) {\n                        editor.resetAnnotationElement(editable);\n                        editor.show(false);\n                        editable.show();\n                        continue;\n                    }\n                    editor = changedAnnotations.get(id);\n                    if (editor) {\n                        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addChangedExistingAnnotation(editor);\n                        editor.renderAnnotationElement(editable);\n                        editor.show(false);\n                    }\n                    editable.show();\n                }\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_cleanup).call(this);\n            if (this.isEmpty) {\n                this.div.hidden = true;\n            }\n            const { classList } = this.div;\n            for (const editorType of kendo_dateinputsCommon_cmn_chunk_js.a(_a$1, _a$1, \"f\", _AnnotationEditorLayer_editorTypes).values()) {\n                classList.remove(`${editorType._type}Editing`);\n            }\n            this.disableTextSelection();\n            this.toggleAnnotationLayerPointerEvents(true);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_isDisabling, false, \"f\");\n        }\n        getEditableAnnotation(id) {\n            var _b;\n            return ((_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_annotationLayer, \"f\")) === null || _b === void 0 ? void 0 : _b.getEditableAnnotation(id)) || null;\n        }\n        /**\n         * Set the current editor.\n         * @param {AnnotationEditor} editor\n         */\n        setActiveEditor(editor) {\n            const currentActive = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getActive();\n            if (currentActive === editor) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").setActiveEditor(editor);\n        }\n        enableTextSelection() {\n            var _b;\n            this.div.tabIndex = -1;\n            if (((_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\")) === null || _b === void 0 ? void 0 : _b.div) && !kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textSelectionAC, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_textSelectionAC, new AbortController(), \"f\");\n                const signal = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").combinedSignal(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textSelectionAC, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\").div.addEventListener(\"pointerdown\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_textLayerPointerDown).bind(this), { signal });\n                // this.#textLayer.div.classList.add(\"highlighting\");\n            }\n        }\n        disableTextSelection() {\n            var _b;\n            this.div.tabIndex = 0;\n            if (((_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\")) === null || _b === void 0 ? void 0 : _b.div) && kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textSelectionAC, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textSelectionAC, \"f\").abort();\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_textSelectionAC, null, \"f\");\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\").div.classList.remove(\"highlighting\");\n            }\n        }\n        enableClick() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_clickAC, \"f\")) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_clickAC, new AbortController(), \"f\");\n            const signal = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").combinedSignal(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_clickAC, \"f\"));\n            this.div.addEventListener(\"pointerdown\", this.pointerdown.bind(this), {\n                signal,\n            });\n            this.div.addEventListener(\"pointerup\", this.pointerup.bind(this), {\n                signal,\n            });\n        }\n        disableClick() {\n            var _b;\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_clickAC, \"f\")) === null || _b === void 0 ? void 0 : _b.abort();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_clickAC, null, \"f\");\n        }\n        attach(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").set(editor.id, editor);\n            const { annotationElementId } = editor;\n            if (annotationElementId &&\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").isDeletedAnnotationElement(annotationElementId)) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").removeDeletedAnnotationElement(editor);\n            }\n        }\n        detach(editor) {\n            var _b;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").delete(editor.id);\n            (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_accessibilityManager, \"f\")) === null || _b === void 0 ? void 0 : _b.removePointerInTextLayer(editor.contentDiv);\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_isDisabling, \"f\") && editor.annotationElementId) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addDeletedAnnotationElement(editor);\n            }\n        }\n        /**\n         * Remove an editor.\n         * @param {AnnotationEditor} editor\n         */\n        remove(editor) {\n            this.detach(editor);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").removeEditor(editor);\n            editor.div.remove();\n            editor.isAttachedToDOM = false;\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_isCleaningUp, \"f\")) {\n                this.addInkEditorIfNeeded(/* isCommitting = */ false);\n            }\n        }\n        /**\n         * An editor can have a different parent, for example after having\n         * being dragged and droped from a page to another.\n         * @param {AnnotationEditor} editor\n         */\n        changeParent(editor) {\n            var _b;\n            if (editor.parent === this) {\n                return;\n            }\n            if (editor.parent && editor.annotationElementId) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addDeletedAnnotationElement(editor.annotationElementId);\n                AnnotationEditor.deleteAnnotationElement(editor);\n                editor.annotationElementId = null;\n            }\n            this.attach(editor);\n            (_b = editor.parent) === null || _b === void 0 ? void 0 : _b.detach(editor);\n            editor.setParent(this);\n            if (editor.div && editor.isAttachedToDOM) {\n                editor.div.remove();\n                this.div.append(editor.div);\n            }\n        }\n        /**\n         * Add a new editor in the current view.\n         * @param {AnnotationEditor} editor\n         */\n        add(editor) {\n            if (editor.parent === this && editor.isAttachedToDOM) {\n                return;\n            }\n            this.changeParent(editor);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addEditor(editor);\n            this.attach(editor);\n            if (!editor.isAttachedToDOM) {\n                const div = editor.render();\n                this.div.append(div);\n                editor.isAttachedToDOM = true;\n            }\n            // The editor will be correctly moved into the DOM (see fixAndSetPosition).\n            editor.fixAndSetPosition();\n            editor.onceAdded();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").addToAnnotationStorage(editor);\n            // editor._reportTelemetry(editor.telemetryInitialData);\n            // todo: this differs from pdf.js\n            // this.setActiveEditor(editor);\n        }\n        moveEditorInDOM(editor) {\n            var _b;\n            if (!editor.isAttachedToDOM) {\n                return;\n            }\n            const { activeElement } = document;\n            if (editor.div.contains(activeElement) && !kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editorFocusTimeoutId, \"f\")) {\n                // When the div is moved in the DOM the focus can move somewhere else,\n                // so we want to be sure that the focus will stay on the editor but we\n                // don't want to call any focus callbacks, hence we disable them and only\n                // re-enable them when the editor has the focus.\n                editor._focusEventsAllowed = false;\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_editorFocusTimeoutId, setTimeout(() => {\n                    kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_editorFocusTimeoutId, null, \"f\");\n                    if (!editor.div.contains(document.activeElement)) {\n                        editor.div.addEventListener(\"focusin\", () => {\n                            editor._focusEventsAllowed = true;\n                        }, { once: true, signal: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\")._signal });\n                        activeElement.focus();\n                    }\n                    else {\n                        editor._focusEventsAllowed = true;\n                    }\n                }, 0), \"f\");\n            }\n            editor._structTreeParentId = (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_accessibilityManager, \"f\")) === null || _b === void 0 ? void 0 : _b.moveElementInDOM(this.div, editor.div, editor.contentDiv, \n            /* isRemovable = */ true);\n        }\n        /**\n         * Add or rebuild depending if it has been removed or not.\n         * @param {AnnotationEditor} editor\n         */\n        addOrRebuild(editor) {\n            if (editor.needsToBeRebuilt()) {\n                editor.parent || (editor.parent = this);\n                editor.rebuild();\n                editor.show();\n            }\n            else {\n                this.add(editor);\n            }\n        }\n        /**\n         * Add a new editor and make this addition undoable.\n         * @param {AnnotationEditor} editor\n         */\n        addUndoableEditor(editor) {\n            const cmd = () => editor._uiManager.rebuild(editor);\n            const undo = () => {\n                editor.remove();\n            };\n            this.addCommands({ cmd, undo, mustExec: false });\n        }\n        /**\n         * Get an id for an editor.\n         * @returns {string}\n         */\n        getNextId() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getId();\n        }\n        combinedSignal(abortController) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").combinedSignal(abortController);\n        }\n        canCreateNewEmptyEditor() {\n            var _b;\n            return (_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"a\", _AnnotationEditorLayer_currentEditorType_get)) === null || _b === void 0 ? void 0 : _b.canCreateNewEmptyEditor();\n        }\n        /**\n         * Paste some content into a new editor.\n         * @param {number} mode\n         * @param {Object} params\n         */\n        pasteEditor(mode, params) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").updateToolbar(mode);\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").updateMode(mode);\n            const { offsetX, offsetY } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_getCenterPoint).call(this);\n            const id = this.getNextId();\n            const editor = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_createNewEditor).call(this, Object.assign({ parent: this, id, x: offsetX, y: offsetY, uiManager: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\"), isCentered: true }, params));\n            if (editor) {\n                this.add(editor);\n            }\n        }\n        /**\n         * Create a new editor\n         * @param {Object} data\n         * @returns {AnnotationEditor | null}\n         */\n        deserialize(data) {\n            var _b, _c;\n            return (((_c = kendo_dateinputsCommon_cmn_chunk_js.a(_a$1, _a$1, \"f\", _AnnotationEditorLayer_editorTypes)\n                .get((_b = data.annotationType) !== null && _b !== void 0 ? _b : data.annotationEditorType)) === null || _c === void 0 ? void 0 : _c.deserialize(data, this, kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\"))) || null);\n        }\n        /**\n         * Create and add a new editor.\n         * @param {PointerEvent} event\n         * @param {boolean} isCentered\n         * @param [Object] data\n         * @returns {AnnotationEditor}\n         */\n        createAndAddNewEditor(event, isCentered, data = {}) {\n            const id = this.getNextId();\n            const editor = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_createNewEditor).call(this, Object.assign({ parent: this, id, x: event.offsetX, y: event.offsetY, uiManager: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\"), isCentered }, data));\n            if (editor) {\n                this.add(editor);\n            }\n            return editor;\n        }\n        /**\n         * Create and add a new editor.\n         */\n        addNewEditor() {\n            this.createAndAddNewEditor(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_getCenterPoint).call(this), /* isCentered = */ true);\n        }\n        /**\n         * Set the last selected editor.\n         * @param {AnnotationEditor} editor\n         */\n        setSelected(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").setSelected(editor);\n        }\n        /**\n         * Add or remove an editor the current selection.\n         * @param {AnnotationEditor} editor\n         */\n        toggleSelected(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").toggleSelected(editor);\n        }\n        /**\n         * Check if the editor is selected.\n         * @param {AnnotationEditor} editor\n         */\n        isSelected(editor) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").isSelected(editor);\n        }\n        /**\n         * Unselect an editor.\n         * @param {AnnotationEditor} editor\n         */\n        unselect(editor) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").unselect(editor);\n        }\n        /**\n         * Pointerup callback.\n         * @param {PointerEvent} event\n         */\n        pointerup(event) {\n            const { isMac } = kendo_pdfjs_loader_js.FeatureTest.platform;\n            if (event.button !== 0 || (event.ctrlKey && isMac)) {\n                // Don't create an editor on right click.\n                return;\n            }\n            if (event.target !== this.div) {\n                return;\n            }\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_hadPointerDown, \"f\")) {\n                // It can happen when the user starts a drag inside a text editor\n                // and then releases the mouse button outside of it. In such a case\n                // we don't want to create a new editor, hence we check that a pointerdown\n                // occurred on this div previously.\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_hadPointerDown, false, \"f\");\n            if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_allowClick, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_allowClick, true, \"f\");\n                return;\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode() === kendo_pdfjs_loader_js.AnnotationEditorType.STAMP) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").unselectAll();\n                return;\n            }\n            this.createAndAddNewEditor(event, /* isCentered = */ false);\n        }\n        /**\n         * Pointerdown callback.\n         * @param {PointerEvent} event\n         */\n        pointerdown(event) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode() === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT) {\n                this.enableTextSelection();\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_hadPointerDown, \"f\")) {\n                // It's possible to have a second pointerdown event before a pointerup one\n                // when the user puts a finger on a touchscreen and then add a second one\n                // to start a pinch-to-zoom gesture.\n                // That said, in case it's possible to have two pointerdown events with\n                // a mouse, we don't want to create a new editor in such a case either.\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_hadPointerDown, false, \"f\");\n                return;\n            }\n            const { isMac } = kendo_pdfjs_loader_js.FeatureTest.platform;\n            if (event.button !== 0 || (event.ctrlKey && isMac)) {\n                // Do nothing on right click.\n                return;\n            }\n            if (event.target !== this.div) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_hadPointerDown, true, \"f\");\n            const editor = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getActive();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_allowClick, !editor || editor.isEmpty(), \"f\");\n        }\n        /**\n         *\n         * @param {AnnotationEditor} editor\n         * @param {number} x\n         * @param {number} y\n         * @returns\n         */\n        findNewParent(editor, x, y) {\n            const layer = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").findParent(x, y);\n            if (layer === null || layer === this) {\n                return false;\n            }\n            layer.changeParent(editor);\n            return true;\n        }\n        /**\n         * Destroy the main editor.\n         */\n        destroy() {\n            var _b, _c;\n            if (((_b = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getActive()) === null || _b === void 0 ? void 0 : _b.parent) === this) {\n                // We need to commit the current editor before destroying the layer.\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").commitOrRemove();\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").setActiveEditor(null);\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editorFocusTimeoutId, \"f\")) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editorFocusTimeoutId, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_editorFocusTimeoutId, null, \"f\");\n            }\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").values()) {\n                (_c = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_accessibilityManager, \"f\")) === null || _c === void 0 ? void 0 : _c.removePointerInTextLayer(editor.contentDiv);\n                editor.setParent(null);\n                editor.isAttachedToDOM = false;\n                editor.div.remove();\n            }\n            this.div = null;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").clear();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").removeLayer(this);\n        }\n        /**\n         * Render the main editor.\n         * @param {RenderEditorLayerOptions} parameters\n         */\n        render({ viewport }) {\n            this.viewport = viewport;\n            kendo_pdfjs_loader_js.setLayerDimensions(this.div, viewport);\n            for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getEditors(this.pageIndex)) {\n                this.add(editor);\n                editor.rebuild();\n            }\n            // We're maybe rendering a layer which was invisible when we started to edit\n            // so we must set the different callbacks for it.\n            this.updateMode();\n        }\n        // /**\n        //  * Update the main editor.\n        //  * @param {RenderEditorLayerOptions} parameters\n        //  */\n        update({ viewport }) {\n            // Editors have their dimensions/positions in percent so to avoid any\n            // issues (see #15582), we must commit the current one before changing\n            // the viewport.\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").commitOrRemove();\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"m\", _AnnotationEditorLayer_cleanup).call(this);\n            const oldRotation = this.viewport.rotation;\n            const rotation = viewport.rotation;\n            this.viewport = viewport;\n            // setLayerDimensions(this.div, { rotation });\n            // todo: fix parameters\n            // setLayerDimensions(this.div, { rotation } as PageViewport);\n            kendo_pdfjs_loader_js.setLayerDimensions(this.div, viewport);\n            if (oldRotation !== rotation) {\n                for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").values()) {\n                    editor.rotate(rotation);\n                }\n            }\n            this.addInkEditorIfNeeded(/* isCommitting = */ false);\n        }\n        /**\n         * Get page dimensions.\n         * @returns {Object} dimensions.\n         */\n        get pageDimensions() {\n            const { pageWidth, pageHeight } = this.viewport.rawDims;\n            return [pageWidth, pageHeight];\n        }\n        get scale() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").viewParameters.realScale;\n        }\n    }\n    _a$1 = AnnotationEditorLayer, _AnnotationEditorLayer_accessibilityManager = new WeakMap(), _AnnotationEditorLayer_allowClick = new WeakMap(), _AnnotationEditorLayer_annotationLayer = new WeakMap(), _AnnotationEditorLayer_clickAC = new WeakMap(), _AnnotationEditorLayer_editorFocusTimeoutId = new WeakMap(), _AnnotationEditorLayer_editors = new WeakMap(), _AnnotationEditorLayer_hadPointerDown = new WeakMap(), _AnnotationEditorLayer_isCleaningUp = new WeakMap(), _AnnotationEditorLayer_isDisabling = new WeakMap(), _AnnotationEditorLayer_textLayer = new WeakMap(), _AnnotationEditorLayer_textSelectionAC = new WeakMap(), _AnnotationEditorLayer_uiManager = new WeakMap(), _AnnotationEditorLayer_instances = new WeakSet(), _AnnotationEditorLayer_textLayerPointerDown = function _AnnotationEditorLayer_textLayerPointerDown(event) {\n        // Unselect all the editors in order to let the user select some text\n        // without being annoyed by an editor toolbar.\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").unselectAll();\n        const { target } = event;\n        if (target === kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\").div ||\n            (target.classList.contains(\"endOfContent\") && kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\").div.contains(target))) {\n            const { isMac } = kendo_pdfjs_loader_js.FeatureTest.platform;\n            if (event.button !== 0 || (event.ctrlKey && isMac)) {\n                // Do nothing on right click.\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").showAllEditors(\"highlight\", true);\n            // if (this.#uiManager.getMode() === AnnotationEditorType.HIGHLIGHT) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode() === kendo_pdfjs_loader_js.AnnotationEditorType.NONE) {\n                // todo: do not continue with free highlight\n                return;\n            }\n            // this.#textLayer.div.classList.add(\"free\");\n            // todo: intentionally prevent free highlight\n            // this.toggleDrawing();\n            // HighlightEditor.startHighlighting(\n            //     this,\n            //     this.#uiManager.direction === \"ltr\",\n            //     event\n            // );\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\").div.addEventListener(\"pointerup\", () => {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_textLayer, \"f\").div.classList.remove(\"free\");\n                this.toggleDrawing(true);\n            }, { once: true, signal: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\")._signal });\n            event.preventDefault();\n        }\n    }, _AnnotationEditorLayer_currentEditorType_get = function _AnnotationEditorLayer_currentEditorType_get() {\n        return kendo_dateinputsCommon_cmn_chunk_js.a(_a$1, _a$1, \"f\", _AnnotationEditorLayer_editorTypes).get(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_uiManager, \"f\").getMode());\n    }, _AnnotationEditorLayer_createNewEditor = function _AnnotationEditorLayer_createNewEditor(params) {\n        const editorType = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_instances, \"a\", _AnnotationEditorLayer_currentEditorType_get);\n        // return editorType ? new editorType.prototype.constructor(params) : null;\n        return editorType ? new editorType(params) : null;\n    }, _AnnotationEditorLayer_getCenterPoint = function _AnnotationEditorLayer_getCenterPoint() {\n        const { x, y, width, height } = this.div.getBoundingClientRect();\n        const tlX = Math.max(0, x);\n        const tlY = Math.max(0, y);\n        const brX = Math.min(window.innerWidth, x + width);\n        const brY = Math.min(window.innerHeight, y + height);\n        const centerX = (tlX + brX) / 2 - x;\n        const centerY = (tlY + brY) / 2 - y;\n        const [offsetX, offsetY] = this.viewport.rotation % 180 === 0\n            ? [centerX, centerY]\n            : [centerY, centerX];\n        return { offsetX, offsetY };\n    }, _AnnotationEditorLayer_cleanup = function _AnnotationEditorLayer_cleanup() {\n        // When we're cleaning up, some editors are removed but we don't want\n        // to add a new one which will induce an addition in this.#editors, hence\n        // an infinite loop.\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_isCleaningUp, true, \"f\");\n        for (const editor of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayer_editors, \"f\").values()) {\n            if (editor.isEmpty()) {\n                editor.remove();\n            }\n        }\n        kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayer_isCleaningUp, false, \"f\");\n    };\n    AnnotationEditorLayer._initialized = false;\n    _AnnotationEditorLayer_editorTypes = { value: new Map(\n        // [FreeTextEditor, InkEditor, StampEditor, HighlightEditor].map(type => [\n        [FreeTextEditor, HighlightEditor].map(type => [\n            type._editorType,\n            type\n        ])) };\n\n    /* Copyright 2022 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationEditorLayerBuilder_annotationLayer, _AnnotationEditorLayerBuilder_drawLayer, _AnnotationEditorLayerBuilder_onAppend, _AnnotationEditorLayerBuilder_textLayer, _AnnotationEditorLayerBuilder_uiManager;\n    // import { GenericL10n } from \"web-null_l10n\";\n    /**\n     * @typedef {Object} AnnotationEditorLayerBuilderOptions\n     * @property {AnnotationEditorUIManager} [uiManager]\n     * @property {PDFPageProxy} pdfPage\n     * @property {IL10n} [l10n]\n     * @property {TextAccessibilityManager} [accessibilityManager]\n     * @property {AnnotationLayer} [annotationLayer]\n     * @property {TextLayer} [textLayer]\n     * @property {DrawLayer} [drawLayer]\n     * @property {function} [onAppend]\n     */\n    class AnnotationEditorLayerBuilder {\n        /**\n         * @param {AnnotationEditorLayerBuilderOptions} options\n         */\n        constructor(options) {\n            // todo: props\n            this.pdfPage = null;\n            this.annotationEditorLayer = null;\n            this._cancelled = null;\n            this.div = null;\n            this.accessibilityManager = null;\n            // todo: props\n            _AnnotationEditorLayerBuilder_annotationLayer.set(this, null);\n            _AnnotationEditorLayerBuilder_drawLayer.set(this, null);\n            _AnnotationEditorLayerBuilder_onAppend.set(this, null);\n            _AnnotationEditorLayerBuilder_textLayer.set(this, null);\n            _AnnotationEditorLayerBuilder_uiManager.set(this, null);\n            this.pdfPage = options.pdfPage;\n            this.accessibilityManager = options.accessibilityManager;\n            // this.l10n = options.l10n;\n            // if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n            // this.l10n ||= new GenericL10n();\n            // }\n            this.annotationEditorLayer = null;\n            this.div = null;\n            this._cancelled = false;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayerBuilder_uiManager, options.uiManager, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayerBuilder_annotationLayer, options.annotationLayer || null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayerBuilder_textLayer, options.textLayer || null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayerBuilder_drawLayer, options.drawLayer || null, \"f\");\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationEditorLayerBuilder_onAppend, options.onAppend || null, \"f\");\n        }\n        /**\n         * @param {PageViewport} viewport\n         * @param {string} intent (default value is 'display')\n         */\n        render(viewport_1) {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, arguments, void 0, function* (viewport, intent = \"display\") {\n                var _a;\n                if (intent !== \"display\") {\n                    return;\n                }\n                if (this._cancelled) {\n                    return;\n                }\n                const clonedViewport = viewport.clone({ dontFlip: true });\n                if (this.div) {\n                    this.annotationEditorLayer.update({ viewport: clonedViewport });\n                    this.show();\n                    return;\n                }\n                // Create an AnnotationEditor layer div\n                const div = (this.div = document.createElement(\"div\"));\n                div.className = \"k-annotation-editor-layer annotationEditorLayer\";\n                div.hidden = true;\n                div.dir = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayerBuilder_uiManager, \"f\").direction;\n                (_a = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayerBuilder_onAppend, \"f\")) === null || _a === void 0 ? void 0 : _a.call(this, div);\n                this.annotationEditorLayer = new AnnotationEditorLayer({\n                    uiManager: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayerBuilder_uiManager, \"f\"),\n                    div,\n                    accessibilityManager: this.accessibilityManager,\n                    pageIndex: this.pdfPage.pageNumber - 1,\n                    // l10n: this.l10n,\n                    viewport: clonedViewport,\n                    annotationLayer: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayerBuilder_annotationLayer, \"f\"),\n                    textLayer: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayerBuilder_textLayer, \"f\"),\n                    drawLayer: kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationEditorLayerBuilder_drawLayer, \"f\"),\n                });\n                const parameters = {\n                    viewport: clonedViewport,\n                    div,\n                    annotations: null,\n                    intent,\n                };\n                this.annotationEditorLayer.render(parameters);\n                this.show();\n            });\n        }\n        cancel() {\n            this._cancelled = true;\n            if (!this.div) {\n                return;\n            }\n            this.annotationEditorLayer.destroy();\n        }\n        hide() {\n            if (!this.div) {\n                return;\n            }\n            this.div.hidden = true;\n        }\n        show() {\n            if (!this.div || this.annotationEditorLayer.isInvisible) {\n                return;\n            }\n            this.div.hidden = false;\n        }\n    }\n    _AnnotationEditorLayerBuilder_annotationLayer = new WeakMap(), _AnnotationEditorLayerBuilder_drawLayer = new WeakMap(), _AnnotationEditorLayerBuilder_onAppend = new WeakMap(), _AnnotationEditorLayerBuilder_textLayer = new WeakMap(), _AnnotationEditorLayerBuilder_uiManager = new WeakMap();\n\n    var _Page_instances, _Page_annotationMode, _Page_isEditing, _Page_layerProperties, _Page_previousRotation, _Page_renderingState, _Page_textLayerMode, _Page_viewportMap, _Page_layers, _Page_addLayer, _Page_setDimensions, _Page_dispatchLayerRendered, _Page_renderAnnotationLayer, _Page_renderAnnotationEditorLayer, _Page_renderDrawLayer, _Page_renderTextLayer, _Page_finishRenderTask;\n    const DEFAULT_ZOOM_LEVEL$1 = 1.25;\n    const DEFAULT_LAYER_PROPERTIES = {\n        annotationEditorUIManager: null,\n        annotationStorage: null,\n        downloadManager: null,\n        enableScripting: false,\n        fieldObjectsPromise: null,\n        findController: null,\n        hasJSActionsPromise: null,\n        get linkService() {\n            // return new SimpleLinkService();\n            return null;\n        },\n    };\n    const LAYERS_ORDER = new Map([\n        [\"canvasWrapper\", 0],\n        [\"textLayer\", 1],\n        [\"annotationLayer\", 2],\n        [\"annotationEditorLayer\", 3],\n        [\"xfaLayer\", 3],\n    ]);\n    class Page extends Component {\n        constructor(element, options) {\n            super(element, options);\n            _Page_instances.add(this);\n            // todo: props\n            this.eventBus = null;\n            this.zoomLayer = null;\n            this.div = null;\n            this.viewport = null;\n            this.id = 1;\n            this._accessibilityManager = null;\n            this._annotationCanvasMap = new Map();\n            this.renderTask = null;\n            this.pdfPageRotate = null;\n            this.rotation = null;\n            this.scale = null;\n            this.pdfViewer = null;\n            // todo: props\n            // todo: props ported from pdf.js\n            this.xfaLayer = null;\n            _Page_annotationMode.set(this, kendo_pdfjs_loader_js.AnnotationMode.ENABLE_FORMS);\n            // #enableHWA = false;\n            // #hasRestrictedScaling = false;\n            // // @ts-expect-error(TS)\n            _Page_isEditing.set(this, false);\n            _Page_layerProperties.set(this, null);\n            // #loadingId = null;\n            _Page_previousRotation.set(this, null);\n            // #renderError = null;\n            _Page_renderingState.set(this, RenderingStates.INITIAL);\n            _Page_textLayerMode.set(this, TextLayerMode.ENABLE);\n            // #useThumbnailCanvas = {\n            //   directDrawing: true,\n            //   initialOptionalContent: true,\n            //   regularAnnotations: true,\n            // };\n            _Page_viewportMap.set(this, new WeakMap());\n            _Page_layers.set(this, [null, null, null, null]);\n            // textLayer: HTMLDivElement;\n            this.textLayer = null;\n            this.textLayerBuilder = null;\n            this.textAccessibilityManager = null;\n            this.annotationLayer = null;\n            this.drawLayer = null;\n            this.annotationEditorLayer = null;\n            this.options = {};\n            this.state = {};\n            this.pdfPage = null;\n            this.extendOptions(options);\n            // todo: ported from pdf.js\n            this.div = element;\n            this.viewport = this.options.viewport;\n            this.id = this.options.id || this.options.number || 1;\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _Page_layerProperties, options.layerProperties || DEFAULT_LAYER_PROPERTIES, \"f\");\n            this.eventBus = options.eventBus;\n            this.initScale();\n            // todo: ported from pdf.js\n            this.pdfViewer = options.pdfViewer;\n            this.pdfPage = options.pdfPage;\n            this.resetState();\n        }\n        destroy() {\n            this.destroyTextLayer();\n        }\n        get isEditing() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_isEditing, \"f\");\n        }\n        get rawWidth() {\n            var _a, _b;\n            return (_b = (_a = this.viewport) === null || _a === void 0 ? void 0 : _a.rawDims) === null || _b === void 0 ? void 0 : _b.pageWidth;\n        }\n        get rawHeight() {\n            var _a, _b;\n            return (_b = (_a = this.viewport) === null || _a === void 0 ? void 0 : _a.rawDims) === null || _b === void 0 ? void 0 : _b.pageWidth;\n        }\n        setState(newState) {\n            this.state = deepExtend(this.state || {}, newState);\n        }\n        resetState() {\n            this.setState({});\n        }\n        initScale() {\n            this.scale = this.options.zoomLevel || this.options.scale || DEFAULT_SCALE;\n        }\n        createPromise() {\n            return createPromise();\n        }\n        getViewport(options = { scale: 1 }) {\n            const viewport = this.pdfPage ? this.pdfPage.getViewport(options) : { width: 0, height: 0 };\n            return viewport;\n        }\n        destroyTextLayer() {\n            this.removeTextLayer();\n        }\n        removeTextLayer() {\n            var _a, _b;\n            if (this.textLayer && ((_a = this.textLayer.div) === null || _a === void 0 ? void 0 : _a.parentNode)) {\n                (_b = this.textLayer.div) === null || _b === void 0 ? void 0 : _b.parentNode.removeChild(this.textLayer.div);\n            }\n        }\n        getPrintContentAsync() {\n            const canvas = this.canvasForPrint;\n            const printContentLoadPromise = this.createPromise();\n            const printContent = new Image();\n            const viewportRawDimensions = this.viewport.rawDims;\n            const pageWidth = viewportRawDimensions.pageWidth;\n            const pageHeight = viewportRawDimensions.pageHeight;\n            // const pageWidth = this.viewport.width;\n            // const pageHeight = this.viewport.height;\n            printContent.src = canvas.toDataURL();\n            printContent.width = pageWidth;\n            printContent.height = pageHeight;\n            printContent.onload = () => {\n                // @ts-expect-error TS(2339):\n                printContentLoadPromise.resolve(printContent);\n            };\n            return printContentLoadPromise;\n        }\n        loadForPrintAsync({ zoomLevel = DEFAULT_ZOOM_LEVEL$1, force = false }) {\n            const that = this;\n            const pageLoadPromise = this.createPromise();\n            const pageZoomLevel = this.pdfViewer.state.zoomLevel;\n            if (this.pdfPage && pageZoomLevel === zoomLevel && !force) {\n                // @ts-expect-error TS(2339): Property 'resolve' does not exist on type 'Promise... Remove this comment to see the full error message\n                return pageLoadPromise.resolve(that);\n            }\n            else if (this.pdfPage && pageZoomLevel && (pageZoomLevel !== zoomLevel || force)) {\n                this.renderForPrintAsync()\n                    .then(() => {\n                    this.setState({\n                        isPrintingInProgress: false\n                    });\n                    // @ts-expect-error TS(2339): Property 'resolve' does not exist on type 'Promise... Remove this comment to see the full error message\n                    pageLoadPromise.resolve(that);\n                });\n                return pageLoadPromise;\n            }\n            const pageIndex = Math.max(0, this.pdfPage._pageIndex);\n            const pagePromise = this.pdfViewer.state.pdfDocument.getPage(pageIndex + 1);\n            pagePromise.then(() => {\n                this.renderForPrintAsync()\n                    .then(() => {\n                    this.setState({\n                        isPrintingInProgress: false\n                    });\n                    // @ts-expect-error TS(2339): Property 'resolve' does not exist on type 'Promise... Remove this comment to see the full error message\n                    pageLoadPromise.resolve(that);\n                });\n            });\n            return pageLoadPromise;\n        }\n        renderForPrintAsync() {\n            var _a, _b;\n            const { canvasContext, canvas,\n            // canvasWrapper,\n            // viewport,\n            // pageElement,\n            // _styles\n             } = this.pdfViewer.createPageElements({\n                pdfPage: this.pdfPage,\n                zoom: this.pdfViewer.options.zoomLevel || 1,\n            });\n            this.canvasForPrint = canvas;\n            // canvasWrapper.appendChild(canvas);\n            // pageElement.appendChild(canvasWrapper);\n            this.setState({\n                isPrintingInProgress: true\n            });\n            const printUnits = this.pdfViewer.options.printResolution / kendo_pdfjs_loader_js.PixelsPerInch.PDF;\n            const optionalContentConfigPromise = this.pdfViewer.state.pdfDocument.getOptionalContentConfig({\n                intent: \"print\",\n            });\n            const renderContext = {\n                canvasContext: canvasContext,\n                transform: [printUnits, 0, 0, printUnits, 0, 0],\n                // viewport: this.pdfPage.getViewport({ scale: 1, rotation: size.rotation }),\n                viewport: this.pdfPage.getViewport({ scale: 1, rotation: this.viewport.rotation }),\n                intent: \"print\",\n                annotationMode: kendo_pdfjs_loader_js.AnnotationMode.ENABLE_STORAGE,\n                optionalContentConfigPromise,\n                printAnnotationStorage: (_b = (_a = this.pdfViewer) === null || _a === void 0 ? void 0 : _a.annotationStorage) === null || _b === void 0 ? void 0 : _b.print\n            };\n            const renderTask = this.pdfPage.render(renderContext);\n            const resultPromise = renderTask.promise;\n            return resultPromise;\n        }\n        isBlank() {\n            return this.element && this.element.getAttribute(\"data-blank\");\n        }\n        setBlank(isBlank) {\n            if (!this.element) {\n                return;\n            }\n            if (isBlank) {\n                this.element.setAttribute(\"data-blank\", true.toString());\n            }\n            else {\n                this.element.removeAttribute(\"data-blank\");\n            }\n        }\n        get renderingState() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_renderingState, \"f\");\n        }\n        setPdfPage(pdfPage) {\n            // if (\n            //     (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n            //     this._isStandalone &&\n            //     (this.pageColors?.foreground === \"CanvasText\" ||\n            //         this.pageColors?.background === \"Canvas\")\n            // ) {\n            //     this._container?.style.setProperty(\n            //         \"--hcm-highlight-filter\",\n            //         pdfPage.filterFactory.addHighlightHCMFilter(\n            //             \"highlight\",\n            //             \"CanvasText\",\n            //             \"Canvas\",\n            //             \"HighlightText\",\n            //             \"Highlight\"\n            //         )\n            //     );\n            //     this._container?.style.setProperty(\n            //         \"--hcm-highlight-selected-filter\",\n            //         pdfPage.filterFactory.addHighlightHCMFilter(\n            //             \"highlight_selected\",\n            //             \"CanvasText\",\n            //             \"Canvas\",\n            //             \"HighlightText\",\n            //             \"Highlight\"\n            //         )\n            //     );\n            // }\n            this.pdfPage = pdfPage;\n            this.pdfPageRotate = pdfPage.rotate;\n            const totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n            this.viewport = pdfPage.getViewport({\n                scale: this.scale * kendo_pdfjs_loader_js.PixelsPerInch.PDF_TO_CSS_UNITS,\n                rotation: totalRotation,\n            });\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_setDimensions).call(this);\n            this.reset();\n        }\n        hasEditableAnnotations() {\n            var _a;\n            return !!((_a = this.annotationLayer) === null || _a === void 0 ? void 0 : _a.hasEditableAnnotations());\n        }\n        // /**\n        //  * The structure tree is currently only supported when the text layer is\n        //  * enabled and a canvas is used for rendering.\n        //  *\n        //  * The structure tree must be generated after the text layer for the\n        //  * aria-owns to work.\n        //  */\n        // async #renderStructTreeLayer() {\n        //     if (!this.textLayer) {\n        //         return;\n        //     }\n        //     this.structTreeLayer ||= new StructTreeLayerBuilder();\n        //     const tree = await (!this.structTreeLayer.renderingDone\n        //         ? this.pdfPage.getStructTree()\n        //         : null);\n        //     const treeDom = this.structTreeLayer?.render(tree);\n        //     if (treeDom) {\n        //         // Pause translation when inserting the structTree in the DOM.\n        //         this.l10n.pause();\n        //         this.canvas?.append(treeDom);\n        //         this.l10n.resume();\n        //     }\n        //     this.structTreeLayer?.show();\n        // }\n        // async #buildXfaTextContentItems(textDivs) {\n        //     const text = await this.pdfPage.getTextContent();\n        //     const items = [];\n        //     for (const item of text.items) {\n        //         items.push(item.str);\n        //     }\n        //     this._textHighlighter.setTextMapping(textDivs, items);\n        //     this._textHighlighter.enable();\n        // }\n        _resetZoomLayer(removeFromDOM = false) {\n            if (!this.zoomLayer) {\n                return;\n            }\n            const zoomLayerCanvas = this.zoomLayer.firstChild;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_viewportMap, \"f\").delete(zoomLayerCanvas);\n            // Zeroing the width and height causes Firefox to release graphics\n            // resources immediately, which can greatly reduce memory consumption.\n            zoomLayerCanvas.width = 0;\n            zoomLayerCanvas.height = 0;\n            if (removeFromDOM) {\n                // Note: `ChildNode.remove` doesn't throw if the parent node is undefined.\n                this.zoomLayer.remove();\n            }\n            this.zoomLayer = null;\n        }\n        reset({ keepZoomLayer = false, keepAnnotationLayer = false, keepAnnotationEditorLayer = false, keepXfaLayer = false, keepTextLayer = false, } = {}) {\n            // this.cancelRendering({\n            //     keepAnnotationLayer,\n            //     keepAnnotationEditorLayer,\n            //     keepXfaLayer,\n            //     keepTextLayer,\n            // });\n            // this.renderingState = RenderingStates.INITIAL;\n            var _a, _b, _c, _d, _e, _f, _g, _h;\n            const div = this.div;\n            if (!div) {\n                return;\n            }\n            const childNodes = div.childNodes, zoomLayerNode = (keepZoomLayer && this.zoomLayer) || null, annotationLayerNode = (keepAnnotationLayer && ((_a = this.annotationLayer) === null || _a === void 0 ? void 0 : _a.div)) || null, annotationEditorLayerNode = (keepAnnotationEditorLayer && ((_b = this.annotationEditorLayer) === null || _b === void 0 ? void 0 : _b.div)) || null, xfaLayerNode = (keepXfaLayer && ((_c = this.xfaLayer) === null || _c === void 0 ? void 0 : _c.div)) || null, textLayerNode = (keepTextLayer && ((_d = this.textLayer) === null || _d === void 0 ? void 0 : _d.div)) || null;\n            for (let i = childNodes.length - 1; i >= 0; i--) {\n                const node = childNodes[i];\n                switch (node) {\n                    case zoomLayerNode:\n                    case annotationLayerNode:\n                    case annotationEditorLayerNode:\n                    case xfaLayerNode:\n                    case textLayerNode:\n                        continue;\n                    default: break;\n                }\n                node.remove();\n                const layerIndex = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layers, \"f\").indexOf(node);\n                if (layerIndex >= 0) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layers, \"f\")[layerIndex] = null;\n                }\n            }\n            div.removeAttribute(\"data-loaded\");\n            if (annotationLayerNode) {\n                // Hide the annotation layer until all elements are resized\n                // so they are not displayed on the already resized page.\n                (_e = this.annotationLayer) === null || _e === void 0 ? void 0 : _e.hide();\n            }\n            if (annotationEditorLayerNode) {\n                (_f = this.annotationEditorLayer) === null || _f === void 0 ? void 0 : _f.hide();\n            }\n            if (xfaLayerNode) {\n                // Hide the XFA layer until all elements are resized\n                // so they are not displayed on the already resized page.\n                (_g = this.xfaLayer) === null || _g === void 0 ? void 0 : _g.hide();\n            }\n            if (textLayerNode) {\n                (_h = this.textLayer) === null || _h === void 0 ? void 0 : _h.hide();\n            }\n            // this.structTreeLayer?.hide();\n            if (!zoomLayerNode) {\n                if (this.canvas) {\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_viewportMap, \"f\").delete(this.canvas);\n                    // Zeroing the width and height causes Firefox to release graphics\n                    // resources immediately, which can greatly reduce memory consumption.\n                    this.canvas.width = 0;\n                    this.canvas.height = 0;\n                    delete this.canvas;\n                }\n                this._resetZoomLayer();\n            }\n        }\n        toggleEditingMode(isEditing) {\n            if (!this.hasEditableAnnotations()) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _Page_isEditing, isEditing, \"f\");\n            this.reset({\n                keepZoomLayer: true,\n                keepAnnotationLayer: true,\n                keepAnnotationEditorLayer: true,\n                keepXfaLayer: true,\n                keepTextLayer: true,\n            });\n        }\n        draw() {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                // if (this.renderingState !== RenderingStates.INITIAL) {\n                //     console.error(\"Must be in new state before drawing\");\n                //     this.reset(); // Ensure that we reset all state to prevent issues.\n                // }\n                // const { div, l10n, pageColors, pdfPage: pdfPage, viewport } = this;\n                // if (!pdfPage) {\n                //     this.renderingState = RenderingStates.FINISHED;\n                //     throw new Error(\"pdfPage is not loaded\");\n                // }\n                // this.renderingState = RenderingStates.RUNNING;\n                const { canvasContext, canvas, canvasWrapper, viewport, pageElement, styles } = this.pdfViewer.createPageElements({\n                    pdfPage: this.pdfPage,\n                    zoom: this.pdfViewer.options.zoomLevel || 1,\n                });\n                if (this.isBlank()) {\n                    this.element.replaceWith(pageElement);\n                    this.element = this.div = pageElement;\n                    this.canvas = canvas;\n                }\n                else {\n                    this.element = this.div = this.element || this.div || pageElement;\n                    this.canvas = this.canvas || canvas;\n                }\n                this.options.styles = styles;\n                // Wrap the canvas so that if it has a CSS transform for high DPI the\n                // overflow will be hidden in Firefox.\n                // const canvasWrapper = document.createElement(\"div\");\n                // canvasWrapper.classList.add(\"canvasWrapper\");\n                canvasWrapper.appendChild(canvas);\n                this.element.appendChild(canvasWrapper);\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_addLayer).call(this, canvasWrapper, \"canvasWrapper\");\n                const { div, \n                // l10n,\n                // pageColors,\n                pdfPage,\n                // viewport\n                 } = this;\n                if (!this.textLayer && kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_textLayerMode, \"f\") !== TextLayerMode.DISABLE && !pdfPage.isPureXfa) {\n                    this._accessibilityManager || (this._accessibilityManager = new TextAccessibilityManager());\n                    this.textLayer = new TextLayerBuilder({\n                        // todo: not part of pdf.js\n                        styles: this.options.styles,\n                        pdfPage,\n                        // highlighter: this._textHighlighter,\n                        accessibilityManager: this._accessibilityManager,\n                        // enablePermissions: this.#textLayerMode === TextLayerMode.ENABLE_PERMISSIONS,\n                        onAppend: textLayerDiv => {\n                            // Pause translation when inserting the textLayer in the DOM.\n                            // this.l10n.pause();\n                            kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_addLayer).call(this, textLayerDiv, \"textLayer\");\n                            // this.l10n.resume();\n                        },\n                    });\n                }\n                if (!this.annotationLayer && kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_annotationMode, \"f\") !== kendo_pdfjs_loader_js.AnnotationMode.DISABLE) {\n                    const { annotationStorage, annotationEditorUIManager, \n                    // downloadManager,\n                    // enableScripting,\n                    // fieldObjectsPromise,\n                    // hasJSActionsPromise,\n                    linkService, } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layerProperties, \"f\");\n                    this._annotationCanvasMap || (this._annotationCanvasMap = new Map());\n                    this.annotationLayer = new AnnotationLayerBuilder({\n                        pdfPage,\n                        eventBus: this.eventBus || this.pdfViewer.eventBus,\n                        annotationStorage,\n                        // imageResourcesPath: this.imageResourcesPath,\n                        // renderForms: this.#annotationMode === AnnotationMode.ENABLE_FORMS,\n                        linkService,\n                        // downloadManager,\n                        // enableScripting,\n                        // hasJSActionsPromise,\n                        // fieldObjectsPromise,\n                        annotationCanvasMap: this._annotationCanvasMap,\n                        accessibilityManager: this._accessibilityManager,\n                        annotationEditorUIManager,\n                        onAppend: annotationLayerDiv => {\n                            kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_addLayer).call(this, annotationLayerDiv, \"annotationLayer\");\n                        },\n                    });\n                }\n                // const renderContinueCallback = cont => {\n                //     showCanvas?.(false);\n                //     if (this.renderingQueue && !this.renderingQueue.isHighestPriority(this)) {\n                //         this.renderingState = RenderingStates.PAUSED;\n                //         this.resume = () => {\n                //             this.renderingState = RenderingStates.RUNNING;\n                //             cont();\n                //         };\n                //         return;\n                //     }\n                //     cont();\n                // };\n                // const { width, height } = viewport;\n                // const canvas = document.createElement(\"canvas\");\n                // canvas.setAttribute(\"role\", \"presentation\");\n                // // Keep the canvas hidden until the first draw callback, or until drawing\n                // // is complete when `!this.renderingQueue`, to prevent black flickering.\n                // canvas.hidden = true;\n                // const hasHCM = !!(pageColors?.background && pageColors?.foreground);\n                // let showCanvas = isLastShow => {\n                //     // In HCM, a final filter is applied on the canvas which means that\n                //     // before it's applied we've normal colors. Consequently, to avoid to have\n                //     // a final flash we just display it once all the drawing is done.\n                //     if (!hasHCM || isLastShow) {\n                //         canvas.hidden = false;\n                //         showCanvas = null; // Only invoke the function once.\n                //     }\n                // };\n                // canvasWrapper.append(canvas);\n                // this.canvas = canvas;\n                // const ctx = canvas.getContext(\"2d\", {\n                //     alpha: false,\n                //     willReadFrequently: !this.#enableHWA,\n                // });\n                // const ctx = canvas.getContext(\"2d\");\n                // const outputScale = (this.outputScale = new OutputScale());\n                // if (\n                //     (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n                //     this.maxCanvasPixels === 0\n                // ) {\n                //     const invScale = 1 / this.scale;\n                //     // Use a scale that makes the canvas have the originally intended size\n                //     // of the page.\n                //     outputScale.sx *= invScale;\n                //     outputScale.sy *= invScale;\n                //     this.#hasRestrictedScaling = true;\n                // } else if (this.maxCanvasPixels > 0) {\n                //     const pixelsInViewport = width * height;\n                //     const maxScale = Math.sqrt(this.maxCanvasPixels / pixelsInViewport);\n                //     if (outputScale.sx > maxScale || outputScale.sy > maxScale) {\n                //         outputScale.sx = maxScale;\n                //         outputScale.sy = maxScale;\n                //         this.#hasRestrictedScaling = true;\n                //     } else {\n                //         this.#hasRestrictedScaling = false;\n                //     }\n                // }\n                // const sfx = approximateFraction(outputScale.sx);\n                // const sfy = approximateFraction(outputScale.sy);\n                // canvas.width = floorToDivide(width * outputScale.sx, sfx[0]);\n                // canvas.height = floorToDivide(height * outputScale.sy, sfy[0]);\n                // const { style } = canvas;\n                // style.width = floorToDivide(width, sfx[1]) + \"px\";\n                // style.height = floorToDivide(height, sfy[1]) + \"px\";\n                // Add the viewport so it's known what it was originally drawn with.\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_viewportMap, \"f\").set(canvas, viewport);\n                // // Rendering area\n                // const transform = outputScale.scaled\n                //     ? [outputScale.sx, 0, 0, outputScale.sy, 0, 0]\n                //     : null;\n                const renderContext = {\n                    canvasContext: canvasContext,\n                    // transform,\n                    viewport,\n                    annotationMode: kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_annotationMode, \"f\"),\n                    // optionalContentConfigPromise: this._optionalContentConfigPromise,\n                    annotationCanvasMap: this._annotationCanvasMap,\n                    // pageColors,\n                    isEditing: kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_isEditing, \"f\"),\n                };\n                // pdfPage.render(renderContext)\n                const renderTask = (this.renderTask = pdfPage.render(renderContext));\n                // renderTask.onContinue = renderContinueCallback;\n                const resultPromise = renderTask.promise.then(() => kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                    var _a;\n                    // showCanvas?.(true);\n                    yield kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_finishRenderTask).call(this, renderTask);\n                    // todo: awaiting this breaks text nodes positioning after zoom\n                    // if \"includeMarkedContent\": true is set in TextLayerBuilder\n                    yield kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_renderTextLayer).call(this);\n                    // this.#renderTextLayer();\n                    if (this.annotationLayer) {\n                        yield kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_renderAnnotationLayer).call(this);\n                    }\n                    const { annotationEditorUIManager } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layerProperties, \"f\");\n                    if (!annotationEditorUIManager) {\n                        return;\n                    }\n                    this.drawLayer || (this.drawLayer = new DrawLayerBuilder({\n                        pageIndex: this.id,\n                    }));\n                    yield kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_renderDrawLayer).call(this);\n                    this.drawLayer.setParent(canvasWrapper);\n                    if (!this.annotationEditorLayer) {\n                        this.annotationEditorLayer = new AnnotationEditorLayerBuilder({\n                            uiManager: annotationEditorUIManager,\n                            pdfPage,\n                            // l10n,\n                            accessibilityManager: this._accessibilityManager,\n                            annotationLayer: (_a = this.annotationLayer) === null || _a === void 0 ? void 0 : _a.annotationLayer,\n                            textLayer: this.textLayer,\n                            drawLayer: this.drawLayer.getDrawLayer(),\n                            onAppend: annotationEditorLayerDiv => {\n                                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_addLayer).call(this, annotationEditorLayerDiv, \"annotationEditorLayer\");\n                            },\n                        });\n                    }\n                    // todo: this is not awaited in pdf.js\n                    kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_renderAnnotationEditorLayer).call(this);\n                    // await this.#renderAnnotationEditorLayer();\n                }), error => {\n                    // When zooming with a `drawingDelay` set, avoid temporarily showing\n                    // a black canvas if rendering was cancelled before the `onContinue`-\n                    // callback had been invoked at least once.\n                    // if (!(error instanceof RenderingCancelledException)) {\n                    //     showCanvas?.(true);\n                    // }\n                    // return this.#finishRenderTask(renderTask, error);\n                    if (!error) {\n                        return;\n                    }\n                });\n                if (pdfPage.isPureXfa) {\n                    // if (!this.xfaLayer) {\n                    //     const { annotationStorage, linkService } = this.#layerProperties;\n                    //     this.xfaLayer = new XfaLayerBuilder({\n                    //         pdfPage,\n                    //         annotationStorage,\n                    //         linkService,\n                    //     });\n                    // }\n                    // this.#renderXfaLayer();\n                }\n                div.setAttribute(\"data-loaded\", true);\n                this.eventBus.dispatch(\"pagerender\", {\n                    source: this,\n                    pageNumber: this.id,\n                });\n                return resultPromise;\n            });\n        }\n    }\n    _Page_annotationMode = new WeakMap(), _Page_isEditing = new WeakMap(), _Page_layerProperties = new WeakMap(), _Page_previousRotation = new WeakMap(), _Page_renderingState = new WeakMap(), _Page_textLayerMode = new WeakMap(), _Page_viewportMap = new WeakMap(), _Page_layers = new WeakMap(), _Page_instances = new WeakSet(), _Page_addLayer = function _Page_addLayer(div, name) {\n        const pos = LAYERS_ORDER.get(name);\n        const oldDiv = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layers, \"f\")[pos];\n        kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layers, \"f\")[pos] = div;\n        if (oldDiv) {\n            oldDiv.replaceWith(div);\n            return;\n        }\n        for (let i = pos - 1; i >= 0; i--) {\n            const layer = kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_layers, \"f\")[i];\n            if (layer) {\n                layer.after(div);\n                return;\n            }\n        }\n        this.div.prepend(div);\n    }, _Page_setDimensions = function _Page_setDimensions() {\n        const { viewport } = this;\n        if (this.pdfPage) {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_previousRotation, \"f\") === viewport.rotation) {\n                return;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _Page_previousRotation, viewport.rotation, \"f\");\n        }\n        if (!this.div || !viewport) {\n            return;\n        }\n        kendo_pdfjs_loader_js.setLayerDimensions(this.div, viewport, \n        /* mustFlip = */ true, \n        /* mustRotate = */ false);\n    }, _Page_dispatchLayerRendered = function _Page_dispatchLayerRendered(name, error) {\n        this.eventBus.dispatch(name, {\n            source: this,\n            pageNumber: this.id,\n            error,\n        });\n    }, _Page_renderAnnotationLayer = function _Page_renderAnnotationLayer() {\n        return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n            let error = null;\n            try {\n                yield this.annotationLayer.render(this.viewport, \"display\");\n            }\n            catch (ex) {\n                console.error(`#renderAnnotationLayer: \"${ex}\".`);\n                error = ex;\n            }\n            finally {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_dispatchLayerRendered).call(this, \"annotationlayerrendered\", error);\n            }\n        });\n    }, _Page_renderAnnotationEditorLayer = function _Page_renderAnnotationEditorLayer() {\n        return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n            let error = null;\n            try {\n                // await this.annotationEditorLayer.render(this.viewport, \"display\");\n                yield this.annotationEditorLayer.render(this.viewport);\n            }\n            catch (ex) {\n                // console.error(`#renderAnnotationEditorLayer: \"${ex}\".`);\n                error = ex;\n            }\n            finally {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_dispatchLayerRendered).call(this, \"annotationeditorlayerrendered\", error);\n            }\n        });\n    }, _Page_renderDrawLayer = function _Page_renderDrawLayer() {\n        return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n            try {\n                yield this.drawLayer.render(\"display\");\n            }\n            catch (ex) {\n                // console.error(`#renderDrawLayer: \"${ex}\".`);\n            }\n        });\n    }, _Page_renderTextLayer = function _Page_renderTextLayer() {\n        return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n            if (!this.textLayer) {\n                return;\n            }\n            let error = null;\n            try {\n                yield this.textLayer.render(this.viewport);\n            }\n            catch (ex) {\n                if (ex instanceof kendo_pdfjs_loader_js.AbortException) {\n                    return;\n                }\n                // console.error(`#renderTextLayer: \"${ex}\".`);\n                error = ex;\n            }\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _Page_instances, \"m\", _Page_dispatchLayerRendered).call(this, \"textlayerrendered\", error);\n            // this.#renderStructTreeLayer();\n        });\n    }, _Page_finishRenderTask = function _Page_finishRenderTask(renderTask) {\n        return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n            // The renderTask may have been replaced by a new one, so only remove\n            // the reference to the renderTask if it matches the one that is\n            // triggering this callback.\n            if (renderTask === this.renderTask) {\n                this.renderTask = null;\n            }\n            //     if (error instanceof RenderingCancelledException) {\n            //         this.#renderError = null;\n            //         return;\n            //     }\n            //     this.#renderError = error;\n            //     this.renderingState = RenderingStates.FINISHED;\n            this._resetZoomLayer(/* removeFromDOM = */ true);\n            //     // Ensure that the thumbnails won't become partially (or fully) blank,\n            //     // for documents that contain interactive form elements.\n            //     this.#useThumbnailCanvas.regularAnnotations = !renderTask.separateAnnots;\n            this.eventBus.dispatch(\"pagerendered\", {\n                source: this,\n                pageNumber: this.id,\n                cssTransform: false,\n                timestamp: performance.now(),\n                // error: this.#renderError,\n                error: \"page render error\",\n            });\n            //     if (error) {\n            //         throw error;\n            //     }\n        });\n    };\n\n    /* Copyright 2014 Opera Software ASA\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     *\n     *\n     * Based on https://code.google.com/p/smhasher/wiki/MurmurHash3.\n     * Hashes roughly 100 KB per millisecond on i7 3.4 GHz.\n     */\n    const SEED = 0xc3d2e1f0;\n    // Workaround for missing math precision in JS.\n    const MASK_HIGH = 0xffff0000;\n    const MASK_LOW = 0xffff;\n    class MurmurHash3_64 {\n        // todo: props\n        constructor(seed) {\n            // todo: props\n            this.h1 = null;\n            this.h2 = null;\n            this.h1 = seed ? seed & 0xffffffff : SEED;\n            this.h2 = seed ? seed & 0xffffffff : SEED;\n        }\n        update(input) {\n            let data, length;\n            if (typeof input === \"string\") {\n                data = new Uint8Array(input.length * 2);\n                length = 0;\n                for (let i = 0, ii = input.length; i < ii; i++) {\n                    const code = input.charCodeAt(i);\n                    if (code <= 0xff) {\n                        data[length++] = code;\n                    }\n                    else {\n                        data[length++] = code >>> 8;\n                        data[length++] = code & 0xff;\n                    }\n                }\n            }\n            else if (ArrayBuffer.isView(input)) {\n                data = input.slice();\n                length = data.byteLength;\n            }\n            else {\n                throw new Error(\"Invalid data format, must be a string or TypedArray.\");\n            }\n            const blockCounts = length >> 2;\n            const tailLength = length - blockCounts * 4;\n            // We don't care about endianness here.\n            const dataUint32 = new Uint32Array(data.buffer, 0, blockCounts);\n            let k1 = 0, k2 = 0;\n            let h1 = this.h1, h2 = this.h2;\n            const C1 = 0xcc9e2d51, C2 = 0x1b873593;\n            const C1_LOW = C1 & MASK_LOW, C2_LOW = C2 & MASK_LOW;\n            for (let i = 0; i < blockCounts; i++) {\n                if (i & 1) {\n                    k1 = dataUint32[i];\n                    k1 = ((k1 * C1) & MASK_HIGH) | ((k1 * C1_LOW) & MASK_LOW);\n                    k1 = (k1 << 15) | (k1 >>> 17);\n                    k1 = ((k1 * C2) & MASK_HIGH) | ((k1 * C2_LOW) & MASK_LOW);\n                    h1 ^= k1;\n                    h1 = (h1 << 13) | (h1 >>> 19);\n                    h1 = h1 * 5 + 0xe6546b64;\n                }\n                else {\n                    k2 = dataUint32[i];\n                    k2 = ((k2 * C1) & MASK_HIGH) | ((k2 * C1_LOW) & MASK_LOW);\n                    k2 = (k2 << 15) | (k2 >>> 17);\n                    k2 = ((k2 * C2) & MASK_HIGH) | ((k2 * C2_LOW) & MASK_LOW);\n                    h2 ^= k2;\n                    h2 = (h2 << 13) | (h2 >>> 19);\n                    h2 = h2 * 5 + 0xe6546b64;\n                }\n            }\n            k1 = 0;\n            switch (tailLength) {\n                case 3:\n                    k1 ^= data[blockCounts * 4 + 2] << 16;\n                /* falls through */\n                case 2:\n                    k1 ^= data[blockCounts * 4 + 1] << 8;\n                /* falls through */\n                case 1:\n                    k1 ^= data[blockCounts * 4];\n                    /* falls through */\n                    k1 = ((k1 * C1) & MASK_HIGH) | ((k1 * C1_LOW) & MASK_LOW);\n                    k1 = (k1 << 15) | (k1 >>> 17);\n                    k1 = ((k1 * C2) & MASK_HIGH) | ((k1 * C2_LOW) & MASK_LOW);\n                    if (blockCounts & 1) {\n                        h1 ^= k1;\n                    }\n                    else {\n                        h2 ^= k1;\n                    }\n                    break;\n                default: break;\n            }\n            this.h1 = h1;\n            this.h2 = h2;\n        }\n        hexdigest() {\n            let h1 = this.h1, h2 = this.h2;\n            h1 ^= h2 >>> 1;\n            h1 = ((h1 * 0xed558ccd) & MASK_HIGH) | ((h1 * 0x8ccd) & MASK_LOW);\n            h2 =\n                ((h2 * 0xff51afd7) & MASK_HIGH) |\n                    (((((h2 << 16) | (h1 >>> 16)) * 0xafd7ed55) & MASK_HIGH) >>> 16);\n            h1 ^= h2 >>> 1;\n            h1 = ((h1 * 0x1a85ec53) & MASK_HIGH) | ((h1 * 0xec53) & MASK_LOW);\n            h2 =\n                ((h2 * 0xc4ceb9fe) & MASK_HIGH) |\n                    (((((h2 << 16) | (h1 >>> 16)) * 0xb9fe1a85) & MASK_HIGH) >>> 16);\n            h1 ^= h2 >>> 1;\n            return ((h1 >>> 0).toString(16).padStart(8, \"0\") +\n                (h2 >>> 0).toString(16).padStart(8, \"0\"));\n        }\n    }\n\n    /* Copyright 2020 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _AnnotationStorage_instances, _AnnotationStorage_modified, _AnnotationStorage_modifiedIds, _AnnotationStorage_storage, _AnnotationStorage_setModified, _PrintAnnotationStorage_serializable;\n    const SerializableEmpty = Object.freeze({\n        map: null,\n        hash: \"\",\n        transfer: undefined,\n    });\n    /**\n     * Key/value storage for annotation data in forms.\n     */\n    class AnnotationStorage {\n        constructor() {\n            _AnnotationStorage_instances.add(this);\n            // todo: props\n            this.onSetModified = null;\n            this.onResetModified = null;\n            this.onAnnotationEditor = null;\n            // todo: props\n            _AnnotationStorage_modified.set(this, false);\n            _AnnotationStorage_modifiedIds.set(this, null);\n            _AnnotationStorage_storage.set(this, new Map());\n            // Callbacks to signal when the modification state is set or reset.\n            // This is used by the viewer to only bind on `beforeunload` if forms\n            // are actually edited to prevent doing so unconditionally since that\n            // can have undesirable effects.\n            this.onSetModified = null;\n            this.onResetModified = null;\n            this.onAnnotationEditor = null;\n        }\n        /**\n         * Get the value for a given key if it exists, or return the default value.\n         * @param {string} key\n         * @param {Object} defaultValue\n         * @returns {Object}\n         */\n        getValue(key, defaultValue) {\n            const value = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").get(key);\n            if (value === undefined) {\n                return defaultValue;\n            }\n            return Object.assign(defaultValue, value);\n        }\n        /**\n         * Get the value for a given key.\n         * @param {string} key\n         * @returns {Object}\n         */\n        getRawValue(key) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").get(key);\n        }\n        /**\n         * Remove a value from the storage.\n         * @param {string} key\n         */\n        remove(key) {\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").delete(key);\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").size === 0) {\n                this.resetModified();\n            }\n            if (typeof this.onAnnotationEditor === \"function\") {\n                for (const value of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").values()) {\n                    if (value instanceof AnnotationEditor) {\n                        return;\n                    }\n                }\n                this.onAnnotationEditor(null);\n            }\n        }\n        /**\n         * Set the value for a given key\n         * @param {string} key\n         * @param {Object} value\n         */\n        setValue(key, value) {\n            const obj = kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").get(key);\n            let modified = false;\n            if (obj !== undefined) {\n                for (const [entry, val] of Object.entries(value)) {\n                    if (obj[entry] !== val) {\n                        modified = true;\n                        obj[entry] = val;\n                    }\n                }\n            }\n            else {\n                modified = true;\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").set(key, value);\n            }\n            if (modified) {\n                kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_instances, \"m\", _AnnotationStorage_setModified).call(this);\n            }\n            if (value instanceof AnnotationEditor &&\n                typeof this.onAnnotationEditor === \"function\") {\n                this.onAnnotationEditor(value.constructor._type);\n            }\n        }\n        /**\n         * Check if the storage contains the given key.\n         * @param {string} key\n         * @returns {boolean}\n         */\n        has(key) {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").has(key);\n        }\n        /**\n         * @returns {Object | null}\n         */\n        getAll() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").size > 0 ? objectFromMap(kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\")) : null;\n        }\n        /**\n         * @param {Object} obj\n         */\n        setAll(obj) {\n            for (const [key, val] of Object.entries(obj)) {\n                this.setValue(key, val);\n            }\n        }\n        get size() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").size;\n        }\n        resetModified() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_modified, \"f\")) {\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationStorage_modified, false, \"f\");\n                if (typeof this.onResetModified === \"function\") {\n                    this.onResetModified();\n                }\n            }\n        }\n        /**\n         * @returns {PrintAnnotationStorage}\n         */\n        get print() {\n            return new PrintAnnotationStorage(this);\n        }\n        /**\n         * PLEASE NOTE: Only intended for usage within the API itself.\n         * @ignore\n         */\n        get serializable() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").size === 0) {\n                return SerializableEmpty;\n            }\n            const map = new Map(), hash = new MurmurHash3_64(null), transfer = [];\n            const context = Object.create(null);\n            let hasBitmap = false;\n            for (const [key, val] of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\")) {\n                const serialized = val instanceof AnnotationEditor\n                    ? val.serialize(/* isForCopying = */ false, context)\n                    : val;\n                if (serialized) {\n                    map.set(key, serialized);\n                    hash.update(`${key}:${JSON.stringify(serialized)}`);\n                    hasBitmap || (hasBitmap = !!serialized.bitmap);\n                }\n            }\n            if (hasBitmap) {\n                // We must transfer the bitmap data separately, since it can be changed\n                // during serialization with SVG images.\n                for (const value of map.values()) {\n                    if (value.bitmap) {\n                        transfer.push(value.bitmap);\n                    }\n                }\n            }\n            return map.size > 0\n                ? { map, hash: hash.hexdigest(), transfer }\n                : SerializableEmpty;\n        }\n        get editorStats() {\n            var _a;\n            let stats = null;\n            const typeToEditor = new Map();\n            for (const value of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").values()) {\n                if (!(value instanceof AnnotationEditor)) {\n                    continue;\n                }\n                const editorStats = value.telemetryFinalData;\n                if (!editorStats) {\n                    continue;\n                }\n                const { type } = editorStats;\n                if (!typeToEditor.has(type)) {\n                    typeToEditor.set(type, Object.getPrototypeOf(value).constructor);\n                }\n                stats || (stats = Object.create(null));\n                const map = (stats[type] || (stats[type] = new Map()));\n                for (const [key, val] of Object.entries(editorStats)) {\n                    if (key === \"type\") {\n                        continue;\n                    }\n                    let counters = map.get(key);\n                    if (!counters) {\n                        counters = new Map();\n                        map.set(key, counters);\n                    }\n                    const count = (_a = counters.get(val)) !== null && _a !== void 0 ? _a : 0;\n                    counters.set(val, count + 1);\n                }\n            }\n            for (const [type, editor] of typeToEditor) {\n                stats[type] = editor.computeTelemetryFinalData(stats[type]);\n            }\n            return stats;\n        }\n        resetModifiedIds() {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationStorage_modifiedIds, null, \"f\");\n        }\n        /**\n         * @returns {{ids: Set<string>, hash: string}}\n         */\n        get modifiedIds() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_modifiedIds, \"f\")) {\n                return kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_modifiedIds, \"f\");\n            }\n            const ids = [];\n            for (const value of kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_storage, \"f\").values()) {\n                if (!(value instanceof AnnotationEditor) ||\n                    !value.annotationElementId ||\n                    !(value.serialize())) {\n                    continue;\n                }\n                ids.push(value.annotationElementId);\n            }\n            return (kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationStorage_modifiedIds, {\n                ids: new Set(ids),\n                hash: ids.join(\",\"),\n            }, \"f\"));\n        }\n    }\n    _AnnotationStorage_modified = new WeakMap(), _AnnotationStorage_modifiedIds = new WeakMap(), _AnnotationStorage_storage = new WeakMap(), _AnnotationStorage_instances = new WeakSet(), _AnnotationStorage_setModified = function _AnnotationStorage_setModified() {\n        if (!kendo_dateinputsCommon_cmn_chunk_js.a(this, _AnnotationStorage_modified, \"f\")) {\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _AnnotationStorage_modified, true, \"f\");\n            if (typeof this.onSetModified === \"function\") {\n                this.onSetModified();\n            }\n        }\n    };\n    /**\n     * A special `AnnotationStorage` for use during printing, where the serializable\n     * data is *frozen* upon initialization, to prevent scripting from modifying its\n     * contents. (Necessary since printing is triggered synchronously in browsers.)\n     */\n    class PrintAnnotationStorage extends AnnotationStorage {\n        constructor(parent) {\n            super();\n            _PrintAnnotationStorage_serializable.set(this, void 0);\n            const { map, hash, transfer } = parent.serializable;\n            // Create a *copy* of the data, since Objects are passed by reference in JS.\n            const clone = structuredClone(map, transfer ? { transfer } : null);\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PrintAnnotationStorage_serializable, { map: clone, hash, transfer }, \"f\");\n        }\n        /**\n         * @returns {PrintAnnotationStorage}\n         */\n        // eslint-disable-next-line getter-return\n        get print() {\n            // unreachable(\"Should not call PrintAnnotationStorage.print\");\n            return null;\n        }\n        /**\n         * PLEASE NOTE: Only intended for usage within the API itself.\n         * @ignore\n         */\n        get serializable() {\n            return kendo_dateinputsCommon_cmn_chunk_js.a(this, _PrintAnnotationStorage_serializable, \"f\");\n        }\n        get modifiedIds() {\n            return kendo_pdfjs_loader_js.shadow(this, \"modifiedIds\", {\n                ids: new Set(),\n                hash: \"\",\n            });\n        }\n    }\n    _PrintAnnotationStorage_serializable = new WeakMap();\n\n    /* Copyright 2015 Mozilla Foundation\n     *\n     * Licensed under the Apache License, Version 2.0 (the \"License\");\n     * you may not use this file except in compliance with the License.\n     * You may obtain a copy of the License at\n     *\n     *     http://www.apache.org/licenses/LICENSE-2.0\n     *\n     * Unless required by applicable law or agreed to in writing, software\n     * distributed under the License is distributed on an \"AS IS\" BASIS,\n     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     * See the License for the specific language governing permissions and\n     * limitations under the License.\n     */\n    var _a, _PDFLinkService_isValidExplicitDest;\n    const DEFAULT_LINK_REL = \"noopener noreferrer nofollow\";\n    const LinkTarget = {\n        NONE: 0, // Default value.\n        SELF: 1,\n        BLANK: 2,\n        PARENT: 3,\n        TOP: 4,\n    };\n    /**\n     * @typedef {Object} PDFLinkServiceOptions\n     * @property {EventBus} eventBus - The application event bus.\n     * @property {number} [externalLinkTarget] - Specifies the `target` attribute\n     *   for external links. Must use one of the values from {LinkTarget}.\n     *   Defaults to using no target.\n     * @property {string} [externalLinkRel] - Specifies the `rel` attribute for\n     *   external links. Defaults to stripping the referrer.\n     * @property {boolean} [ignoreDestinationZoom] - Ignores the zoom argument,\n     *   thus preserving the current zoom level in the viewer, when navigating\n     *   to internal destinations. The default value is `false`.\n     */\n    /**\n     * Performs navigation functions inside PDF, such as opening specified page,\n     * or destination.\n     * @implements {IPDFLinkService}\n     */\n    class PDFLinkService {\n        /**\n         * @param {PDFLinkServiceOptions} options\n         */\n        constructor({ eventBus = null, externalLinkTarget = null, externalLinkRel = null, ignoreDestinationZoom = false, } = {}) {\n            // todo: props\n            this.eventBus = null;\n            this.externalLinkTarget = null;\n            this.externalLinkRel = null;\n            this._ignoreDestinationZoom = null;\n            this.baseUrl = null;\n            this.pdfDocument = null;\n            this.pdfViewer = null;\n            this.pdfHistory = null;\n            // todo: props\n            this.externalLinkEnabled = true;\n            this.eventBus = eventBus;\n            this.externalLinkTarget = externalLinkTarget;\n            this.externalLinkRel = externalLinkRel;\n            this._ignoreDestinationZoom = ignoreDestinationZoom;\n            this.baseUrl = null;\n            this.pdfDocument = null;\n            this.pdfViewer = null;\n            this.pdfHistory = null;\n        }\n        setDocument(pdfDocument, baseUrl = null) {\n            this.baseUrl = baseUrl;\n            this.pdfDocument = pdfDocument;\n        }\n        setViewer(pdfViewer) {\n            this.pdfViewer = pdfViewer;\n        }\n        setHistory(pdfHistory) {\n            this.pdfHistory = pdfHistory;\n        }\n        /**\n         * @type {number}\n         */\n        get pagesCount() {\n            return this.pdfDocument ? this.pdfDocument.numPages : 0;\n        }\n        /**\n         * @type {number}\n         */\n        get page() {\n            return this.pdfDocument ? this.pdfViewer.currentPageNumber : 1;\n        }\n        /**\n         * @param {number} value\n         */\n        set page(value) {\n            if (this.pdfDocument) {\n                this.pdfViewer.currentPageNumber = value;\n            }\n        }\n        /**\n         * @type {number}\n         */\n        get rotation() {\n            return this.pdfDocument ? this.pdfViewer.pagesRotation : 0;\n        }\n        /**\n         * @param {number} value\n         */\n        set rotation(value) {\n            if (this.pdfDocument) {\n                this.pdfViewer.pagesRotation = value;\n            }\n        }\n        /**\n         * @type {boolean}\n         */\n        get isInPresentationMode() {\n            return this.pdfDocument ? this.pdfViewer.isInPresentationMode : false;\n        }\n        /**\n         * This method will, when available, also update the browser history.\n         *\n         * @param {string|Array} dest - The named, or explicit, PDF destination.\n         */\n        goToDestination(dest) {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                if (!this.pdfDocument) {\n                    return;\n                }\n                let namedDest, explicitDest, pageNumber;\n                if (typeof dest === \"string\") {\n                    namedDest = dest;\n                    explicitDest = yield this.pdfDocument.getDestination(dest);\n                }\n                else {\n                    namedDest = null;\n                    explicitDest = yield dest;\n                }\n                if (!Array.isArray(explicitDest)) {\n                    // console.error(\n                    //     `goToDestination: \"${explicitDest}\" is not a valid destination array, for dest=\"${dest}\".`\n                    // );\n                    return;\n                }\n                // Dest array looks like that: <page-ref> </XYZ|/FitXXX> <args..>\n                const [destRef] = explicitDest;\n                if (destRef && typeof destRef === \"object\") {\n                    pageNumber = this.pdfDocument.cachedPageNumber(destRef);\n                    if (!pageNumber) {\n                        // Fetch the page reference if it's not yet available. This could\n                        // only occur during loading, before all pages have been resolved.\n                        try {\n                            pageNumber = (yield this.pdfDocument.getPageIndex(destRef)) + 1;\n                        }\n                        catch (_b) {\n                            console.error(`goToDestination: \"${destRef}\" is not a valid page reference, for dest=\"${dest}\".`);\n                            return;\n                        }\n                    }\n                }\n                else if (Number.isInteger(destRef)) {\n                    pageNumber = destRef + 1;\n                }\n                if (!pageNumber || pageNumber < 1 || pageNumber > this.pagesCount) {\n                    console.error(`goToDestination: \"${pageNumber}\" is not a valid page number, for dest=\"${dest}\".`);\n                    return;\n                }\n                if (this.pdfHistory) {\n                    // Update the browser history before scrolling the new destination into\n                    // view, to be able to accurately capture the current document position.\n                    this.pdfHistory.pushCurrentPosition();\n                    this.pdfHistory.push({ namedDest, explicitDest, pageNumber });\n                }\n                this.pdfViewer.scrollPageIntoView({\n                    pageNumber,\n                    destArray: explicitDest,\n                    ignoreDestinationZoom: this._ignoreDestinationZoom,\n                });\n            });\n        }\n        /**\n         * This method will, when available, also update the browser history.\n         *\n         * @param {number|string} val - The page number, or page label.\n         */\n        goToPage(val) {\n            if (!this.pdfDocument) {\n                return;\n            }\n            const pageNumber = (typeof val === \"string\" && this.pdfViewer.pageLabelToPageNumber(val)) ||\n                val | 0;\n            if (!(Number.isInteger(pageNumber) &&\n                pageNumber > 0 &&\n                pageNumber <= this.pagesCount)) {\n                console.error(`PDFLinkService.goToPage: \"${val}\" is not a valid page.`);\n                return;\n            }\n            if (this.pdfHistory) {\n                // Update the browser history before scrolling the new page into view,\n                // to be able to accurately capture the current document position.\n                this.pdfHistory.pushCurrentPosition();\n                this.pdfHistory.pushPage(pageNumber);\n            }\n            this.pdfViewer.scrollPageIntoView({ pageNumber });\n        }\n        /**\n         * Adds various attributes (href, title, target, rel) to hyperlinks.\n         * @param {HTMLAnchorElement} link\n         * @param {string} url\n         * @param {boolean} [newWindow]\n         */\n        addLinkAttributes(link, url, newWindow = false) {\n            if (!url || typeof url !== \"string\") {\n                throw new Error('A valid \"url\" parameter must provided.');\n            }\n            const target = newWindow ? LinkTarget.BLANK : this.externalLinkTarget, rel = this.externalLinkRel;\n            if (this.externalLinkEnabled) {\n                link.href = link.title = url;\n            }\n            else {\n                link.href = \"\";\n                link.title = `Disabled: ${url}`;\n                link.onclick = () => false;\n            }\n            let targetStr = \"\"; // LinkTarget.NONE\n            switch (target) {\n                case LinkTarget.NONE:\n                    break;\n                case LinkTarget.SELF:\n                    targetStr = \"_self\";\n                    break;\n                case LinkTarget.BLANK:\n                    targetStr = \"_blank\";\n                    break;\n                case LinkTarget.PARENT:\n                    targetStr = \"_parent\";\n                    break;\n                case LinkTarget.TOP:\n                    targetStr = \"_top\";\n                    break;\n                default: break;\n            }\n            link.target = targetStr;\n            link.rel = typeof rel === \"string\" ? rel : DEFAULT_LINK_REL;\n        }\n        /**\n         * @param {string|Array} dest - The PDF destination object.\n         * @returns {string} The hyperlink to the PDF object.\n         */\n        getDestinationHash(dest) {\n            if (typeof dest === \"string\") {\n                if (dest.length > 0) {\n                    return this.getAnchorUrl(\"#\" + escape(dest));\n                }\n            }\n            else if (Array.isArray(dest)) {\n                const str = JSON.stringify(dest);\n                if (str.length > 0) {\n                    return this.getAnchorUrl(\"#\" + escape(str));\n                }\n            }\n            return this.getAnchorUrl(\"\");\n        }\n        /**\n         * Prefix the full url on anchor links to make sure that links are resolved\n         * relative to the current URL instead of the one defined in <base href>.\n         * @param {string} anchor - The anchor hash, including the #.\n         * @returns {string} The hyperlink to the PDF object.\n         */\n        getAnchorUrl(anchor) {\n            return this.baseUrl ? this.baseUrl + anchor : anchor;\n        }\n        /**\n         * @param {string} hash\n         */\n        setHash(hash) {\n            if (!this.pdfDocument) {\n                return;\n            }\n            let pageNumber, dest;\n            if (hash.includes(\"=\")) {\n                const params = parseQueryString(hash);\n                if (params.has(\"search\")) {\n                    const query = params.get(\"search\").replaceAll('\"', \"\"), phrase = params.get(\"phrase\") === \"true\";\n                    this.eventBus.dispatch(\"findfromurlhash\", {\n                        source: this,\n                        query: phrase ? query : query.match(/\\S+/g),\n                    });\n                }\n                // borrowing syntax from \"Parameters for Opening PDF Files\"\n                if (params.has(\"page\")) {\n                    pageNumber = params.get(\"page\") | 0 || 1;\n                }\n                if (params.has(\"zoom\")) {\n                    // Build the destination array.\n                    const zoomArgs = params.get(\"zoom\").split(\",\"); // scale,left,top\n                    const zoomArg = zoomArgs[0];\n                    const zoomArgNumber = parseFloat(zoomArg);\n                    if (!zoomArg.includes(\"Fit\")) {\n                        // If the zoomArg is a number, it has to get divided by 100. If it's\n                        // a string, it should stay as it is.\n                        dest = [\n                            null,\n                            { name: \"XYZ\" },\n                            zoomArgs.length > 1 ? zoomArgs[1] | 0 : null,\n                            zoomArgs.length > 2 ? zoomArgs[2] | 0 : null,\n                            zoomArgNumber ? zoomArgNumber / 100 : zoomArg,\n                        ];\n                    }\n                    else if (zoomArg === \"Fit\" || zoomArg === \"FitB\") {\n                        dest = [null, { name: zoomArg }];\n                    }\n                    else if (zoomArg === \"FitH\" ||\n                        zoomArg === \"FitBH\" ||\n                        zoomArg === \"FitV\" ||\n                        zoomArg === \"FitBV\") {\n                        dest = [\n                            null,\n                            { name: zoomArg },\n                            zoomArgs.length > 1 ? zoomArgs[1] | 0 : null,\n                        ];\n                    }\n                    else if (zoomArg === \"FitR\") {\n                        if (zoomArgs.length !== 5) {\n                            console.error('PDFLinkService.setHash: Not enough parameters for \"FitR\".');\n                        }\n                        else {\n                            dest = [\n                                null,\n                                { name: zoomArg },\n                                zoomArgs[1] | 0,\n                                zoomArgs[2] | 0,\n                                zoomArgs[3] | 0,\n                                zoomArgs[4] | 0,\n                            ];\n                        }\n                    }\n                    else {\n                        console.error(`PDFLinkService.setHash: \"${zoomArg}\" is not a valid zoom value.`);\n                    }\n                }\n                if (dest) {\n                    this.pdfViewer.scrollPageIntoView({\n                        pageNumber: pageNumber || this.page,\n                        destArray: dest,\n                        allowNegativeOffset: true,\n                    });\n                }\n                else if (pageNumber) {\n                    this.page = pageNumber; // simple page\n                }\n                if (params.has(\"pagemode\")) {\n                    this.eventBus.dispatch(\"pagemode\", {\n                        source: this,\n                        mode: params.get(\"pagemode\"),\n                    });\n                }\n                // Ensure that this parameter is *always* handled last, in order to\n                // guarantee that it won't be overridden (e.g. by the \"page\" parameter).\n                if (params.has(\"nameddest\")) {\n                    this.goToDestination(params.get(\"nameddest\"));\n                }\n                // if (typeof PDFJSDev === \"undefined\" || !PDFJSDev.test(\"MOZCENTRAL\")) {\n                return;\n                // }\n                // // Support opening of PDF attachments in the Firefox PDF Viewer,\n                // // which uses a couple of non-standard hash parameters; refer to\n                // // `DownloadManager.openOrDownloadData` in the firefoxcom.js file.\n                // if (!params.has(\"filename\") || !params.has(\"filedest\")) {\n                //     return;\n                // }\n                // hash = params.get(\"filedest\");\n            }\n            // Named (or explicit) destination.\n            dest = unescape(hash);\n            try {\n                dest = JSON.parse(dest);\n                if (!Array.isArray(dest)) {\n                    // Avoid incorrectly rejecting a valid named destination, such as\n                    // e.g. \"4.3\" or \"true\", because `JSON.parse` converted its type.\n                    dest = dest.toString();\n                }\n            }\n            catch (e) {\n                if (!e) {\n                    return;\n                }\n            }\n            if (typeof dest === \"string\" || kendo_dateinputsCommon_cmn_chunk_js.a(_a, _a, \"m\", _PDFLinkService_isValidExplicitDest).call(_a, dest)) {\n                this.goToDestination(dest);\n                return;\n            }\n            // console.error(\n            //     `PDFLinkService.setHash: \"${unescape(hash)}\" is not a valid destination.`\n            // );\n        }\n        /**\n         * @param {string} action\n         */\n        executeNamedAction(action) {\n            var _b, _c;\n            if (!this.pdfDocument) {\n                return;\n            }\n            // See PDF reference, table 8.45 - Named action\n            switch (action) {\n                case \"GoBack\":\n                    (_b = this.pdfHistory) === null || _b === void 0 ? void 0 : _b.back();\n                    break;\n                case \"GoForward\":\n                    (_c = this.pdfHistory) === null || _c === void 0 ? void 0 : _c.forward();\n                    break;\n                case \"NextPage\":\n                    this.pdfViewer.nextPage();\n                    break;\n                case \"PrevPage\":\n                    this.pdfViewer.previousPage();\n                    break;\n                case \"LastPage\":\n                    this.page = this.pagesCount;\n                    break;\n                case \"FirstPage\":\n                    this.page = 1;\n                    break;\n                default:\n                    break; // No action according to spec\n            }\n            this.eventBus.dispatch(\"namedaction\", {\n                source: this,\n                action,\n            });\n        }\n        /**\n         * @param {Object} action\n         */\n        executeSetOCGState(action) {\n            return kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                if (!this.pdfDocument) {\n                    return;\n                }\n                const pdfDocument = this.pdfDocument, optionalContentConfig = yield this.pdfViewer.optionalContentConfigPromise;\n                if (pdfDocument !== this.pdfDocument) {\n                    return; // The document was closed while the optional content resolved.\n                }\n                optionalContentConfig.setOCGState(action);\n                this.pdfViewer.optionalContentConfigPromise = Promise.resolve(optionalContentConfig);\n            });\n        }\n    }\n    _a = PDFLinkService, _PDFLinkService_isValidExplicitDest = function _PDFLinkService_isValidExplicitDest(dest) {\n        if (!Array.isArray(dest) || dest.length < 2) {\n            return false;\n        }\n        const [page, zoom, ...args] = dest;\n        if (!(typeof page === \"object\" &&\n            Number.isInteger(page === null || page === void 0 ? void 0 : page.num) &&\n            Number.isInteger(page === null || page === void 0 ? void 0 : page.gen)) &&\n            !Number.isInteger(page)) {\n            return false;\n        }\n        if (!(typeof zoom === \"object\" && typeof (zoom === null || zoom === void 0 ? void 0 : zoom.name) === \"string\")) {\n            return false;\n        }\n        const argsLen = args.length;\n        let allowNull = true;\n        switch (zoom.name) {\n            case \"XYZ\":\n                if (argsLen < 2 || argsLen > 3) {\n                    return false;\n                }\n                break;\n            case \"Fit\":\n            case \"FitB\":\n                return argsLen === 0;\n            case \"FitH\":\n            case \"FitBH\":\n            case \"FitV\":\n            case \"FitBV\":\n                if (argsLen > 1) {\n                    return false;\n                }\n                break;\n            case \"FitR\":\n                if (argsLen !== 4) {\n                    return false;\n                }\n                allowNull = false;\n                break;\n            default:\n                return false;\n        }\n        for (const arg of args) {\n            if (!(typeof arg === \"number\" || (allowNull && arg === null))) {\n                return false;\n            }\n        }\n        return true;\n    };\n\n    var PdfViewerInteractionMode;\n    (function (PdfViewerInteractionMode) {\n        PdfViewerInteractionMode[PdfViewerInteractionMode[\"TextSelection\"] = 0] = \"TextSelection\";\n        PdfViewerInteractionMode[PdfViewerInteractionMode[\"Pan\"] = 1] = \"Pan\";\n    })(PdfViewerInteractionMode || (PdfViewerInteractionMode = {}));\n    ;\n\n    var _PdfViewer_instances, _PdfViewer_annotationEditorMode, _PdfViewer_switchAnnotationEditorModeTimeoutId, _PdfViewer_eventAbortController, _PdfViewer_onPageRenderedCallback, _PdfViewer_switchToEditAnnotationMode, _PdfViewer_scrollIntoView;\n    const PDF_JS = \"pdfjs\";\n    const ERROR = \"error\";\n    const ZOOM_START = \"zoomStart\";\n    const ZOOM_END = \"zoomEnd\";\n    const PAGES_LOAD = \"pagesLoad\";\n    const PRINT_END = \"printEnd\";\n    const SCROLL = \"scroll\";\n    const DOWNLOAD = \"download\";\n    const ANNOTATION_EDITOR_TOOLBAR_SHOW = \"annotationEditorToolBarShow\";\n    const ANNOTATION_EDITOR_TOOLBAR_HIDE = \"annotationEditorToolBarHide\";\n    const DEFAULT_ZOOM_LEVEL = 1.25;\n    const FRAMES_PER_SECOND = 1000 / 60;\n    class PdfViewer extends Component {\n        constructor(element, options) {\n            super(element, options);\n            _PdfViewer_instances.add(this);\n            this.options = {\n                pdfServiceType: PDF_JS,\n                // this is a flag used mainly in tests as CSSStyleSheet.replaceSync\n                // fails with jsdom\n                // a better solution is not to load a stylesheet in setHiddenCanvasStyles\n                // but rather create a class like \"k-hidden-canvas-element\"\n                // and override the rendering from pdf.js\n                pdfjsSetHiddenCanvasStyles: true,\n                fileData: [],\n                page: 1,\n                fileDescriptor: null,\n                downloadFileName: \"Document\",\n                minZoom: 0.5,\n                maxZoom: 4,\n                zoomRate: 0.25,\n                zoomLevel: DEFAULT_ZOOM_LEVEL,\n                zoomBeforePrint: false,\n                zoomLevelForPrint: 3,\n                searchMatchScrollLeftOffset: 0,\n                // add some default offset, so that the found match\n                // does not appear on the top edge of the page when navigated to\n                searchMatchScrollTopOffset: -64,\n                // what percentage of the page should be scrolled,\n                // so that the page is considered to be changed to the next one\n                pageChangeScrollThreshold: 0.85,\n                // values higher than 200ms can result in browser zoom\n                pageWheelThrottleDelay: 200,\n                // ported from pdf.js\n                printResolution: 150,\n                loadOnDemand: false,\n                loadOnDemandPageSize: 2,\n                messages: {\n                    freeTextEditorPlaceholder: \"Start typing\",\n                    errorMessages: {\n                        parseError: \"PDF file fails to process.\",\n                        notFound: \"File is not found.\",\n                        popupBlocked: \"Popup is blocked.\"\n                    }\n                },\n                annotations: {\n                    highlight: {\n                        color: \"#ffff00\"\n                    }\n                },\n                elementSelectors: {\n                    pageSelector: \"k-page:not(.k-blank-page)\",\n                    pagesContainerClass: \"k-pdf-viewer-pages\",\n                    pageCanvasWrapper: \"k-canvas-wrapper\",\n                    documentContainerClass: \"k-pdf-viewer-canvas\",\n                    textLayerClass: \"k-text-layer\",\n                    searchHighlightClass: \"k-search-highlight\",\n                    searchHighlightMarkClass: \"k-search-highlight-mark\",\n                    charClass: \"k-text-char\",\n                    textElementSelector: \"span[role='presentation']\",\n                    renderedPageSelector: \"k-page[data-page-number]\",\n                    enabledTextSelectionClass: \"k-enable-text-select\",\n                    enabledPanningClass: \"k-enable-panning\"\n                },\n                events: {\n                    [PAGES_LOAD]: noop,\n                    [PRINT_END]: noop,\n                    [ZOOM_START]: noop,\n                    [ZOOM_END]: noop,\n                    [ERROR]: noop,\n                    [SCROLL]: noop,\n                    [ANNOTATION_EDITOR_TOOLBAR_SHOW]: noop,\n                    [ANNOTATION_EDITOR_TOOLBAR_HIDE]: noop\n                }\n            };\n            // todo: props\n            // isPageEditing = null;\n            this.interactionMode = PdfViewerInteractionMode.TextSelection;\n            this.printContainer = null;\n            // todo: props ported from pdf.js\n            this._scrollMode = ScrollMode.PAGE;\n            this.isInPresentationMode = false;\n            this._currentPageNumber = 1;\n            this.linkService = null;\n            this.annotationStorage = null;\n            this._annotationStorageModified = false;\n            this._hasAnnotationEditors = false;\n            _PdfViewer_annotationEditorMode.set(this, kendo_pdfjs_loader_js.AnnotationEditorType.NONE);\n            this.annotationEditorUIManager = null;\n            _PdfViewer_switchAnnotationEditorModeTimeoutId.set(this, null);\n            // #buffer = null;\n            // #altTextManager = null;\n            // #annotationEditorHighlightColors = null;\n            // #annotationEditorMode = AnnotationEditorType.NONE;\n            // #annotationEditorUIManager = null;\n            // #annotationMode = AnnotationMode.ENABLE_FORMS;\n            // #containerTopLeft = null;\n            // #enableHWA = false;\n            // #enableHighlightFloatingButton = false;\n            // #enablePermissions = false;\n            // #enableUpdatedAddImage = false;\n            // #enableNewAltTextWhenAddingImage = false;\n            _PdfViewer_eventAbortController.set(this, null);\n            // #mlManager = null;\n            _PdfViewer_onPageRenderedCallback.set(this, null);\n            // #switchAnnotationEditorModeTimeoutId = null;\n            // #getAllTextInProgress = false;\n            // #hiddenCopyElement = null;\n            // #interruptCopyCondition = false;\n            // #previousContainerHeight = 0;\n            // #resizeObserver = new ResizeObserver(this.#resizeObserverCallback.bind(this));\n            // #scrollModePageState = null;\n            // #scaleTimeoutId = null;\n            // #textLayerMode = TextLayerMode.ENABLE;\n            // todo: props\n            this.state = {};\n            this.pdfDocument = null;\n            this.pages = [];\n            this.triggerError = (e) => {\n                this.trigger(ERROR, {\n                    error: e\n                });\n            };\n            this.triggerPrintEnd = (e) => {\n                this.trigger(PRINT_END, e);\n            };\n            this.onPagesLoad = (args) => {\n                this.state.pdfDocument = args.pdfDoc;\n                this.state.pdfPages = args.pdfPages;\n                this.clearSearch();\n                this.initSearchService();\n                this.enableDocumentScrollEventsTracking();\n                this.triggerPagesLoad(args);\n            };\n            this.onDocumentScrollerScroll = (e) => {\n                const currentPageIndex = this.getCurrentPageIndex();\n                const pages = this.pages;\n                const page = pages[currentPageIndex];\n                const nextPage = pages[currentPageIndex + 1];\n                const previousPage = pages[currentPageIndex - 1];\n                if (page && page.isBlank()) {\n                    this.drawPageAsync({ pageIndex: currentPageIndex });\n                }\n                if (nextPage && nextPage.isBlank()) {\n                    this.drawPageAsync({ pageIndex: currentPageIndex + 1 });\n                }\n                if (previousPage && previousPage.isBlank()) {\n                    this.drawPageAsync({ pageIndex: currentPageIndex - 1 });\n                }\n                this.tryTriggerScroll(e);\n            };\n            // this is mainly used by blazor to track the page number\n            // as this can only be obtained by JS\n            this.tryTriggerScroll = (e) => {\n                let isPageChanged = false;\n                const pageNumber = currentPage(this.element) + 1;\n                if (pageNumber !== this.state.activePageNumber && (pageNumber >= 1 && pageNumber <= this.state.pdfDocument.numPagesh)) {\n                    isPageChanged = true;\n                    this.state.activePageNumber = pageNumber;\n                }\n                if (this.shouldPreventScroll) {\n                    this.shouldPreventScroll = false;\n                }\n                else {\n                    this.trigger(SCROLL, {\n                        scrollLeft: e.scrollLeft,\n                        scrollTop: e.scrollTop,\n                        pageNumber: this.state.activePageNumber,\n                        isPageChanged: isPageChanged\n                    });\n                }\n            };\n            this.printDocumentAsync = () => {\n                this.initPrintContainer();\n                const pagePrintPromises = this.getPagesPrintContentAsync(this.printContainer);\n                const printPromise = createPromise();\n                Promise.all(pagePrintPromises)\n                    .then(() => {\n                    // print the document during next render task\n                    setTimeout(() => {\n                        this.openPrintDialog();\n                        // @ts-expect-error TS()\n                        printPromise.resolve();\n                    }, FRAMES_PER_SECOND);\n                });\n                return printPromise;\n            };\n            this.onDocumentWheel = (e) => {\n                if (!e.ctrlKey && !e.metaKey) {\n                    return;\n                }\n                e.preventDefault();\n                const wheelDelta = mousewheelDelta(e);\n                const zoomModifier = wheelDelta < 0 ? 1 : -1;\n                const zoomLevel = this.state.zoomLevel + (zoomModifier * this.options.zoomRate);\n                this.triggerZoomStart({\n                    zoomLevel: zoomLevel\n                });\n                this.zoom({\n                    zoomLevel: zoomLevel\n                });\n                this.triggerZoomEnd({\n                    zoomLevel: zoomLevel\n                });\n            };\n            this.extendOptions(options);\n            this.throwIfInvalidOptions();\n            this.wrapper = this.element;\n            this.initEventBus();\n            kendo_dateinputsCommon_cmn_chunk_js._(this, _PdfViewer_eventAbortController, new AbortController(), \"f\");\n            this.resetState();\n            this.bindEvents();\n            this.initLinkService();\n            this.initDocumentContainer();\n            this.loadFile(this.options.fileDescriptor || {\n                data: this.options.fileData,\n                page: this.options.page\n            });\n        }\n        destroy() {\n            this.destroyEventBus();\n            this.unbindEvents();\n            this.destroySearchService();\n            this.destroyAnnotationEditorUIManager();\n            this.destroyDocumentScroller();\n        }\n        throwIfInvalidOptions() {\n            if (this.options.minZoom > this.options.maxZoom) {\n                throw new Error(\"The min zoom should be greater than max zoom\");\n            }\n        }\n        set annotationEditorParams({ type, value }) {\n            if (!this.annotationEditorUIManager) {\n                return;\n            }\n            this.annotationEditorUIManager.updateParams(type, value);\n        }\n        get annotationEditorMode() {\n            return this.annotationEditorUIManager\n                ? kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_annotationEditorMode, \"f\")\n                : kendo_pdfjs_loader_js.AnnotationEditorType.DISABLE;\n        }\n        set annotationEditorMode({ mode, editId = null, isFromKeyboard = false }) {\n            // todo: set isFromKeyboard intentionally to allow editor creation\n            // set annotationEditorMode({ mode, editId = null, isFromKeyboard = true }) {\n            if (!this.annotationEditorUIManager) {\n                // throw new Error(`The AnnotationEditor is not enabled.`);\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_annotationEditorMode, \"f\") === mode) {\n                return; // The AnnotationEditor mode didn't change.\n            }\n            if (!this.isValidAnnotationEditorMode(mode)) {\n                // throw new Error(`Invalid AnnotationEditor mode: ${mode}`);\n                return;\n            }\n            if (!this.pdfDocument) {\n                return;\n            }\n            if (mode === kendo_pdfjs_loader_js.AnnotationEditorType.STAMP) {\n                // this.#mlManager?.loadModel(\"altText\");\n            }\n            const { eventBus } = this;\n            const updater = () => {\n                this.cleanupSwitchAnnotationEditorMode();\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _PdfViewer_annotationEditorMode, mode, \"f\");\n                this.annotationEditorUIManager.updateMode(mode, editId, isFromKeyboard);\n                eventBus.dispatch(\"annotationeditormodechanged\", {\n                    source: this,\n                    mode,\n                });\n            };\n            // // todo: fix\n            // const isEditingPage = (this.pages || []).some(x => x.isEditing);\n            if (mode === kendo_pdfjs_loader_js.AnnotationEditorType.NONE || kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_annotationEditorMode, \"f\") === kendo_pdfjs_loader_js.AnnotationEditorType.NONE) {\n                const isEditing = mode !== kendo_pdfjs_loader_js.AnnotationEditorType.NONE;\n                if (!isEditing) {\n                    this.pdfDocument.annotationStorage.resetModifiedIds();\n                }\n                for (const pageView of this.pages) {\n                    pageView.toggleEditingMode(isEditing);\n                }\n                // We must call #switchToEditAnnotationMode unconditionally to ensure that\n                // page is rendered if it's useful or not.\n                const idsToRefresh = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_instances, \"m\", _PdfViewer_switchToEditAnnotationMode).call(this);\n                if (isEditing && idsToRefresh) {\n                    // We're editing so we must switch to editing mode when the rendering is\n                    // done.\n                    this.cleanupSwitchAnnotationEditorMode();\n                    kendo_dateinputsCommon_cmn_chunk_js._(this, _PdfViewer_onPageRenderedCallback, ({ pageNumber }) => {\n                        idsToRefresh.delete(pageNumber);\n                        if (idsToRefresh.size === 0) {\n                            kendo_dateinputsCommon_cmn_chunk_js._(this, _PdfViewer_switchAnnotationEditorModeTimeoutId, setTimeout(updater, 0), \"f\");\n                        }\n                    }, \"f\");\n                    const { signal } = kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_eventAbortController, \"f\");\n                    eventBus._on(\"pagerendered\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_onPageRenderedCallback, \"f\"), { signal });\n                }\n            }\n            updater();\n        }\n        extendOptions(options) {\n            this.options = deepExtend(this.options, options);\n        }\n        setOptions(options) {\n            this.options = options;\n        }\n        bindEvents() {\n            this.bindPagesWheel();\n        }\n        bindPagesWheel() {\n            const documentContainer = this.getDocumentContainer();\n            if (!documentContainer) {\n                return;\n            }\n            if (this.options.pageWheelThrottleDelay > 0) {\n                // @ts-expect-error TS(2339): Property 'throttledPagesWheel' does not exist on t... Remove this comment to see the full error message\n                this.throttledPagesWheel = throttle(this.onDocumentWheel, this.options.pageWheelThrottleDelay);\n            }\n            else {\n                // @ts-expect-error TS(2339): Property 'throttledPagesWheel' does not exist on t... Remove this comment to see the full error message\n                this.throttledPagesWheel = this.onDocumentWheel;\n            }\n            // @ts-expect-error TS(2339): Property 'throttledPagesWheel' does not exist on t... Remove this comment to see the full error message\n            documentContainer.addEventListener(\"wheel\", this.throttledPagesWheel);\n        }\n        unbindEvents() {\n            this.unbindPagesWheel();\n        }\n        unbindPagesWheel() {\n            const documentContainer = this.getDocumentContainer();\n            if (!documentContainer) {\n                return;\n            }\n            // @ts-expect-error TS(2339): Property 'throttledPagesWheel' does not exist on t... Remove this comment to see the full error message\n            if (this.throttledPagesWheel && this.throttledPagesWheel.cancel) {\n                // @ts-expect-error TS(2339): Property 'throttledPagesWheel' does not exist on t... Remove this comment to see the full error message\n                this.throttledPagesWheel.cancel();\n            }\n            // @ts-expect-error TS(2339): Property 'throttledPagesWheel' does not exist on t... Remove this comment to see the full error message\n            documentContainer.removeEventListener(\"wheel\", this.throttledPagesWheel);\n        }\n        setState(newState) {\n            this.state = deepExtend(this.state || {}, newState);\n        }\n        resetState() {\n            this.setState({\n                activePageNumber: 1,\n                visiblePagesCount: 1,\n                pagePromises: [],\n                downloadFilePromise: null,\n                pdfDocument: null,\n                zoomLevel: this.options.zoomLevel,\n                zoomLevelType: this.options.zoomLevelType,\n                zoomLevelBeforePrint: null\n            });\n        }\n        initEventBus() {\n            this.eventBus = new EventBus();\n        }\n        destroyEventBus() {\n        }\n        initLinkService() {\n            var _a;\n            this.linkService = new PDFLinkService({\n                eventBus: this.eventBus,\n                externalLinkTarget: LinkTarget.BLANK,\n                externalLinkRel: \"noopener noreferrer nofollow\",\n                ignoreDestinationZoom: false,\n            });\n            (_a = this.linkService) === null || _a === void 0 ? void 0 : _a.setViewer(this);\n        }\n        initAnnotationEditorUIManager() {\n            this.annotationEditorUIManager = new AnnotationEditorUIManager({\n                container: this.getDocumentContainer(),\n                // todo: pdf.js expects a dom element and not a component\n                viewer: this.element,\n                pdfViewer: this,\n                pdfDocument: this.state.pdfDocument,\n                eventBus: this.eventBus\n            });\n            this.setAnnotationEditorUIManagerScale();\n        }\n        setAnnotationEditorUIManagerScale() {\n            var _a;\n            // this is required when loading a new document\n            // so that annotation editors have correct positions during dragging\n            (_a = this.annotationEditorUIManager) === null || _a === void 0 ? void 0 : _a.onScaleChanging({\n                scale: this.options.zoomLevel\n            });\n        }\n        destroyAnnotationEditorUIManager() {\n            var _a;\n            (_a = this.annotationEditorUIManager) === null || _a === void 0 ? void 0 : _a.destroy();\n        }\n        bindEventBusAnnotationsEvents() {\n            const eventBus = this.eventBus = this.eventBus || new EventBus();\n            eventBus._on(\"switchannotationeditorparams\", (evt) => {\n                this.annotationEditorParams = evt;\n            }\n            // { signal }\n            );\n            eventBus._on(\"switchannotationeditormode\", evt => {\n                // todo: inline the call to this.annotationEditorMode = evt;\n                // this.annotationEditorMode = evt;\n                this.annotationEditorUIManager.updateParams(evt.type, evt.value);\n                const { mode, editId, isFromKeyboard } = evt;\n                this.annotationEditorUIManager.annotationEditorMode = evt;\n                this.annotationEditorUIManager.updateMode(mode, editId, isFromKeyboard);\n                eventBus.dispatch(\"annotationeditormodechanged\", {\n                    source: this,\n                    mode,\n                });\n            }\n            // { signal }\n            );\n            eventBus._on(\"kendoAnnotationEditorToolBarShow\", (evt) => {\n                var _a;\n                if (!evt) {\n                    return;\n                }\n                const annotationEditorMode = this.annotationEditorUIManager.getMode();\n                if (annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT ||\n                    annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT) {\n                    if (annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT) {\n                        this.addHighlightAnnotation();\n                    }\n                    this.triggerAnnotationEditorToolBarShow(Object.assign(Object.assign({}, evt), { annotationEditorMode: annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT ? \"highlight\" : \"freeText\", anchor: evt.anchor || ((_a = this.annotationEditorUIManager.firstSelectedEditor) === null || _a === void 0 ? void 0 : _a.div) }));\n                }\n            }\n            // { signal }\n            );\n            eventBus._on(\"kendoAnnotationEditorToolBarHide\", (evt) => {\n                if (!evt) {\n                    return;\n                }\n                const annotationEditorMode = this.annotationEditorUIManager.getMode();\n                if (annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT ||\n                    annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.FREETEXT) {\n                    this.triggerAnnotationEditorToolBarHide(Object.assign(Object.assign({}, evt), { annotationEditorMode: annotationEditorMode === kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT ? \"highlight\" : \"freeText\" }));\n                }\n            }\n            // { signal }\n            );\n            eventBus._on(\"showannotationeditorui\", (evt) => {\n                switch (evt.mode) {\n                    case kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT:\n                        // editorHighlightButton.click();\n                        eventBus.dispatch(\"switchannotationeditormode\", {\n                            source: this,\n                            mode: kendo_pdfjs_loader_js.AnnotationEditorType.HIGHLIGHT,\n                            // {},...eventDetails,\n                            // evt.detail is the number of clicks.\n                            // isFromKeyboard: evt.detail === 0,\n                            isFromKeyboard: false\n                        });\n                        break;\n                    default: break;\n                }\n            }\n            // { signal }\n            );\n        }\n        unbindEventBusAnnotationsEvents() {\n            // this.eventBus.off();\n        }\n        loadFile(args) {\n            const fileData = args.data;\n            const loadFileOptions = {\n                data: null,\n                url: \"\",\n                arrayBuffer: null,\n                typedArray: null\n            };\n            if (fileData && (fileData.buffer instanceof ArrayBuffer || fileData instanceof ArrayBuffer)) {\n                loadFileOptions.arrayBuffer = fileData.buffer || fileData;\n            }\n            else if (isString(fileData) && fileData !== \"\") {\n                loadFileOptions.data = fileData;\n                loadFileOptions.url = null;\n            }\n            else if (isString(args.url) && args.url !== \"\") {\n                loadFileOptions.data = null;\n                loadFileOptions.url = args.url;\n            }\n            else if (args.typedArray) {\n                loadFileOptions.typedArray = args.typedArray;\n            }\n            if (args.data || args.url || args.arrayBuffer || args.typedArray) {\n                const readOptions = Object.assign({ dom: this.getPagesContainer(), zoom: this.options.zoomLevel }, loadFileOptions);\n                this.disableDocumentScrollEventsTracking();\n                this.clearDocument();\n                this.loadDocument(readOptions);\n                this.setScaleFactor(this.options.zoomLevel);\n            }\n        }\n        loadDocument(options) {\n            const params = this.getDocumentParameters(options);\n            const { zoom } = options;\n            this.clearDocumentState();\n            kendo_pdfjs_loader_js.getDocument(params)\n                .promise.then((pdfDoc) => {\n                var _a;\n                (_a = this.linkService) === null || _a === void 0 ? void 0 : _a.setDocument(pdfDoc);\n                this.initDocumentAnnotationStorage(pdfDoc);\n                this.initAnnotationEditorUIManager();\n                this.bindEventBusAnnotationsEvents();\n                const pagesPromises = [];\n                for (let i = 1; i <= pdfDoc.numPages; i++) {\n                    pagesPromises.push(pdfDoc.getPage(i));\n                }\n                return { pagesPromises: pagesPromises, pdfDoc };\n            })\n                .then(({ pagesPromises: pagesPromises, pdfDoc }) => {\n                this.state.pagesPromises = pagesPromises;\n                this.destroyPageComponents();\n                return this.drawPagesFromPromisesAsync(pagesPromises)\n                    .then((pdfPages) => {\n                    this.setHiddenCanvasStyles();\n                    this.onPagesLoad({ pdfPages, pdfDoc, zoom });\n                })\n                    .catch((e) => {\n                    this.triggerError(e);\n                });\n            })\n                .catch((e) => {\n                this.triggerError(e);\n            });\n        }\n        initDocumentAnnotationStorage(pdfDocument) {\n            this.state.pdfDocument = pdfDocument;\n            this.pdfDocument = pdfDocument;\n            this.annotationStorage = new AnnotationStorage();\n            // todo: intentionally override the default value\n            // as it relies on checks like \"instanceof <something>\"\n            // but the classes from pdf.js are not exported\n            // and thus they are migrated, see https://github.com/mozilla/pdf.js/issues/18656\n            // Object.defineProperty(Object.getPrototypeOf(this.pdfDocument), 'annotationStorage', {\n            //     get: () => {\n            //         if (this.state.isPrintingInProgress) {\n            //             return this.annotationStorage?.print;\n            //         } else {\n            //             return this.annotationStorage;\n            //         }\n            //     },\n            //     set: (value) => {\n            //         this.annotationStorage = value;\n            //     },\n            //     // this is required\n            //     configurable: true\n            // });\n            Object.defineProperty(Object.getPrototypeOf(this.pdfDocument._transport), 'annotationStorage', {\n                get: () => {\n                    var _a;\n                    if (this.state.isPrintingInProgress) {\n                        return (_a = this.annotationStorage) === null || _a === void 0 ? void 0 : _a.print;\n                    }\n                    else {\n                        return this.annotationStorage;\n                    }\n                },\n                set: (value) => {\n                    this.annotationStorage = value;\n                },\n                // this is required\n                configurable: true\n            });\n            this._initializeAnnotationStorageCallbacks(pdfDocument);\n        }\n        _initializeAnnotationStorageCallbacks(pdfDocument) {\n            if (pdfDocument !== this.pdfDocument) {\n                return;\n            }\n            const { annotationStorage } = pdfDocument;\n            annotationStorage.onSetModified = () => {\n                // window.addEventListener(\"beforeunload\", beforeUnload);\n                // if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n                this._annotationStorageModified = true;\n                // }\n            };\n            annotationStorage.onResetModified = () => {\n                // window.removeEventListener(\"beforeunload\", beforeUnload);\n                // if (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) {\n                delete this._annotationStorageModified;\n                // }\n            };\n            annotationStorage.onAnnotationEditor = typeStr => {\n                this._hasAnnotationEditors = !!typeStr;\n                // this.setTitle();\n            };\n        }\n        drawPagesFromPromisesAsync(pagesPromises) {\n            return Promise.all(pagesPromises)\n                .then((pdfPages) => kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                const pages = yield Promise.all(this.drawPagesAsync(pdfPages));\n                this.appendPages(pages);\n                return pdfPages;\n            }));\n        }\n        drawPagesAsync(pdfPages) {\n            pdfPages = pdfPages || this.state.pdfPages;\n            const hasPages = (this.pages || []).length > 0;\n            if (!hasPages) {\n                this.initPageComponents(pdfPages);\n            }\n            else {\n                for (let i = 0; i < this.pages.length; i++) {\n                    const pageViewport = this.pages[i].getViewport({\n                        scale: this.state.zoomLevel\n                    });\n                    // todo: adjust page viewport manually\n                    // otherwise, loading a document with links to the document\n                    // will not scroll to the specific page on click\n                    // pdf.js handles this in a more complex way\n                    // that will require porting more code\n                    this.pages[i].viewport = pageViewport;\n                }\n            }\n            const pageRenderPromises = [];\n            pdfPages.map((pdfPage, pageIndex) => kendo_dateinputsCommon_cmn_chunk_js.b(this, void 0, void 0, function* () {\n                const page = this.pages[pageIndex];\n                if (this.options.loadOnDemand &&\n                    pageIndex >= this.options.loadOnDemandPageSize &&\n                    !page.element) {\n                    const blankPageElements = this.createBlankPageElements({ pdfPage, zoom: this.state.zoomLevel });\n                    if (page && !page.element) {\n                        page.element = blankPageElements.pageElement;\n                        page.setBlank(true);\n                    }\n                    const pageRenderPromise = createPromise();\n                    pageRenderPromises.push(pageRenderPromise);\n                    pageRenderPromise.then((renderedPage) => {\n                        return renderedPage;\n                    });\n                    pageRenderPromise.resolve(page.element);\n                }\n                else if (this.options.loadOnDemand && page.isBlank()) {\n                    // keep blank pages on reload\n                    const pageRenderPromise = createPromise();\n                    pageRenderPromises.push(pageRenderPromise);\n                    pageRenderPromise.then((renderedPage) => {\n                        return renderedPage;\n                    });\n                    pageRenderPromise.resolve(page.element);\n                }\n                else {\n                    const pageRenderPromise = this.drawPageAsync({ pageIndex });\n                    pageRenderPromises.push(pageRenderPromise);\n                    pageRenderPromise.then((renderedPage) => {\n                        return renderedPage;\n                    });\n                }\n            }));\n            return pageRenderPromises;\n        }\n        createBlankPageElements({ pdfPage, zoom }) {\n            const pageElements = this.createPageElements({ pdfPage, zoom });\n            pageElements.canvasWrapper.appendChild(pageElements.canvas);\n            pageElements.pageElement.appendChild(pageElements.canvasWrapper);\n            return pageElements;\n        }\n        getDocumentParameters(options) {\n            let params = {\n                verbosity: 0,\n                isEvalSupported: true\n            };\n            if (typeof options.data === 'string' && options.data !== \"\") {\n                params.data = parsePdfFromBase64String(options.data);\n            }\n            else if (typeof options.url === 'string' && options.url !== \"\") {\n                params.url = options.url;\n            }\n            else if (options.arrayBuffer instanceof ArrayBuffer) {\n                params = options.arrayBuffer;\n            }\n            else if (options.typedArray) {\n                params = options.typedArray;\n            }\n            return params;\n        }\n        appendPages(pages) {\n            pages.forEach(page => this.appendPage(page));\n        }\n        appendPage(page, pageIndex = null) {\n            const pagesContainer = this.getPagesContainer();\n            if (hasValue(pageIndex)) {\n                pagesContainer === null || pagesContainer === void 0 ? void 0 : pagesContainer.insertBefore(page, pagesContainer.children[pageIndex]);\n            }\n            else {\n                pagesContainer === null || pagesContainer === void 0 ? void 0 : pagesContainer.appendChild(page);\n            }\n        }\n        drawPageAsync({ pageIndex = 0 }) {\n            var _a;\n            const index = clamp(pageIndex, 0, Math.max(0, this.state.pdfDocument.numPages - 1));\n            return (_a = this.pages[index]) === null || _a === void 0 ? void 0 : _a.draw().then(() => {\n                return this.pages[index].element;\n            });\n        }\n        createPageElements({ pdfPage = null, zoom = 1, }) {\n            if (zoom <= 0) {\n                return;\n            }\n            const viewportScale = scale();\n            const scaleNum = zoom || viewportScale;\n            const viewport = pdfPage === null || pdfPage === void 0 ? void 0 : pdfPage.getViewport({ scale: viewportScale });\n            const { adjustedWidth, adjustedHeight, adjustRatio } = adjustCanvasSize(viewport.width, viewport.height);\n            // const styles = {\n            //     width: Math.floor(viewport.width / scaleNum) * zoom + 'pt',\n            //     height: Math.floor(viewport.height / scaleNum) * zoom + 'pt'\n            // };\n            // use PageView.setLayerDimensions\n            const { pageWidth, pageHeight } = viewport.rawDims;\n            const styles = {\n                // \"round\" is supported in all browsers since May 2024\n                // https://developer.mozilla.org/en-US/docs/Web/CSS/round#browser_compatibility\n                width: `round(var(--scale-factor) * ${pageWidth}px, 1px)`,\n                height: `round(var(--scale-factor) * ${pageHeight}px, 1px)`\n            };\n            const pageElement = createElement(\"div\", \"k-page\", styles);\n            const canvas = createElement(\"canvas\", '', {\n                width: \"100%\",\n                height: \"100%\"\n            });\n            canvas.height = adjustedHeight;\n            canvas.width = adjustedWidth;\n            const canvasContext = canvas.getContext(\"2d\");\n            const canvasWrapper = convertToHtml(`\n            <div class=\"${this.options.elementSelectors.pageCanvasWrapper}\"></div>\n        `);\n            // canvasWrapper.appendChild(canvas);\n            // pageElement.appendChild(canvasWrapper);\n            const adjustedScale = adjustRatio * scaleNum;\n            viewport.width = adjustedWidth;\n            viewport.height = adjustedHeight;\n            viewport.scale = adjustedScale;\n            return {\n                canvasContext,\n                canvasWrapper,\n                canvas,\n                viewport,\n                scaleNum,\n                pageElement,\n                styles,\n            };\n        }\n        triggerPagesLoad(e) {\n            this.trigger(PAGES_LOAD, e);\n        }\n        triggerZoomStart(e) {\n            this.trigger(ZOOM_START, e);\n        }\n        triggerZoomEnd(e) {\n            this.trigger(ZOOM_END, e);\n        }\n        triggerDownload(e) {\n            return this.trigger(DOWNLOAD, e);\n        }\n        triggerAnnotationEditorToolBarShow(e) {\n            this.trigger(ANNOTATION_EDITOR_TOOLBAR_SHOW, e);\n        }\n        triggerAnnotationEditorToolBarHide(e) {\n            this.trigger(ANNOTATION_EDITOR_TOOLBAR_HIDE, e);\n        }\n        clearDocument() {\n            var _a;\n            this.clearPagesElements();\n            this.clearDocumentState();\n            (_a = this.linkService) === null || _a === void 0 ? void 0 : _a.setDocument(null);\n        }\n        clearDocumentState() {\n            this.state.pdfDocument = null;\n            this.state.pdfPages = [];\n            this.pages.forEach(x => x.destroy());\n            this.pages = [];\n        }\n        initPageComponents(pdfPages) {\n            // const scale = this.currentScale;\n            // const currentScale = scale();\n            const currentScale = this.options.zoomLevel;\n            const viewport = pdfPages[0].getViewport({\n                scale: currentScale * kendo_pdfjs_loader_js.PixelsPerInch.PDF_TO_CSS_UNITS,\n            });\n            for (let pageNum = 1; pageNum <= pdfPages.length; pageNum++) {\n                const pageIndex = pageNum - 1;\n                const pageView = new Page(null, {\n                    pdfViewer: this,\n                    container: this.element,\n                    eventBus: this.eventBus,\n                    id: pageNum,\n                    scale: currentScale,\n                    viewport: viewport,\n                    defaultViewport: viewport,\n                    // optionalContentConfigPromise,\n                    // renderingQueue: this.renderingQueue,\n                    textLayerMode: TextLayerMode.ENABLE,\n                    annotationMode: AnnotationMode.ENABLE,\n                    // imageResourcesPath: this.imageResourcesPath,\n                    // maxCanvasPixels: this.maxCanvasPixels,\n                    // pageColors,\n                    // l10n: this.l10n,\n                    layerProperties: this._layerProperties,\n                    // enableHWA: this.#enableHWA,\n                });\n                this.pages.push(pageView);\n                this.pages[pageIndex].setPdfPage(pdfPages[pageIndex]);\n            }\n        }\n        destroyPageComponents() {\n            this.pages.forEach(x => x.destroy());\n            this.pages = [];\n        }\n        clearPagesElements() {\n            const documentContainer = this.getDocumentContainer();\n            const pagesContainer = this.getPagesContainer();\n            if (!documentContainer || !pagesContainer || !this.hasDocument()) {\n                return;\n            }\n            const pages = this.getPagesElements();\n            pages.forEach(page => {\n                // @ts-expect-error TS(2345): Argument of type 'unknown' is not assignable to pa... Remove this comment to see the full error message\n                pagesContainer.removeChild(page);\n            });\n        }\n        initDocumentContainer() {\n            if (this.documentContainer) {\n                return;\n            }\n            this.documentContainer = this.getDocumentContainer();\n            this.initDocumentScroller(this.documentContainer);\n        }\n        initDocumentScroller(element) {\n            if (this.documentScroller || !element) {\n                return;\n            }\n            this.documentScroller = this.createDocumentScroller(element, {\n                filter: toClassSelector$1(this.options.elementSelectors.pageSelector),\n                events: {\n                    [SCROLL]: this.onDocumentScrollerScroll\n                }\n            });\n        }\n        createDocumentScroller(element, options) {\n            return new Scroller(element, options);\n        }\n        destroyDocumentScroller() {\n            if (!this.documentScroller) {\n                return;\n            }\n            this.documentScroller.destroy();\n            this.documentScroller = null;\n        }\n        enableDocumentScrollEventsTracking() {\n            var _a;\n            (_a = this.documentScroller) === null || _a === void 0 ? void 0 : _a.enableScrollEventsTracking();\n        }\n        disableDocumentScrollEventsTracking() {\n            var _a;\n            (_a = this.documentScroller) === null || _a === void 0 ? void 0 : _a.disableScrollEventsTracking();\n        }\n        getCurrentPageIndex() {\n            return currentPage(this.element) || 0;\n        }\n        downloadFile({ fileName, saveOptions = {} }) {\n            this.downloadDocument({\n                options: {\n                    pdf: this.state.pdfDocument\n                },\n                fileName: fileName || this.options.downloadFileName,\n                saveOptions: saveOptions\n            });\n        }\n        downloadDocument({ options, fileName = \"Document\", saveOptions = {}, }) {\n            if (options.pdf) {\n                let exportMethod = options.pdf.getData.bind(options.pdf);\n                let serializedAnnotationStorage = {};\n                let originalAnnotationStorage = {};\n                if (options.pdf.annotationStorage.size > 0) {\n                    exportMethod = options.pdf.saveDocument.bind(options.pdf);\n                    // saveDocument() has checks that test \"editor instanceof AnnotationEditor\", but they fail\n                    // because AnnotationEditor from \"pdfjs-dist/legacy/build/pdf.mjs\" is not exported\n                    // thus replace instances of editors with their serialized version\n                    // and then revert\n                    serializedAnnotationStorage = {};\n                    originalAnnotationStorage = options.pdf.annotationStorage.getAll();\n                    Object.keys(originalAnnotationStorage).forEach((key) => {\n                        serializedAnnotationStorage[key] = originalAnnotationStorage[key].toJSON();\n                    });\n                    Object.keys(originalAnnotationStorage).forEach((key) => {\n                        options.pdf.annotationStorage.remove(key);\n                    });\n                    Object.keys(serializedAnnotationStorage).forEach((key) => {\n                        options.pdf.annotationStorage.setValue(key, serializedAnnotationStorage[key]);\n                    });\n                }\n                exportMethod()\n                    .then((data) => {\n                    return new Blob([data], { type: 'application/pdf' });\n                })\n                    .then((blob) => {\n                    if (!this.triggerDownload({ blob, fileName, saveOptions })) {\n                        this.saveFile(blob, fileName, saveOptions);\n                    }\n                })\n                    .catch((e) => {\n                    this.triggerError(e);\n                })\n                    .finally(() => {\n                    var _a;\n                    if (((_a = options.pdf) === null || _a === void 0 ? void 0 : _a.annotationStorage.size) <= 0) {\n                        return;\n                    }\n                    const currentAnnotationStorage = options.pdf.annotationStorage.getAll();\n                    Object.keys(currentAnnotationStorage).forEach((key) => {\n                        options.pdf.annotationStorage.remove(key);\n                    });\n                    Object.keys(originalAnnotationStorage).forEach((key) => {\n                        options.pdf.annotationStorage.setValue(key, originalAnnotationStorage[key]);\n                    });\n                });\n            }\n        }\n        ;\n        saveFile(blob, fileName, saveOptions) {\n            try {\n                kendo_fileSaver_cmn_chunk_js.s(blob, fileName, saveOptions);\n            }\n            catch (_a) {\n                return false;\n            }\n            return true;\n        }\n        hasDocument() {\n            return hasValue(this.state.pdfDocument);\n        }\n        zoom(args) {\n            args.zoomLevel = this.calculateZoomLevel({\n                zoomLevel: args.zoomLevel,\n                zoomLevelType: args.zoomLevelType,\n                currentZoom: this.options.zoomLevel,\n            });\n            this.options.zoomLevel = args.zoomLevel;\n            this.state.zoomLevel = args.zoomLevel;\n            this.eventBus.dispatch(\"scalechanging\", {\n                source: this,\n                scale: this.options.zoomLevel,\n            });\n            this.reloadFile(this.state.pdfDocument);\n        }\n        calculateZoomLevel({ zoomLevel, zoomLevelType, currentZoom }) {\n            const documentContainer = this.getDocumentContainer();\n            const page = documentContainer.querySelector(toClassSelector$1(this.options.elementSelectors.pageSelector));\n            const pageSize = { width: page.offsetWidth, height: page.offsetHeight };\n            let calculatedZoomLevel = clamp(zoomLevel || DEFAULT_ZOOM_LEVEL, this.options.minZoom, this.options.maxZoom);\n            if (zoomLevelType === \"ActualWidth\" || zoomLevelType === \"actualWidth\") {\n                calculatedZoomLevel = 1;\n            }\n            else if (zoomLevelType === \"FitToWidth\" || zoomLevelType === \"fitToWidth\") {\n                calculatedZoomLevel = documentContainer.offsetWidth / (pageSize.width / currentZoom);\n            }\n            else if (zoomLevelType === \"FitToPage\" || zoomLevelType === \"fitToPage\") {\n                calculatedZoomLevel = documentContainer.offsetHeight / (pageSize.height / currentZoom);\n            }\n            return calculatedZoomLevel;\n        }\n        reloadFile(pdfDoc) {\n            const pagesPromises = [];\n            for (let i = 1; i <= pdfDoc.numPages; i++) {\n                pagesPromises.push(pdfDoc.getPage(i));\n            }\n            this.disableDocumentScrollEventsTracking();\n            this.drawPagesFromPromisesAsync(pagesPromises)\n                .then((pdfPages) => {\n                this.setHiddenCanvasStyles();\n                this.onPagesLoad({ pdfPages, pdfDoc });\n            })\n                .catch((e) => {\n                this.triggerError(e);\n            });\n            this.setScaleFactor(this.state.zoomLevel);\n        }\n        setHiddenCanvasStyles() {\n            if (!this.options.pdfjsSetHiddenCanvasStyles) {\n                return;\n            }\n            // required after pdf.js 4.x version\n            const sheet = new CSSStyleSheet();\n            sheet.replaceSync(`.hiddenCanvasElement {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 0;\n            height: 0;\n            display: none;\n        }`);\n            this.getPagesContainer().ownerDocument.adoptedStyleSheets = [sheet];\n        }\n        printFile() {\n            if (!this.hasDocument()) {\n                return;\n            }\n            this.setState({\n                isPrintingInProgress: true\n            });\n            if (this.options.zoomBeforePrint) {\n                // such option existed in the Kendo jQuery version internally\n                this.cacheZoomLevelBeforePrint();\n                this.loadDocumentForPrintAsync({\n                    zoomLevel: this.options.zoomLevelBeforePrint,\n                    force: true\n                })\n                    .then(() => {\n                    this.printDocumentAsync()\n                        .then(() => {\n                        this.trigger(PRINT_END);\n                    });\n                })\n                    .catch(this.triggerError)\n                    .finally(() => {\n                    this.setState({\n                        isPrintingInProgress: false\n                    });\n                    this.restoreZoomLevelBeforePrint();\n                });\n            }\n            else {\n                this.loadDocumentForPrintAsync({\n                    zoomLevel: this.state.zoomLevel,\n                    force: true\n                })\n                    .then(() => {\n                    this.printDocumentAsync()\n                        .then(() => {\n                        this.trigger(PRINT_END);\n                    });\n                })\n                    .catch(this.triggerError)\n                    .finally(() => {\n                    this.setState({\n                        isPrintingInProgress: false\n                    });\n                });\n            }\n        }\n        loadDocumentForPrintAsync({ zoomLevel = DEFAULT_ZOOM_LEVEL, force = false }) {\n            const pages = this.pages;\n            const pageLoadPromises = [];\n            const loadPromise = createPromise();\n            for (let i = 0; i < pages.length; i++) {\n                const pageLoadPromise = pages[i].loadForPrintAsync({\n                    zoomLevel: zoomLevel,\n                    force: force\n                });\n                pageLoadPromises.push(pageLoadPromise);\n            }\n            Promise.all(pageLoadPromises)\n                .then(() => {\n                // @ts-expect-error TS()\n                loadPromise.resolve();\n            });\n            return loadPromise;\n        }\n        getPagesPrintContentAsync(printContainer) {\n            const pages = this.pages;\n            const pagePrintPromises = [];\n            for (let i = 0; i < pages.length; i++) {\n                const pagePrintPromise = pages[i].getPrintContentAsync();\n                pagePrintPromise.then((pagePrintContent) => {\n                    const pageWrapper = convertToHtml(`<div></div>`);\n                    pageWrapper.appendChild(pagePrintContent);\n                    printContainer.appendChild(pageWrapper);\n                });\n                pagePrintPromises.push(pagePrintPromise);\n            }\n            return pagePrintPromises;\n        }\n        initPrintContainer() {\n            this.printContainer = convertToHtml(`<div></div>`);\n        }\n        openPrintDialog() {\n            const pages = this.pages;\n            const width = pages[0].rawWidth;\n            const height = pages[0].rawHeight;\n            const printDialog = window.open('', '', 'innerWidth=' + width + ',innerHeight=' + height + 'location=no,titlebar=no,toolbar=no');\n            if (!printDialog || !printDialog.document) {\n                this.triggerError({\n                    message: this.options.messages.errorMessages.popupBlocked\n                });\n                return;\n            }\n            printDialog.document.body.style.margin = '0';\n            printDialog.document.body.appendChild(this.printContainer);\n            const afterPrintHandler = () => {\n                printDialog.removeEventListener(\"afterprint\", afterPrintHandler);\n                printDialog.close();\n            };\n            printDialog.addEventListener(\"afterprint\", afterPrintHandler);\n            printDialog.focus();\n            printDialog.print();\n            // setTimeout(() => {\n            // printDialog.print();\n            // done();\n            // });\n        }\n        cacheZoomLevelBeforePrint() {\n            this.setState({\n                zoomLevelBeforePrint: this.state.zoomLevel\n            });\n        }\n        restoreZoomLevelBeforePrint() {\n            if (this.state.zoomLevelBeforePrint === this.state.zoomLevel) {\n                return;\n            }\n            this.zoom({\n                zoomLevel: this.state.zoomLevelBeforePrint,\n                zoomLevelType: this.state.zoomLevelType,\n                currentZoom: this.state.zoomLevel\n            });\n        }\n        searchText(options = { text: \"\", matchCase: false }) {\n            var _a;\n            this.initSearchService();\n            const matches = (_a = this.searchService) === null || _a === void 0 ? void 0 : _a.search(options);\n            return matches;\n        }\n        clearSearch() {\n            this.destroySearchService();\n        }\n        initSearchService() {\n            const textLayers = Array.from(this.wrapper.querySelectorAll(toClassSelector$1(this.options.elementSelectors.textLayerClass)) || []);\n            if (this.searchService) {\n                // refresh text nodes as text layers have changed\n                if (textLayers.every((x, i) => x === this.searchService.options.textContainers[i])) {\n                    return;\n                }\n                else {\n                    this.destroySearchService();\n                }\n            }\n            this.searchService = new SearchService({\n                textContainers: textLayers,\n                highlightClass: this.options.elementSelectors.searchHighlightClass,\n                highlightMarkClass: this.options.elementSelectors.searchHighlightMarkClass,\n                charClass: this.options.elementSelectors.charClass\n            });\n        }\n        destroySearchService() {\n            if (!this.searchService) {\n                return;\n            }\n            this.searchService.destroy();\n            this.searchService = null;\n        }\n        goToNextSearchMatch() {\n            if (!this.searchService) {\n                return;\n            }\n            this.searchService.markNextMatch();\n            const matchElement = this.searchService.getActiveMatchElement();\n            this.scrollToSearchMatch(matchElement);\n        }\n        goToPreviousSearchMatch() {\n            if (!this.searchService) {\n                return;\n            }\n            this.searchService.markPreviousMatch();\n            const matchElement = this.searchService.getActiveMatchElement();\n            this.scrollToSearchMatch(matchElement);\n        }\n        getPagesContainer() {\n            return this.element.querySelector(toClassSelector$1(this.options.elementSelectors.pagesContainerClass));\n        }\n        getDocumentContainer() {\n            return this.wrapper.querySelector(toClassSelector$1(this.options.elementSelectors.documentContainerClass));\n        }\n        getPagesElements() {\n            const documentContainer = this.getDocumentContainer();\n            if (!documentContainer) {\n                return [];\n            }\n            return toArray(documentContainer.querySelectorAll(toClassSelector$1(this.options.elementSelectors.pageSelector)));\n        }\n        scrollToSearchMatch(matchElement) {\n            if (!matchElement) {\n                return;\n            }\n            const closestCharElement = matchElement.closest('.k-text-char');\n            const closestTextElement = closestCharElement\n                ? closestCharElement.closest('span[role=\"presentation\"]')\n                : null;\n            if (!closestTextElement) {\n                return;\n            }\n            const closestPageElement = closestTextElement.closest('.k-page');\n            if (!closestPageElement) {\n                return;\n            }\n            const scrollLeft = closestPageElement.offsetLeft +\n                -1 * this.documentScroller.element.offsetLeft +\n                closestTextElement.offsetLeft +\n                this.options.searchMatchScrollLeftOffset;\n            const scrollTop = closestPageElement.offsetTop +\n                -1 * this.documentScroller.element.offsetTop +\n                closestTextElement.offsetTop +\n                this.options.searchMatchScrollTopOffset;\n            this.documentScroller.scrollTo(scrollLeft, scrollTop, { trackScrollEvent: false });\n        }\n        resetInteractionMode() {\n            this.setInteractionMode({\n                mode: PdfViewerInteractionMode.TextSelection\n            });\n        }\n        setInteractionMode(args) {\n            this.interactionMode = args.mode;\n            if (this.interactionMode === PdfViewerInteractionMode.TextSelection) {\n                this.disableScrollerEventsTracking();\n                addClass(this.options.elementSelectors.enabledTextSelectionClass, this.documentScroller.element);\n                removeClass(this.options.elementSelectors.enabledPanningClass, this.documentScroller.element);\n            }\n            else if (this.interactionMode === PdfViewerInteractionMode.Pan) {\n                this.enableScrollerEventsTracking();\n                removeClass(this.options.elementSelectors.enabledTextSelectionClass, this.documentScroller.element);\n                addClass(this.options.elementSelectors.enabledPanningClass, this.documentScroller.element);\n            }\n        }\n        enableScrollerEventsTracking() {\n            if (!this.documentScroller) {\n                return;\n            }\n            this.documentScroller.enablePanEventsTracking();\n        }\n        disableScrollerEventsTracking() {\n            if (!this.documentScroller) {\n                return;\n            }\n            this.documentScroller.disablePanEventsTracking();\n        }\n        setScaleFactor(scaleFactor) {\n            this.element.style.setProperty('--scale-factor', String(scaleFactor * kendo_pdfjs_loader_js.PixelsPerInch.PDF_TO_CSS_UNITS));\n        }\n        activatePageNumber(pageNumber) {\n            const page = this.getPageByNumber(pageNumber);\n            if (!page) {\n                return;\n            }\n            const pageIndex = pageNumber - 1;\n            if (this.state.activePageNumber === pageNumber) {\n                return;\n            }\n            this.state.activePageNumber = pageNumber;\n            if (page.isBlank()) {\n                this.drawPageAsync({ pageIndex: pageIndex })\n                    .then(() => {\n                    this.scrollToPage({\n                        pageNumber\n                    });\n                });\n            }\n            else {\n                this.scrollToPage({\n                    pageNumber\n                });\n            }\n        }\n        scrollToPage({ pageNumber }) {\n            const { left, top } = this.getPageNumberScrollOffset(pageNumber);\n            this.scrollDocument({\n                left: left,\n                top: top\n            });\n        }\n        scrollDocument({ left, top }) {\n            var _a;\n            (_a = this.documentScroller) === null || _a === void 0 ? void 0 : _a.scrollTo(left, top, {\n                // as we are manually scrolling to the page\n                // we want to ignore the scroller's element scroll event\n                // to avoid double handling of the scrolling\n                trackScrollEvent: false\n            });\n        }\n        getPageNumberScrollOffset(pageNumber) {\n            const page = this.getPageByNumber(pageNumber);\n            if (!page) {\n                return {\n                    left: 0,\n                    top: 0\n                };\n            }\n            // pages might have different sizes\n            // although pdf.js does not fully support this\n            const previousPages = this.pages.slice(0, Math.max(0, pageNumber - 1));\n            const previousPagesScrollOffset = previousPages\n                .map(x => {\n                const pageScrollOffset = this.getPageScrollOffset(x);\n                return pageScrollOffset;\n            })\n                .reduce((sum, pageScrollOffset) => sum + pageScrollOffset, 0);\n            return {\n                left: 0,\n                top: previousPagesScrollOffset\n            };\n        }\n        getPageScrollOffset(page) {\n            var _a;\n            const pageHeight = ((_a = page === null || page === void 0 ? void 0 : page.element) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect().height) || 0;\n            const computedStyles = getComputedStyle(page.element);\n            const pageMarginTop = parseFloat(computedStyles.marginTop) || 0;\n            return pageHeight + pageMarginTop;\n        }\n        getPageByNumber(pageNumber) {\n            const page = this.pages && this.pages[pageNumber - 1];\n            return page;\n        }\n        addHighlightAnnotation() {\n            var _a;\n            (_a = this.annotationEditorUIManager) === null || _a === void 0 ? void 0 : _a.highlightSelection();\n        }\n        setHighlightColor(color) {\n            this.executeAnnotationCommand({\n                commandType: kendo_pdfjs_loader_js.AnnotationEditorParamsType.HIGHLIGHT_COLOR,\n                commandValue: color\n            });\n        }\n        deleteAnnotation() {\n            var _a;\n            (_a = this.annotationEditorUIManager) === null || _a === void 0 ? void 0 : _a.delete();\n        }\n        resetAnnotationEditorMode() {\n            this.setAnnotationEditorMode({\n                mode: kendo_pdfjs_loader_js.AnnotationEditorType.NONE,\n                editId: null,\n                isFromKeyboard: false\n            });\n        }\n        setAnnotationEditorMode(modeDescriptor) {\n            this.annotationEditorMode = modeDescriptor;\n        }\n        setFreeTextColor(color) {\n            this.executeAnnotationCommand({\n                commandType: kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_COLOR,\n                commandValue: color\n            });\n        }\n        setFreeTextFontSize(fontSize) {\n            this.executeAnnotationCommand({\n                commandType: kendo_pdfjs_loader_js.AnnotationEditorParamsType.FREETEXT_SIZE,\n                commandValue: parseFloat(fontSize)\n            });\n        }\n        executeAnnotationCommand({ commandType, commandValue }) {\n            this.eventBus.dispatch(\"switchannotationeditorparams\", {\n                source: this,\n                type: commandType,\n                value: commandValue\n            });\n        }\n        // todo: ported from pdf.js\n        isValidAnnotationEditorMode(mode) {\n            return Object.values(kendo_pdfjs_loader_js.AnnotationEditorType).includes(mode) && mode !== kendo_pdfjs_loader_js.AnnotationEditorType.DISABLE;\n        }\n        cleanupSwitchAnnotationEditorMode() {\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_onPageRenderedCallback, \"f\")) {\n                this.eventBus._off(\"pagerendered\", kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_onPageRenderedCallback, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _PdfViewer_onPageRenderedCallback, null, \"f\");\n            }\n            if (kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_switchAnnotationEditorModeTimeoutId, \"f\") !== null) {\n                clearTimeout(kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_switchAnnotationEditorModeTimeoutId, \"f\"));\n                kendo_dateinputsCommon_cmn_chunk_js._(this, _PdfViewer_switchAnnotationEditorModeTimeoutId, null, \"f\");\n            }\n        }\n        _getVisiblePages() {\n            // const views =\n            //     this._scrollMode === ScrollMode.PAGE\n            //         ? this.#scrollModePageState.pages\n            //         : this._pages,\n            //     horizontal = this._scrollMode === ScrollMode.HORIZONTAL,\n            //     rtl = horizontal && this._isContainerRtl;\n            // return getVisibleElements({\n            //     scrollEl: this.container,\n            //     views,\n            //     sortByVisibility: true,\n            //     horizontal,\n            //     rtl,\n            // });\n            return this.pages;\n        }\n        get _layerProperties() {\n            const self = this;\n            return kendo_pdfjs_loader_js.shadow(this, \"_layerProperties\", {\n                get annotationEditorUIManager() {\n                    return self.annotationEditorUIManager;\n                },\n                get annotationStorage() {\n                    var _a;\n                    return (_a = self.pdfDocument) === null || _a === void 0 ? void 0 : _a.annotationStorage;\n                },\n                // get downloadManager() {\n                //     return self.downloadManager;\n                // },\n                // get enableScripting() {\n                //     return !!self._scriptingManager;\n                // },\n                // get fieldObjectsPromise() {\n                //     return self.pdfDocument?.getFieldObjects();\n                // },\n                // get findController() {\n                //     return self.findController;\n                // },\n                // get hasJSActionsPromise() {\n                //     return self.pdfDocument?.hasJSActions();\n                // },\n                get linkService() {\n                    return self.linkService;\n                },\n            });\n        }\n        /**\n         * Scrolls page into view.\n         * @param {ScrollPageIntoViewParameters} params\n         */\n        scrollPageIntoView({ pageNumber, destArray = null, allowNegativeOffset = false, ignoreDestinationZoom = false, }) {\n            if (!this.pdfDocument) {\n                return;\n            }\n            const pageView = Number.isInteger(pageNumber) && this.pages[pageNumber - 1];\n            if (!pageView) {\n                // console.error(\n                //     `scrollPageIntoView: \"${pageNumber}\" is not a valid pageNumber parameter.`\n                // );\n                return;\n            }\n            if (this.isInPresentationMode || !destArray) {\n                this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n                return;\n            }\n            let x = 0, y = 0;\n            const width = 0, height = 0;\n            // widthScale,\n            // heightScale;\n            const changeOrientation = pageView.rotation % 180 !== 0;\n            // const pageWidth =\n            //     (changeOrientation ? pageView.height : pageView.width) /\n            //     pageView.scale /\n            //     PixelsPerInch.PDF_TO_CSS_UNITS;\n            const pageHeight = (changeOrientation ? pageView.rawWidth : pageView.rawHeight) /\n                pageView.scale /\n                kendo_pdfjs_loader_js.PixelsPerInch.PDF_TO_CSS_UNITS;\n            // let scale: any = 0;\n            switch (destArray[1].name) {\n                case \"XYZ\":\n                    x = destArray[2];\n                    y = destArray[3];\n                    // scale = destArray[4];\n                    // If x and/or y coordinates are not supplied, default to\n                    // _top_ left of the page (not the obvious bottom left,\n                    // since aligning the bottom of the intended page with the\n                    // top of the window is rarely helpful).\n                    x = x !== null ? x : 0;\n                    y = y !== null ? y : pageHeight;\n                    break;\n                // case \"Fit\":\n                // case \"FitB\":\n                //     scale = \"page-fit\";\n                //     break;\n                // case \"FitH\":\n                // case \"FitBH\":\n                //     y = destArray[2];\n                //     scale = \"page-width\";\n                //     // According to the PDF spec, section 12.3.2.2, a `null` value in the\n                //     // parameter should maintain the position relative to the new page.\n                //     if (y === null && this._location) {\n                //         x = this._location.left;\n                //         y = this._location.top;\n                //     } else if (typeof y !== \"number\" || y < 0) {\n                //         // The \"top\" value isn't optional, according to the spec, however some\n                //         // bad PDF generators will pretend that it is (fixes bug 1663390).\n                //         y = pageHeight;\n                //     }\n                //     break;\n                // case \"FitV\":\n                // case \"FitBV\":\n                //     x = destArray[2];\n                //     width = pageWidth;\n                //     height = pageHeight;\n                //     scale = \"page-height\";\n                //     break;\n                // case \"FitR\":\n                //     x = destArray[2];\n                //     y = destArray[3];\n                //     width = destArray[4] - x;\n                //     height = destArray[5] - y;\n                //     let hPadding = SCROLLBAR_PADDING,\n                //         vPadding = VERTICAL_PADDING;\n                //     if (\n                //         (typeof PDFJSDev === \"undefined\" || PDFJSDev.test(\"GENERIC\")) &&\n                //         this.removePageBorders\n                //     ) {\n                //         hPadding = vPadding = 0;\n                //     }\n                //     widthScale =\n                //         (this.container.clientWidth - hPadding) /\n                //         width /\n                //         PixelsPerInch.PDF_TO_CSS_UNITS;\n                //     heightScale =\n                //         (this.container.clientHeight - vPadding) /\n                //         height /\n                //         PixelsPerInch.PDF_TO_CSS_UNITS;\n                //     scale = Math.min(Math.abs(widthScale), Math.abs(heightScale));\n                //     break;\n                default:\n                    // console.error(\n                    //     `scrollPageIntoView: \"${destArray[1].name}\" is not a valid destination type.`\n                    // );\n                    return;\n            }\n            if (!ignoreDestinationZoom) {\n                // if (scale && scale !== this.options.zoomLevel) {\n                // }\n                // if (scale && scale !== this._currentScale) {\n                // this.currentScaleValue = scale;\n                // } else if (this._currentScale === UNKNOWN_SCALE) {\n                // this.currentScaleValue = DEFAULT_SCALE_VALUE;\n                // }\n            }\n            // if (scale === \"page-fit\" && !destArray[4]) {\n            //     this.#scrollIntoView(pageView);\n            //     return;\n            // }\n            const boundingRect = [\n                pageView.viewport.convertToViewportPoint(x, y),\n                pageView.viewport.convertToViewportPoint(x + width, y + height),\n            ];\n            let left = Math.min(boundingRect[0][0], boundingRect[1][0]);\n            let top = Math.min(boundingRect[0][1], boundingRect[1][1]);\n            if (!allowNegativeOffset) {\n                // Some bad PDF generators will create destinations with e.g. top values\n                // that exceeds the page height. Ensure that offsets are not negative,\n                // to prevent a previous page from becoming visible (fixes bug 874482).\n                left = Math.max(left, 0);\n                top = Math.max(top, 0);\n            }\n            // left *= scale || this.state.zoomLevel;\n            // top *= scale || this.state.zoomLevel;\n            kendo_dateinputsCommon_cmn_chunk_js.a(this, _PdfViewer_instances, \"m\", _PdfViewer_scrollIntoView).call(this, pageView, /* pageSpot = */ { left, top });\n        }\n        /**\n         * @returns {boolean} Whether the pageNumber is valid (within bounds).\n         * @private\n         */\n        _setCurrentPageNumber(val, resetCurrentPageView = false) {\n            if (this._currentPageNumber === val) {\n                if (resetCurrentPageView) {\n                    // this.#resetCurrentPageView();\n                }\n                return true;\n            }\n            // if (!(0 < val && val <= this.pagesCount)) {\n            if (!(0 < val && val <= this.state.pdfDocument.numPages)) {\n                return false;\n            }\n            const previous = this._currentPageNumber;\n            this._currentPageNumber = val;\n            this.eventBus.dispatch(\"pagechanging\", {\n                source: this,\n                pageNumber: val,\n                // pageLabel: this._pageLabels?.[val - 1] ?? null,\n                previous,\n            });\n            // if (resetCurrentPageView) {\n            //     this.#resetCurrentPageView();\n            // }\n            return true;\n        }\n    }\n    _PdfViewer_annotationEditorMode = new WeakMap(), _PdfViewer_switchAnnotationEditorModeTimeoutId = new WeakMap(), _PdfViewer_eventAbortController = new WeakMap(), _PdfViewer_onPageRenderedCallback = new WeakMap(), _PdfViewer_instances = new WeakSet(), _PdfViewer_switchToEditAnnotationMode = function _PdfViewer_switchToEditAnnotationMode() {\n        // const visible = this._getVisiblePages();\n        // const visible = this._getVisiblePages();\n        const pagesToRefresh = [];\n        // const { ids, views } = visible;\n        // for (const page of views) {\n        const ids = new Set();\n        this.pages.forEach(x => {\n            ids.add(x.id);\n        });\n        for (const page of this.pages) {\n            // const { view } = page;\n            const view = page;\n            if (!view.hasEditableAnnotations()) {\n                ids.delete(view.id);\n                continue;\n            }\n            pagesToRefresh.push(page);\n        }\n        if (pagesToRefresh.length === 0) {\n            return null;\n        }\n        // this.renderingQueue.renderHighestPriority({\n        //     first: pagesToRefresh[0],\n        //     last: pagesToRefresh.at(-1),\n        //     views: pagesToRefresh,\n        //     ids,\n        // });\n        // todo: render pages instead of using renderingQueue\n        // as this will require porting more code\n        this.drawPagesAsync(this.state.pdfPages);\n        return ids;\n    }, _PdfViewer_scrollIntoView = function _PdfViewer_scrollIntoView(pageView, pageSpot = null) {\n        const { div, id } = pageView;\n        // Ensure that `this._currentPageNumber` is correct, when `#scrollIntoView`\n        // is called directly (and not from `#resetCurrentPageView`).\n        if (this._currentPageNumber !== id) {\n            this._setCurrentPageNumber(id);\n        }\n        // if (this._scrollMode === ScrollMode.PAGE) {\n        //     this.#ensurePageViewVisible();\n        //     // Ensure that rendering always occurs, to avoid showing a blank page,\n        //     // even if the current position doesn't change when the page is scrolled.\n        //     this.update();\n        // }\n        if (!pageSpot && !this.isInPresentationMode) {\n            const left = div.offsetLeft + div.clientLeft, right = left + div.clientWidth;\n            // const { scrollLeft, clientWidth } = this.container;\n            const { scrollLeft, clientWidth } = this.element;\n            if (this._scrollMode === ScrollMode.HORIZONTAL ||\n                left < scrollLeft ||\n                right > scrollLeft + clientWidth) {\n                pageSpot = { left: 0, top: 0 };\n            }\n        }\n        scrollIntoView(div, pageSpot);\n        // // Ensure that the correct *initial* document position is set, when any\n        // // OpenParameters are used, for documents with non-default Scroll/Spread\n        // // modes (fixes issue 15695). This is necessary since the scroll-handler\n        // // invokes the `update`-method asynchronously, and `this._location` could\n        // // thus be wrong when the initial zooming occurs in the default viewer.\n        // if (!this._currentScaleValue && this._location) {\n        //     this._location = null;\n        // }\n    };\n\n    exports.D = DEFAULT_ZOOM_LEVEL$2;\n    exports.S = SearchService;\n    exports.__meta__ = __meta__;\n    exports.a = goToPreviousSearchMatch;\n    exports.b = calculateZoomLevel;\n    exports.c = currentPage;\n    exports.d = download;\n    exports.e = Scroller;\n    exports.f = renderPage;\n    exports.g = goToNextSearchMatch;\n    exports.l = loadPDF;\n    exports.p = print;\n    exports.r = reloadDocument;\n    exports.s = scrollToPage;\n\n}));\n"]}