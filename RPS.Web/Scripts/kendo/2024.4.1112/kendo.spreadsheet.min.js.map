{"version":3,"file":"kendo.spreadsheet.min.js","names":["global","factory","exports","module","require","define","amd","globalThis","self","kendo","_globals","Spreadsheet","this","clone","hash","target","Object","assign","keys","reduce","copy","key","$","jQuery","ObservableObject","data","MESSAGES","spreadsheet","messages","dialogs","apply","save","cancel","remove","retry","revert","okText","formatCellsDialog","title","categories","number","currency","date","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","buttons","justifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","mergeDialog","mergeCells","mergeHorizontally","mergeVertically","unmerge","freezeDialog","freezePanes","freezeRows","freezeColumns","unfreeze","confirmationDialog","text","validationDialog","hintMessage","hintTitle","criteria","any","custom","list","comparers","greaterThan","lessThan","between","notBetween","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","comparerMessages","labels","comparer","min","max","value","start","end","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","pdf","area","workbook","sheet","selection","paper","a2","a3","a4","a5","b3","b4","b5","folio","legal","letter","tabloid","executive","margin","normal","narrow","wide","scale","fit","fileName","saveAsType","exportArea","paperSize","margins","orientation","print","guidelines","center","horizontally","vertically","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","sheetRenameDialog","rename","insertCommentDialog","comment","removeComment","insertImageDialog","info","typeError","registry","register","name","dialogClass","registered","create","options","SpreadsheetDialog","Observable","extend","init","fn","call","translate","bind","events","autoFocus","dialog","_dialog","scrollable","resizable","modal","visible","width","open","close","_onDialogClose","activate","_onDialogActivate","deactivate","_onDialogDeactivate","addClass","className","append","template","ns","errors","kendoWindow","trigger","action","_action","destroy","element","find","formattedValue","format","formatting","FormatCellsViewModel","useCategory","category","type","formatCurrency","set","currencies","length","allFormats","useFirstFormat","formats","undefined","_currency","decimals","iso","map","convert","categoryFilter","preview","get","uniqueBy","field","array","result","values","i","inArray","push","token","n","pattern","replace","Array","join","abbr","JSON","stringify","symbol","test","toLowerCase","FormatCellsDialog","defaultOptions","_generateFormats","$kendoOutput","htmlEncode","currenciesFrom","cultures","numberFormats","dateFormats","calendarPatterns","current","calendars","standard","patterns","range","slice","viewModel","Date","formatItemTemplate","currencyFilter","setOptions","filter","roleSelector","parent","attr","command","property","culture","numberFormat","MessageDialog","messageId","getter","ConfirmationDialog","confirm","isConfirmed","_confirmed","ValidationErrorDialog","_retry","FontFamilyDialog","_list","ul","fonts","defaultFont","default","ui","StaticList","dataSource","DataSource","change","fetch","e","sender","FontSizeDialog","sizes","defaultSize","parseInt","BordersDialog","_borderPalette","observable","state","borderPalette","color","border","style","size","first","BorderPalette","_state","ColorChooser","_value","ColorPickerDialog","_colorPalette","colorPalette","kendoColorPalette","palette","CustomColorDialog","animation","one","_colorPicker","colorPicker","kendoFlatColorPicker","AlignmentDialog","iconClass","icon","dataItem","MergeDialog","FreezeDialog","ValidationViewModel","ValidationCellsViewModel","reset","criterion","setHintMessageTemplate","_mute","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","from","to","setComparers","defaultHintTitle","all","defaultComparers","text_comparers","idx","shift","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","update","validation","fromValidationObject","dataType","comparerType","allowNulls","showButton","messageTemplate","titleTemplate","useCustomMessages","toValidationObject","ValidationDialog","errorTemplate","message","validatable","Validator","validateOnBlur","validate","ExportAsDialog","extension","fileFormats","excel","excelExport","proxyURL","pdfExport","forceProxy","author","autoPrint","subject","keywords","creator","fitWidth","areas","paperSizes","landscape","hCenter","vCenter","TEXT","bottom","left","right","top","basicErrorDialog","id","msg","ImportErrorDialog","err","context","error","UseKeyboardDialog","HyperlinkDialog","arguments","model","link","on","ev","keyCode","val","stopPropagation","preventDefault","SheetRenameDialog","args","sheetName","_oldSheetName","_newSheetName","InsertCommentDialog","InsertImageDialog","okEnabled","imageUrl","hasImage","isHovered","_url","_image","window","URL","revokeObjectURL","blob","_width","height","_height","stopEvent","drop","selectFile","originalEvent","dataTransfer","files","dragEnter","dragLeave","image","createObjectURL","img","Image","src","onload","Localizable","path","def","split","thing","trans","isArray","ret","prototype","BORDER_TYPES","BORDER_TYPES_ICONS","allBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","outsideBorders","leftBorder","topBorder","rightBorder","bottomBorder","noBorders","BORDER_PALETTE_MESSAGES","colorPickerPalette","Widget","_borderTypePalette","_borderColorPalette","colorChooser","that","class","appendTo","kendoToggleButton","toHyphens","toggle","_toggle","FlatColorPicker","view","input","_change","wrapper","_apply","_cancel","previous","siblings","checked","getDefaultToolElement","firstIconName","ToolBar","toolbar","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","alignment","alignmentButtons","backgroundColor","increaseFontSize","decreaseFontSize","bold","borders","cut","deleteColumn","deleteRow","fontFamily","fontSize","formatTypes","automatic","percent","financial","time","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","insertComment","insertImage","italic","merge","mergeButtons","paste","redo","undo","exportAs","toggleGridlines","sort","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","underline","hyperlink","defaultFormats","COLOR_PICKER_MESSAGES","customColor","toolDefaults","separator","extensions","overflow","togglable","component","overflowComponent","componentOptions","fillMode","items","attributes","commandOn","toolIcon","clearButton","sample","itemTemplate","enable","popupComponent","formatCells","selected","SpreadsheetToolBar","forEach","t","showText","tools","toolbarName","parentMessages","defaultTools","handleClick","_click","click","commandType","file","home","insert","refresh","activeCell","_tools","tool","isFunction","showGridLines","_updateTool","resize","toArray","_getItem","vertical","menu","enabled","label","toolbarEl","widget","widgetInstance","menuItem","_ref","verticalAlign","textAlign","removeClass","is","trim","cssProperties","propertyDictionary","Menu","CACHE_CHAR_WIDTH","charWidthFunction","func","span","div","document","createElement","position","whiteSpace","appendChild","createTextNode","String","fromCharCode","body","widths","firstChild","nextSibling","offsetWidth","removeChild","ch","code","charCodeAt","drawTabularData","progress","Deferred","promise","guideColor","columns","headerBackground","headerColor","oddBackground","evenBackground","rowHeight","maxEmpty","useGridFormat","drawing","defineFont","drawDOM","getFontFaces","charWidth","textWidth","charAt","mkCell","borderLeft","borderTop","borderRight","borderBottom","reject","col","columnTitles","columnWidths","rows","row","rowIndex","cells","colIndex","Math","background","unshift","Sheet","fromJSON","w","index","draw","headerRows","resolve","registerEditor","calendar","popup","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","callback","dateToNumber","anchor","querySelector","origin","alignLeft","numberToDate","Calendar","fromValidation","toValidation","formula","calc","runtime","Formula","_rowAndColPresent","disableDates","validationComparers","edit","kendoStaticList","selectable","autoBind","getKendoStaticList","item","add","el","Matrix","each","setDataSource","read","outerWidth","_outerWidth","DOT","EMPTYCHAR","SheetsBar","classNames","sheetsBarWrapper","_openDialog","openDialog","_addButton","_menuButton","_tree","dom","Tree","render","_createSheetsWrapper","_initSheetDropDownButtons","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetContextMenu","_onSheetSelect","sheetsBarKItem","_createEditor","distance","_editor","_renderSheets","_sheets","_selectedIndex","sheetsBarEditor","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","newSheetName","off","_onSheetRename","renderSheets","sheets","selectedIndex","isInEditMode","_isRtl","support","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","sheetsBarScrollable","sheetsBarSheetsWrapper","_toggleScrollButtons","_sheetsGroup","scrollLeft","prev","sheetsBarPrev","next","sheetsBarNext","toggleClass","scrollWidth","scrollPrevButton","scrollNextButton","sheetsWrapper","event","_nowScrollingSheets","_scrollSheetsByDelta","renderScrollButtons","sheetElements","isSelectedSheet","role","elementContent","sheetsBarKActive","sheetsBarKTextbox","maxlength","sheetsBarKLink","sheetsBarKLinkText","contextMenuButton","html","renderButton","sheetsBarMoreIcon","ind","btnEl","allSheets","visibleSheets","isSingleVisibleSheet","shouldAllowMoveRight","shouldAllowMoveLeft","kendoDropDownButton","itemsWrapper","childrenElements","sheetsBarKReset","baseButtonClass","sheetsBarKButton","sheetsBarKButtonBare","ariaHidden","tabIndex","sheetsBarArrowWIcon","sheetsBarArrowEIcon","children","sheetsBarItems","Sortable","container","axis","ignore","draggable","hint","wrap","sheetsBarHintWrapper","sheetsBarKResetItems","closest","which","oldIndex","newIndex","_onSheetRemove","_onSheetDuplicate","_renamePrompt","_hideSheet","_moveSheet","renameSheetIndex","findIndex","sh","closeCallback","dlg","sheetIndex","direction","newSheetIndex","removedSheetName","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","_onAddSelect","_onMenuSelect","addButton","sheetsBarAdd","kendoButton","sheetsBarPlusIcon","menuButton","sheetsBarSheetsMenu","sheetsBarMenuIcon","cssClass","isNaN","itemPosition","sheetsGroup","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","finish","animate","delta","scrLeft","sheetsBarRemove","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButtonDefaults","sheetsBarXIcon","sheetsBarKSprite","details","button","detailsSummary","detailsContent","iconCollapseName","iconExpandName","iconSearchName","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","filterMenu","sortAscending","sortDescending","search","addToCurrent","clear","blanks","operatorNone","and","or","operators","string","contains","doesnotcontain","startswith","endswith","matches","doesnotmatch","eq","neq","lt","gt","gte","lte","Details","FilterMenu","_summary","iconName","expanded","_icon","prependTo","_container","hide","show","fx","expand","stop","binders","spreadsheetFilterValue","Binder","bindings","templates","guid","dir","query","hasVisibleChildren","HierarchicalDataSource","toString","toLocaleLowerCase","itemVisible","indexOf","anyVisibleChildren","filterSpread","hidden","operator","uncheckAll","hasChildren","FilterMenuViewModel","valuesChange","valuesDataSource","toJSON","appendToSearch","valueFilter","concat","lastIndexOf","valueSelect","node","hasActiveSearch","filterValues","logic","operatorChange","isNone","isString","flattenOperators","hasOwnProperty","unique","FilterMenuController","valuesTree","column","columnRange","forEachCell","cell","isHiddenRow","distinctValues","a","b","filterType","filterForColumn","topValue","filters","allFilters","columnFilters","active","checkboxesConfig","checkChildren","_filterInit","_popup","_sort","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","openFor","hasClass","pageX","pageY","_active","customFilter","operatingRange","activeFilter","copyAnchorStyles","kendoMenu","select","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","accentFoldingFiltering","activeContainer","defaultSheetName","nameBox","formulaInput","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","menus","delete","unhide","bringToFront","sendToBack","PDFMixin","override_drawPDF","group","activeSheet","overrideSaveAsPDF","saveAsPDF","_drawPDF","then","root","pdfResultPromise","exportPDF","exportPDFToBlob","convertPromiseToDeferred","done","dataURI","saveAs","proxyTarget","fail","Workbook","undefined$1","browser","msie","version","K_ACTIVE","NS","commonEngine","FormulaInput","toActionSelector","selectors","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","viewClassNames","View","ContextMenu","FormulaInputStaticList","d","itemClick","handler","FormulaInputRefArgs","constructor","NameBoxRefArgs","nameEditor","combo","initializeComboBox","transport","readData","success","cache","kendoComboBox","dataTextField","dataValueField","ignoreCase","onChange","noDataTemplate","onKeyDown","onDelete","editor","_renderInnerContent","SPREADSHEET_CONTENT_HTML_TEMPLATE","_createFormulaInputs","spreadsheetRef","_initSpreadsheetWidget","_bindWorkbookEvents","_onUpdateTools","_resizeHandler","_showWatermarkOverlay","widgetOptions","sheetsbar","formulaBarInputRef","_formulaBarInputRefList","_formulaBarInputRefPopup","formulaCellInputRef","_formulaCellInputRefList","_formulaCellInputRefPopup","nameBoxRef","createFilterMenu","createTabStrip","_initHeader","focus","createSheetEditor","sheetsBar","createSheetBar","openDialogCallback","_sheetsBar","createContextMenus","_dialogs","_initContextMenus","createSheetDataSource","getWorkbookCommand","commandName","commandOptions","getIconHTMLString","reason","sheetSelection","ref","dialogOptions","opts","commandArgs","saveAsExcel","ooxml","exportOptions","executeCommand","pop","contextmenu","objectRef","targetType","showUnhide","showUnmerge","isComposite","topLeft","bottomRight","cellContextMenu","colHeaderContextMenu","rowHeaderContextMenu","drawingContextMenu","setTimeout","locale","intl","kendoCultureToIntl","SpreadsheetWidget","formulaBarInputRefElement","formulaBarInputRefListId","listWrapper","insertAfter","aria","itemRole","Popup","formulaCellInputRefElement","formulaCellInputRefListId","cellEditor","contextMenuConfig","showOn","CELL_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","DRAWING_CONTEXT_MENU","onContextMenuSelect","_controller","navigator","_sheet","_activeDrawing","overElement","_getCopyRegex","newName","replaceAll","RegExp","sheetsbarOptions","onAddSelect","onSheetSelect","onSheetReorderEnd","onSheetRename","sheetToCopy","sheetByName","copies","regex","insertSheet","onSheetRemove","sheetToHide","x","visibleSheetIndex","nextVisibleSheet","_sheetsSearchCache","_createToolBar","toolbarId","empty","activeTabIndex","activeToolbar","_activeToolBar","undoRedoStack","content","toolbarOptions","defaultTab","_resize","layout","_workbookChanging","_workbookChange","_autoRefresh","recalc","Range","_workbookCut","_workbookCopy","_workbookPaste","moveSheetToIndex","removeSheet","sheetByIndex","renameSheet","autoRefresh","json","saveJSON","fromFile","_workbook","_workbookExcelExport","_workbookExcelImport","_initProgress","deferred","loading","pb","kendoProgressBar","chunkCount","finally","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","columnWidth","headerHeight","headerWidth","defaultCellStyle","useCultureDecimals","defineName","undefineName","nameValue","forEachName","addImage","cleanupImages","plugin","kendo$1","__meta__","depends","defineProperty"],"sources":["kendo.spreadsheet.js"],"mappings":"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","ignoreList":[],"sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('kendo.excel.js'), require('kendo.progressbar.js'), require('kendo.pdf.js'), require('kendo.toolbar.js'), require('kendo.list.js'), require('kendo.spreadsheet.common.js'), require('kendo.core.js'), require('kendo.binder.js'), require('kendo.validator.js'), require('kendo.icons.js'), require('kendo.window.js'), require('kendo.colorpicker.js'), require('kendo.combobox.js'), require('kendo.dropdownlist.js'), require('kendo.dropdownbutton.js'), require('kendo.popup.js'), require('kendo.togglebutton.js'), require('kendo.calendar.js'), require('kendo.listview.js'), require('kendo.dom.js'), require('kendo.sortable.js'), require('kendo.treeview.js'), require('kendo.numerictextbox.js'), require('kendo.datepicker.js'), require('kendo.datetimepicker.js'), require('kendo.ooxml.js')) :\n    typeof define === 'function' && define.amd ? define(['exports', 'kendo.excel', 'kendo.progressbar', 'kendo.pdf', 'kendo.toolbar', 'kendo.list', 'kendo.spreadsheet.common', 'kendo.core', 'kendo.binder', 'kendo.validator', 'kendo.icons', 'kendo.window', 'kendo.colorpicker', 'kendo.combobox', 'kendo.dropdownlist', 'kendo.dropdownbutton', 'kendo.popup', 'kendo.togglebutton', 'kendo.calendar', 'kendo.listview', 'kendo.dom', 'kendo.sortable', 'kendo.treeview', 'kendo.numerictextbox', 'kendo.datepicker', 'kendo.datetimepicker', 'kendo.ooxml'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.kendo = global.kendo || {}, global.kendo._globals = global.kendo._globals || {}, global.kendo._globals.Spreadsheet = {})));\n})(this, (function (exports) {\n    (function(kendo) {\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: \"Apply\",\n            save: \"Save\",\n            cancel: \"Cancel\",\n            remove: \"Remove\",\n            retry: \"Retry\",\n            revert: \"Revert\",\n            okText: \"OK\",\n            formatCellsDialog: {\n                title: \"Format\",\n                categories: {\n                    number: \"Number\",\n                    currency: \"Currency\",\n                    date: \"Date\"\n                }\n            },\n            fontFamilyDialog: {\n                title: \"Font\"\n            },\n            fontSizeDialog: {\n                title: \"Font size\"\n            },\n            bordersDialog: {\n                title: \"Borders\"\n            },\n            alignmentDialog: {\n                title: \"Alignment\",\n                buttons: {\n                    justifyLeft: \"Align left\",\n                    justifyCenter: \"Center\",\n                    justifyRight: \"Align right\",\n                    justifyFull: \"Justify\",\n                    alignTop: \"Align top\",\n                    alignMiddle: \"Align middle\",\n                    alignBottom: \"Align bottom\"\n                }\n            },\n            mergeDialog: {\n                title: \"Merge cells\",\n                buttons: {\n                    mergeCells: \"Merge all\",\n                    mergeHorizontally: \"Merge horizontally\",\n                    mergeVertically: \"Merge vertically\",\n                    unmerge: \"Unmerge\"\n                }\n            },\n            freezeDialog: {\n                title: \"Freeze panes\",\n                buttons: {\n                    freezePanes: \"Freeze panes\",\n                    freezeRows: \"Freeze rows\",\n                    freezeColumns: \"Freeze columns\",\n                    unfreeze: \"Unfreeze panes\"\n                }\n            },\n            confirmationDialog: {\n                text: \"Are you sure you want to remove this sheet?\",\n                title: \"Sheet remove\"\n            },\n            validationDialog: {\n                title: \"Data Validation\",\n                hintMessage: \"Please enter a valid {0} value {1}.\",\n                hintTitle: \"Validation {0}\",\n                criteria: {\n                    any: \"Any value\",\n                    number: \"Number\",\n                    text: \"Text\",\n                    date: \"Date\",\n                    custom: \"Custom Formula\",\n                    list: \"List\"\n                },\n                comparers: {\n                    greaterThan: \"greater than\",\n                    lessThan: \"less than\",\n                    between: \"between\",\n                    notBetween: \"not between\",\n                    equalTo: \"equal to\",\n                    notEqualTo: \"not equal to\",\n                    greaterThanOrEqualTo: \"greater than or equal to\",\n                    lessThanOrEqualTo: \"less than or equal to\"\n                },\n                comparerMessages: {\n                    greaterThan: \"greater than {0}\",\n                    lessThan: \"less than {0}\",\n                    between: \"between {0} and {1}\",\n                    notBetween: \"not between {0} and {1}\",\n                    equalTo: \"equal to {0}\",\n                    notEqualTo: \"not equal to {0}\",\n                    greaterThanOrEqualTo: \"greater than or equal to {0}\",\n                    lessThanOrEqualTo: \"less than or equal to {0}\",\n                    custom: \"that satisfies the formula: {0}\"\n                },\n                labels: {\n                    criteria: \"Criteria\",\n                    comparer: \"Comparer\",\n                    min: \"Min\",\n                    max: \"Max\",\n                    value: \"Value\",\n                    start: \"Start\",\n                    end: \"End\",\n                    onInvalidData: \"On invalid data\",\n                    rejectInput: \"Reject input\",\n                    showWarning: \"Show warning\",\n                    showHint: \"Show hint\",\n                    hintTitle: \"Hint title\",\n                    hintMessage: \"Hint message\",\n                    ignoreBlank: \"Ignore blank\",\n                    showListButton: \"Display button to show list\",\n                    showCalendarButton: \"Display button to show calendar\"\n                },\n                placeholders: {\n                    typeTitle: \"Type title\",\n                    typeMessage: \"Type message\"\n                }\n            },\n            exportAsDialog: {\n                title: \"Export...\",\n                defaultFileName: \"Workbook\",\n                xlsx: {\n                    description: \"Excel Workbook (.xlsx)\"\n                },\n                pdf: {\n                    description: \"Portable Document Format (.pdf)\",\n                    area: {\n                        workbook: \"Entire Workbook\",\n                        sheet: \"Active Sheet\",\n                        selection: \"Selection\"\n                    },\n                    paper: {\n                        a2        : \"A2 (420 mm × 594 mm)\",\n                        a3        : \"A3 (297 mm x 420 mm)\",\n                        a4        : \"A4 (210 mm x 297 mm)\",\n                        a5        : \"A5 (148 mm x 210 mm)\",\n                        b3        : \"B3 (353 mm × 500 mm)\",\n                        b4        : \"B4 (250 mm x 353 mm)\",\n                        b5        : \"B5 (176 mm x 250 mm)\",\n                        folio     : 'Folio (8.5\" x 13\")',\n                        legal     : 'Legal (8.5\" x 14\")',\n                        letter    : 'Letter (8.5\" x 11\")',\n                        tabloid   : 'Tabloid (11\" x 17\")',\n                        executive : 'Executive (7.25\" x 10.5\")'\n                    },\n                    margin: {\n                        normal: \"Normal\",\n                        narrow: \"Narrow\",\n                        wide: \"Wide\"\n                    }\n                },\n                labels: {\n                    scale: \"Scale\",\n                    fit: \"Fit to page\",\n                    fileName: \"File name\",\n                    saveAsType: \"Save as type\",\n                    exportArea: \"Export\",\n                    paperSize: \"Paper size\",\n                    margins: \"Margins\",\n                    orientation: \"Orientation\",\n                    print: \"Print\",\n                    guidelines: \"Guidelines\",\n                    center: \"Center\",\n                    horizontally: \"Horizontally\",\n                    vertically: \"Vertically\"\n                }\n            },\n            modifyMergedDialog: {\n                errorMessage: \"Cannot change part of a merged cell.\"\n            },\n            rangeDisabledDialog: {\n                errorMessage: \"Destination range contains disabled cells.\"\n            },\n            intersectsArrayDialog: {\n                errorMessage: \"You cannot alter part of an array\"\n            },\n            incompatibleRangesDialog: {\n                errorMessage: \"Incompatible ranges\"\n            },\n            noFillDirectionDialog: {\n                errorMessage: \"Cannot determine fill direction\"\n            },\n            duplicateSheetNameDialog: {\n                errorMessage: \"Duplicate sheet name\"\n            },\n            overflowDialog: {\n                errorMessage: \"Cannot paste, because the copy area and the paste area are not the same size and shape.\"\n            },\n            useKeyboardDialog: {\n                title: \"Copying and pasting\",\n                errorMessage: \"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:\",\n                labels: {\n                    forCopy: \"for copy\",\n                    forCut: \"for cut\",\n                    forPaste: \"for paste\"\n                }\n            },\n            unsupportedSelectionDialog: {\n                errorMessage: \"That action cannot be performed on multiple selection.\"\n            },\n            linkDialog: {\n                title: \"Hyperlink\",\n                labels: {\n                    text: \"Text\",\n                    url: \"Address\",\n                    removeLink: \"Remove link\"\n                }\n            },\n            sheetRenameDialog: {\n                title: \"Rename Sheet\",\n                labels: {\n                    text: \"Rename Sheet\",\n                    rename: \"Rename\"\n                }\n            },\n            insertCommentDialog: {\n                title: \"Insert comment\",\n                labels: {\n                    comment: \"Comment\",\n                    removeComment: \"Remove comment\"\n                }\n            },\n            insertImageDialog: {\n                title: \"Insert image\",\n                info: \"Drag an image here, or click to select\",\n                typeError: \"Please select a JPEG, PNG or GIF image\"\n            }\n        };\n\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function(name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function(name) {\n                return !!registry[name];\n            },\n            create: function(name, options) {\n                var dialogClass = registry[name];\n\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function(options) {\n                kendo.Observable.fn.init.call(this, options);\n\n                this.options = translate($.extend(true, {}, this.options, options));\n\n                this.bind(this.events, options);\n            },\n            events: [\n                \"close\",\n                \"activate\"\n            ],\n            options: {\n                autoFocus: true\n            },\n            dialog: function() {\n                if (!this._dialog) {\n                    var options = {\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function() {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    };\n                    this._dialog = $(\"<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />\")\n                        .addClass(this.options.className || \"\")\n                        .append(kendo.template(this.options.template)({\n                            messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                            ns: kendo.ns,\n\n                            // this is for ImportErrorDialog.  ugly that\n                            // we need this line here, but I couldn't\n                            // figure out a better way\n                            errors: this.options.errors\n                        }))\n                        .kendoWindow(options)\n                        .data(\"kendoWindow\");\n                }\n\n                return this._dialog;\n            },\n            _onDialogClose: function() {\n                this.trigger(\"close\", {\n                    action: this._action\n                });\n            },\n            _onDialogActivate: function() {\n                this.trigger(\"activate\");\n            },\n            _onDialogDeactivate: function() {\n                this.trigger(\"deactivate\");\n                this.destroy();\n            },\n            destroy: function() {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function() {\n                this.dialog().open();\n                this.dialog().element.find(\".k-button-solid-primary\").trigger(\"focus\");\n            },\n            apply: function() {\n                this.close();\n            },\n            close: function() {\n                this._action = \"close\";\n\n                this.dialog().close();\n            }\n        });\n\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function(options) {\n                ObservableObject.fn.init.call(this, options);\n\n                this.useCategory(this.category);\n            },\n            useCategory: function(category) {\n                var type = category && category.type || \"number\";\n                var formatCurrency = type == \"currency\";\n\n                this.category = category;\n\n                this.set(\"showCurrencyFilter\", formatCurrency && this.currencies.length > 1);\n\n                if (!formatCurrency) {\n                    this.set(\"formats\", this.allFormats[type + \"Formats\"]);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n\n                this.useFirstFormat();\n            },\n            useFirstFormat: function() {\n                if (this.formats.length) {\n                    this.set(\"format\", this.formats[0].value);\n                }\n            },\n            currency: function(currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n\n                    var info = currency.value;\n                    var formats = [\n                        { currency: info, decimals: true },\n                        { currency: info, decimals: true, iso: true },\n                        { currency: info, decimals: false }\n                    ];\n\n                    formats = formats.map(function(format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n\n                        return { value: format, name: formattedValue(1000, format) };\n                    });\n\n                    this.set(\"formats\", formats);\n\n                    this.useFirstFormat();\n                }\n\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function(category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n\n                return this.category;\n            },\n            preview: function() {\n                var format = this.get(\"format\");\n                var value = this.value || 0;\n\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n\n        FormatCellsViewModel.convert = {\n            currency: function(options) {\n                function repeat(token, n) {\n                    return new Array(n+1).join(token);\n                }\n\n                // convert culture info to spreadsheet format\n                var info = options.currency;\n                var format = info.pattern[1];\n\n                if (options.decimals) {\n                    format = format.replace(/n/g, \"n\" + info[\".\"] + repeat(\"0\", info.decimals));\n                }\n\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, \"\");\n                } else {\n                    format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n                }\n\n                format = format.replace(/n/g, \"?\");\n\n                return format;\n            },\n            date: function(format) {\n                if ((/T|Z/).test(format)) {\n                    return \"\";\n                }\n\n                return format.toLowerCase().replace(/tt/g, \"AM/PM\").replace(/'/g, '\"');\n            }\n        };\n\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n\n            return result;\n        }\n\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        { type: \"number\", name: messages.categories.number },\n                        { type: \"currency\", name: messages.categories.currency },\n                        { type: \"date\", name: messages.categories.date }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._generateFormats();\n            },\n            options: {\n                className: \"k-spreadsheet-format-cells\",\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-edit-form-container'><div class='k-root-tabs' data-${kendo.htmlEncode(data.ns)}role='tabstrip' data-${kendo.htmlEncode(data.ns)}text-field='name' data-${kendo.htmlEncode(data.ns)}bind='source: categories, value: categoryFilter' data-${kendo.htmlEncode(data.ns)}animation='false'></div>\n    <div class='k-spreadsheet-preview' data-${kendo.htmlEncode(data.ns)}bind='text: preview'></div><select data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-format-filter' data-${kendo.htmlEncode(data.ns)}text-field='description' data-${kendo.htmlEncode(data.ns)}value-field='value.name' data-${kendo.htmlEncode(data.ns)}bind='visible: showCurrencyFilter, value: currency, source: currencies'></select><ul data-${kendo.htmlEncode(data.ns)}role='staticlist' tabindex='0' id='formats-list' aria-label='formats list' class='k-list k-reset' bind:data-${kendo.htmlEncode(data.ns)}template='formatItemTemplate' data-${kendo.htmlEncode(data.ns)}value-primitive='true' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='source: formats, value: format'></ul>\n    <div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>\n</div>`;\n                    return $kendoOutput;\n                }\n            },\n            _generateFormats: function() {\n                var options = this.options;\n\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        { value: \"#.00%\", name: \"100.00%\" },\n                        { value: \"#%\", name: \"100%\" },\n                        { value: \"#.00\", name: \"1024.00\" },\n                        { value: \"#,###.00\", name: \"1,024.00\" }\n                    ];\n                }\n\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n\n                    options.dateFormats = uniqueBy(\"value\", $.map(calendarPatterns, function(format) {\n                        format = FormatCellsViewModel.convert.date(format);\n\n                        if (!format) {\n                            return;\n                        }\n\n                        return { value: format, name: formattedValue(34567.7678, format) };\n                    }));\n                }\n            },\n            open: function(range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value,\n                    formatItemTemplate: (data) => kendo.htmlEncode(data.name)\n                });\n\n                SpreadsheetDialog.fn.open.call(this);\n\n                element = this.dialog().element;\n\n                kendo.bind(element, this.viewModel);\n\n                var currencyFilter = element.find(\"select.k-format-filter\").data(\"kendoDropDownList\");\n\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: \"contains\" });\n                }\n\n                element.find(kendo.roleSelector(\"staticlist\")).parent().addClass(\"k-list-wrapper\");\n\n                element.find(\".k-tabstrip-item\").attr(\"aria-controls\", \"formats-list\");\n            },\n            apply: function() {\n                var format = this.viewModel.format;\n\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"format\",\n                        value: format\n                    }\n                });\n            }\n        });\n\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy(\"description\", $.map(cultures, function(culture, name) {\n                if (!(/-/).test(name)) {\n                    return;\n                }\n\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format(\n                    \"{0} ({1}, {2})\",\n                    currency.name,\n                    currency.abbr,\n                    currency.symbol\n                );\n\n                return { description: description, value: currency };\n            }));\n        };\n\n        kendo.spreadsheet.dialogs.register(\"formatCells\", FormatCellsDialog);\n\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-message\",\n                title: \"\",\n                messageId: \"\",\n                text: \"\",\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${data.messages.okText}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"message\", MessageDialog);\n\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: \"k-spreadsheet-message\",\n                messageId: \"\",\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: confirm'><span\n            class='k-button-text'>${data.messages.okText}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function() {\n                return this._confirmed;\n            },\n            confirm: function() {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"confirmation\", ConfirmationDialog);\n\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-message\",\n                title: \"\",\n                messageId: \"\",\n                text: \"\",\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div><div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: retry'><span class='k-button-text'>${data.messages.retry}</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function() {\n                this._retry = true;\n                this.close();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"validationError\", ValidationErrorDialog);\n\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this._list();\n            },\n            options: {\n                template: () => \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n                var fonts = this.options.options;\n                var defaultFont = this.options.default;\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: (data) => kendo.htmlEncode(data),\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"fontFamily\",\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"fontFamily\", FontFamilyDialog);\n\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this._list();\n            },\n            options: {\n                template: () => \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n                var sizes = this.options.options;\n                var defaultSize = this.options.default;\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: (data) => kendo.htmlEncode(data),\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"fontSize\",\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"fontSize\", FontSizeDialog);\n\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this.element = this.dialog().element;\n                this._borderPalette();\n\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n            },\n            options: {\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                var state = this.borderPalette.value();\n\n                if (state.color && state.type) {\n                    this.trigger(\"action\", {\n                        command: \"BorderChangeCommand\",\n                        options: {\n                            border: state.type,\n                            style: { size: 1, color: state.color }\n                        }\n                    });\n                }\n            },\n            _borderPalette: function() {\n                var element = this.dialog().element.find(\"div\").first();\n\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                    change: this.value.bind(this)\n                });\n            },\n            value: function(state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"borders\", BordersDialog);\n\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function(options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n            },\n            options: {\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function(e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function(options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function() {\n                var element = this.dialog().element.find(\"div\").first();\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [ //metro palette\n                        \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                        \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                        \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                        \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                        \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                        \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                    ],\n                    change: this.value.bind(this)\n                }).data(\"kendoColorPalette\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"colorPicker\", ColorPickerDialog);\n\n        var CustomColorDialog = ColorChooser.extend({\n            init: function(options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one(\"activate\", this._colorPicker.bind(this));\n            },\n            _colorPicker: function() {\n                var element = this.dialog().element.find(\"div\").first();\n                this.colorPicker = element.kendoFlatColorPicker({\n                    change: this.value.bind(this)\n                }).data(\"kendoFlatColorPicker\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"customColor\", CustomColorDialog);\n\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: messages.buttons.justifyLeft },\n                        { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: messages.buttons.justifyCenter },\n                        { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: messages.buttons.justifyRight },\n                        { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: messages.buttons.justifyFull },\n                        { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: messages.buttons.alignTop },\n                        { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: messages.buttons.alignMiddle },\n                        { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: messages.buttons.alignBottom }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: () => \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: (data) => `<a role='button' title='${data.text}' data-property='${data.property}' data-value='${data.value}'>\n                                ${kendo.ui.icon(data.iconClass)} ${data.text}\n                           </a>`,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"alignment\", AlignmentDialog);\n\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { value: \"cells\",        iconClass: \"cells-merge\",        text: messages.buttons.mergeCells },\n                        { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: messages.buttons.mergeHorizontally },\n                        { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: messages.buttons.mergeVertically },\n                        { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: messages.buttons.unmerge }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: () => \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: (data) => `<a role='button' title='${data.text}' data-value='${data.value}'>` +\n                                `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                              \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"MergeCellCommand\",\n                    options: {\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"merge\", MergeDialog);\n\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { value: \"panes\",    iconClass: \"pane-freeze\",  text: messages.buttons.freezePanes },\n                        { value: \"rows\",     iconClass: \"row-freeze\",    text: messages.buttons.freezeRows },\n                        { value: \"columns\",  iconClass: \"column-freeze\",    text: messages.buttons.freezeColumns },\n                        { value: \"unfreeze\", iconClass: \"table-unmerge\", text: messages.buttons.unfreeze }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: () => \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: (data) => `<a role='button' title='${data.text}' data-value='${data.value}'>` +\n                                `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                              \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"FreezePanesCommand\",\n                    options: {\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"freeze\", FreezeDialog);\n\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function(options) {\n                ObservableObject.fn.init.call(this, options);\n\n                this.bind(\"change\", (function(e) {\n\n                    if (e.field === \"criterion\") {\n                        this.reset();\n\n                        if (this.criterion === \"custom\" || this.criterion === \"list\") {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n\n                    if (e.field === \"comparer\") {\n                        this.setHintMessageTemplate();\n                    }\n\n                    if ((e.field == \"hintMessage\" || e.field == \"hintTitle\") && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n\n                    if ((e.field == \"from\" || e.field == \"to\" || e.field == \"hintMessageTemplate\" || e.field == \"type\") && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }).bind(this));\n\n                this.reset();\n            },\n            buildMessages: function() {\n                this._mute = true;\n                this.set(\"hintTitle\", this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : \"\");\n                this.set(\"hintMessage\", this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : \"\");\n                this._mute = false;\n            },\n            reset: function() {\n                this.setComparers();\n                this.set(\"comparer\", this.comparers[0].type);\n                this.set(\"from\", null);\n                this.set(\"to\", null);\n\n                this.set(\"useCustomMessages\", false);\n\n                this.shouldBuild = true;\n\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            //TODO: refactor\n            setComparers: function() {\n                var all = this.defaultComparers;\n                var comparers = [];\n\n                if (this.criterion === \"text\") {\n                    var text_comparers = [\"equalTo\", \"notEqualTo\"];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n\n                this.set(\"comparers\", comparers);\n            },\n            setHintMessageTemplate: function() {\n               if (this.criterion !== \"custom\" && this.criterion !== \"list\") {\n                   this.set(\"hintMessageTemplate\", kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n               } else {\n                   this.set(\"hintMessageTemplate\", \"\");\n                   this.set(\"hintMessage\", \"\");\n               }\n            },\n            isAny: function() {\n                return this.get(\"criterion\") === \"any\";\n            },\n            isNumber: function() {\n                return this.get(\"criterion\") === \"number\";\n            },\n            showToForNumber: function() {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function() {\n                return this.showTo() && this.isDate();\n            },\n            isText: function() {\n                return this.get(\"criterion\") === \"text\";\n            },\n            isDate: function() {\n                return this.get(\"criterion\") === \"date\";\n            },\n            isList: function() {\n                return this.get(\"criterion\") === \"list\";\n            },\n            isCustom: function() {\n                return this.get(\"criterion\") === \"custom\";\n            },\n            showRemove: function() {\n                return this.get(\"hasValidation\");\n            },\n            showTo: function() {\n                return this.get(\"comparer\") == \"between\" || this.get(\"comparer\") == \"notBetween\";\n            },\n            update: function(validation) {\n                this.set(\"hasValidation\", !!validation);\n\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function(validation) {\n                this.set(\"criterion\", validation.dataType);\n                this.set(\"comparer\", validation.comparerType);\n                this.set(\"from\", validation.from);\n                this.set(\"to\", validation.to);\n                this.set(\"type\", validation.type);\n                this.set(\"ignoreBlank\", validation.allowNulls);\n                this.set(\"showButton\", validation.showButton);\n\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function() {\n                if (this.criterion === \"any\") {\n                    return null;\n                }\n\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n\n                return options;\n            }\n        });\n\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        { type: \"any\", name: messages.criteria.any },\n                        { type: \"number\", name: messages.criteria.number },\n                        { type: \"text\", name: messages.criteria.text },\n                        { type: \"date\", name: messages.criteria.date },\n                        { type: \"custom\", name: messages.criteria.custom },\n                        { type: \"list\", name: messages.criteria.list }\n                    ],\n                    comparers: [\n                        { type: \"greaterThan\", name: messages.comparers.greaterThan },\n                        { type: \"lessThan\",    name: messages.comparers.lessThan },\n                        { type: \"between\",     name: messages.comparers.between },\n                        { type: \"notBetween\",  name: messages.comparers.notBetween },\n                        { type: \"equalTo\",     name: messages.comparers.equalTo },\n                        { type: \"notEqualTo\",  name: messages.comparers.notEqualTo },\n                        { type: \"greaterThanOrEqualTo\", name: messages.comparers.greaterThanOrEqualTo },\n                        { type: \"lessThanOrEqualTo\",    name: messages.comparers.lessThanOrEqualTo }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: \"any\",\n                type: \"reject\",\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: (data) =>\n                    `<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">\n                    ${kendo.ui.icon({ icon: \"exclamation-circle\", iconClass: \"k-tooltip-icon\" })}\n                    <span class=\"k-tooltip-content\">${data.message}</span>\n                    <span class=\"k-callout k-callout-n\"></span>\n                </div>`,\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class=\"k-edit-form-container\">\n                    <div class=\"k-edit-label\"><label for=\"criteria\">${kendo.htmlEncode(data.messages.validationDialog.labels.criteria)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"criteria\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.criteria)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: criterion, source: criteria\"></select></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isNumber\">\n                    <div class=\"k-edit-label\"><label for=\"number-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"number-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"comparer-min\">${kendo.htmlEncode(data.messages.validationDialog.labels.min)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-min\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.min)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.min)}\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isNumber\" required=\"required\" /></span></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: showTo\">\n                    <div class=\"k-edit-label\"><label for=\"comparer-max\">${kendo.htmlEncode(data.messages.validationDialog.labels.max)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-max\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.max)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.max)}\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span></div>\n                    </div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isText\">\n                    <div class=\"k-edit-label\"><label for=\"text-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"text-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"text-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"text-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isText\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isDate\">\n                    <div class=\"k-edit-label\"><label for=\"date-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"date-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"date-comparer-start\">${kendo.htmlEncode(data.messages.validationDialog.labels.start)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-start\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.start)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.start)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isDate\" required=\"required\" /></span></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: showTo\">\n                    <div class=\"k-edit-label\"><label for=\"date-comparer-end\">${kendo.htmlEncode(data.messages.validationDialog.labels.end)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-end\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.end)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.end)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span></div>\n                    </div></div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isCustom\">\n                    <div class=\"k-edit-label\"><label for=\"custom-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"custom-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isCustom\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isList\">\n                    <div class=\"k-edit-label\"><label for=\"list-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"list-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isList\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isList\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: showButton\" /><label for=\"listShowButton\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showListButton)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isDate\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: showButton\" /><label for=\"dateShowButton\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showCalendarButton)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.ignoreBlank)}\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: ignoreBlank\" /><label for=\"ignoreBlank\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.ignoreBlank)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\">\n                    <div class=\"k-hr\"></div>\n                    <div class=\"k-edit-label\"><label>${kendo.htmlEncode(data.messages.validationDialog.labels.onInvalidData)}:</label></div>\n                    <div class=\"k-edit-field\"><input type=\"radio\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.rejectInput)}\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: type\" class=\"k-radio k-radio-md\" /><label for=\"validationTypeReject\" class=\"k-radio-label\">${kendo.htmlEncode(data.messages.validationDialog.labels.rejectInput)}</label> <input type=\"radio\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.showWarning)}\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: type\" class=\"k-radio k-radio-md\" /><label for=\"validationTypeWarning\" class=\"k-radio-label\">${kendo.htmlEncode(data.messages.validationDialog.labels.showWarning)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\" class=\"hint-wrapper\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.showHint)}\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: useCustomMessages\" /><label class=\"k-checkbox-label\" for=\"useCustomMessages\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showHint)}</label></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: useCustomMessages\">\n                    <div class=\"k-edit-label\"><label for=\"hint-title\">${kendo.htmlEncode(data.messages.validationDialog.labels.hintTitle)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-title\" name=\"hint-title\" class=\"k-input-inner\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.hintTitle)}\" placeholder=\"${kendo.htmlEncode(data.messages.validationDialog.placeholders.typeTitle)}\" data-${kendo.htmlEncode(data.ns)}bind=\"value: hintTitle\" /></span></div>\n                    <div class=\"k-edit-label\"><label for=\"hint-message\">${kendo.htmlEncode(data.messages.validationDialog.labels.hintMessage)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-message\" class=\"k-input-inner\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.hintMessage)}\" placeholder=\"${kendo.htmlEncode(data.messages.validationDialog.placeholders.typeMessage)}\" data-${kendo.htmlEncode(data.ns)}bind=\"value: hintMessage\" /></span></div>\n                    </div></div>\n                    <div class=\"k-actions\"><button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-${kendo.htmlEncode(data.ns)}bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.remove)}</span></button><button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\" data-${kendo.htmlEncode(data.ns)}bind=\"click: apply\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.apply)}</span></button><button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-${kendo.htmlEncode(data.ns)}bind=\"click: close\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.cancel)}</span></button></div>\n                    </div>`;\n                    return $kendoOutput;\n                }\n            },\n            open: function(range) {\n                var options = this.options;\n                var element;\n\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n\n                this.viewModel.update(range.validation());\n\n                SpreadsheetDialog.fn.open.call(this);\n\n                element = this.dialog().element;\n\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n\n                kendo.bind(element, this.viewModel);\n\n                this.validatable = new kendo.ui.Validator(element.find(\".k-edit-form-container\"), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function() {\n\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n\n                    this.trigger(\"action\", {\n                        command: \"EditValidationCommand\",\n                        options: {\n                            value: this.viewModel.toValidationObject()\n                        }\n                    });\n                }\n            },\n            remove: function() {\n                this.viewModel.set(\"criterion\", \"any\");\n                this.apply();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"validation\", ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n\n        function PDF_PAPER_SIZE(size) {\n            return {\n                value: size,\n                text: TEXT(\"exportAsDialog.pdf.paper.\" + size)\n            };\n        }\n\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                options = this.options;\n\n                this.viewModel = kendo.observable({\n                    title: options.title,\n                    name: options.name,\n                    extension: options.extension,\n                    fileFormats:options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        autoPrint: options.pdfExport.autoPrint,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n\n                        fitWidth: options.pdf.fitWidth,\n                        area: options.pdf.area,\n                        areas: options.pdf.areas,\n                        paperSize: options.pdf.paperSize,\n                        paperSizes: options.pdf.paperSizes,\n                        margin: options.pdf.margin,\n                        margins: options.pdf.margins,\n                        landscape: options.pdf.landscape,\n                        guidelines: options.pdf.guidelines,\n                        hCenter: options.pdf.hCenter,\n                        vCenter: options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                var dialog = this.dialog();\n                this.viewModel.bind(\"change\", function(e) {\n                    if (e.field === \"extension\") {\n                        this.set(\"showPdfOptions\", this.extension === \".pdf\" ? true : false);\n                        dialog.center();\n                    }\n                });\n\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                title: TEXT(\"exportAsDialog.title\", \"Export...\"),\n                name: TEXT(\"exportAsDialog.defaultFileName\", \"Workbook\"),\n                extension: \".xlsx\",\n                fileFormats: [{\n                    description: TEXT(\"exportAsDialog.xlsx.description\", \"Excel Workbook (.xlsx)\"),\n                    extension: \".xlsx\"\n                }, {\n                    description: TEXT(\"exportAsDialog.pdf.description\", \"Portable Document Format (.pdf)\"),\n                    extension: \".pdf\"\n                }],\n                pdf: {\n                    fitWidth: true,\n                    area: \"workbook\",\n                    areas: [{\n                        area: \"workbook\",\n                        text: TEXT(\"exportAsDialog.pdf.area.workbook\", \"Entire Workbook\")\n                    },{\n                        area: \"sheet\",\n                        text: TEXT(\"exportAsDialog.pdf.area.sheet\", \"Active Sheet\")\n                    },{\n                        area: \"selection\",\n                        text: TEXT(\"exportAsDialog.pdf.area.selection\", \"Selection\")\n                    }],\n                    paperSize: \"a4\",\n                    paperSizes: [\n                        \"a2\", \"a3\", \"a4\", \"a5\", \"b3\", \"b4\", \"b5\", \"folio\", \"legal\", \"letter\", \"tabloid\", \"executive\"\n                    ].map(PDF_PAPER_SIZE),\n                    margin: {bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\"},\n                    margins: [\n                        { value: { bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.normal\", \"Normal\")\n                        },\n                        { value: { bottom: \"0.75in\", left: \"0.25in\", right: \"0.25in\", top: \"0.75in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.narrow\", \"Narrow\")\n                        },\n                        { value: { bottom: \"1in\", left: \"1in\", right: \"1in\", top: \"1in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.wide\", \"Wide\")\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-edit-label'><label id='name-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.fileName)}:</label></div>\n                    <div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input aria-labelledby='name-label' class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: name' /></span></div>\n                    <div >\n                       <div class='k-edit-label'><label id='file-format-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.saveAsType)}:</label></div>\n                       <div class='k-edit-field'><select aria-labelledby='file-format-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='description' data-${kendo.htmlEncode(data.ns)}value-field='extension' data-${kendo.htmlEncode(data.ns)}bind='value: extension, source: fileFormats'></select></div>\n                    </div>\n                    <div class='k-export-config' data-${kendo.htmlEncode(data.ns)}bind='visible: showPdfOptions'>\n                    <hr class='k-hr' />\n                    <div class='k-edit-label'><label id='export-area-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.exportArea)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='export-area-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='area' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.area, source: pdf.areas'></select></div>\n                    <div class='k-edit-label'><label id='paper-size-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.paperSize)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='paper-size-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.paperSize, source: pdf.paperSizes'></select></div>\n                    <div class='k-edit-label'><label id='margins-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.margins)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='margins-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}value-primitive='true'data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.margin, source: pdf.margins'></select></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.orientation)}:</label></div>\n                    <div class='k-edit-field'>\n                       <div class='k-button-group'>\n                          <input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-${kendo.htmlEncode(data.ns)}type='boolean' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.landscape' value='false' />\n                          <label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'>\n                          ${kendo.ui.icon({ icon: \"file\", iconClass: \"k-button-icon\" })}\n                          </label>\n                          <input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-${kendo.htmlEncode(data.ns)}type='boolean' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.landscape' value='true' />\n                          <label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'>\n                          ${kendo.ui.icon({ icon: \"file-horizontal\", iconClass: \"k-button-icon\" })}\n                          </label>\n                       </div>\n                    </div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.print)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.guidelines)}</label></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.scale)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.fit)}</label></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.center)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.horizontally)}</label><input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.vertically)}</label></div>\n                    <div class='k-page-orientation'>\n                       ${kendo.ui.icon($(`<span data-${data.ns}bind='invisible: pdf.landscape'></span>`), { icon: \"file\" })}\n                       ${kendo.ui.icon($(`<span data-${data.ns}bind='visible: pdf.landscape'></span>`), { icon: \"file-horizontal\" })}\n                    </div>\n                    </div>\n                    <div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span class='k-button-text'>${kendo.htmlEncode(data.messages.save)}</span></button><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"SaveAsCommand\",\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register(\"exportAs\", ExportAsDialog);\n\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(\n                id,\n                MessageDialog.extend({\n                    options: { messageId: msg }\n                })\n            );\n        }\n\n        basicErrorDialog(\"modifyMerged\", \"modifyMergedDialog.errorMessage\");\n        basicErrorDialog(\"rangeDisabled\", \"rangeDisabledDialog.errorMessage\");\n        basicErrorDialog(\"intersectsArray\", \"intersectsArrayDialog.errorMessage\");\n        basicErrorDialog(\"overflow\", \"overflowDialog.errorMessage\");\n        basicErrorDialog(\"unsupportedSelection\", \"unsupportedSelectionDialog.errorMessage\");\n        basicErrorDialog(\"incompatibleRanges\", \"incompatibleRangesDialog.errorMessage\");\n        basicErrorDialog(\"noFillDirection\", \"noFillDirectionDialog.errorMessage\");\n        basicErrorDialog(\"duplicateSheetName\", \"duplicateSheetNameDialog.errorMessage\");\n\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: \"Errors in import\",\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'><div class='k--header-message'>We encountered ${data.errors.length} errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div><div class='k--errors'><table><thead><tr><th>Context</th><th>Error message</th></tr></thead>`;\n                    for (let i = 0; i < errors.length; ++i) {\n                        $kendoOutput += ``; let err = errors[i];;\n                        $kendoOutput += `<tr><td>${kendo.htmlEncode(err.context)}</td><td>${kendo.htmlEncode(err.error)}</td></tr>`;\n                    }\n                    $kendoOutput += `</table></div></div><div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"importError\", ImportErrorDialog);\n\n        var UseKeyboardDialog = MessageDialog.extend({\n            options: {\n                title: TEXT(\"useKeyboardDialog.title\", \"Copying and pasting\"),\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `${kendo.htmlEncode(data.messages.useKeyboardDialog.errorMessage)}\n                <div>Ctrl+C ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forCopy)}</div>\n                <div>Ctrl+X ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forCut)}</div>\n                <div>Ctrl+V ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forPaste)}</div>\n                <div class=\"k-actions\"><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n                        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n                            class='k-button-text'>${data.messages.okText}</span></button></div>`;\n                    return $kendoOutput;\n                }\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"useKeyboard\", UseKeyboardDialog);\n\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                title: TEXT(\"linkDialog.title\", \"Hyperlink\"),\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-edit-label'><label id='url-label'>${kendo.htmlEncode(data.messages.linkDialog.labels.url)}:</label></div>\n<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input\n            class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: url'\n            title='${kendo.htmlEncode(data.messages.linkDialog.labels.url)}' aria-labelledby='url-label' /></span></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left'\n        data-${kendo.htmlEncode(data.ns)}bind='click: remove'><span\n            class='k-button-text'>${data.messages.linkDialog.labels.removeLink}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${data.messages.okText}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                    return $kendoOutput;\n                },\n                autoFocus: false\n            },\n            open: function(range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function() {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger(\"action\", {\n                            command: \"HyperlinkCommand\",\n                            options: {\n                                link: model.url\n                            }\n                        });\n                        self.close();\n                    },\n                    remove: function() {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                // it would be nice if we could easily handle that in one\n                // place for all dialogs, but it doesn't seem easily\n                // doable.\n                element.find(\"input\")\n                    .trigger(\"focus\")\n                    .on(\"keydown\", function(ev){\n                        if (ev.keyCode == 13 /*ENTER*/) {\n                            model.url = $(this).val(); // there won't be a \"change\" event and the model wouldn't update :-\\\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.apply();\n                        } else if (ev.keyCode == 27 /*ESC*/) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.cancel();\n                        }\n                    });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"hyperlink\", HyperlinkDialog);\n\n        var SheetRenameDialog = SpreadsheetDialog.extend({\n            options: {\n                title: TEXT(\"sheetRenameDialog.title\", \"Rename Sheet\"),\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-edit-label'><label id='sheet-name-label'>${kendo.htmlEncode(data.messages.sheetRenameDialog.labels.text)}:</label></div>\n<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input\n            class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: sheetName'\n            title='${kendo.htmlEncode(data.messages.sheetRenameDialog.labels.text)}' aria-labelledby='sheet-name-label' /></span></div>\n<div class='k-actions'><button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${data.messages.sheetRenameDialog.labels.rename}</span></button><button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                    return $kendoOutput;\n                },\n                autoFocus: false\n            },\n            open: function(range, args) {\n                let sheet = range.sheet();\n                let self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                let element = self.dialog().element;\n                let model = kendo.observable({\n                    sheetName: args?._oldSheetName || sheet.name(),\n                    apply: function() {\n                        self._newSheetName = model.sheetName;\n                        self.close();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                element.find(\"input\")\n                    .trigger(\"focus\")\n                    .on(\"keydown\", function(ev){\n                        if (ev.keyCode == 13 /*ENTER*/) {\n                            model.sheetName = $(this).val();\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.apply();\n                        } else if (ev.keyCode == 27 /*ESC*/) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.cancel();\n                        }\n                    });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"renameSheet\", SheetRenameDialog);\n\n        var InsertCommentDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-insert-comment\",\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-edit-label'><label id='comment-label'>${kendo.htmlEncode(data.messages.insertCommentDialog.labels.comment)}:</label></div>\n                <div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea\n                    aria-labelledby='comment-label' rows='5' class='k-input-inner'\n                    data-${kendo.htmlEncode(data.ns)}bind='value: comment'></textarea></span></div>\n                <div class='k-actions'> <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: remove'><span\n                    class='k-button-text'>${kendo.htmlEncode(data.messages.insertCommentDialog.labels.removeComment)}</span></button>\n                <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n                    class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button> <button\n                    class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n                    class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                    return $kendoOutput;\n                },\n                title: TEXT(\"insertCommentDialog.title\", \"Insert comment\"),\n                autoFocus: false,\n                width: 450\n            },\n            open: function(range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    comment: range.comment(),\n                    apply: function() {\n                        if (!/\\S/.test(model.comment)) {\n                            model.comment = null;\n                        }\n                        self.trigger(\"action\", {\n                            command: \"InsertCommentCommand\",\n                            options: {\n                                value: model.comment\n                            }\n                        });\n                        self.close();\n                    },\n                    remove: function() {\n                        model.comment = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                element.find(\"textarea\").trigger(\"focus\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"insertComment\", InsertCommentDialog);\n\n        var InsertImageDialog = SpreadsheetDialog.extend({\n            options: {\n                template: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<div class='k-spreadsheet-insert-image-dialog'> <label\n        data-${kendo.htmlEncode(data.ns)}bind='style: { background-image: imageUrl }, css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered }, events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\n        <div data-${kendo.htmlEncode(data.ns)}bind='text: info'></div>\n        <input type='file' data-${kendo.htmlEncode(data.ns)}bind='events: { change: change }'\n            accept='image/png, image/jpeg, image/gif' />\n    </label></div>\n<div class='k-actions'> <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='enabled: okEnabled, click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button> <button\n        class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                    return $kendoOutput;\n                },\n                title: TEXT(\"insertImageDialog.title\", \"Insert image\"),\n                width: \"auto\"\n            },\n            open: function() {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    okEnabled: false,\n                    info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                    imageUrl: \"\",\n                    hasImage: false,\n                    isHovered: false,\n                    _url: null,\n                    _image: null,\n                    apply: function() {\n                        window.URL.revokeObjectURL(model._url);\n                        self.trigger(\"action\", {\n                            command: \"InsertImageCommand\",\n                            options: {\n                                blob   : model._image,\n                                width  : model._width,\n                                height : model._height\n                            }\n                        });\n                        self.close();\n                    },\n                    cancel: self.close.bind(self),\n                    stopEvent: function(ev) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    },\n                    drop: function(ev) {\n                        model.stopEvent(ev);\n                        model.selectFile(ev.originalEvent.dataTransfer.files);\n                        model.set(\"isHovered\", false);\n                    },\n                    dragEnter: function(ev) {\n                        model.stopEvent(ev);\n                        model.set(\"isHovered\", true);\n                    },\n                    dragLeave: function(ev) {\n                        model.stopEvent(ev);\n                        model.set(\"isHovered\", false);\n                    },\n                    change: function(ev) {\n                        model.selectFile(ev.target.files);\n                    },\n                    selectFile: function(files) {\n                        var image;\n                        for (var i = 0; i < files.length; ++i) {\n                            if (/^image\\//i.test(files[i].type)) {\n                                image = files[i];\n                                break;\n                            }\n                        }\n                        if (model._url) {\n                            window.URL.revokeObjectURL(model._url);\n                        }\n                        if (image) {\n                            model._image = image;\n                            model._url = window.URL.createObjectURL(image);\n                            var img = new Image();\n                            img.src = model._url;\n                            img.onload = function() {\n                                model._width = img.width;\n                                model._height = img.height;\n                                model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                                model.set(\"okEnabled\", true);\n                                model.set(\"imageUrl\", \"url('\" + model._url + \"')\");\n                                model.set(\"hasImage\", true);\n                            };\n                        } else {\n                            model._image = null;\n                            model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                            model.set(\"okEnabled\", false);\n                            model.set(\"imageUrl\", \"\");\n                            model.set(\"hasImage\", false);\n                        }\n                    }\n                });\n                kendo.bind(element, model);\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"insertImage\", InsertImageDialog);\n\n        function Localizable(path, def) {\n            this.path = path.split(\".\");\n            this.def = def;\n        }\n\n        Localizable.prototype.trans = function() {\n            var msg = kendo.spreadsheet.messages.dialogs;\n            for (var i = 0; i < this.path.length; ++i) {\n                msg = msg[this.path[i]];\n                if (!msg) {\n                    return this.def;\n                }\n            }\n            return msg;\n        };\n\n        function TEXT(path, def) {\n            return new Localizable(path, def);\n        }\n\n        function translate(thing) {\n            if (thing instanceof Localizable) {\n                return thing.trans();\n            }\n            else if (Array.isArray(thing)) {\n                return thing.map(translate);\n            }\n            else if (thing != null && typeof thing == \"object\") {\n                return Object.keys(thing).reduce(function(ret, key){\n                    ret[key] = translate(thing[key]);\n                    return ret;\n                }, {});\n            }\n            return thing;\n        }\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var BORDER_TYPES = [\n                \"allBorders\",\n                \"insideBorders\",\n                \"insideHorizontalBorders\",\n                \"insideVerticalBorders\",\n                \"outsideBorders\",\n                \"leftBorder\",\n                \"topBorder\",\n                \"rightBorder\",\n                \"bottomBorder\",\n                \"noBorders\"\n            ];\n            var BORDER_TYPES_ICONS = {\n               allBorders: \"bordersAll\",\n               insideBorders: \"bordersInside\",\n               insideHorizontalBorders: \"bordersInsideHorizontal\",\n               insideVerticalBorders: \"bordersInsideVertical\",\n               outsideBorders: \"bordersOutside\",\n               leftBorder: \"borderLeft\",\n               topBorder: \"borderTop\",\n               rightBorder: \"borderRight\",\n               bottomBorder: \"borderBottom\",\n               noBorders: \"bordersNone\"\n            };\n\n            var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n                allBorders: \"All borders\",\n                insideBorders: \"Inside borders\",\n                insideHorizontalBorders: \"Inside horizontal borders\",\n                insideVerticalBorders: \"Inside vertical borders\",\n                outsideBorders: \"Outside borders\",\n                leftBorder: \"Left border\",\n                topBorder: \"Top border\",\n                rightBorder: \"Right border\",\n                bottomBorder: \"Bottom border\",\n                noBorders: \"No border\"\n            };\n\n            var colorPickerPalette = [ //metro palette\n                \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n            ];\n\n            var BorderPalette = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    kendo.ui.Widget.call(this, element, options);\n\n                    this.element = element;\n                    this.color = \"#000\";\n\n                    this.element.addClass(\"k-spreadsheet-popup\");\n\n                    this._borderTypePalette();\n                    this._borderColorPalette();\n                },\n\n                options: {\n                    name: \"BorderPalette\"\n                },\n\n                events: [\n                    \"change\"\n                ],\n\n                destroy: function() {\n                    this.colorChooser.destroy();\n                    kendo.destroy(this.element.find(\".k-spreadsheet-border-type-palette\"));\n                },\n\n                value: function() {\n                    return { type: this.type, color: this.color };\n                },\n\n                _borderTypePalette: function() {\n                    var that = this;\n                    var messages = BORDER_PALETTE_MESSAGES;\n\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-border-type-palette\"\n                    });\n\n                    $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border type</span></span>').appendTo(this.element);\n\n                    element.appendTo(this.element);\n\n                    BORDER_TYPES.map(function(type) {\n                        $('<button title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" data-border-type=\"' + type + '\">')\n                            .appendTo(element)\n                            .kendoToggleButton({\n                                icon: kendo.toHyphens(BORDER_TYPES_ICONS[type]),\n                                toggle: that._toggle.bind(that)\n                            });\n                    });\n                },\n\n                _borderColorPalette: function() {\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-border-color-palette\"\n                    });\n\n                    $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border color</span></span>').appendTo(this.element);\n                    element.appendTo(this.element);\n\n                    this.colorChooser = new kendo.ui.FlatColorPicker(element, {\n                        buttons: !this.options.change,\n                        color: this.color,\n                        view: \"palette\",\n                        palette: colorPickerPalette,\n                        input: false,\n                        change: this._change.bind(this)\n                    });\n\n                    this.colorChooser.wrapper.find(\".k-coloreditor-apply\").on(\"click\", this._apply.bind(this));\n                    this.colorChooser.wrapper.find(\".k-coloreditor-cancel\").on(\"click\", this._cancel.bind(this));\n                },\n\n                _change: function() {\n                    this.color = this.colorChooser.value();\n                },\n\n                _toggle: function(e) {\n                    var type = e.target.data(\"borderType\"),\n                        previous = e.target.siblings(\".k-selected\").data(\"kendoToggleButton\");\n\n                    if (e.checked === true) {\n                        if (previous) {\n                            previous.toggle(false);\n                        }\n\n                        this.type = type;\n                    } else {\n                        this.type = null;\n                    }\n                },\n\n                _apply: function() {\n                    this.trigger(\"change\", { type: this.type, color: this.color });\n                },\n\n                _cancel: function() {\n                    this.trigger(\"change\", { type: null, color: null });\n                }\n            });\n\n            kendo.spreadsheet.BorderPalette = BorderPalette;\n\n        })(window.kendo);\n\n    (function(kendo) {\n        var $ = kendo.jQuery;\n\n        function getDefaultToolElement(firstIconName) {\n            return `<button role=\"button\">${kendo.ui.icon({ icon: firstIconName, iconClass: \"k-button-icon\" })}<span class=\"k-button-text\">${kendo.ui.icon(\"caret-alt-down\")}</span></button>`\n        };\n\n        var ToolBar = kendo.ui.ToolBar;\n\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: \"Add column left\",\n            addColumnRight: \"Add column right\",\n            addRowAbove: \"Add row above\",\n            addRowBelow: \"Add row below\",\n            alignment: \"Alignment\",\n            alignmentButtons: {\n                justifyLeft: \"Align left\",\n                justifyCenter: \"Center\",\n                justifyRight: \"Align right\",\n                justifyFull: \"Justify\",\n                alignTop: \"Align top\",\n                alignMiddle: \"Align middle\",\n                alignBottom: \"Align bottom\"\n            },\n            backgroundColor: \"Background\",\n            increaseFontSize: \"Increase font size\",\n            decreaseFontSize: \"Decrease font size\",\n            bold: \"Bold\",\n            borders: \"Borders\",\n            copy: \"Copy\",\n            cut: \"Cut\",\n            deleteColumn: \"Delete column\",\n            deleteRow: \"Delete row\",\n            filter: \"Filter\",\n            fontFamily: \"Font\",\n            fontSize: \"Font size\",\n            format: \"Custom format...\",\n            formatTypes: {\n                automatic: \"Automatic\",\n                text: \"Text\",\n                number: \"Number\",\n                percent: \"Percent\",\n                financial: \"Financial\",\n                currency: \"Currency\",\n                date: \"Date\",\n                time: \"Time\",\n                dateTime: \"Date time\",\n                duration: \"Duration\",\n                moreFormats: \"More formats...\"\n            },\n            formatDecreaseDecimal: \"Decrease decimal\",\n            formatIncreaseDecimal: \"Increase decimal\",\n            freeze: \"Freeze panes\",\n            freezeButtons: {\n                freezePanes: \"Freeze panes\",\n                freezeRows: \"Freeze rows\",\n                freezeColumns: \"Freeze columns\",\n                unfreeze: \"Unfreeze panes\"\n            },\n            insertComment: \"Insert comment\",\n            insertImage: \"Insert image\",\n            italic: \"Italic\",\n            merge: \"Merge cells\",\n            mergeButtons: {\n                mergeCells: \"Merge all\",\n                mergeHorizontally: \"Merge horizontally\",\n                mergeVertically: \"Merge vertically\",\n                unmerge: \"Unmerge\"\n            },\n            open: \"Open...\",\n            paste: \"Paste\",\n            redo: \"Redo\",\n            undo: \"Undo\",\n            exportAs: \"Export...\",\n            toggleGridlines: \"Toggle gridlines\",\n            sort: \"Sort\",\n            sortButtons: {\n                // sortSheetAsc: \"Sort sheet A to Z\",\n                // sortSheetDesc: \"Sort sheet Z to A\",\n                sortRangeAsc: \"Sort range A to Z\",\n                sortRangeDesc: \"Sort range Z to A\"\n            },\n            textColor: \"Text Color\",\n            textWrap: \"Wrap text\",\n            underline: \"Underline\",\n            validation: \"Data validation...\",\n            hyperlink: \"Link\"\n        };\n\n        var defaultTools = {\n            file: [\n                \"open\",\n                \"exportAs\",\n            ],\n            format: [\n                \"format\",\n                \"formatDecreaseDecimal\",\n                \"formatIncreaseDecimal\"\n            ],\n            home: [\n                [\"undo\", \"redo\"],\n                \"separator\",\n                [\"cut\", \"copy\", \"paste\"],\n                \"separator\",\n                \"fontFamily\", \"fontSize\", \"increaseFontSize\", \"decreaseFontSize\",\n                \"separator\",\n                [\"bold\", \"italic\", \"underline\"],\n                \"separator\",\n                \"textColor\",\n                \"separator\",\n                \"backgroundColor\",\n                \"borders\",\n                \"separator\",\n                \"alignment\",\n                \"textWrap\",\n            ],\n            insert: [\n                \"insertComment\",\n                \"separator\",\n                \"hyperlink\",\n                \"separator\",\n                \"insertImage\",\n                \"separator\",\n                [\"addColumnLeft\", \"addColumnRight\", \"addRowBelow\", \"addRowAbove\"],\n                \"separator\",\n                [\"deleteColumn\", \"deleteRow\"]\n            ],\n            data: [\n                \"sort\",\n                \"separator\",\n                \"filter\",\n                \"separator\",\n                \"validation\"\n            ],\n            view: [\n                \"freeze\",\n                \"merge\",\n                \"toggleGridlines\"\n            ]\n        };\n\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: \"@\",\n            number: \"#,0.00\",\n            percent: \"0.00%\",\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: \"$#,##0.00;[Red]$#,##0.00\",\n            date: \"m/d/yyyy\",\n            time: \"h:mm:ss AM/PM\",\n            dateTime: \"m/d/yyyy h:mm\",\n            duration: \"[h]:mm:ss\"\n        };\n\n        var colorPickerPalette = [ //metro palette\n            \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n            \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n            \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n            \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n            \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n            \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n        ];\n\n        var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n            reset: \"Reset color\",\n            customColor: \"Custom color...\",\n            apply: \"Apply\",\n            cancel: \"Cancel\"\n        };\n\n        var toolDefaults = {\n            undo: {\n               type: \"button\",\n               name: \"undo\",\n               icon: \"undo\",\n               command: \"undo\"\n            },\n            redo: {\n               type: \"button\",\n               name: \"redo\",\n               icon: \"redo\",\n               command: \"redo\"\n            },\n            separator: { type: \"separator\" },\n            //home tab\n            open: {\n                type: \"open\",\n                name: \"open\",\n                icon: \"folder-open\",\n                extensions: \".xlsx\",\n                command: \"OpenCommand\"\n            },\n            exportAs: {\n                type: \"button\",\n                name: \"exportAs\",\n                dialog: \"exportAs\",\n                overflow: \"never\",\n                icon: \"download\"\n            },\n            bold: {\n                type: \"button\",\n                command: \"PropertyChangeCommand\",\n                property: \"bold\",\n                value: true,\n                icon: \"bold\",\n                togglable: true\n            },\n            italic: {\n                type: \"button\",\n                command: \"PropertyChangeCommand\",\n                property: \"italic\",\n                value: true,\n                icon: \"italic\",\n                togglable: true\n            },\n            underline: {\n                type: \"button\",\n                command: \"PropertyChangeCommand\",\n                property: \"underline\",\n                value: true,\n                icon: \"underline\",\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: \"button\",\n                name: \"formatDecreaseDecimal\",\n                command: \"AdjustDecimalsCommand\",\n                value: -1,\n                icon: \"decimal-decrease\"\n            },\n            formatIncreaseDecimal: {\n                type: \"button\",\n                name: \"formatIncreaseDecimal\",\n                command: \"AdjustDecimalsCommand\",\n                value: +1,\n                icon: \"decimal-increase\"\n            },\n            textWrap: {\n                type: \"button\",\n                name: \"textWrap\",\n                command: \"TextWrapCommand\",\n                property: \"wrap\",\n                value: true,\n                icon: \"text-wrap\",\n                togglable: true\n            },\n            cut: {\n                type: \"button\",\n                name: \"cut\",\n                command: \"ToolbarCutCommand\",\n                icon: \"cut\"\n            },\n            copy: {\n                type: \"button\",\n                name: \"copy\",\n                command: \"ToolbarCopyCommand\",\n                icon: \"copy\"\n            },\n            paste: {\n                type: \"button\",\n                name: \"paste\",\n                command: \"ToolbarPasteCommand\",\n                icon: \"clipboard\"\n            },\n            alignment: {\n                type: \"component\",\n                name: \"alignment\",\n                property: \"alignment\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"align-left\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"alignment\",\n                    icon: \"align-left\"\n                },\n                componentOptions: {\n                    fillMode: \"flat\",\n                    items: [\n                        { attributes: { \"data-value\": \"left\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-left\", text: MESSAGES.alignmentButtons.justifyLeft },\n                        { attributes: { \"data-value\": \"center\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-center\", text: MESSAGES.alignmentButtons.justifyCenter },\n                        { attributes: { \"data-value\": \"right\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-right\", text: MESSAGES.alignmentButtons.justifyRight },\n                        { attributes: { \"data-value\": \"justify\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-justify\", text: MESSAGES.alignmentButtons.justifyFull },\n                        { attributes: { class: \"k-separator\" } },\n                        { attributes: { \"data-value\": \"top\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-top\", text: MESSAGES.alignmentButtons.alignTop },\n                        { attributes: { \"data-value\": \"center\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-middle\", text: MESSAGES.alignmentButtons.alignMiddle },\n                        { attributes: { \"data-value\": \"bottom\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-bottom\", text: MESSAGES.alignmentButtons.alignBottom }\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            backgroundColor: {\n                type: \"component\",\n                name: \"backgroundColor\",\n                commandOn: \"change\",\n                command: \"PropertyChangeCommand\",\n                property: \"background\",\n                component: \"ColorPicker\",\n                componentOptions: {\n                    view: \"palette\",\n                    toolIcon: \"droplet\",\n                    fillMode: \"flat\",\n                    palette: colorPickerPalette,\n                    clearButton: true,\n                    messages: COLOR_PICKER_MESSAGES,\n                    input: false,\n                    commandOn: \"change\"\n                },\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"colorPicker\",\n                    icon: \"droplet\",\n                    property: \"background\"\n                }\n            },\n            textColor: {\n                type: \"component\",\n                name: \"textColor\",\n                commandOn: \"change\",\n                command: \"PropertyChangeCommand\",\n                property: \"color\",\n                component: \"ColorPicker\",\n                componentOptions: {\n                    view: \"palette\",\n                    fillMode: \"flat\",\n                    toolIcon: \"foreground-color\",\n                    palette: colorPickerPalette,\n                    clearButton: true,\n                    messages: COLOR_PICKER_MESSAGES,\n                    input: false,\n                    commandOn: \"change\"\n                },\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"colorPicker\",\n                    icon: \"foreground-color\",\n                    property: \"color\"\n                }\n            },\n            fontFamily: {\n                type: \"component\",\n                name: \"fontFamily\",\n                command: \"PropertyChangeCommand\",\n                property: \"fontFamily\",\n                component: \"DropDownList\",\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"fontFamily\",\n                    icon: \"font-family\"\n                },\n                componentOptions: {\n                    dataSource: [\"Arial\", \"Courier New\", \"Georgia\", \"Times New Roman\", \"Trebuchet MS\", \"Verdana\"],\n                    value: \"Arial\",\n                    fillMode: \"flat\",\n                    commandOn: \"change\"\n                }\n            },\n            fontSize: {\n                type: \"component\",\n                name: \"fontSize\",\n                command: \"PropertyChangeCommand\",\n                property: \"fontSize\",\n                component: \"ComboBox\",\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"fontSize\",\n                    icon: \"font-size\"\n                },\n                componentOptions: {\n                    dataSource: [8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72],\n                    value: 12,\n                    fillMode: \"flat\",\n                    commandOn: \"change\"\n                }\n            },\n            increaseFontSize: {\n                type: \"button\",\n                name: \"increaseFontSize\",\n                command: \"IncreaseFontSize\",\n                property: \"fontSize\",\n                icon: \"font-grow\"\n            },\n            decreaseFontSize: {\n                type: \"button\",\n                name: \"decreaseFontSize\",\n                command: \"DecreaseFontSize\",\n                property: \"fontSize\",\n                icon: \"font-shrink\"\n            },\n            format: {\n                type: \"component\",\n                name: \"format\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"custom-format\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"formatCells\",\n                    icon: \"custom-format\"\n                },\n                componentOptions: {\n                    fillMode: \"flat\",\n                    items: [\n                        { attributes: { \"data-value\": defaultFormats.automatic, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.automatic },\n                        { attributes: { \"data-value\": defaultFormats.text, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.text },\n                        { attributes: { \"data-value\": defaultFormats.number, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.number, sample: \"1,499.99\" },\n                        { attributes: { \"data-value\": defaultFormats.percent, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.percent, sample: \"14.50%\" },\n                        { attributes: { \"data-value\": defaultFormats.financial, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.financial, sample: \"(1,000.12)\" },\n                        { attributes: { \"data-value\": defaultFormats.currency, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.currency, sample: \"$1,499.99\" },\n                        { attributes: { \"data-value\": defaultFormats.date, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.date, sample: \"4/21/2012\" },\n                        { attributes: { \"data-value\": defaultFormats.time, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.time, sample: \"5:49:00 PM\" },\n                        { attributes: { \"data-value\": defaultFormats.dateTime, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.dateTime, sample: \"4/21/2012 5:49:00\" },\n                        { attributes: { \"data-value\": defaultFormats.duration, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.duration, sample: \"168:05:00\" },\n                        { attributes: { \"data-value\": \"popup\", \"data-popup\": \"formatCells\" }, text: MESSAGES.formatTypes.moreFormats },\n                    ],\n                    itemTemplate: (data) => {\n                        let $kendoOutput;\n                        $kendoOutput = `<span class=\"k-link k-menu-link\"><span class=\"k-menu-link-text\">`; if (data.sample) { ;\n                        $kendoOutput += `<span class='k-spreadsheet-sample'>${kendo.htmlEncode(data.sample)}</span> `; } ;\n                        $kendoOutput += `${kendo.htmlEncode(data.text)}</span></span>`;\n                        return $kendoOutput;\n                    },\n                    commandOn: \"click\"\n                }\n            },\n            filter: {\n                type: \"button\",\n                name: \"filter\",\n                property: \"hasFilter\",\n                icon: \"filter\",\n                command: \"FilterCommand\",\n                togglable: true,\n                enable: false\n            },\n            merge: {\n                type: \"component\",\n                name: \"merge\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"cells-merge\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"merge\",\n                    icon: \"cells-merge\"\n                },\n                componentOptions: {\n                    fillMode: \"flat\",\n                    items: [\n                        { attributes: { \"data-value\": \"cells\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge\", text: MESSAGES.mergeButtons.mergeCells },\n                        { attributes: { \"data-value\": \"horizontally\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-horizontally\", text: MESSAGES.mergeButtons.mergeHorizontally },\n                        { attributes: { \"data-value\": \"vertically\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-vertically\", text: MESSAGES.mergeButtons.mergeVertically },\n                        { attributes: { \"data-value\": \"unmerge\", \"data-command\": \"MergeCellCommand\" }, icon: \"table-unmerge\", text: MESSAGES.mergeButtons.unmerge }\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            freeze: {\n                type: \"component\",\n                name: \"freeze\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"pane-freeze\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"freeze\",\n                    icon: \"pane-freeze\"\n                },\n                componentOptions: {\n                    fillMode: \"flat\",\n                    items: [\n                        { attributes: { \"data-value\": \"panes\", \"data-command\": \"FreezePanesCommand\" }, icon: \"pane-freeze\", text: MESSAGES.freezeButtons.freezePanes },\n                        { attributes: { \"data-value\": \"rows\", \"data-command\": \"FreezePanesCommand\" }, icon: \"row-freeze\", text: MESSAGES.freezeButtons.freezeRows },\n                        { attributes: { \"data-value\": \"columns\", \"data-command\": \"FreezePanesCommand\" }, icon: \"column-freeze\", text: MESSAGES.freezeButtons.freezeColumns },\n                        { attributes: { \"data-value\": \"unfreeze\", \"data-command\": \"FreezePanesCommand\" }, icon: \"table-unmerge\", text: MESSAGES.freezeButtons.unfreeze }\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            borders: {\n                type: \"popupButton\",\n                name: \"borders\",\n                icon: \"borders-all\",\n                popupComponent: kendo.spreadsheet.BorderPalette,\n                commandOn: \"change\",\n                command: \"BorderChangeCommand\",\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"borders\"\n                }\n            },\n            formatCells: {\n                type: \"button\",\n                dialog: \"formatCells\",\n                overflow: \"never\"\n            },\n            hyperlink: {\n                type: \"button\",\n                name: \"hyperlink\",\n                dialog: \"hyperlink\",\n                icon: \"link\"\n            },\n            toggleGridlines: {\n                type: \"button\",\n                name: \"toggleGridlines\",\n                command: \"GridLinesChangeCommand\",\n                property: \"gridLines\",\n                value: true,\n                icon: \"borders-none\",\n                togglable: true,\n                selected: true\n            },\n            insertComment: {\n                type: \"button\",\n                name: \"insertComment\",\n                dialog: \"insertComment\",\n                property: \"comment\",\n                togglable: true,\n                icon: \"comment\"\n            },\n            insertImage: {\n                type: \"button\",\n                name: \"insertImage\",\n                dialog: \"insertImage\",\n                icon: \"image\",\n            },\n\n            //insert tab\n            addColumnLeft: {\n                type: \"button\",\n                name: \"addColumnLeft\",\n                command: \"AddColumnCommand\",\n                value: \"left\",\n                icon: \"table-column-insert-left\"\n            },\n            addColumnRight: {\n                type: \"button\",\n                name: \"addColumnRight\",\n                command: \"AddColumnCommand\",\n                value: \"right\",\n                icon: \"table-column-insert-right\"\n            },\n            addRowBelow: {\n                type: \"button\",\n                name: \"addRowBelow\",\n                command: \"AddRowCommand\",\n                value: \"below\",\n                icon: \"table-row-insert-below\"\n            },\n            addRowAbove: {\n                type: \"button\",\n                name: \"addRowAbove\",\n                command: \"AddRowCommand\",\n                value: \"above\",\n                icon: \"table-row-insert-above\"\n            },\n            deleteColumn: {\n                type: \"button\",\n                name: \"deleteColumn\",\n                command: \"DeleteColumnCommand\",\n                icon: \"table-column-delete\"\n            },\n            deleteRow: {\n                type: \"button\",\n                name: \"deleteRow\",\n                command: \"DeleteRowCommand\",\n                icon: \"table-row-delete\"\n            },\n\n            //data tab\n            sort: {\n                type: \"component\",\n                name: \"sort\",\n                component: \"DropDownButton\",\n                element: getDefaultToolElement(\"sort-desc\"),\n                overflowComponent: {\n                    type: \"button\",\n                    dialog: \"sort\",\n                    icon: \"sort-desc\"\n                },\n                componentOptions: {\n                    fillMode: \"flat\",\n                    items: [\n                        { attributes: { \"data-value\": \"asc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeAsc, icon: \"sort-asc\" },\n                        { attributes: { \"data-value\": \"desc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeDesc, icon: \"sort-desc\" },\n                    ],\n                    commandOn: \"click\"\n                }\n            },\n            validation: {\n                type: \"button\",\n                name: \"validation\",\n                dialog: \"validation\",\n                icon: \"exclamation-circle\"\n            }\n        };\n\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function(element, options) {\n                Object.keys(toolDefaults).forEach((t) => {\n                    if (t !== \"validation\") {\n                        toolDefaults[t].showText = \"overflow\";\n                    }\n                });\n\n                options.tools = options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName];\n                options.parentMessages = MESSAGES;\n                options.defaultTools = toolDefaults;\n\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n\n                this.element.addClass(\"k-spreadsheet-toolbar k-toolbar-md\");\n\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick,\n                    change: handleClick\n                });\n            },\n            _click: function(e) {\n                var target = e.target,\n                    property = target.data(\"property\"),\n                    value = e.value || target.data(\"value\") || e.target.val(),\n                    commandType = target.data(\"command\"),\n                    dialog = target.data(\"dialog\"),\n                    options = target.data(\"options\") || {};\n\n                if (value === \"popup\") {\n                    // Special case to open custom format dialog from option of the format DDL\n                    dialog = target.data(\"popup\");\n                }\n\n                if (commandType === \"IncreaseFontSize\") {\n                    commandType = \"PropertyChangeCommand\";\n                    value++;\n                }\n\n                if (commandType === \"DecreaseFontSize\") {\n                    commandType = \"PropertyChangeCommand\";\n                    value--;\n                }\n\n                options.property = property || null;\n                options.value = value || null;\n\n                if (dialog) {\n                    this.dialog({\n                        name: dialog,\n                        options: options\n                    });\n                    return;\n                }\n\n                if (!commandType) {\n                    return;\n                }\n\n                var args = {\n                    command: commandType,\n                    options: options\n                };\n\n                if (typeof args.options.value === \"boolean\") {\n                    args.options.value = e.checked ? true : null;\n                }\n\n                this.action(args);\n            },\n            events: [\n                \"action\",\n                \"dialog\"\n            ],\n            options: {\n                name: \"SpreadsheetToolBar\",\n                resizable: true,\n                tools: defaultTools,\n                fillMode: \"flat\"\n            },\n            action: function(args) {\n                this.trigger(\"action\", args);\n            },\n            dialog: function(args) {\n                this.trigger(\"dialog\", args);\n            },\n            refresh: function(activeCell) {\n                var range = activeCell,\n                    tools = this._tools();\n\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property,\n                        tool = tools[i].tool,\n                        value = kendo.isFunction(range[property]) ? range[property]() : range;\n\n                    if (property == \"gridLines\") {\n                        // this isn't really a property of the range, it's per-sheet.\n                        value = range.sheet().showGridLines();\n                    }\n\n                    this._updateTool(tool, value, property, range);\n                }\n\n                this.resize(true);\n            },\n            _tools: function() {\n                return this.element.find(\"[data-property]\").toArray().map(function(element) {\n                    element = $(element);\n                    return {\n                        property: element.attr(\"data-property\"),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            _updateTool: function(tool, value, property, range) {\n                var component = tool.component,\n                    toolbarEl = tool.toolbarEl,\n                    widget = kendo.widgetInstance(toolbarEl.find(\"[data-role]\")),\n                    menuItem = tool.menuItem,\n                    toggle = false,\n                    vertical, text, menu, selection, enabled, label;\n\n                if (property === \"hasFilter\") {\n                    selection = range.sheet().selection();\n\n                    if (selection && selection._ref && selection._ref.height) {\n                        enabled = value || selection._ref.height() > 1;\n\n                        this.enable(toolbarEl, enabled);\n                    }\n                } else if (property === \"alignment\") {\n                    vertical = value.verticalAlign();\n                    text = value.textAlign();\n                    menu = component.menu.element;\n\n                    menu.find(\".k-item .k-link\").removeClass(\"k-selected\");\n                    menu.find(\".k-item[data-property=textAlign][data-value=\" + text + \"] .k-link\").addClass(\"k-selected\");\n                    menu.find(\".k-item[data-property=verticalAlign][data-value=\" + vertical + \"] .k-link\").addClass(\"k-selected\");\n                } else if (property === \"background\" || property === \"color\") {\n                    widget.value(value);\n                } else if (property === \"fontFamily\" || property === \"fontSize\") {\n                    if (toolbarEl.is(\"button\")) {\n                        toolbarEl.attr(\"data-value\", value);\n                        toolbarEl.data(\"value\", value);\n                        return;\n                    }\n                    label = menuItem.find(\".k-menu-link-text\").text().split(\"(\")[0].trim();\n                    menuItem.find(\".k-menu-link-text\").text(label + \" (\" + value + \") ...\");\n                    widget.value(value);\n                }\n\n                if (component && component.toggle) {\n                    if (typeof value === \"boolean\") {\n                        toggle = !!value;\n                    } else if (typeof value === \"string\") {\n                        if (toolbarEl.data(\"value\")) {\n                            toggle = toolbarEl.data(\"value\") === value;\n                        } else {\n                            // if no value is specified in the tool options,\n                            // assume it should be ON if the range value is not null, and OFF otherwise.\n                            toggle = value != null;\n                        }\n                    }\n\n                    this.toggle(toolbarEl, toggle);\n                }\n            }\n        });\n\n        kendo.cssProperties.propertyDictionary[\"SpreadsheetToolBar\"] = kendo.cssProperties.propertyDictionary[\"ToolBar\"];\n\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n\n        kendo.spreadsheet.Menu = kendo.ui.Menu;\n\n    })(window.kendo);\n\n    \"use strict\";\n\n        function clone(hash, target) {\n            if (!target) {\n                target = {};\n            }\n            if (Object.assign) {\n                return Object.assign(target, hash);\n            }\n            return Object.keys(hash).reduce(function(copy, key) {\n                copy[key] = hash[key];\n                return copy;\n            }, target);\n        }\n\n        function drawTabularData(options) {\n            var progress = new $.Deferred();\n            var promise = progress.promise();\n\n            options = clone(options, {\n                dataSource       : null,\n                guidelines       : true,\n                guideColor       : \"#000\",\n                columns          : null,\n                headerBackground : \"#999\",\n                headerColor      : \"#000\",\n                oddBackground    : null,\n                evenBackground   : null,\n                fontFamily       : \"Arial\",\n                fontSize         : 12,\n                paperSize        : \"A4\",\n                margin           : \"1cm\",\n                landscape        : true,\n                fitWidth         : false,\n                scale            : 1,\n                rowHeight        : 20,\n                maxEmpty         : 1,\n                useGridFormat    : true\n            });\n\n            // retrieve fonts; custom fonts should be already loaded\n            kendo.drawing.pdf.defineFont(\n                kendo.drawing.drawDOM.getFontFaces(document)\n            );\n\n            var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n            function textWidth(value) {\n                if (value != null) {\n                    var width = 12;         // magic numbers :-/\n                    for (var i = value.length; --i >= 0;) {\n                        width += charWidth(value.charAt(i));\n                    }\n                    return width;\n                }\n                return 0;\n            }\n\n            var border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n            function mkCell(data) {\n                if (!border) {\n                    return data;\n                }\n                return clone(data, {\n                    borderLeft: border,\n                    borderTop: border,\n                    borderRight: border,\n                    borderBottom: border\n                });\n            }\n\n            options.dataSource.fetch(function(){\n                var data = options.dataSource.data();\n                if (!data.length) {\n                    return progress.reject(\"Empty dataset\");\n                }\n\n                // this really must be present\n                var columns = options.columns.map(function(col){\n                    if (typeof col == \"string\") {\n                        return { title: col, field: col };\n                    } else {\n                        return col;\n                    }\n                });\n                var columnTitles = columns.map(function(col){\n                    return col.title || col.field;\n                });\n                var columnWidths = columnTitles.map(textWidth);\n\n                // prepare data for a Sheet object's fromJSON method\n                var rows = data.map(function(row, rowIndex){\n                    return {\n                        cells: columns.map(function(col, colIndex){\n                            var value = row[col.field];\n\n                            // NOTE: value might not be string.  I added option useGridFormat (default\n                            // true), which will use a column's format, if present, to convert the value\n                            // to a string, so that we can measure the width right now.\n                            if (options.useGridFormat) {\n                                if (value != null) {\n                                    if (col.format) {\n                                        value = kendo.format(col.format, value);\n                                    } else {\n                                        value += \"\";\n                                    }\n                                }\n                                // adjust the column widths while we're at it\n                                columnWidths[colIndex] = Math.max(\n                                    textWidth(value),\n                                    columnWidths[colIndex]\n                                );\n                            }\n\n                            // if options.useGridFormat is false and col.format is present, pass it over\n                            // to the spreadsheet.  In that case we should calculate the widths after\n                            // the spreadsheet is created (XXX to be implemented when someone needs it).\n                            return mkCell({\n                                value: value,\n                                format: options.useGridFormat ? null : col.format,\n                                background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                            });\n                        })\n                    };\n                });\n\n                // insert header line\n                rows.unshift({\n                    cells: columnTitles.map(function(label){\n                        return mkCell({\n                            value: label,\n                            background: options.headerBackground,\n                            color: options.headerColor\n                        });\n                    })\n                });\n\n                // init a Sheet object.  Note that we have to add one\n                // extra-row and column, because the very last ones can't\n                // have right/bottom borders (known limitation).\n                var sheet = new kendo.spreadsheet.Sheet(\n                    rows.length + 1,        // rows\n                    columns.length + 1,     // columns\n                    options.rowHeight,      // row height\n                    50,                     // column width\n                    20,                     // header height\n                    20,                     // header width,\n                    {                       // default cell style\n                        fontFamily: options.fontFamily,\n                        fontSize: options.fontSize,\n                        verticalAlign: \"center\"\n                    }\n                );\n\n                // load data\n                sheet.fromJSON({\n                    name: \"Sheet1\",\n                    rows: rows,\n                    columns: columnWidths.map(function(w, i){\n                        return { index: i, width: w };\n                    })\n                });\n\n                sheet.draw({\n                    paperSize  : options.paperSize,\n                    landscape  : options.landscape,\n                    margin     : options.margin,\n                    guidelines : false, // using borders instead (better contrast)\n                    scale      : options.scale,\n                    fitWidth   : options.fitWidth,\n                    maxEmpty   : options.maxEmpty,\n                    headerRows : 1\n                }, progress.resolve.bind(progress));\n            });\n\n            return promise;\n        }\n\n        var CACHE_CHAR_WIDTH = {};\n\n        var charWidthFunction = function(fontFamily, fontSize) {\n            var id = fontSize + \":\" + fontFamily;\n            var func = CACHE_CHAR_WIDTH[id];\n            if (!func) {\n                var span, div = document.createElement(\"div\");\n                div.style.position = \"fixed\";\n                div.style.left = \"-10000px\";\n                div.style.top = \"-10000px\";\n                div.style.fontFamily = fontFamily;\n                div.style.fontSize = fontSize + \"px\";\n                div.style.whiteSpace = \"pre\";\n                for (var i = 32; i < 128; ++i) {\n                    span = document.createElement(\"span\");\n                    span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                    div.appendChild(span);\n                }\n                document.body.appendChild(div);\n                var widths = {};\n                for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                    widths[i] = span.offsetWidth;\n                }\n                while ((span = div.firstChild)) {\n                    div.removeChild(span);\n                }\n                func = CACHE_CHAR_WIDTH[id] = function(ch) {\n                    var code = ch.charCodeAt(0);\n                    var width = widths[code];\n                    if (width == null) {\n                        // probably not an ASCII character, let's cache its width as well\n                        span = document.createElement(\"span\");\n                        span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                        div.appendChild(span);\n                        width = widths[code] = span.offsetWidth;\n                        div.removeChild(span);\n                    }\n                    return width;\n                };\n            }\n            return func;\n        };\n\n        kendo.spreadsheet.drawTabularData = drawTabularData;\n\n    (function(kendo) {\n\n        \"use strict\";\n\n\n        let registerEditor = kendo.spreadsheet.registerEditor;\n        var $ = kendo.jQuery;\n\n        registerEditor(\"_validation_date\", function(){\n            var context, calendar, popup;\n\n            function create() {\n                if (!calendar) {\n                    calendar = $(\"<div>\").kendoCalendar();\n                    popup = $(\"<div>\").kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n\n                    calendar.bind(\"change\", function(){\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format(\"yyyy-mm-dd\");\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({\n                    anchor: context.view.element.querySelector(\".k-spreadsheet-editor-button\"),\n                    origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                    position: context.alignLeft ? \"top right\" : \"top left\"\n                });\n            }\n\n            function open() {\n                create();\n\n                var date = context.range.value();\n                var sheet = context.range.sheet();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    var fromValidation = val.from;\n                    var toValidation = val.to;\n                    var formula = kendo.spreadsheet.calc.runtime.Formula;\n\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                        }\n                    }\n                    if (val.comparerType == \"between\") {\n                        if(toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.to.value);\n                        }\n                    }\n                    if (val.comparerType == \"lessThan\" || val.comparerType == \"lessThanOrEqualTo\") {\n                        if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.from.value);\n                        }\n                    }\n                    calendar.setOptions({\n                        disableDates: function(date) {\n                            var from, to;\n\n                            if(fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                                from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                            } else {\n                                from = fromValidation ? fromValidation.value|0 : 0;\n                            }\n\n                            if(toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                                to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                            } else {\n                                to = toValidation ? toValidation.value|0 : 0;\n                            }\n\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation\n                                .validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({ disableDates: null, min: null, max: null });\n                }\n                popup.open();\n            }\n\n            function _rowAndColPresent(value) {\n                return (value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1);\n            }\n\n            return {\n                edit: function(options) {\n                    context = options;\n                    open();\n                },\n                icon: \"calendar\"\n            };\n        });\n\n        registerEditor(\"_validation_list\", function(){\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $(\"<ul class='k-list k-reset'/>\").kendoStaticList({\n                        template   : \"#:value#\",\n                        selectable : true,\n                        autoBind   : false\n                    });\n                    popup = $(\"<div class='k-spreadsheet-list-popup'>\").kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n\n                    list.bind(\"change\", function(){\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({\n                    anchor: context.view.element.querySelector(\".k-spreadsheet-editor-button\"),\n                    origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                    position: context.alignLeft ? \"top right\" : \"top left\"\n                });\n            }\n            function open() {\n                create();\n                var items = context.validation.from.value;\n                var data = [], add = function(el){ data.push({ value: el }); };\n                if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    items.each(add);\n                } else {\n                    // actually Excel expects a simple string for list\n                    // validation (comma-separated labels).\n                    (items+\"\").split(/\\s*,\\s*/).forEach(add);\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function(options) {\n                    context = options;\n                    open();\n                },\n                icon: \"caret-alt-down\"\n            };\n        });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var outerWidth = kendo._outerWidth;\n            var DOT = \".\";\n            var EMPTYCHAR = \" \";\n            var sheetsBarClassNames = {\n                sheetsBarWrapper: \"k-spreadsheet-sheets-bar\",\n                sheetsBarSheetsWrapper: \"k-tabstrip k-tabstrip-bottom\",\n                sheetsBarAdd: \"k-spreadsheet-sheet-add\",\n                sheetsBarSheetsMenu: \"k-spreadsheet-sheets-menu\",\n                sheetsBarRemove: \"k-spreadsheet-sheets-remove\",\n                sheetsBarItems: \"k-spreadsheet-sheets\",\n                sheetsBarEditor: \"k-spreadsheet-sheets-editor\",\n                sheetsBarScrollable: \"k-tabstrip-scrollable\",\n                sheetsBarNext: \"k-tabstrip-next\",\n                sheetsBarPrev: \"k-tabstrip-prev\",\n                sheetsBarKItem: \"k-item\",\n                sheetsBarKActive: \"k-active\",\n                sheetsBarKTextbox: \"k-textbox\",\n                sheetsBarKLink: \"k-link\",\n                sheetsBarKLinkText: \"k-link-text\",\n                sheetsBarKIcon: \"k-icon\",\n                sheetsBarKFontIcon: \"k-icon\",\n                sheetsBarKButton: \"k-button k-icon-button\",\n                sheetsBarKButtonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n                sheetsBarKButtonBare: \"k-button-md k-rounded-md k-button-flat k-button-flat-base\",\n                sheetsBarArrowWIcon: \"caret-alt-left\",\n                sheetsBarArrowEIcon: \"caret-alt-right\",\n                sheetsBarKReset: \"k-reset k-tabstrip-items k-tabstrip-items-start\",\n                sheetsBarXIcon: \"x\",\n                sheetsBarMoreIcon: \"caret-alt-down\",\n                sheetsBarKSprite: \"k-sprite\",\n                sheetsBarPlusIcon: \"plus\",\n                sheetsBarMenuIcon: \"menu\",\n                sheetsBarHintWrapper: \"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint\",\n                sheetsBarKResetItems: \"k-reset k-tabstrip-items k-tabstrip-items-start\"\n            };\n\n            var SheetsBar = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    var classNames = SheetsBar.classNames;\n\n                    kendo.ui.Widget.call(this, element, options);\n\n                    element = this.element;\n\n                    element.addClass(classNames.sheetsBarWrapper);\n\n                    this._openDialog = options.openDialog;\n\n                    this._addButton();\n                    this._menuButton();\n                    this._tree = new kendo.dom.Tree(element[0]);\n\n                    this._tree.render([this._createSheetsWrapper([])]);\n                    this._initSheetDropDownButtons();\n\n                    this._toggleScrollEvents(true);\n\n                    this._createSortable();\n\n                    this._sortable.bind(\"start\", this._onSheetReorderStart.bind(this));\n\n                    this._sortable.bind(\"end\", this._onSheetReorderEnd.bind(this));\n\n                    element.on(\"click\", \"[ref-sheetsbar-more-button]\", this._onSheetContextMenu.bind(this));\n\n                    element.on(\"click\", \"li\", this._onSheetSelect.bind(this));\n\n                    element.on(\"dblclick\", \"li\" + DOT + classNames.sheetsBarKItem + DOT + classNames.sheetsBarKItem, this._createEditor.bind(this));\n                },\n\n                options: {\n                    name: \"SheetsBar\",\n                    scrollable: {\n                        distance: 200\n                    }\n                },\n\n                events: [\n                    \"select\",\n                    \"reorder\",\n                    \"rename\"\n                ],\n\n                _createEditor: function() {\n                    if (this._editor) {\n                        return;\n                    }\n\n                    this._renderSheets(this._sheets, this._selectedIndex, true);\n                    this._editor = this.element\n                        .find(kendo.format(\"input{0}{1}\", DOT, SheetsBar.classNames.sheetsBarEditor))\n                        .trigger(\"focus\")\n                        .on(\"keydown\", this._onEditorKeydown.bind(this))\n                        .on(\"blur\", this._onEditorBlur.bind(this));\n                },\n\n                _destroyEditor: function(canceled) {\n                    var newSheetName = canceled ? null : this._editor.val();\n                    this._editor.off();\n                    this._editor = null;\n                    this._renderSheets(this._sheets, this._selectedIndex, false);\n                    this._onSheetRename(newSheetName);\n                },\n\n                renderSheets: function(sheets, selectedIndex) {\n                    if (!sheets || selectedIndex < 0) {\n                        return;\n                    }\n\n                    this._renderSheets(sheets, selectedIndex, false);\n                },\n\n                _renderSheets: function(sheets, selectedIndex, isInEditMode) {\n                    var that = this;\n                    var classNames = SheetsBar.classNames;\n\n                    that._isRtl = kendo.support.isRtl(that.element);\n                    that._sheets = sheets;\n                    that._selectedIndex = selectedIndex;\n\n                    that._renderHtml(isInEditMode, true);\n\n                    if (!that._scrollableAllowed()) {\n                        return;\n                    }\n\n                    var sheetsWrapper = that._sheetsWrapper();\n\n                    sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n\n                    that._toggleScrollButtons();\n                },\n\n                _toggleScrollButtons: function(toggle) {\n                    var that = this;\n                    var ul = that._sheetsGroup();\n                    var wrapper = that._sheetsWrapper();\n                    var scrollLeft = kendo.scrollLeft(ul);\n                    var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                    var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n\n                    if (toggle === false) {\n                        prev.addClass('k-disabled');\n                        next.addClass('k-disabled');\n                    } else {\n                        prev.toggleClass('k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0));\n                        next.toggleClass('k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1));\n                    }\n\n                },\n\n                _toggleScrollEvents: function(toggle) {\n                    var that = this;\n                    var classNames = SheetsBar.classNames;\n                    var options = that.options;\n                    var scrollPrevButton;\n                    var scrollNextButton;\n                    var sheetsWrapper = that._sheetsWrapper();\n                    scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                    scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n\n                    if (toggle) {\n                        scrollPrevButton.on(\"mousedown\", function(event) {\n                            event.preventDefault();\n                            event.stopPropagation();\n                            that._nowScrollingSheets = true;\n                            that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                        });\n\n                        scrollNextButton.on(\"mousedown\", function(event) {\n                            event.preventDefault();\n                            event.stopPropagation();\n                            that._nowScrollingSheets = true;\n                            that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                        });\n\n                        scrollPrevButton.add(scrollNextButton).on(\"mouseup\", function() {\n                            that._nowScrollingSheets = false;\n                        });\n                    } else {\n                        scrollPrevButton.off();\n                        scrollNextButton.off();\n                    }\n                },\n\n                _renderHtml: function(isInEditMode, renderScrollButtons) {\n                    var idx;\n                    var sheetElements = [];\n                    var dom = kendo.dom;\n                    var element = dom.element;\n                    var sheets = this._sheets;\n                    var selectedIndex = this._selectedIndex;\n                    var classNames = SheetsBar.classNames;\n\n                    for (idx = 0; idx < sheets.length; idx++) {\n                        var sheet = sheets[idx];\n\n                        var isSelectedSheet = (idx === selectedIndex);\n                        var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR, role: \"tab\" };\n                        var elementContent = [];\n                        if (sheet.state() !== 'visible') {\n                            attr.className += \"k-hidden \";\n                        }\n\n                        if (isSelectedSheet) {\n                            attr.className += classNames.sheetsBarKActive;\n                        }\n\n                        if (isSelectedSheet && isInEditMode) {\n                            elementContent.push(element(\"input\", {\n                                type: \"text\",\n                                value: sheet.name(),\n                                className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                                maxlength: 50\n                            }, []));\n                        } else {\n                            elementContent.push(element(\"span\", {\n                                className: classNames.sheetsBarKLink,\n                                title: sheet.name()\n                            }, [element(\"span\", { className: classNames.sheetsBarKLinkText }, [dom.text(sheet.name())])]));\n\n                            let contextMenuButton = element($(kendo.html.renderButton($(`<button ref-sheetsbar-more-button data-sheet-name=\"${sheet.name()}\" class=\"k-menu-button\"></button>`), {\n                                icon: classNames.sheetsBarMoreIcon,\n                                fillMode: \"flat\"\n                            }))[0]);\n\n                            elementContent.push(element(\"span\", {\n                                className: \"k-item-actions\",\n                                'data-type': 'context-menu',\n                            }, [contextMenuButton]));\n                        }\n\n                        sheetElements.push(element(\"li\", attr, elementContent));\n                    }\n\n                    kendo.destroy(this._sheetsWrapper());\n                    this._addButton();\n                    this._menuButton();\n                    this._tree.render([ this._createSheetsWrapper(sheetElements, renderScrollButtons)]);\n                    this._initSheetDropDownButtons();\n                },\n                _initSheetDropDownButtons: function() {\n                    let that = this;\n                    this.element.find(\"[ref-sheetsbar-more-button]\").each(function(ind, btnEl){\n                        let el = $(btnEl);\n                        let allSheets = that._sheets || [];\n                        let visibleSheets = allSheets.filter(sheet => sheet.state() === 'visible');\n                        let isSingleVisibleSheet = !that._sheets || that._sheets && visibleSheets.length < 2;\n                        let sheetName = el.data(\"sheetName\");\n                        let shouldAllowMoveRight = !(isSingleVisibleSheet || (that._sheets && ind == allSheets.length - 1));\n                        let shouldAllowMoveLeft = !(isSingleVisibleSheet || (that._sheets && ind === 0));\n                        el.kendoDropDownButton({\n                            icon: SheetsBar.classNames.sheetsBarMoreIcon,\n                            fillMode: \"flat\",\n                            items: [\n                                { text: \"Delete\", icon: \"trash\", attributes: { \"data-command\": \"delete\", \"data-sheet-name\": sheetName }, enabled: !isSingleVisibleSheet },\n                                { text: \"Duplicate\", icon: \"copy\", attributes: { \"data-command\": \"duplicate\", \"data-sheet-name\": sheetName } },\n                                { text: \"Rename\", icon: \"pencil\", attributes: { \"data-command\": \"rename\", \"data-sheet-name\": sheetName } },\n                                { text: \"Hide\", icon: \"eye-slash\", attributes: { \"data-command\": \"hide\", \"data-sheet-name\": sheetName }, enabled: !isSingleVisibleSheet },\n                                { text: \"Move Right\", icon: \"arrow-right\", attributes: { \"data-command\": \"move-right\", \"data-sheet-name\": sheetName }, enabled: shouldAllowMoveRight },\n                                { text: \"Move Left\", icon: \"arrow-left\", attributes: { \"data-command\": \"move-left\", \"data-sheet-name\": sheetName }, enabled: shouldAllowMoveLeft },\n                            ],\n                            click: that._onSheetContextMenu.bind(that)\n                        });\n                    });\n                },\n                _createSheetsWrapper: function(sheetElements, renderScrollButtons) {\n                    var element = kendo.dom.element;\n                    var classNames = SheetsBar.classNames;\n                    var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' });\n                    var childrenElements = [element(\"ul\", {\n                        className: classNames.sheetsBarKReset,\n                        role: \"tablist\"\n                    }, sheetElements), null, null];\n\n                    renderScrollButtons = true;\n\n                    if (renderScrollButtons) {\n                        var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n\n                        childrenElements[1] = (element(\"button\", { ariaHidden: \"true\", tabIndex: -1, className: baseButtonClass + classNames.sheetsBarPrev }, [\n                            element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowWIcon, iconClass: \"k-button-icon\" }))[0])\n                        ]));\n\n                        childrenElements[2] = (element(\"button\", { ariaHidden: \"true\", tabIndex: -1, className: baseButtonClass + classNames.sheetsBarNext }, [\n                            element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowEIcon, iconClass: \"k-button-icon\" }))[0])\n                        ]));\n                    }\n\n                    itemsWrapper.children = childrenElements;\n\n                    return element(\"div\", { className: classNames.sheetsBarItems }, [itemsWrapper]);\n                },\n\n                _createSortable: function() {\n                    var classNames = SheetsBar.classNames;\n                    this._sortable = new kendo.ui.Sortable(this.element, {\n                        filter: `ul li.${classNames.sheetsBarKItem}`,\n                        container: DOT + classNames.sheetsBarItems,\n                        axis: \"x\",\n                        animation: false,\n                        ignore: \"input\",\n                        end: function() {\n                            if (this.draggable.hint) {\n                                this.draggable.hint.remove();\n                            }\n                        },\n                        hint: function(element) {\n                            var hint = $(element).clone().attr(\"ref-sheetsbar-sortable-hint\", \"\");\n                            return hint.wrap(\"<div class='\" + classNames.sheetsBarHintWrapper + \"'><ul class='\" + classNames.sheetsBarKResetItems + \"'></ul></div>\").closest(\"div\");\n                        }\n                    });\n                },\n\n                _onEditorKeydown: function(e) {\n                    if (this._editor) {\n                        if (e.which === 13) {\n                            this._destroyEditor();\n                        }\n\n                        if (e.which === 27) {\n                            this._destroyEditor(true);\n                        }\n                    }\n                },\n\n                _onEditorBlur: function() {\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n                },\n\n                _onSheetReorderEnd: function(e) {\n                    e.preventDefault();\n                    this.trigger(\"reorder\", { oldIndex: e.oldIndex, newIndex: e.newIndex });\n                },\n\n                _onSheetReorderStart: function(e) {\n                    if (this._editor) {\n                        e.preventDefault();\n                    }\n                },\n                _onSheetContextMenu: function(e) {\n                    let sheetName = $(e.target).closest(\"li\").data(\"sheetName\");\n                    let command = $(e.target).closest(\"li\").data(\"command\");\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    if (sheetName && command) {\n                        switch(command) {\n                            case \"delete\":\n                                this._onSheetRemove(e);\n                                break;\n                            case \"duplicate\":\n                                this._onSheetDuplicate(sheetName);\n                                break;\n                            case \"rename\":\n                                this._renamePrompt(sheetName);\n                                break;\n                            case \"hide\":\n                                this._hideSheet(sheetName);\n                                break;\n                            case \"move-right\":\n                                this._moveSheet(sheetName, 1);\n                                break;\n                            case \"move-left\":\n                                this._moveSheet(sheetName, -1);\n                                break;\n                        }\n                    }\n                },\n                _onSheetDuplicate: function(sheetName) {\n                    this.trigger(\"duplicate\", { name: sheetName });\n                },\n                _renamePrompt: function(sheetName) {\n                    let renameSheetIndex = this._sheets.findIndex(sh => sh.name() == sheetName);\n                    let closeCallback = function(e) {\n                        let dlg = e.sender;\n                        if (dlg._newSheetName && dlg._newSheetName !== sheetName) {\n                            this.trigger(\"rename\", { name: dlg._newSheetName, sheetIndex: renameSheetIndex });\n                        }\n                    }.bind(this);\n\n                    this._openDialog(\"renameSheet\", {\n                        close: closeCallback,\n                        _oldSheetName: sheetName\n                    });\n                },\n                _hideSheet: function(sheetName) {\n                    this.trigger(\"hide\", { name: sheetName });\n                },\n                _moveSheet: function(sheetName, direction) {\n                    let sheetIndex = this._sheets.findIndex(sheet => sheet.name() === sheetName);\n                    let newSheetIndex = sheetIndex + direction;\n                    if (newSheetIndex < 0 || newSheetIndex >= this._sheets.length) {\n                        return;\n                    }\n\n                    this.trigger(\"reorder\", { oldIndex: sheetIndex, newIndex: newSheetIndex });\n                },\n                _onSheetRemove: function(e) {\n                    var removedSheetName = $(e.target).closest(\"li\").data(\"sheetName\");\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    var closeCallback = function(e) {\n                        var dlg = e.sender;\n\n                        if (dlg.isConfirmed()) {\n                            this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n                        }\n                    }.bind(this);\n\n                    this._openDialog(\"confirmation\", {\n                        close: closeCallback\n                    });\n                },\n\n                _onSheetSelect: function(e) {\n                    var selectedSheetText = $(e.target).text();\n\n                    if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    this._scrollSheetsToItem($(e.target).closest(\"li\"));\n                    this.trigger(\"select\", { name: selectedSheetText, isAddButton: false });\n                },\n\n                _onSheetRename: function(newSheetName) {\n                    if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                        return;\n                    }\n\n                    this.trigger(\"rename\", { name: newSheetName, sheetIndex: this._selectedIndex });\n                },\n\n                _onAddSelect: function(ev) {\n                    ev.sender.element.removeClass(\"k-focus\");\n                    this.trigger(\"select\", { isAddButton: true });\n                },\n\n                _onMenuSelect: function(ev) {\n                    let sheetName = $(ev.target).closest(\"li\").data(\"sheetName\");\n                    if (sheetName) {\n                        this.trigger(\"show\", { name: sheetName });\n                    }\n                },\n\n                _addButton: function() {\n                    var classNames = SheetsBar.classNames;\n                    let addButton = this.element.find(\".\" + classNames.sheetsBarAdd);\n                    if (!addButton.length) {\n                        addButton = $(`<button class=\"${classNames.sheetsBarAdd}\" aria-label=\"Add new sheet\"></button>`).appendTo(this.element);\n                    } else {\n                        kendo.destroy(addButton);\n                    }\n\n                    addButton.kendoButton({\n                        icon: classNames.sheetsBarPlusIcon,\n                        fillMode: \"flat\",\n                        click: this._onAddSelect.bind(this)\n                    });\n                },\n                _menuButton: function() {\n                    var classNames = SheetsBar.classNames;\n                    let menuButton = this.element.find(\".\" + classNames.sheetsBarSheetsMenu);\n                    if (!menuButton.length) {\n                        menuButton = $(`<button class=\"${classNames.sheetsBarSheetsMenu}\"></button>`).appendTo(this.element);\n                    } else {\n                        kendo.destroy(menuButton);\n                    }\n\n                    menuButton.kendoDropDownButton({\n                        icon: classNames.sheetsBarMenuIcon,\n                        fillMode: \"flat\",\n                        items: (this._sheets || []).map(sheet => ({\n                            text: sheet.name(),\n                            attributes: { 'data-sheet-name': sheet.name() },\n                            icon: sheet.state() === 'visible' ? 'eye' : 'eye-slash',\n                            cssClass: classNames\n                        })),\n                        click: this._onMenuSelect.bind(this)\n                    });\n                },\n\n                destroy: function() {\n                    this._sortable.destroy();\n                },\n\n                _scrollableAllowed: function() {\n                    var options = this.options;\n                    return options.scrollable && !isNaN(options.scrollable.distance);\n                },\n\n                _scrollSheetsToItem: function(item) {\n                    var that = this;\n                    var sheetsGroup = that._sheetsGroup();\n                    var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                    var itemWidth = outerWidth(item);\n                    var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                    var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                    var itemPosition;\n\n                    if (that._isRtl) {\n                        if (itemOffset < 0) {\n                            itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                        } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                            itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                        }\n                    } else {\n                        if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                            itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                        } else if (currentScrollOffset > itemOffset) {\n                            itemPosition = itemOffset;\n                        }\n                    }\n\n                    sheetsGroup.finish().animate({ \"scrollLeft\": itemPosition }, \"fast\", \"linear\", function() {\n                        that._toggleScrollButtons();\n                    });\n                },\n\n                _sheetsGroup: function() {\n                    return this._sheetsWrapper().find(\"ul\");\n                },\n\n                _sheetsWrapper: function() {\n                    return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n                },\n\n                _scrollSheetsByDelta: function(delta) {\n                    var that = this;\n                    var sheetsGroup = that._sheetsGroup();\n                    var scrLeft = kendo.scrollLeft(sheetsGroup);\n\n                    sheetsGroup.finish().animate({ \"scrollLeft\": scrLeft + delta }, \"fast\", \"linear\", function() {\n                        if (that._nowScrollingSheets) {\n                            that._scrollSheetsByDelta(delta);\n                        } else {\n                            that._toggleScrollButtons();\n                        }\n                    });\n                }\n            });\n\n            kendo.spreadsheet.SheetsBar = SheetsBar;\n            $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n        })(window.kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var Widget = kendo.ui.Widget;\n            var classNames = {\n                details: \"k-details\",\n                button: \"k-button\",\n                detailsSummary: \"k-details-summary\",\n                detailsContent: \"k-details-content\",\n                icon: \"k-icon\",\n                iconCollapseName: \"caret-br\",\n                iconExpandName: \"caret-alt-right\",\n                iconSearchName: \"search\",\n                textbox: \"k-textbox\",\n                wrapper: \"k-spreadsheet-filter-menu\",\n                filterByCondition: \"k-spreadsheet-condition-filter\",\n                filterByValue: \"k-spreadsheet-value-filter\",\n                valuesTreeViewWrapper: \"k-spreadsheet-value-treeview-wrapper\",\n                actionButtons: \"k-actions\"\n            };\n\n            kendo.spreadsheet.messages.filterMenu = {\n                all: \"All\",\n                sortAscending: \"Sort range A to Z\",\n                sortDescending: \"Sort range Z to A\",\n                filterByValue: \"Filter by value\",\n                filterByCondition: \"Filter by condition\",\n                apply: \"Apply\",\n                search: \"Search\",\n                addToCurrent: \"Add to current selection\",\n                clear: \"Clear\",\n                blanks: \"(Blanks)\",\n                operatorNone: \"None\",\n                and: \"AND\",\n                or: \"OR\",\n                operators: {\n                    string: {\n                        contains: \"Text contains\",\n                        doesnotcontain: \"Text does not contain\",\n                        startswith: \"Text starts with\",\n                        endswith: \"Text ends with\",\n                        matches: \"Text matches\",\n                        doesnotmatch: \"Text does not match\"\n                    },\n                    date: {\n                        eq:  \"Date is\",\n                        neq: \"Date is not\",\n                        lt:  \"Date is before\",\n                        gt:  \"Date is after\"\n                    },\n                    number: {\n                        eq: \"Is equal to\",\n                        neq: \"Is not equal to\",\n                        gte: \"Is greater than or equal to\",\n                        gt: \"Is greater than\",\n                        lte: \"Is less than or equal to\",\n                        lt: \"Is less than\"\n                    }\n                }\n            };\n\n            var Details = Widget.extend({\n                init: function(element, options) {\n                    Widget.fn.init.call(this, element, options);\n\n                    this.element.addClass(FilterMenu.classNames.details);\n\n                    this._summary = this.element.find(\".\" + FilterMenu.classNames.detailsSummary)\n                        .on(\"click\", this._toggle.bind(this));\n\n                    var iconName = options.expanded ? FilterMenu.classNames.iconCollapseName : FilterMenu.classNames.iconExpandName;\n                    this._icon = $(kendo.ui.icon(iconName))\n                        .prependTo(this._summary);\n\n                    this._container = kendo.wrap(this._summary.next(), true);\n\n                    if (!options.expanded) {\n                        this._container.hide();\n                    }\n                },\n                options: {\n                    name: \"Details\"\n                },\n                events: [ \"toggle\" ],\n                visible: function() {\n                    return this.options.expanded;\n                },\n                toggle: function(show) {\n                    var animation = kendo.fx(this._container).expand(\"vertical\");\n\n                    animation.stop()[show ? \"reverse\" : \"play\"]();\n                    kendo.ui.icon(this._icon, { icon: show ? FilterMenu.classNames.iconExpandName : FilterMenu.classNames.iconCollapseName });\n\n                    this.options.expanded = !show;\n                },\n                _toggle: function() {\n                    var show = this.visible();\n                    this.toggle(show);\n                    this.trigger(\"toggle\", { show: show });\n                }\n            });\n\n            kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n                init: function(element, bindings, options) {\n                    kendo.data.Binder.fn.init.call(this, element, bindings, options);\n\n                    this._change = this.change.bind(this);\n                    $(this.element).on(\"change\", this._change);\n                },\n                refresh: function() {\n                    var that = this,\n                        value = that.bindings.spreadsheetFilterValue.get(); //get the value from the View-Model\n\n                    $(that.element).val(value instanceof Date ? \"\" : value);\n                },\n                change: function() {\n                    var value = this.element.value;\n                    this.bindings.spreadsheetFilterValue.set(value); //update the View-Model\n                }\n            });\n\n            kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n                init: function(widget, bindings, options) {\n                    kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n\n                    this.widget = widget;\n                    this._change = this.change.bind(this);\n                    this.widget.first(\"change\", this._change);\n                },\n                refresh: function() {\n                    var binding = this.bindings.spreadsheetFilterValue,\n                        value = binding.get(),\n                        type = $(this.widget.element).data(\"filterType\");\n\n                    if ((type === \"date\" && value instanceof Date) || (type === \"number\" && !isNaN(value))) {\n                        this.widget.value(value);\n                    } else {\n                        this.widget.value(null);\n                    }\n                },\n                change: function() {\n                    var value = this.widget.value(),\n                        binding = this.bindings.spreadsheetFilterValue;\n\n                    binding.set(value);\n                }\n            });\n\n            var templates = {\n                filterByValue: (data) =>\n                    `<div class='${classNames.detailsSummary}'>${data.messages.filterByValue}</div>` +\n                    `<div class='${classNames.detailsContent}'>` +\n                        \"<div class='k-searchbox k-input k-input-md k-rounded-md k-input-solid'>\" +\n                            kendo.ui.icon({ icon: \"search\", iconClass: \"k-input-icon\" }) +\n                            `<input class='k-input-inner' autocomplete='off' placeholder='${data.messages.search}' data-${data.ns}bind='events: { input: filterValues }' />` +\n                        \"</div>\" +\n                        `<div data-${data.ns}bind='visible: hasActiveSearch'><input class='k-checkbox k-checkbox-md k-rounded-md' type='checkbox' data-${data.ns}bind='checked: appendToSearch' id='_${data.guid}'/><label class='k-checkbox-label' for='_${data.guid}'>${data.messages.addToCurrent}</label></div>` +\n                        `<div class='${classNames.valuesTreeViewWrapper}'>` +\n                            `<div data-${data.ns}role='treeview' ` +\n                                `bind:data-${data.ns}checkboxes='checkboxesConfig' `+\n                                `data-${data.ns}bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' `+\n                                \"></div>\" +\n                        \"</div>\" +\n                    \"</div>\",\n                filterByCondition: (data) =>\n                    `<div class='${classNames.detailsSummary}'>${data.messages.filterByCondition}</div>` +\n                    `<div class='${classNames.detailsContent}'>` +\n                        '<div>' +\n                            '<select ' +\n                                `aria-label=\"${data.messages.filterByCondition}\" ` +\n                                `data-${data.ns}role=\"dropdownlist\"` +\n                                `data-${data.ns}bind=\"value: operator, source: operators, events: { change: operatorChange } \"` +\n                                `data-${data.ns}value-primitive=\"false\"` +\n                                `data-${data.ns}option-label=\"${data.messages.operatorNone}\"` +\n                                `data-${data.ns}height=\"auto\"` +\n                                `data-${data.ns}text-field=\"text\"` +\n                                `data-${data.ns}value-field=\"unique\">`+\n                            '</select>'+\n                        '</div>' +\n\n                        `<div data-${data.ns}bind=\"visible: isString\">` +\n                            `<input aria-label=\"string-value\" data-filter-type=\"string\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />`+\n                        '</div>' +\n\n                        `<div data-${data.ns}bind=\"visible: isNumber\">` +\n                            `<input aria-label=\"number-value\" data-filter-type=\"number\" data-${data.ns}role=\"numerictextbox\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />`+\n                        '</div>' +\n\n                        `<div data-${data.ns}bind=\"visible: isDate\">` +\n                            `<input aria-label=\"date-value\" data-filter-type=\"date\" data-${data.ns}role=\"datepicker\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />`+\n                        '</div>' +\n                    \"</div>\",\n                menuItem: (data) =>\n                    `<li data-command='${data.command}' data-dir='${data.dir}'>` +\n                        `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                    \"</li>\",\n                actionButtons: (data) =>\n                    `<button data-${data.ns}bind='click: apply' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'><span class='k-button-text'>${data.messages.apply}</span></button>` +\n                    `<button data-${data.ns}bind='click: clear' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>${data.messages.clear}</span></button>`\n            };\n\n            function distinctValues(values) {\n                var hash = {};\n                var result = [];\n\n                for (var i = 0; i < values.length; i++) {\n                    if (!hash[values[i].value]) {\n                        hash[values[i].value] = values[i];\n                        result.push(values[i]);\n                    } else if (!hash[values[i].value].checked && values[i].checked) {\n                        hash[values[i].value].checked = true;\n                    }\n                }\n\n                return result;\n            }\n\n            function filter(dataSource, query) {\n                var hasVisibleChildren = false;\n                var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n                var valuesFilter = this;\n                var values = this.values;\n                for (var i = 0; i < data.length; i++) {\n                    var item = data[i];\n                    var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                    var itemVisible = query === true || query === \"\" || text.indexOf(query) >= 0;\n                    var filterSpread = filter.bind(valuesFilter);\n                    var anyVisibleChildren = filterSpread(item.children, query); // pass true if parent matches\n\n                    hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                    item.hidden = !itemVisible && !anyVisibleChildren;\n\n                    if (query.length || (values && !values.length)) {\n                        item.checked = !item.hidden;\n                    } else if (values && values.indexOf(item.text) != -1){\n                        item.checked = true;\n                    }\n                }\n\n                if (data) {\n                    // re-apply filter on children\n                    dataSource.filter({ field: \"hidden\", operator: \"neq\", value: true });\n                }\n\n                return hasVisibleChildren;\n            }\n\n            function uncheckAll(dataSource) {\n                var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n\n                for (var i = 0; i < data.length; i++) {\n                    var item = data[i];\n                    item.checked = false;\n\n                    if (item.hasChildren) {\n                        uncheckAll(item.children);\n                    }\n                }\n            }\n\n            var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n                valuesChange: function(e) {\n                    var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                    var checked = function(item) {\n                        return item.checked;\n                    };\n                    var value = function(item) {\n                        return item.dataType === \"date\" ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                    };\n                    var unique = function(value, index, array) {\n                        return array.lastIndexOf(value) === index;\n                    };\n                    var data = dataSource.data();\n                    var values = data.toJSON()[0].items;\n                    var blanks = values.filter(function(item) {\n                        return item.dataType === \"blank\";\n                    });\n\n                    blanks = blanks.length ? blanks[0].checked : false;\n                    values = values.filter(checked).map(value);\n\n                    if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                        values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                    }\n\n                    this.set(\"valueFilter\", {\n                        values: values,\n                        blanks: blanks\n                    });\n                },\n                valueSelect: function(e) {\n                    e.preventDefault();\n\n                    var node = e.sender.dataItem(e.node);\n                    node.set(\"checked\", !node.checked);\n                },\n                hasActiveSearch: false,\n                appendToSearch: false,\n                filterValues: function(e) {\n                    var query = typeof e == \"string\" ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                    var dataSource = this.valuesDataSource;\n\n                    this.set(\"hasActiveSearch\", !!query);\n\n                    var filterSpread = filter.bind(this.valueFilter);\n                    uncheckAll(dataSource);\n                    filterSpread(dataSource, query);\n                },\n                reset: function() {\n                    this.set(\"customFilter\", { logic: \"and\", criteria: [ { operator: null, value: null } ] });\n                    this.set(\"valueFilter\", { values: [] });\n                },\n                operatorChange: function(e) {\n                    var dataItem = e.sender.dataItem();\n                    this.set(\"operatorType\", dataItem.type);\n\n                    // https://github.com/telerik/kendo-ui-core/issues/3317 - when switching from Value\n                    // filter to “filter by condition”, the customFilter property is lost.\n                    if (!this.get(\"customFilter\")) {\n                        this.reset();\n                    }\n\n                    this.set(\"customFilter.criteria[0].operator\", dataItem.value);\n                },\n                isNone: function() {\n                    return this.get(\"operatorType\") === undefined;\n                },\n                isString: function() {\n                    return this.get(\"operatorType\") === \"string\";\n                },\n                isNumber: function() {\n                    return this.get(\"operatorType\") === \"number\";\n                },\n                isDate: function() {\n                    return this.get(\"operatorType\") === \"date\";\n                }\n            });\n\n            function flattenOperators(operators) {\n                var messages = kendo.spreadsheet.messages.filterMenu.operators;\n                var result = [];\n                for (var type in operators) {\n                    if (!operators.hasOwnProperty(type)) {\n                        continue;\n                    }\n\n                    for (var operator in operators[type]) {\n                        if (!operators[type].hasOwnProperty(operator)) {\n                            continue;\n                        }\n\n                        result.push({\n                            text: messages[type][operator],\n                            value: operator,\n                            unique: type + \"_\" + operator,\n                            type: type\n                        });\n                    }\n                }\n                return result;\n            }\n\n            var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n                valuesTree: function(range, column) {\n                    return [{\n                        text: kendo.spreadsheet.messages.filterMenu.all,\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n                },\n                values: function(range, column) {\n                    var values = [];\n                    var messages = kendo.spreadsheet.messages.filterMenu;\n                    var columnRange = range.column(column);\n                    var sheet = range.sheet();\n\n                    columnRange.forEachCell(function(row, col, cell) {\n                        var checked = true;\n                        if (sheet.isHiddenRow(row)) {\n                            checked = false;\n                        }\n\n                        var value = cell.value;\n                        var dataType = cell.dataType;\n                        var text = cell.text;\n\n                        if (value === undefined) {\n                            dataType = \"blank\";\n                        } else if (cell.format) {\n                            dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                        } else {\n                            dataType = typeof value;\n                        }\n\n                        if (value !== null && cell.format) {\n                            text = kendo.spreadsheet.formatting.text(value, cell.format);\n                        } else {\n                            text = dataType == \"blank\" ? messages.blanks : value;\n                        }\n\n                        if (dataType === \"percent\" || dataType === \"currency\") { //treat percent as number\n                            dataType = \"number\";\n                        }\n\n                        if (dataType === \"date\") {\n                            value = kendo.spreadsheet.numberToDate(value);\n                        }\n\n                        values.push({\n                            dataType: dataType,\n                            value: value,\n                            text: text,\n                            checked: checked\n                        });\n                    });\n\n                    values = distinctValues(values);\n\n                    values.sort(function(a, b) {\n                        if (a.dataType === b.dataType) {\n                            return 0;\n                        }\n\n                        if (a.dataType === \"blank\" || b.dataType === \"blank\") {\n                            return a.dataType === \"blank\" ? -1 : 1;\n                        }\n\n                        if (a.dataType === \"number\" || b.dataType === \"number\") {\n                            return a.dataType === \"number\" ? -1 : 1;\n                        }\n\n                        if (a.dataType === \"date\" || b.dataType === \"date\") {\n                            return a.dataType === \"date\" ? -1 : 1;\n                        }\n\n                        return 0;\n                    });\n\n                    return values;\n                },\n\n                filterType: function(range, column) {\n                    // 1. try to infer type from current filter\n                    var sheet = range.sheet();\n                    var filter = this.filterForColumn(column, sheet);\n                    var type;\n\n                    filter = filter && filter.filter.toJSON();\n\n                    if (filter && filter.filter == \"custom\") {\n                        var value = filter.criteria[0].value;\n\n                        if (value instanceof Date) {\n                            type = \"date\";\n                        } else if (typeof value == \"string\") {\n                            type = \"string\";\n                        } else if (typeof value == \"number\") {\n                            type = \"number\";\n                        }\n                    }\n\n                    if (!type) {\n                        // 2. try to infer type from column data\n                        var topValue = this.values(range.row(1), column)[0];\n                        type = topValue && topValue.dataType;\n\n                        if (type == \"blank\") {\n                            type = null;\n                        }\n                    }\n\n                    return type;\n                },\n\n                filterForColumn: function(column, sheet) {\n                    var allFilters = sheet.filter();\n                    var filters;\n\n                    if (allFilters) {\n                        filters =  allFilters.columns.filter(function(item) {\n                            return item.index === column;\n                        })[0];\n                    }\n\n                    return filters;\n                },\n\n                filter: function(column, sheet) {\n                    var columnFilters = this.filterForColumn(column, sheet);\n\n                    if (!columnFilters) {\n                        return;\n                    }\n\n                    var options = columnFilters.filter.toJSON();\n                    var type = options.filter;\n\n                    delete options.filter;\n\n                    var result = {\n                        type: type,\n                        options: options\n                    };\n\n                    var criteria = options.criteria;\n                    if (criteria && criteria.length) {\n                        result.operator = criteria[0].operator;\n                    }\n\n                    return result;\n                }\n            };\n\n            var FilterMenu = Widget.extend({\n                init: function(element, options) {\n                    Widget.call(this, element, options);\n\n                    this.element.addClass(FilterMenu.classNames.wrapper);\n\n                    this.viewModel = new FilterMenuViewModel({\n                        active: \"value\",\n                        checkboxesConfig: { checkChildren: true },\n                        operator: null,\n                        operators: flattenOperators(this.options.operators),\n                        clear: this.clear.bind(this),\n                        apply: this.apply.bind(this)\n                    });\n\n                    this._filterInit();\n                    this._popup();\n                    this._sort();\n                    this._filterByCondition();\n                    this._filterByValue();\n                    this._actionButtons();\n                },\n\n                options: {\n                    name: \"FilterMenu\",\n                    column: 0,\n                    range: null,\n                    operators: {\n                        string: {\n                            contains: \"Text contains\",\n                            doesnotcontain: \"Text does not contain\",\n                            startswith: \"Text starts with\",\n                            endswith: \"Text ends with\",\n                            matches: \"Text matches\",\n                            doesnotmatch: \"Text does not match\"\n                        },\n                        date: {\n                            eq:  \"Date is\",\n                            neq: \"Date is not\",\n                            lt:  \"Date is before\",\n                            gt:  \"Date is after\"\n                        },\n                        number: {\n                            eq: \"Is equal to\",\n                            neq: \"Is not equal to\",\n                            gte: \"Is greater than or equal to\",\n                            gt: \"Is greater than\",\n                            lte: \"Is less than or equal to\",\n                            lt: \"Is less than\"\n                        }\n                    }\n                },\n\n                events: [\n                    \"action\"\n                ],\n\n                destroy: function() {\n                    Widget.fn.destroy.call(this);\n\n                    this.menu.destroy();\n                    this.valuesTreeView.destroy();\n                    this.popup.destroy();\n                },\n\n                openFor: function(anchor, event) {\n                    if ($(anchor).hasClass(\"k-spreadsheet-view-size\")) {\n                        // on touch devices this element will sit above to\n                        // enable scrolling; it's not useful as an anchor,\n                        // use event coords instead.\n                        this.popup.open(event.pageX, event.pageY);\n                    } else {\n                        this.popup.setOptions({ anchor: anchor });\n                        this.popup.open();\n                    }\n                },\n\n                close: function() {\n                    this.popup.close();\n                },\n\n                clear: function() {\n                    this.action({\n                        command: \"ClearFilterCommand\",\n                        options: {\n                            column: this.options.column\n                        }\n                    });\n                    this.viewModel.reset();\n                    this.close();\n                },\n\n                apply: function() {\n                    this._active();\n\n                    var options = {\n                        operatingRange: this.options.range,\n                        column: this.options.column\n                    };\n\n                    var valueFilter;\n                    var customFilter;\n\n                    if (this.viewModel.active === \"value\") {\n                        this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                        valueFilter = this.viewModel.valueFilter.toJSON();\n\n                        if (valueFilter.blanks || (valueFilter.values && valueFilter.values.length)) {\n                            options.valueFilter = valueFilter;\n                        }\n                    } else if (this.viewModel.active === \"custom\") {\n                        customFilter = this.viewModel.customFilter.toJSON();\n\n                        if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                            options.customFilter = customFilter;\n                        }\n                    }\n\n                    if (options.valueFilter || options.customFilter) {\n                        this.action({ command: \"ApplyFilterCommand\", options: options });\n                    }\n                },\n\n                action: function(options) {\n                    this.trigger(\"action\", $.extend({ }, options));\n                },\n\n                _filterInit: function() {\n                    var column = this.options.column;\n                    var range = this.options.range;\n                    var sheet = range.sheet();\n                    var activeFilter = FilterMenuController.filter(column, sheet);\n\n                    if (activeFilter) {\n                        var filterType = FilterMenuController.filterType(range, column);\n\n                        this.viewModel.set(\"active\", activeFilter.type);\n                        this.viewModel.set(activeFilter.type + \"Filter\", activeFilter.options);\n\n                        if (activeFilter.type == \"custom\") {\n                            this.viewModel.set(\"operator\", filterType + \"_\" + activeFilter.operator);\n                            this.viewModel.set(\"operatorType\", filterType);\n                        }\n                    } else {\n                        this.viewModel.reset();\n                    }\n                },\n\n                _popup: function() {\n                    this.popup = this.element.kendoPopup({\n                        copyAnchorStyles: false\n                    }).data(\"kendoPopup\");\n                },\n\n                _sort: function() {\n                    var template = kendo.template(FilterMenu.templates.menuItem);\n                    var messages = kendo.spreadsheet.messages.filterMenu;\n                    var items = [\n                        { command: \"sort\", dir: \"asc\", text: messages.sortAscending, iconClass: \"sort-asc\" },\n                        { command: \"sort\", dir: \"desc\", text: messages.sortDescending, iconClass: \"sort-desc\" }\n                    ];\n\n                    var ul = $(\"<ul></ul>\", {\n                        \"html\": kendo.render(template, items)\n                    }).appendTo(this.element);\n\n                    this.menu = ul.kendoMenu({\n                        orientation: \"vertical\",\n                        select: function(e) {\n                            var dir = $(e.item).data(\"dir\");\n                            var range = this.options.range.resize({ top: 1 });\n                            var options = {\n                                value: dir,\n                                sheet: false,\n                                operatingRange: range,\n                                column: this.options.column\n                            };\n\n                            this.action({ command: \"SortCommand\", options: options });\n                        }.bind(this)\n                    }).data(\"kendoMenu\");\n                },\n\n                _appendTemplate: function(template, className, details, expanded) {\n                    var compiledTemplate = kendo.template(template);\n                    var wrapper = $(\"<div class='\" + className + \"'/>\").html(compiledTemplate({\n                        messages: kendo.spreadsheet.messages.filterMenu,\n                        guid: kendo.guid(),\n                        ns: kendo.ns\n                    }));\n\n                    this.element.append(wrapper);\n\n                    if (details) {\n                        details = new Details(wrapper, { expanded: expanded, toggle: this._detailToggle.bind(this) });\n                    }\n\n                    kendo.bind(wrapper, this.viewModel);\n\n                    return wrapper;\n                },\n\n                _detailToggle: function(e) {\n                    this.element\n                        .find(\"[\" + kendo.attr(\"role\") + \"=details]\")\n                        .not(e.sender.element)\n                        .data(\"kendoDetails\")\n                        .toggle(!e.show);\n                },\n\n                _filterByCondition: function() {\n                    var isExpanded = this.viewModel.active === \"custom\";\n                    this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n                },\n\n                _filterByValue: function() {\n                    var isExpanded = this.viewModel.active === \"value\";\n                    var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n\n                    this.valuesTreeView = wrapper.find(\"[\" + kendo.attr(\"role\") + \"=treeview]\").data(\"kendoTreeView\");\n\n                    var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n\n                    this.viewModel.set(\"valuesDataSource\", new kendo.data.HierarchicalDataSource({ data: values, accentFoldingFiltering: kendo.culture().name }));\n                },\n\n                _actionButtons: function() {\n                    this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n                },\n\n                _active: function() {\n                    var activeContainer = this.element.find(\"[\" + kendo.attr(\"role\") + \"=details]\").filter(function(index, element) {\n                        return $(element).data(\"kendoDetails\").visible();\n                    });\n\n                    if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                        this.viewModel.set(\"active\", \"value\");\n                    } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                        this.viewModel.set(\"active\", \"custom\");\n                    }\n                }\n            });\n\n            kendo.spreadsheet.FilterMenu = FilterMenu;\n            $.extend(true, FilterMenu, { classNames: classNames, templates: templates });\n\n        })(window.kendo);\n\n    (function(kendo) {\n\n        kendo.spreadsheet.messages.workbook = {\n            defaultSheetName: \"Sheet\"\n        };\n\n        kendo.spreadsheet.messages.view = {\n            nameBox: \"Name Box\",\n            formulaInput: \"Formula Input\",\n            errors: {\n                openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n                shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n                insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n                insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n                filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n                sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n                cantSortMultipleSelection: \"Cannot sort multiple selection\",\n                cantSortNullRef: \"Cannot sort empty selection\",\n                cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n                validationError: \"The value that you entered violates the validation rules set on the cell.\",\n                cannotModifyDisabled: \"Cannot modify disabled cells.\",\n                insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n                insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n            },\n            tabs: {\n                file: \"File\",\n                home: \"Home\",\n                insert: \"Insert\",\n                format: \"Format\",\n                data: \"Data\",\n                view: \"View\"\n            }\n        };\n\n        kendo.spreadsheet.messages.menus = {\n            \"cut\": \"Cut\",\n            \"copy\": \"Copy\",\n            \"paste\": \"Paste\",\n            \"merge\": \"Merge\",\n            \"unmerge\": \"Unmerge\",\n            \"delete\": \"Delete\",\n            \"hide\": \"Hide\",\n            \"unhide\": \"Unhide\",\n            \"bringToFront\": \"Bring to front\",\n            \"sendToBack\": \"Send to back\"\n        };\n    })(window.kendo);\n\n    (function(kendo) {\n        let $ = kendo.jQuery;\n\n        if (kendo.PDFMixin) {\n            let override_drawPDF = function(options) {\n                var result = new $.Deferred();\n                var callback = function(group) {\n                    result.resolve(group);\n                };\n                switch(options.area) {\n                case \"workbook\":\n                    options.workbook.draw(options, callback);\n                    break;\n                case \"sheet\":\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case \"selection\":\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n\n                return result.promise();\n            };\n\n             let overrideSaveAsPDF = function(options) {\n                if (this.events.indexOf(\"pdfExport\") === -1) {\n                    kendo.PDFMixin.extend(this);\n                    this.saveAsPDF = overrideSaveAsPDF;\n                    this._drawPDF = override_drawPDF;\n                }\n\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger(\"pdfExport\", args)) {\n                    return;\n                }\n\n                this._drawPDF(options, progress)\n                .then(function(root) {\n                    let pdfResultPromise = options.forceProxy\n                        ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n                        : kendo.pdf.exportPDFToBlob(root);\n                    return kendo.convertPromiseToDeferred(pdfResultPromise);\n                })\n                .done(function(dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n\n                    progress.resolve();\n                })\n                .fail(function(err) {\n                    progress.reject(err);\n                });\n\n                return promise;\n            };\n\n            kendo.spreadsheet.Workbook.prototype.saveAsPDF = overrideSaveAsPDF;\n\n            kendo.spreadsheet.Workbook.prototype._drawPDF = override_drawPDF;\n        }\n    })(kendo);\n\n    const __meta__ = {\n        id: \"spreadsheet\",\n        name: \"Spreadsheet\",\n        category: \"web\",\n        description: \"Spreadsheet component\",\n        depends: [\n            \"core\", \"binder\", \"colorpicker\", \"combobox\", \"data\", \"dom\", \"dropdownlist\",\n            \"menu\", \"ooxml\", \"popup\", \"sortable\", \"toolbar\", \"treeview\",\n            \"window\", \"validator\", \"excel\", \"pdf\", \"drawing\", \"list\", \"spreadsheet.common\"]\n    };\n\n    (function(kendo, undefined$1) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n\n        const K_ACTIVE = \"k-active\";\n        let $ = kendo.jQuery;\n        let Widget = kendo.ui.Widget;\n        let NS = \".kendoSpreadsheet\";\n        let DOT = \".\";\n        let commonEngine = kendo.spreadsheet.commonEngine;\n        let FormulaInput = kendo.spreadsheet.FormulaInput;\n        let SheetsBar = kendo.spreadsheet.SheetsBar;\n\n        function toActionSelector(selectors) {\n            return selectors.map(function(action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(\",\");\n        }\n\n        let COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector(['cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below']);\n        let UNHIDE_ACTION_SELECTORS = toActionSelector(['unhide-row', 'unhide-column']);\n        let classNames = {\n            wrapper: \"k-spreadsheet\"\n        };\n\n        let viewClassNames = commonEngine.View.classNames;\n\n        const SPREADSHEET_CONTENT_HTML_TEMPLATE = ({ messages }) => `\n                            <div ref-header-container class=\"k-spreadsheet-header\"><div ref-header-menu></div><div ref-header-toolbar></div></div>\n                            <div class=\"k-spreadsheet-action-bar\">\n                                <div class=\"k-spreadsheet-name-editor\">\n                                    <input ref-namebox-input title=\"${messages.nameBox || \"Name Box\"}\" aria-label=\"${messages.nameBox || \"Name Box\"}\"></input>\n                                </div>\n                                <div class=\"k-spreadsheet-formula-bar\">\n                                    ${kendo.ui.icon(\"formula-fx\")}\n                                    <div class=\"k-spreadsheet-formula-input\"\n                                        role=\"combobox\"\n                                        title=\"${messages.view.formulaInput}\"\n                                        aria-haspopup=\"menu\"\n                                        aria-expanded=\"false\"\n                                        contentEditable=\"true\"\n                                        spellCheck=\"false\">\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"k-spreadsheet-view\">\n                                <div class=\"k-spreadsheet-fixed-container\"></div>\n                                <div class=\"k-spreadsheet-scroller\">\n                                    <div class=\"k-spreadsheet-view-size\"></div>\n                                </div>\n                                <div tabIndex=\"0\" class=\"k-spreadsheet-clipboard\" contentEditable=\"true\" ></div>\n                                <div contentEditable=\"true\"\n                                    spellCheck=\"false\"\n                                    role=\"combobox\"\n                                    title=\"${messages.view.formulaInput}\"\n                                    aria-haspopup=\"menu\"\n                                    aria-expanded=\"false\"\n                                    class=\"k-spreadsheet-formula-input k-spreadsheet-cell-editor\">\n                                </div>\n                            </div>\n                            <div ref-sheets-bar></div>`;\n\n        const CELL_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.cellContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"merge\">${messages.menus.merge}</li>\n                        <li data-action=\"unmerge\">${messages.menus.unmerge}</li>\n                    </ul>`;\n\n        const ROW_HEADER_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.rowHeaderContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-row\">${messages.menus.delete}</li>\n                        <li data-action=\"hide-row\">${messages.menus.hide}</li>\n                        <li data-action=\"unhide-row\">${messages.menus.unhide}</li>\n                    </ul>`;\n\n        const COL_HEADER_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.colHeaderContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-column\">${messages.menus.delete}</li>\n                        <li data-action=\"hide-column\">${messages.menus.hide}</li>\n                        <li data-action=\"unhide-column\">${messages.menus.unhide}</li>\n                    </ul>`;\n\n        const DRAWING_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.drawingContextMenu}\">\n                        <li data-action=\"bring-to-front\">${messages.menus.bringToFront}</li>\n                        <li data-action=\"send-to-back\">${messages.menus.sendToBack}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-drawing\">${messages.menus.delete}</li>\n                    </ul>`;\n\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n\n        let FormulaInputStaticList = kendo.ui.StaticList.extend({\n            data: function(d) {\n                return this.dataSource.data(d);\n            },\n            itemClick: function(handler) {\n                this.bind(\"change\", function(ev) { handler(this.value()[0]); });\n            }\n        });\n\n        class FormulaInputRefArgs {\n            constructor({ list, popup }) {\n                this.current = { list, popup };\n                this.clone = function clone() {\n                    return this;\n                };\n            }\n        }\n\n        class NameBoxRefArgs {\n            constructor({ nameEditor, container }) {\n                let combo = this.initializeComboBox(container, nameEditor);\n                this.current = {\n                    value: (val) => {\n                        if (val === undefined$1) {\n                            const item = combo.value();\n                            return item ? (item.name || item) : item;\n                        } else {\n                            combo.value(val || '');\n                        }\n                    }\n                };\n\n                this.nameEditor = nameEditor;\n\n                this.clone = function clone() {\n                    return this;\n                };\n            }\n\n            initializeComboBox(container) {\n                let that = this;\n                let dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function(options) {\n                            let data = that.nameEditor()?.readData() || [];\n                            options.success(data);\n                        },\n                        cache: false\n                    }\n                });\n\n                let combo = $(container).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: \"name\",\n                    dataValueField: \"name\",\n                    template: ({ name }) => `${kendo.htmlEncode(name)}<a role='button' class='k-button-delete' href='\\\\#'>${kendo.ui.icon(\"x\")}</a>`,\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: that.onChange.bind(that),\n                    noDataTemplate: () => \"<div></div>\",\n                    open: function() {\n                        dataSource.read();\n                    }\n                }).data(\"kendoComboBox\");\n\n                combo.input\n                    .on(\"keydown\", that.onKeyDown.bind(this));\n                combo.popup.element\n                    .addClass(\"k-spreadsheet-names-popup\")\n\n                    .on(\"mousemove\", function(ev) {\n                        // XXX: should remove this when we find a better\n                        // solution for the popup closing as we hover the\n                        // resize handles.\n                        ev.stopPropagation();\n                    })\n\n                    .on(\"click\", \".k-button-delete\", function(ev) {\n                        ev.preventDefault();\n                        ev.stopPropagation();\n                        let item = $(ev.target).closest(\".k-list-item\");\n                        item = combo.dataItem(item);\n                        that.onDelete(item.name);\n                    });\n\n                return combo;\n            }\n\n            // Event: Handle change in ComboBox\n            onChange(event) {\n                const editor = this.nameEditor();\n                if (editor && event.sender.value()) {\n                    editor.trigger(\"select\", { name: event.sender.value() });\n                }\n            }\n\n            // Event: Delete button click within item\n            onDelete(name) {\n                this.nameEditor()?.trigger(\"delete\", { name });\n            }\n\n            // Handling keyboard events like Enter, Escape\n            onKeyDown(event) {\n                const editor = this.nameEditor();\n                if (editor) {\n                    if (event.key === 'Enter') {\n                        const name = event.target.value;\n                        editor.trigger(\"enter\", { value: name });\n                    } else if (event.key === 'Escape') {\n                        editor.trigger(\"cancel\");\n                    }\n                }\n            }\n        }\n\n        let Spreadsheet = kendo.ui.Widget.extend({\n            _renderInnerContent: function(element) {\n                $(element).append(SPREADSHEET_CONTENT_HTML_TEMPLATE(this.options));\n            },\n            init: function(element, options) {\n                let that = this;\n                Widget.fn.init.call(this, element, options);\n\n                this.options.messages = $.extend(true, {\n                    view: kendo.spreadsheet.messages.view,\n                    tabs: kendo.spreadsheet.messages.view.tabs,\n                    menus: kendo.spreadsheet.messages.menus,\n                    workbook: {\n                        defaultSheetName: \"Sheet\",\n                    }\n                }, this.options.messages);\n\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this.element.attr(\"role\", \"application\");\n                this._renderInnerContent(this.element);\n\n                this._createFormulaInputs();\n\n                that.spreadsheetRef = this._initSpreadsheetWidget();\n\n                this._bindWorkbookEvents();\n\n                const activeSheet = this.activeSheet();\n                this._onUpdateTools({ range: activeSheet.range(activeSheet.activeCell()) });\n\n                this._resizeHandler = function() { that.resize(); };\n                $(window).on(\"resize\" + NS, this._resizeHandler);\n\n                if (this._showWatermarkOverlay) {\n                    this._showWatermarkOverlay(this.element[0]);\n                }\n            },\n            _initSpreadsheetWidget: function() {\n                let that = this;\n                let widgetOptions = $.extend({},\n                    that.options, {\n                    sheetsbar: that.options.sheetsbar != false ? that.options.sheetsbar : {},\n                    formulaBarInputRef: new FormulaInputRefArgs({\n                        list: this._formulaBarInputRefList,\n                        popup: this._formulaBarInputRefPopup\n                    }),\n                    formulaCellInputRef: new FormulaInputRefArgs({\n                        list: this._formulaCellInputRefList,\n                        popup: this._formulaCellInputRefPopup\n                    }),\n                    nameBoxRef: new NameBoxRefArgs({\n                        container: that.element.find('.k-spreadsheet-name-editor [ref-namebox-input]'),\n                        nameEditor: function() {\n                            return that.spreadsheetRef?.view.nameEditor;\n                        }\n                    }),\n                    createFilterMenu: function(options) {\n                        let element = $(\"<div></div>\").appendTo(that.element);\n                        return new kendo.spreadsheet.FilterMenu(element, options);\n                    },\n                    createTabStrip: function(options) {\n                        if (that.options.toolbar) {\n                            that._initHeader();\n\n                            return {\n                                focus: function() { that.menu.wrapper.trigger(\"focus\"); },\n                                select: function(name) { that.menu.element.find(`li[ref-tab-name=\"${name}\"]`).click(); },\n                                destroy: function() { that.menu.destroy(); }\n                            };\n                        }\n                    },\n                    createSheetEditor: function(options) {\n                        that.sheetsBar._createEditor();\n                    },\n                    createSheetBar: function(openDialogCallback) {\n                        that._sheetsBar(openDialogCallback);\n                    },\n                    createContextMenus: function(options) {\n                        that._dialogs = [];\n                        that._initContextMenus();\n                    },\n                    createSheetDataSource: function(dataSource) {\n                        return kendo.data.DataSource.create(dataSource);\n                    },\n                    getWorkbookCommand: function(commandName, commandOptions) {\n                        return new kendo.spreadsheet[commandName](commandOptions);\n                    },\n                    getIconHTMLString: function(iconName) {\n                        return $(kendo.ui.icon(iconName))[0];\n                    },\n                    update: function(e) {\n                        that._onUpdateTools(e);\n                        if (e.reason.sheetSelection && that.sheetsBar) {\n                            that.sheetsBar.renderSheets(e.sender.sheets(), e.sender.sheetIndex(e.sheet));\n                        }\n                    },\n                    message: (args) => {\n                        // exclude these properties from the options\n                        let { sender, name, ref, range, ...dialogOptions } = args;\n                        let opts = $.extend({}, { pdfExport: that.options.pdf, excelExport: that.options.excel }, dialogOptions);\n                        let dialog = kendo.spreadsheet.dialogs.create(args.name, opts);\n\n                        if (dialog) {\n                            dialog.bind(\"action\", function(args) {\n                                if (args.command == \"SaveAsCommand\") {\n                                    let { sender, ...commandArgs } = args;\n                                    let fileName = args.options.name + args.options.extension;\n                                    if (args.options.extension === \".xlsx\") {\n                                        return that.spreadsheetRef.saveAsExcel($.extend(commandArgs, {\n                                            fileName: fileName,\n                                            Workbook: kendo.ooxml.Workbook,\n                                            saveAs: function(data, fileName, exportOptions) {\n                                                kendo.saveAs({ dataURI: data, fileName, ...exportOptions });\n                                            }\n                                        }));\n                                    } else if (this.options.extension === \".pdf\") {\n                                        return that.spreadsheetRef.saveAsPDF($.extend(args.options.pdf, { workbook: this.options.workbook, fileName: fileName }));\n                                    }\n                                }\n\n                                that.spreadsheetRef.executeCommand(args);\n                            });\n\n                            dialog.bind(\"deactivate\", () => {\n                                dialog.destroy();\n                                that._dialogs.pop();\n                            });\n\n                            that._dialogs.push(dialog);\n\n                            dialog.open(args.range, args);\n                            args.dialog = dialog;\n                        }\n                    },\n                    contextmenu: (e) => {\n                        const { objectRef, targetType, showUnhide, showUnmerge, originalEvent, isComposite } = e;\n                        const selection = e.sender.activeSheet().select();\n                        const { topLeft, bottomRight } = selection;\n\n                        this.cellContextMenu.close();\n                        this.colHeaderContextMenu.close();\n                        this.rowHeaderContextMenu.close();\n                        this.drawingContextMenu.close();\n\n                        let menu;\n\n                        if (targetType == \"columnheader\") {\n                            menu = this.colHeaderContextMenu;\n                        } else if (targetType == \"rowheader\") {\n                            menu = this.rowHeaderContextMenu;\n                        } else if (targetType == \"drawing\") {\n                            menu = this.drawingContextMenu;\n                        } else {\n                            menu = this.cellContextMenu;\n                        }\n\n                        menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                        menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                        menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n\n                        // avoid the immediate close\n                        setTimeout(function() {\n                            menu.open(e.originalEvent.pageX, e.originalEvent.pageY);\n                        });\n                    },\n                    locale: kendo.cultures.current.name,\n                    intl: kendo.kendoCultureToIntl(),\n                });\n\n                return new kendo.spreadsheet.commonEngine.SpreadsheetWidget(this.element[0], widgetOptions);\n            },\n            _createFormulaInputs: function() {\n                let formulaBarInputRefElement = this.element.find('.k-spreadsheet-action-bar .k-spreadsheet-formula-input');\n                let formulaBarInputRefListId = kendo.guid();\n                formulaBarInputRefElement.attr(\"aria-controls\", formulaBarInputRefListId);\n\n                this._formulaBarInputRefList = new FormulaInputStaticList($(`<ul id=\"${formulaBarInputRefListId}\" />`)\n                    .addClass(FormulaInput.classNames.listWrapper)\n                    .insertAfter(formulaBarInputRefElement), {\n                    aria: {\n                        role: 'menu',\n                        itemRole: 'menuitem'\n                    },\n                    autoBind: false,\n                    selectable: true,\n                    dataTextField: \"text\",\n                    dataValueField: \"value\",\n                    template: ({ text, value }) => `${text || value}`\n                });\n\n                this._formulaBarInputRefList.element.on(\"mousedown\", function(e) {\n                    e.preventDefault();\n                });\n\n                this._formulaBarInputRefPopup = new kendo.ui.Popup(this._formulaBarInputRefList.element, {\n                    anchor: this.element.find(\".k-spreadsheet-formula-input:not(.k-spreadsheet-cell-editor)\"),\n                    open: function(ev) { formulaBarInputRefElement.attr(\"aria-expanded\", true); },\n                    close: function(ev) { formulaBarInputRefElement.attr(\"aria-expanded\", false); }\n                });\n\n                let formulaCellInputRefElement = this.element.find('.k-spreadsheet-cell-editor');\n                let formulaCellInputRefListId = kendo.guid();\n                formulaCellInputRefElement.attr(\"aria-controls\", formulaCellInputRefListId);\n\n                this._formulaCellInputRefList = new FormulaInputStaticList($(`<ul id=\"${formulaCellInputRefListId}\" />`)\n                    .addClass(FormulaInput.classNames.listWrapper)\n                    .insertAfter(formulaCellInputRefElement), {\n                    aria: {\n                        role: 'menu',\n                        itemRole: 'menuitem'\n                    },\n                    autoBind: false,\n                    selectable: true,\n                    dataValueField: \"value\",\n                    dataTextField: \"text\",\n                    template: ({ text, value }) => `${text || value}`\n\n                });\n\n                this._formulaCellInputRefList.element.on(\"mousedown\", function(e) {\n                    e.preventDefault();\n                });\n\n                this._formulaCellInputRefPopup = new kendo.ui.Popup(this._formulaCellInputRefList.element, {\n                    anchor: this.element.find(DOT + commonEngine.View.classNames.cellEditor),\n                    open: function(ev) { formulaCellInputRefElement.attr(\"aria-expanded\", true); },\n                    close: function(ev) { formulaCellInputRefElement.attr(\"aria-expanded\", false); }\n                });\n            },\n            _initContextMenus: function() {\n                let that = this;\n\n                let contextMenuConfig = {\n                    target: this.element,\n                    animation: false,\n                    showOn: \"never\" // this is just an invalid event name to prevent the show\n                };\n\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu($(CELL_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu($(COL_HEADER_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu($(ROW_HEADER_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n                this.drawingContextMenu = new kendo.spreadsheet.ContextMenu($(DRAWING_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n                this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            },\n            onContextMenuSelect: function(e) {\n                let that = this;\n                let action = $(e.item).data(\"action\");\n                let command;\n                switch (action) {\n                    case \"cut\":\n                        command = { command: \"ToolbarCutCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                        break;\n                    case \"copy\":\n                        command = { command: \"ToolbarCopyCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                        break;\n                    case \"paste\":\n                        command = { command: \"ToolbarPasteCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                        break;\n                    case \"delete-drawing\":\n                        command = { command: \"DeleteDrawingCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                        break;\n                    case \"bring-to-front\":\n                        command = { command: \"BringToFrontCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                        break;\n                    case \"send-to-back\":\n                        command = { command: \"SendToBackCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                        break;\n                    case \"unmerge\":\n                        command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n                        break;\n                    case \"merge\":\n                        this.spreadsheetRef.openDialog(\"merge\");\n                        break;\n                    case \"hide-row\":\n                        command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n                        break;\n                    case \"hide-column\":\n                        command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n                        break;\n                    case \"unhide-row\":\n                        command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n                        break;\n                    case \"unhide-column\":\n                        command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n                        break;\n                    case \"delete-row\":\n                        command = { command: \"DeleteRowCommand\" };\n                        break;\n                    case \"delete-column\":\n                        command = { command: \"DeleteColumnCommand\" };\n                        break;\n                }\n\n                if (command) {\n                    that.spreadsheetRef.executeCommand(command);\n                }\n            },\n            _onUpdateTools: function(e) {\n                let reason = e.reason;\n                if (reason && (reason.overElement || reason.comment)) {\n                    return;\n                }\n                this.toolbar?.refresh(e.range);\n            },\n            _getCopyRegex: function(sheetName) {\n                const newName = sheetName.replaceAll('(', '\\\\(').replaceAll(')', '\\\\)');\n                const st = `(${newName})\\\\s?\\\\(`;\n                return new RegExp(st, 's');\n            },\n            _sheetsBar: function(openDialogCallback) {\n                let that = this;\n\n                if (that.options.sheetsbar) {\n                    let sheetsbarOptions = $.extend(true, {\n                        openDialog: openDialogCallback,\n                    }, that.options.sheetsbar);\n\n                    that.sheetsBar = new SheetsBar(that.element[0].querySelector('[ref-sheets-bar]'), sheetsbarOptions);\n\n                    that.sheetsBar.bind(\"select\", function onSheetSelect(ev) {\n                        if (ev.isAddButton) {\n                            that.spreadsheetRef.view.sheetsbar.onAddSelect();\n                        } else {\n                            that.spreadsheetRef.view.sheetsbar.onSheetSelect(ev.name);\n                        }\n                    });\n\n                    that.sheetsBar.bind(\"reorder\", function onSheetReorderEnd(ev) {\n                        that.spreadsheetRef.view.sheetsbar.onSheetReorderEnd(ev);\n                    });\n\n                    that.sheetsBar.bind(\"rename\", function onSheetRename(ev) {\n                        that.spreadsheetRef.view.sheetsbar.onSheetRename(ev.name, ev.sheetIndex);\n                    });\n\n                    that.sheetsBar.bind(\"duplicate\", function onSheetDuplicate(ev) {\n                        let name = ev.name;\n                        let sheetToCopy = that.sheetByName(name);\n                        let sheetIndex = that.sheetIndex(sheetToCopy);\n                        let copies = 0;\n                        const regex = that._getCopyRegex(name);\n                        that.sheets().forEach(sheet => {\n                            const isPresent = regex.test(sheet.name());\n                            if (isPresent) {\n                                copies += 1;\n                            }\n                        });\n\n                        const newName = `${name} (${copies + 1})`;\n                        that.insertSheet({ data: { ...sheetToCopy.toJSON(), name: newName }, index: sheetIndex + 1 });\n                        that.spreadsheetRef.view.sheetsbar.onSheetSelect(newName);\n                    });\n\n                    that.sheetsBar.bind(\"remove\", function onSheetBarRemove(ev) {\n                        that.spreadsheetRef.view.sheetsbar.onSheetRemove(ev.name);\n                    });\n\n                    that.sheetsBar.bind(\"hide\", function onSheetBarHide(ev) {\n                        let sheetName = ev.name;\n                        let sheetToHide = that.sheetByName(sheetName);\n                        let visibleSheets = that.sheets().filter(x=> x.state() === \"visible\");\n                        let visibleSheetIndex = visibleSheets.findIndex(x=> x.name() === sheetName);\n                        let nextVisibleSheet = visibleSheets[visibleSheetIndex + 1] || visibleSheets[visibleSheetIndex - 1];\n                        sheetToHide._state('hidden');\n\n                        that.spreadsheetRef.workbook._sheetsSearchCache = {};\n                        that.spreadsheetRef.view.sheetsbar.onSheetSelect(nextVisibleSheet.name());\n                    });\n\n                    that.sheetsBar.bind(\"show\", function onSheetBarShow(ev) {\n                        let sheetName = ev.name;\n                        that.sheetByName(sheetName)._state('visible');\n                        that.spreadsheetRef.workbook._sheetsSearchCache = {};\n                        that.spreadsheetRef.view.sheetsbar.onSheetSelect(ev.name);\n                    });\n                }\n            },\n            _createToolBar: function(options, tabs, toolbarId) {\n                let that = this;\n\n                if (that.toolbar) {\n                    that.toolbar.destroy();\n                    that.toolbar.element.empty();\n                }\n\n                let activeTabIndex = tabs.findIndex((item) => item.id === toolbarId);\n                let activeToolbar = tabs[activeTabIndex];\n                let tools = options[activeToolbar.id];\n\n                that._activeToolBar = activeToolbar.text;\n\n                that.toolbar = new kendo.spreadsheet.ToolBar(this.element.find(\"[ref-header-toolbar]\"), {\n                    tools: typeof tools === \"boolean\" ? undefined$1 : tools,\n                    toolbarName: activeToolbar.id,\n                    fillMode: \"flat\",\n                    action: function(args) {\n                        if (args.command === 'undo' || args.command === 'redo') {\n                            that.spreadsheetRef.workbook.undoRedoStack[args.command]();\n                            return;\n                        }\n\n                        if (args.command == \"OpenCommand\") {\n                            args.options.file = args.options.value;\n                        } else if (args.command === \"BorderChangeCommand\") {\n                            args.options.border = args.options.border || args.options.value.type;\n                            args.options.style = args.options.style || args.options.value.style || { color: args.options.value.color, size: 1 };\n                        }\n\n                        that.spreadsheetRef.executeCommand(args);\n                    },\n                    dialog: function(args) {\n                        that.spreadsheetRef.openDialog(args.name, args.options);\n                    }\n                });\n                that.toolbar.element.attr(\"aria-label\", activeToolbar.text);\n            },\n\n            _initHeader: function() {\n                let that = this;\n                let messages = this.options.messages.tabs;\n                let options = $.extend(true, { file: true, home: true, insert: true, format: true, data: true, view: true }, this.options.toolbar);\n                let tabs = [];\n\n                if (this.menu) {\n                    this.menu.destroy();\n                    this.menu.empty();\n                }\n\n                if (this.toolbar) {\n                    this.toolbar.destroy();\n                    this.toolbar.empty();\n                }\n\n                for (let name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({ id: name, text: messages[name], content: \"\", attr: { \"ref-tab-name\": name } });\n                    }\n                }\n\n                this.menu = new kendo.spreadsheet.Menu(this.element.find(\"[ref-header-menu]\"), {\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    select: function(e) {\n                        let text = $(e.item).text();\n                        if (that._activeToolBar !== text) {\n                            $(e.item).addClass(K_ACTIVE)\n                                .siblings(\"li\").removeClass(K_ACTIVE);\n\n                            that._createToolBar(options, tabs, tabs.find((item) => item.text === text).id);\n                            const activeSheet = that.activeSheet();\n                            that._onUpdateTools({ range: activeSheet.range(activeSheet.activeCell()) });\n                        }\n                    }\n                });\n\n                if (tabs.length) {\n                    let defaultTab = tabs.find((item)=> item.id === \"home\");\n                    this.menu.element.find(`li[ref-tab-name=\"home\"]`).addClass(K_ACTIVE);\n                    that._createToolBar(options, tabs, defaultTab ? defaultTab.id : tabs[0].id);\n                }\n            },\n\n            executeCommand(options) {\n                return this.spreadsheetRef.executeCommand(options);\n            },\n\n            _resize: function() {\n                this.refresh({ layout: true });\n            },\n\n            _workbookChanging: function(e) {\n                if (this.trigger(\"changing\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookChange: function(e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n\n                if (e.recalc && e.ref) {\n                    let range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger(\"change\", { range: range });\n                }\n            },\n\n            _workbookCut: function(e) {\n                this.trigger(\"cut\", e);\n            },\n\n            _workbookCopy: function(e) {\n                this.trigger(\"copy\", e);\n            },\n\n            _workbookPaste: function(e) {\n                this.trigger(\"paste\", e);\n            },\n\n            activeSheet: function(sheet) {\n                return this.spreadsheetRef.activeSheet(sheet);\n            },\n\n            moveSheetToIndex: function(sheet, index) {\n                return this.spreadsheetRef.moveSheetToIndex(sheet, index);\n            },\n\n            insertSheet: function(options) {\n                return this.spreadsheetRef.insertSheet(options);\n            },\n\n            sheets: function() {\n                return this.spreadsheetRef.sheets();\n            },\n\n            removeSheet: function(sheet) {\n                return this.spreadsheetRef.removeSheet(sheet);\n            },\n\n            sheetByName: function(sheetName) {\n                return this.spreadsheetRef.sheetByName(sheetName);\n            },\n\n            sheetIndex: function(sheet) {\n                return this.spreadsheetRef.sheetIndex(sheet);\n            },\n\n            sheetByIndex: function(index) {\n                return this.spreadsheetRef.sheetByIndex(index);\n            },\n\n            renameSheet: function(sheet, newSheetName) {\n                return this.spreadsheetRef.renameSheet(sheet, newSheetName);\n            },\n\n            refresh: function(reason) {\n                this.spreadsheetRef.refresh(reason);\n\n                return this;\n            },\n\n            openDialog: function(name, options) {\n                return this.spreadsheetRef.openDialog(name, options);\n            },\n\n            autoRefresh: function(value) {\n                if (value !== undefined$1) {\n                    this._autoRefresh = value;\n\n                    if (value === true) {\n                        this.refresh();\n                    }\n\n                    return this;\n                }\n\n                return this._autoRefresh;\n            },\n\n            toJSON: function() {\n                return this.spreadsheetRef.toJSON();\n            },\n\n            fromJSON: function(json) {\n                this.spreadsheetRef.fromJSON(json);\n            },\n\n            saveJSON: function() {\n                return this.spreadsheetRef.saveJSON();\n            },\n\n            fromFile: function(blob, name) {\n                return this.spreadsheetRef.fromFile(blob, name);\n            },\n\n            saveAsPDF: function(options) {\n                this.spreadsheetRef.saveAsPDF(\n                    $.extend({}, this.options.pdf, options, { workbook: this.spreadsheetRef._workbook })\n                );\n            },\n\n            saveAsExcel: function(options) {\n                this.spreadsheetRef.saveAsExcel(options);\n            },\n\n            draw: function(options, callback) {\n                this.spreadsheetRef.draw(options, callback);\n            },\n\n            _workbookExcelExport: function(e) {\n                if (this.trigger(\"excelExport\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookExcelImport: function(e) {\n                if (this.trigger(\"excelImport\", e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.deferred);\n                }\n            },\n\n            _initProgress: function(deferred) {\n                let loading =\n                    $(\"<div class='k-loading-mask' \" +\n                        \"style='width: 100%; height: 100%; top: 0;'>\" +\n                        \"<div class='k-loading-color'></div>\" +\n                        \"</div>\")\n                        .appendTo(this.element);\n\n                let pb = $(\"<div class='k-loading-progress'>\")\n                    .appendTo(loading)\n                    .kendoProgressBar({\n                        type: \"chunk\", chunkCount: 10,\n                        min: 0, max: 1, value: 0\n                    }).data(\"kendoProgressBar\");\n\n                deferred.progress(function(e) {\n                    pb.value(e.progress);\n                })\n                    .promise.finally(function() {\n                        kendo.destroy(loading);\n                        loading.remove();\n                    });\n            },\n\n            _workbookPdfExport: function(e) {\n                if (this.trigger(\"pdfExport\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookInsertSheet: function(e) {\n                if (this.trigger(\"insertSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookRemoveSheet: function(e) {\n                if (this.trigger(\"removeSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookSelectSheet: function(e) {\n                if (this.trigger(\"selectSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookRenameSheet: function(e) {\n                if (this.trigger(\"renameSheet\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookInsertRow: function(e) {\n                if (this.trigger(\"insertRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookInsertColumn: function(e) {\n                if (this.trigger(\"insertColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookDeleteRow: function(e) {\n                if (this.trigger(\"deleteRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookDeleteColumn: function(e) {\n                if (this.trigger(\"deleteColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookHideRow: function(e) {\n                if (this.trigger(\"hideRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookHideColumn: function(e) {\n                if (this.trigger(\"hideColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookUnhideRow: function(e) {\n                if (this.trigger(\"unhideRow\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookUnhideColumn: function(e) {\n                if (this.trigger(\"unhideColumn\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookSelect: function(e) {\n                this.trigger(\"select\", e);\n            },\n\n            _workbookChangeFormat: function(e) {\n                this.trigger(\"changeFormat\", e);\n            },\n\n            _workbookDataBinding: function(e) {\n                if (this.trigger(\"dataBinding\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _workbookDataBound: function(e) {\n                this.trigger(\"dataBound\", e);\n            },\n\n            _workbookProgress: function(e) {\n                kendo.ui.progress(this.element, e.toggle);\n            },\n\n            _bindWorkbookEvents: function() {\n                this.spreadsheetRef.bind(\"cut\", this._workbookCut.bind(this));\n                this.spreadsheetRef.bind(\"copy\", this._workbookCopy.bind(this));\n                this.spreadsheetRef.bind(\"paste\", this._workbookPaste.bind(this));\n                this.spreadsheetRef.bind(\"changing\", this._workbookChanging.bind(this));\n                this.spreadsheetRef.bind(\"change\", this._workbookChange.bind(this));\n                this.spreadsheetRef.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n                this.spreadsheetRef.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n                this.spreadsheetRef.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n                this.spreadsheetRef.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n                this.spreadsheetRef.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n                this.spreadsheetRef.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n                this.spreadsheetRef.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n                this.spreadsheetRef.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n                this.spreadsheetRef.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n                this.spreadsheetRef.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n                this.spreadsheetRef.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n                this.spreadsheetRef.bind(\"hideRow\", this._workbookHideRow.bind(this));\n                this.spreadsheetRef.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n                this.spreadsheetRef.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n                this.spreadsheetRef.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n                this.spreadsheetRef.bind(\"select\", this._workbookSelect.bind(this));\n                this.spreadsheetRef.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n                this.spreadsheetRef.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n                this.spreadsheetRef.bind(\"dataBound\", this._workbookDataBound.bind(this));\n                this.spreadsheetRef.bind(\"progress\", this._workbookProgress.bind(this));\n            },\n\n            destroy: function() {\n                kendo.ui.Widget.fn.destroy.call(this);\n\n                this._formulaBarInputRefPopup?.destroy();\n                this._formulaCellInputRefPopup?.destroy();\n                this._formulaBarInputRefList?.destroy();\n                this._formulaCellInputRefList?.destroy();\n\n                this._formulaBarInputRefList = this._formulaCellInputRefList = null;\n                this._formulaBarInputRefPopup = this._formulaCellInputRefPopup = null;\n\n                if (this.menu) {\n                    this.menu.destroy();\n                }\n\n                if (this.toolbar) {\n                    this.toolbar.destroy();\n                }\n\n                if (this.sheetsBar) {\n                    this.sheetsBar.destroy();\n                }\n\n                this._dialogs?.forEach(function(dialog) {\n                    dialog?.destroy();\n                });\n\n                this.spreadsheetRef?.destroy();\n\n                this.cellContextMenu?.destroy();\n\n                this.rowHeaderContextMenu?.destroy();\n                this.colHeaderContextMenu?.destroy();\n                this.drawingContextMenu?.destroy();\n\n                this.cellContextMenu = this.rowHeaderContextMenu =\n                    this.colHeaderContextMenu =\n                    this.drawingContextMenu = null;\n\n                if (this._resizeHandler) {\n                    $(window).off(\"resize\" + NS, this._resizeHandler);\n                }\n\n                kendo.destroy(this.element);\n            },\n\n            options: {\n                name: \"Spreadsheet\",\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 30,\n                columnWidth: 64,\n                headerHeight: 30,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: \"\",\n                    fileName: \"Workbook.xlsx\"\n                },\n                messages: {},\n                pdf: {\n                    // which part of the workbook to be exported\n                    area: \"workbook\",\n                    fileName: \"Workbook.pdf\",\n                    proxyURL: \"\",\n                    // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n                    // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n                    // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n                    // by content.\n                    paperSize: \"a4\",\n                    // True to reverse the paper dimensions if needed such that width is the larger edge.\n                    landscape: true,\n                    // An object containing { left, top, bottom, right } margins with units.\n                    margin: null,\n                    // Optional information for the PDF Info dictionary; all strings except for the date.\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: \"Kendo UI PDF Generator v.\" + kendo.version,\n                    // Creation Date; defaults to new Date()\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: \"Arial\",\n                    fontSize: 12\n                },\n                useCultureDecimals: false\n            },\n\n            defineName: function(name, value, hidden) {\n                return this.spreadsheetRef.defineName(name, value, hidden);\n            },\n\n            undefineName: function(name) {\n                return this.spreadsheetRef.undefineName(name);\n            },\n\n            nameValue: function(name) {\n                return this.spreadsheetRef.nameValue(name);\n            },\n\n            forEachName: function(func) {\n                return this.spreadsheetRef.forEachName(func);\n            },\n\n            cellContextMenu: function() {\n                return this.cellContextMenu;\n            },\n\n            rowHeaderContextMenu: function() {\n                return this.rowHeaderContextMenu;\n            },\n\n            colHeaderContextMenu: function() {\n                return this.colHeaderContextMenu;\n            },\n\n            addImage: function(image) {\n                return this.spreadsheetRef.addImage(image);\n            },\n\n            cleanupImages: function() {\n                return this.spreadsheetRef.cleanupImages();\n            },\n\n            events: [\n                \"cut\",\n                \"copy\",\n                \"paste\",\n                \"pdfExport\",\n                \"excelExport\",\n                \"excelImport\",\n                \"changing\",\n                \"change\",\n                \"render\",\n                \"removeSheet\",\n                \"selectSheet\",\n                \"renameSheet\",\n                \"insertRow\",\n                \"insertColumn\",\n                \"deleteRow\",\n                \"insertSheet\",\n                \"deleteColumn\",\n                \"hideRow\",\n                \"hideColumn\",\n                \"unhideRow\",\n                \"unhideColumn\",\n                \"select\",\n                \"changeFormat\",\n                \"dataBinding\",\n                \"dataBound\"\n            ]\n        });\n\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    })(window.kendo);\n    var kendo$1 = kendo;\n\n    exports.__meta__ = __meta__;\n    exports.default = kendo$1;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n"]}