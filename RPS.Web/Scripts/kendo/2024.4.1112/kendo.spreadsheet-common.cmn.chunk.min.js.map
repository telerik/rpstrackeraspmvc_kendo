{"version":3,"file":"kendo.spreadsheet-common.cmn.chunk.min.js","names":["global","factory","exports","module","require","define","amd","globalThis","self","kendo","_globals","SpreadsheetCommonCmnChunk","DrawingCmnChunk","DateMathCmnChunk","CommonCmnChunk","JszipEsmCmnChunk","this","kendo_drawing_cmn_chunk_js","kendo_dateMath_cmn_chunk_js","kendo_common_cmn_chunk_js","kendo_jszipEsm_cmn_chunk_js","columnName","colIndex","letter","Math","floor","String","fromCharCode","displaySheet","sheet","test","replace","displayRef","row","col","rel","aa","isFinite","Ref","constructor","type","clone","hasSheet","_hasSheet","simplify","setSheet","absolute","_arow","_acol","relative","_args","adjust","_row","_col","_trow","_tcol","_forRow","_start","_delta","toString","print","forEach","callback","obj","call","map","intersect","_ref","intersects","ref","NULLREF","isCell","toRow","toColumn","first","lastRange","size","rangeAt","_index","nextRangeIndex","previousRangeIndex","eq","reference","r1","r2","CellRef","RangeRef","topLeft","bottomRight","UnionRef","single","refs","refs1","refs2","length","i","len","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","forEachRow","_callback","forEachColumn","axis","sorted","index","indexOf","push","sort","a","b","valid","renameSheet","oldSheetName","newSheetName","toLowerCase","display","NameRef","name","super","ret","trow","tcol","mod","abs","arow","acol","toRangeRef","height","width","leftColumn","rightColumn","topRow","bottomRow","forRow","start","delta","Error","tl","br","endSheet","normalize","_containsRange","range","_containsCell","cell","contains","Array","that","some","Boolean","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","min","tmp","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","intersecting","filter","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","result","resize","options","limit","bind","num","value","top","left","bottom","right","move","rows","cols","tr","slice","x","u","reduce","empty","theRef","join","newRefs","splice","FIRSTREF","SHEETREF","Infinity","messages","nameBox","errors","modifyMerged","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","home","insert","data","cut","copy","paste","merge","unmerge","delete","hide","unhide","bringToFront","sendToBack","defaultSheetName","toolbar","sheetsbar","columns","rowHeight","columnWidth","headerHeight","headerWidth","excel","fileName","forceProxy","proxyURL","pdf","area","paperSize","landscape","margin","title","author","subject","keywords","creator","date","defaultCellStyle","fontFamily","fontSize","useCultureDecimals","locale","ALL_REASONS","recalc","selection","activeCell","layout","sheetSelection","editorChange","editorClose","keys","RX_UNICODE_LETTER","RegExp","memoize","f","cache","Object","create","id","arguments","apply","withExit","Return","ex","getterCache","FIELD_REGEX","getter","field","safe","key","fields","_","indexAccessor","isPresent","idx","deepExtend","destination","deepExtendOne","source","property","propValue","propType","destProp","Date","getTime","isFunction","isPlainObject","support","scrollbar","refresh","isNaN","_scrollbar","div","document","createElement","style","overflow","overflowX","zoom","clear","innerHTML","body","appendChild","offsetWidth","scrollWidth","removeChild","insertAfter","newElement","after","parentNode","insertBefore","nextSibling","isDate","isString","fn","proto","getPrototypeOf","CalcError","code","intlValue","intl","culture","localeInfo","calc","runtime","FUNCS","FUNCS$1","Context","formula","ss","parent","resolve","val","resolveCells","_resolve","error","undefined","isArray","asMatrix","maybeRoundFloatErrors","arrayFormulaRange","_arrayArg","onFormula","context","formulas","loop","add","getRefCells","pending","exec","cellValues","wantNulls","getRefData","Matrix","fetchName","nameValue","Formula$1","ValidationFormulaContext","workbook","isMerged","force","func","fname","args","bool","cells","m","set","line","h","el","isRange","each","r","c","Number","hiddenInfo","getData","argmax","end","pos","v","get","getNA","includeEmpty","eachRow","eachCol","mapRow","mapCol","JSON","stringify","transpose","unit","n","j","multiply","s","va","vb","adds","sign","y","determinant","C","L","k","d","t","inverse","augment","imax","sameRef","Formula","handler","printer","absrefs","onReady","setArrayFormulaRange","forceRefs","lcsheet","deepClone","parentContext","ctx","level","next","setTimeout","reset","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","prevRefs","newRef","prevRange","compileArgumentChecks","functionName","forced","arrayArgs","main","haveForced","canBeArrayArg","hasArrayArgs","comp","cond","charAt","substr","allowError","typeCheck","Function","limitPrecision$1","forceNum","round","err","digits","parseInt","toPrecision","withErrorHandling","makeSyncFunction","check","doit","xargs","arrays","makeAsyncFunction","count","makeCallback","unshift","dateToJulianDays","co","th","comatrix","thmatrix","elmatrix","sqrt","BASE_DATE","DAYS_IN_MONTH","ORDINAL_ADD_DAYS","isLeapYear$1","yr","daysInMonth$1","mo","unpackDate$2","serial","l","jd","year","month","day","ord","packDate$2","MS_IN_MIN","MS_IN_HOUR","unpackTime$1","frac","ms","hours","minutes","seconds","milliseconds","packTime$1","hh","mm","ParseError","message","Node","node","NullNode","packDate","unpackDate","packTime","unpackTime","serialToDate","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","daysInMonth","validDate","da","isLeapYear","daysInYear","parseDate","str","format","formatting","makeDateFormat","parseExactDate","limitPrecision","defineBuiltinFunction","isAsync","impl","defineAlias","alias","orig","kendoSpreadsheetAliases","InputStream","input","peek","eof","croak","readWhile","predicate","readEscaped","escaped","ch","lookingAt","rx","skip","forward","msg","prototype","remove","attr","text","nodeName","children","NULL_NODE","Element","TextNode","nodeValue","HtmlNode","html","element","attrs","text$1","Tree","root","appendTo","render","cached","cachedChildren","cachedLength","replaceChild","syncAttributes","removeAttributes","cachedAttr","cachedValue","setStyle","setAttribute","removeStyle","cachedStyle","removeAttribute","cssText","className","createTextNode","nodes","lastChild","HTML_CONTAINER","firstChild","insertHtml","child","dom","RX_COLORS","RX_CONDITION","parse$2","decimalPart","sections","haveConditional","sec","readSection","op","maybeColor","readFormat","tok","prev","readNext","part","maybeFraction","fraction","sep","decimal","split","am","pm","color","parseFloat","custom","maybeCondition","runtime$1","padLeft","calendar","days","abbreviated","wide","months","narrow","ampm","fraclen","toFixed","eltime","fill","formatInt","parts","declen","lastPart","shouldInsertMinus","iv","skipMinus","numbers","symbols","group","chf","formatDec","decimals","last","intpart","decpart","exp","padRight","digNumber","pow","compileFormatPart","ahead","restart","TokenStream2","hasDate","hasTime","hasAmpm","percentCount","currency","scaleCount","separeThousands","intFormat","decFormat","condition","checkComma","hidden","intPart","decPart","isNegative","checkCondition","matchedCurrency","output","percentSign","shift","TEXT","compile","localCulture","section","tree","found","toUpperCase","fmt","parse","span","__dataType","visibility","textAndColor","adjustDecimals","diff","ast","adjusted","out","printToken","print$1","spreadsheet","createKendoObj","OPERATORS_STANDARD","OPERATORS_COMMA","ops","cls","OPERATORS","SEPARATORS","DEC","ARG","COL","setDecimalSeparator","withDecimalSeparator","save","_separators","TRUE","FALSE","getcol","charCodeAt","getrow","parseFormula","is","TokenStream","parseExpression","addReference","allowEOF","commas","maybeBinary","parseAtom","parseFuncall","parseArray","upper","maybePercent","my_prec","his_prec","makePrinter","prec","withParens","parenthesize","arg","td","needParens","evFuncAnd","evaluate","evFuncOr","evFunc","evFuncIf","evArguments","evRef","evUnary","evBinary","evMatrix","FORMULA_CACHE","makeFormula","hash","makeInterpreter","identity$1","tokens","isDigit","isIdStart","isUnicodeLetter","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","quote","space","isWhitespace","getRC","readSymbol","readString","readSheetName","readOperator","readPunc","forEditor","begin","EOF","RawTokenStream","token","fixCell","addPos","thing","startToken","endToken","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","e","g","FORMAT_PARSERS","registerFormatParser","p","parseNameDefinition","def","nameRef","defAST","parseReference","noThrow","OUT","stream","parseSqref","tokenize","existingFormat","patterns","monthFirst","intlService","comma","dot","localeCurrency","currencies","rxnum","NUMBER_FORMAT_RX","getNumberRegexp","rxcur","suffix","has_currency","has_percent","repeat","FormulaContext","fsheet","frow","fcol","sheetByName","sheetIndex","states","sheetByIndex","_grid","startCellIndex","cellRefIndex","endCellIndex","values","_properties","iterator","at","_displayString","arrayRange","tlRow","tlCol","vrow","vcol","_value","clearTimeout","_formulaContextRefresh","batch","KEY_NAMES$1","EventListener","target","observer","handlers","_handlers","_observer","window","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","_attachEvent","documentElement","on","events","eventType","addEventListener","_removeEvent","removeEventListener","altKey","handleEvent","event","keyCode","isAlphaNum","keyName","rightClick","which","button","pageX","pageY","dx","dy","eventKey","navigator","platform","metaKey","ctrlKey","shiftKey","catchAllHandler","destroy","alphaNumRegExp","ACTIONS","up","down","pageup","pagedown","ENTRY_ACTIONS","tab","enter","backspace","CONTAINER_EVENTS","wheel","contextmenu","mousemove","CLIPBOARD_EVENTS","mouseup","EDITOR_EVENTS","esc","FORMULABAR_EVENTS","assign","focus","FORMULAINPUT_EVENTS","SELECTION_MODES","rowheader","columnheader","topcorner","autofill","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","view","container","clipboardElement","clipboard","scroller","tabstrip","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","listener","scrollHandler","onScroll","mouseDownHandler","onMouseDown","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","executeCommand","_execute","enable","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_workbook","execute","command","trigger","_preventNavigation","reason","deactivate","showError","openDialog","_activeTooltip","activeSheet","onContextMenuSelect","item","getAttribute","drawing","_sheet","_activeDrawing","removeSheet","isAddButton","insertSheet","canInsertRef","oldIndex","activeSheetName","moveSheetToIndex","newIndex","axisManager","onCommandRequest","_viewPortHeight","clientHeight","isActive","isEditorDisabled","resetEditorValue","nameForRef","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","preventDefault","onAction","action","moveActiveCell","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","selectAll","undoRedoStack","redo","undo","disabled","casual","activateEditor","navigateInSelection","onShiftAction","modifySelection","appendSelection","onMouseMove","resizingInProgress","selectionInProgress","object","objectAt","positionResizeHandle","removeResizeHandle","_renderComment","pane","originFrame","_startResizingDrawing","stopPropagation","startBox","drawingBoundingBox","startDragging","triggerChange","dragging","onEditorEsc","openCustomEditor","_setFormulaSelections","highlightedRefs","startSelection","_selectionMode","startResizing","openFilterMenu","handle","closest","location","translateCoords","direction","startX","startY","onContextMenu","draggingInProgress","selectForContextMenu","selectDrawingForContextMenu","isComposite","select","showUnhide","showUnmerge","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","selectionIncludesMergedCells","objectRef","targetType","originalEvent","prevent","constrainResize","resizeHandle","resizeHandlePosition","_dragDrawing","drag","aspect","offsetY","offsetX","onMouseDrag","clientX","clientY","resizeHintPosition","selectToLocation","frame","scrollTop","startAutoScroll","onMouseUp","completeResizing","completeDragging","completeSelection","stopAutoScroll","activeEditor","refAtPoint","onDblClick","sel","onCut","menuInvoked","clipBoardValue","_pasteImage","blob","img","Image","src","URL","createObjectURL","onload","revokeObjectURL","onPaste","plain","clipboardData","files","file","trim","external","hasHTML","hasPlainText","DOMStringList","types","items","kind","getAsFile","onCopy","scrollLeft","scrollRight","box","getBoundingClientRect","noDrawing","loc","cellLocation","extendSelection","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","column","filterColumn","filterMenu","createFilterMenu","close","openFor","_saveEditorValue","arrayFormula","_range","isInEditMode","_lastEditorValue","onEditorArrayFormula","onEditorBarFocus","activate","rect","activeCellRectangle","tooltip","onEditorCellFocus","scale","insertNewline","onEditorBlur","defaultPrevented","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","_inputForRef","intersectingArrayFormula","onDialogRequest","additionalOptions","pdfExport","excelExport","ev","RangeTreeNode","NilNode","skew","temp","heir","ValueRange","RangeTree","findrange","ranges","RangeList","firstRange","pop","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","expValues","sourceStart","sourceEnd","targetStart","intValues","Iterator","getState","setState","state","toJSON","fromJSON","vals","unique","SparseRangeList","_defaultValue","lastRangeStart","Property","list","dst","JsonProperty","propertyBagSpec","sortable","serializable","formats","depends","PropertyBag","rowCount","columnCount","defaultValues","cellCount","specs","properties","lists","spec","cloneFormulaTree","validation","_resize","new_rows","new_cols","old_rows","cell_count","scaleIndex","scaleNode","si","prop","iter","iterators","hBorders","leftBorders","rightBorders","addBorder","forEachProperty","cloneFormulaValue","ALL_PROPERTIES","DATE_FORMAT","Validation","from","to","dataType","comparerType","allowNulls","fromIsDateValue","toIsDateValue","showButton","fromIsListValue","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","from_value","to_value","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","_getListData","cube","array","_getOptions","optionsResult","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","validationExport","validationHandler","parsedFromDate","parsedToDate","validationComparers","valueToCompare","toValue","resultOptions","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","measureText","PROPERTIES","Range$1","Range","skipHiddenCells","skipHiddenRows","isHiddenRow","skipHiddenCols","isHiddenColumn","_normalize","partition","_set","noTrigger","topLeftRef","forEachMergedCell","isValue","_get","_property","_resizedRef","existingFormatType","t1","intlVal","_useCultureDecimals","exit","__","_forFormulas","intersection","canEditArrayFormula","_getValidationState","ci","ri","_validation","_merge","mergedCells","_mergedCells","mergedRef","vi","props","isAutofill","setProp","propName","isFilteredRow","includes","clearAll","contentsOnly","formatOnly","keepBorders","wrap","clearContent","clearFormat","isSortable","cantSort","mc","_getMergedCells","primary","secondary","cant","merged","hasMerged","_sortBy","ascending","isFilterable","clearFilters","_filterBy","clearFilter","_filter","hasFilter","intersectingMerged","propertyName","origRef","_rows","forEachCell","cellState","dr","dc","origin","rowDelta","colDelta","internalClipboard","isExternal","externalClipboard","_adjustRowHeight","rowRange","_columns","sum","textHeight","measureBox","setProperty","styles","baselineMarkerSize","normalizeText","getTextHeight","hasValue","defStyle","_defaultCellStyle","flag","draw","insideBorders","insideVerticalBorders","insideHorizontalBorders","ERR_INCOMPATIBLE","FillError","linearRegression","N","mx","my","s1","s2","findSeries","series","getType","forEachSeries","findStep","q","lst","strl","stringLists","findStringList","match","console","_previewFillFrom","srcRange","destRange","dest","horizontal","descending","hint","srcIdx","fillFrom","STRING$1","FUNCTION","_defaultPrevented","isDefaultPrevented","Observable","_events","eventName","one","original","eventNames","handlersIsFunction","unbind","sender","Widget","setOptions","_setEvents","getSize","currentSize","_size","offsetHeight","SheetEditor","formulaBar","_active","barInput","formulaInput","cellInput","syncWith","_triggerUpdate","_blur","activeElement","_activeElement","viewWidth","scrollerElement","scrollbarWidth","viewElement","_rect","position","querySelector","clientWidth","maxWidth","noChange","inputType","popup","visible","isKeyboardAction","toggleTooltip","oldRect","newRect","isArrayFormula","classList","toggle","ampRegExp","ltRegExp","quoteRegExp","aposRegExp","gtRegExp","Axis","_count","_hidden","scrollBarSize","_refresh","positions","includesHidden","nextVisible","nextUntil","pred","advanced","nextPage","pageSize","prevPage","firstVisible","firstHidden","lastVisible","lastHidden","prevVisible","prevUntil","locate","startSegment","endSegment","lastPage","total","_pixelValues","offset","startOffset","startIndex","endOffset","endIndex","current","indexVisible","nowCount","PaneAxis","headerSize","_axis","hasHeader","defaultValue","frozen","viewSize","_viewSize","paneSegment","Rectangle","intersectsRect","toDiv","Grid","_headerHeight","_headerWidth","isAxis","totalHeight","totalWidth","cellRef","rowRef","colRef","rectangle","PaneGrid","rangeDimensions","rangeRef","grid","hasRowHeader","hasColumnHeader","rowOffset","columnOffset","mergedCellLeft","mergedCellTop","boundingRectangle","scrollBoundaries","widthCompensation","heightCompensation","scrollBottom","Sorter","_lists","ascendingComparer","descendingComparer","sortBy","li","typeA","typeB","localeCompare","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHiddenRows","deleteSelectedColumns","indexes","_saveModifiedFormulas","deleteColumn","deleteSelectedRows","deleteRow","hideSelectedColumns","hideColumn","hasRight","hasLeft","hideSelectedRows","hideRow","hasBottom","hasTop","unhideSelectedColumns","unhideColumn","unhideSelectedRows","unhideRow","addColumnLeft","base","insertColumn","addColumnRight","addRowAbove","selectedRows","insertRow","addRowBelow","AutoFillCalculator","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","lower","further","bottomLeft","topRight","EdgeNavigator","rangeGetter","prevLeft","nextRight","nextLeft","prevRight","boundary","SheetNavigator","autoFillCalculator","colEdge","columnRange","rowEdge","unionWithMerged","leftCol","rightCol","setSelectionValue","_sheetRef","mode","addToExisting","refForMode","startAutoFill","scrollInto","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","makeWordMovement","newSelection","updateCurrentSelectionRange","originalActiveCell","selTopLeft","selBottomRight","isFirstCell","isLastCell","setSelection","currentNavigationRange","done","navigatedAway","singleCellSelection","nextNavigationRange","_view","previousNavigationRange","shouldSkip","resizeAutoFill","_autoFillOrigin","punch","preview","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","isCol","firstVal","numberToDate","identity","o","SheetDataSourceBinder","acc","_normalizeColumns","_dataSource","_header","_boundRowsCount","dataSource","fetch","_sheetChangeHandler","_sheetChange","_sheetDeleteRowHandler","_sheetDeleteRow","_sheetInsertRowHandler","_sheetInsertRow","model","getters","normalizedRef","normalizedRefs","setValues","record","valueIndex","colValueIndex","currentValue","reader","_skipRebind","_changeHandler","_progressHandler","_errorHandler","_change","_requestStart","_error","createSheetDataSource","_progress","getterIdx","kendoDate","today","dayOfWeek","isToday","addDays","firstDayOfMonth","logic","or","and","operatorsMap","doesnotcontain","doesnotendwith","doesnotstartwith","lastIndexOf","endswith","gt","gte","isempty","isnotempty","isnotnull","isnull","lt","lte","neq","startswith","dateRegExp","transformFilter","ignoreCase","operator","accentFoldingFiltering","itemProp","typedGetter","toLocaleLowerCase","convertValue","isNumeric","transformCompositeFilter","combiner","filters","extendedFilter","filtersObj","dateToSerial$1","serialToDate$1","Filter","prepare","matches","substring","ValueFilter","_values","_dates","_blanks","blanks","dates","CustomFilter","_logic","criteria","_criteria","_matches","criterionValue","criterionType","valueType","TopFilter","_type","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","yesterday","nextWeek","sameWeek","thisWeek","lastWeek","nextMonth","sameMonth","thisMonth","lastMonth","nextQuarter","quarter","thisQuarter","lastQuarter","nextYear","sameYear","thisYear","lastYear","yearToDate","initDynamicFilter","setFullYear","setMonth","firstWeek","secondWeek","MODIFIED_FORMULAS","Selection","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","panes","_currentView","EDITORS","Sheet","_reinit","activeCellCustomEditor","background","italic","bold","underline","verticalAlign","textAlign","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","_sorter","_viewSelection","_editSelection","_formulaSelections","_drawings","newRows","newCols","oldRows","oldCols","_resizeAddRow","_resizeAddColumn","_resizeDeleteRow","_resizeDeleteColumn","_resizeForJSON","colCount","_selectionState","_inEdit","_navigator","_axisManager","_name","_sheetName","_state","_sheetState","accessor","_field","suspendChanges","_valueChanged","setDataSource","dataSourceBinder","columnIndex","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_restoreModifiedFormulas","wb","_adjustReferences","_sheets","_forValidations","adjustNames","topLeftCell","rowIndex","skipDataSourceInsert","frozenRows","nextRef","isEnabledRow","skipDataSourceDelete","frozenColumns","isEnabledColumn","_filterRow","showGridLines","gridLinesColor","numRows","numColumns","forEachFilterHeader","columnRef","forEachRange","doIt","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","_draggingInProgress","hintPosition","handlePosition","_visualRange","comment","_commentRef","_resizeHandlePosition","_resizeHintPosition","refBox","refBoundingBox","previous","_selectionInProgress","operatingRange","expandedRef","selectionState","trims","_focus","activeCellSelection","selectedHeaders","allCols","allRows","maxRow","maxCol","rowState","colState","rowSelection","colSelection","all","isInEdit","_viewActiveCell","viewSelection","hyperlinks","clearDefaultStyle","link","toCss","borderTop","borderBottom","borderRight","borderLeft","json","drawings","_sort","_compileFormula","_compileValidation","Drawing","activeCellRef","_refreshFilter","resetFormulas","resetValidations","revalidate","curValidation","_copyValuesInRange","suspended","filterRef","_clearFilter","getAxisState","setAxisState","currentRef","withCultureDecimals","addDrawing","drw","removeDrawing","usesImage","image","opacity","anchor","PAPER_SIZE","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c0","c3","c4","c5","c6","c7","c8","c9","c10","executive","folio","legal","tabloid","mm2pt","cm2pt","cm","in2pt","inch","unitsToPoints","in","CONT","GUIDELINE_WIDTH","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","ceil","doLayout","wholeRect","rowHeights","colWidths","relrow","relcol","rh","cw","forScreen","rowspan","colspan","nonEmpty","dBorders","shouldDrawCell","emptyCells","pageWidth","scaleFactor","fitWidth","hyCoords","yCoords","xCoords","boxWidth","boxHeight","headerCells","orlast","orderCoords","orderCells","sameBorder","drawLayout","ncols","nrows","addPage","endbottom","endright","isInside","page","G","append","content","clip","fromRect","R","matrix","M","multiplyCopy","translate","hCenter","vCenter","transform","guidelines","moveTo","lineTo","stroke","guideColor","borders","Borders","r2d2","B","boxSizing","lineHeight","padding","font","makeFontDef","textDecoration","applyIndent","whiteSpace","overflowWrap","wordWrap","vtrans","textGroup","D","drawText","drawCell$1","bordersGroup","vert","rendered","horiz","url","imageUrl","indent","paddingLeft","paddingRight","drawFn","center","paper","getOption","getPaperOptions","multiPage","autoPrint","Container","addVert","border","addHoriz","pb","_context","DOT","viewClassNames","fixedContainer","editContainer","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonSelected","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","sheetsBarActive","sheetsBarInactive","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","paneClassNames","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCell","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","resizeHint","resizeHintHandle","resizeHintMarker","resizeHintVertical","selectionHighlight","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","href","shouldDraw","defaultBorder","toHSV","toCssRgba","outline","fontStyle","fontWeight","classNames","Pane","getIconHTMLString","isVisible","_currentRect","_rectangle","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","headerClassName","renderResizeHandle","paneClasses","itemSelection","allHeaders","cont","borderColor","activeCellRange","absRow","absCol","_activeFormulaColor","_directionClasses","ttOffset","contentWidth","toplevelElements","borderWidth","renderDrawings","backgroundImage","drawingResizeHandles","RESIZE_HANDLE_WIDTH","filterIconRect","_addDiv","filtered","classes","selections","colorClass","selectionClasses","_renderCustomEditorButton","autoFillRectangle","cssClass","ed","btnClass","isLastColumn","_buttonOutOfVisiblePane","_editorInLastColumn","btn","activeFormulaSelection","colorClasses","active","cellClasses","theGrid","KEY_NAMES","PRIVATE_FORMULA_CHECK","FormulaInput","opt","autoScale","filterOperator","scalePadding","minLength","formulaBarWidth","wrapper","_highlightedRefs","_formulaSource","_formulaList","_tooltip","_sync","_keydown","_keyup","_input","_paste","getPos","getSelection","lookup","focusNode","focusOffset","anchorNode","anchorOffset","collapsed","lookupNode","nodeType","setPos","eiv","_setRange","createRange","setStart","setEnd","currentRange","getRangeAt","startContainer","endContainer","removeAllRanges","addRange","formulaSource","itemClick","_formulaListChange","tokenCtx","_tokenContext","_mute","activeToken","completion","nextToken","_replaceAt","_focusId","_isFormula","_navigated","_move","_keyDownTimeout","_syntaxHighlight","focusFirst","_focusTimeout","focusNext","focusPrev","focusIndex","focusLast","point","touches","_editorToSync","_textContainer","computedStyles","computedStyle","defaultView","getComputedStyle","getPropertyValue","currentStyle","strMatch","g1","hasOwnProperty","kendoGetComputedStyles","_span","_cellTooltip","show","_activeElement$1","startsWith","_canInsertRef","strictMode","canReplace","afterPoint","canInsertBetween","isOpenParen","newValue","rest","innerText","textContent","txt","refClasses","refIndex","parens","open","isMatchingParen","reverse","htmlEncode","listWrapper","FormulaBar","formulaInputDiv","NameEditor","readData","forEachName","combobox","SheetsBar","onSheetReorderEnd","onSheetRemove","removedSheetName","confirmation","onSheetSelect","selectedSheetText","onSheetRename","onAddSelect","HtmlTable","trs","_height","_width","addColumn","addRow","addCell","toDomTree","role","within","View","_chrome","_dialogs","_formulaInput","firstElementChild","clipboardContents","_sheetsbar","createContextMenus","enableClipboard","isClipboardDeactivated","nameBoxRef","formulaBarInputRef","_tabstrip","formulaCellInputRef","createSheetBar","openDialogCallback","createTabStrip","_executeCommand","cellRectangle","isColumnResizer","w","isRowResizer","isFilterIcon","isAutoFill","isEditButton","drawingAt","drx","dry","paneAt","selecting","containingPane","_pane","_destroyFilterMenu","_filterMenu","selectClipboardContents","preventScroll","selectNodeContents","selectElementContents","scrollIntoView","willScroll","_destroyDialog","edit","editRange","dialog","reopenEditor","currentDialogs","errorMessages","onClose","dialogOptions","scrollbarSize","contentHeight","resizeDirection","renderResizeHint","renderClipboardContents","status","canCopy","multiSelection","table","selectionView","primaryMergedCells","secondaryMergedCells","backgroundColor","borderRightColor","borderBottomColor","sdval","sdnum","sibling","cellBefore","borderLeftColor","prevRow","cellAbove","borderTopColor","_uid","reTable","tables","contentStr","Clipboard","_content","_externalContent","_internalContent","iframe","random","chars","guid","canPaste","pasteRef","pasteOnMerged","pasteOnDisabled","intersectsMerged","originActiveCell","_isInternal","newState","setStateData","parseTSV","doc","contentWindow","write","program","head","richState","vBorders","rowSpan","colSpan","ignoreColspan","parseHTML","rowData","colData","uid","includeUid","tablesArr","foreign","stripStyle","isExcel","borderObject","txtElem","COMMAND_TYPES","noop","Command","rejectState","validationState","_forEachCell","DrawingUpdateCommand","_drawing","_orig","_previous","DrawingCommand","InsertImageCommand","_blob","addImage","DeleteDrawingCommand","ReorderDrawingsCommand","_origIndex","_newIndex","_reorder","BringToFrontCommand","SendToBackCommand","TargetValueCommand","_target","ColumnWidthCommand","RowHeightCommand","HyperlinkCommand","_link","_prevLink","_prevUnderline","_hasSetValue","GridLinesChangeCommand","PropertyChangeCommand","PropertyCleanCommand","ClearContentCommand","rowValues","nullValues","changeType","EditCommand","_editRange","_exec","InsertCommentCommand","TextWrapCommand","_rowHeight","AdjustDecimalsCommand","BorderChangeCommand","_style","_batch","noBorders","outsideBorders","allBorders","leftBorder","rightBorder","topBorder","bottomBorder","MergeCellCommand","horizontally","vertically","FreezePanesCommand","_topLeft","unfreeze","PasteCommand","_clipboard","_event","_clipboardContent","_targetRangeRefs","clipboardContent","_processPaste","_adjustPasteTarget","multipliers","sourceRows","sourceCols","refToSelect","rangeToSelect","multiplier","targetRangeRefs","compare","topLeftA","topLeftB","sourceData","_targetRanges","_populateTargetRange","_targetRangeDimensions","targetRangeRows","targetRangeCols","rowsMultiplier","colsMultiplier","AdjustRowHeightCommand","ToolbarPasteCommand","detectClipboardAccess","execCommand","CutCommand","_eventType","rangeValues","currentRow","CopyCommand","queryCommandSupported","ToolbarCopyCommand","cannotUndo","AutoFillCommand","_origin","autoFillData","ToolbarCutCommand","FilterCommand","SortCommand","expandRange","ApplyFilterCommand","filterRule","exists","valueFilter","customFilter","ClearFilterCommand","HideLineCommand","UnHideLineCommand","DeleteCommand","_expandedRange","_expand","_indexes","_undoOne","DeleteRowCommand","DeleteColumnCommand","AddCommand","_pos","AddColumnCommand","AddRowCommand","EditValidationCommand","OpenCommand","fromFile","excelImportErrors","SaveAsCommand","extension","saveAsExcel","saveAsPDF","NameCommand","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","commands","freeze","__proto__","UndoRedoStack","stack","currentCommandIndex","canUndo","canRedo","STRING","ENTITIES","amp","quot","apos","nbsp","CODE","UCS2","START_CDATA","END_CDATA","END_COMMENT","START_COMMENT","END_SHORT_TAG","END_TAG","END_DECLARATION","QUESTION_MARK","LESS_THAN","GREATER_THAN","SEMICOLON","EQUAL","AMPERSAND","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","EXIT","parse$1","callbacks","selector","$tag","readChar","readAsciiWhile","skipWhitespace","eat","isHexDigit","isNameStart","isName","xmlTag","xmlName","xmlAttrs","xmlComment","xmlEntity","xmlContent","xmlString","what","arg1","arg2","parseXML","Deferred","_progressHandlers","_resolved","_rejected","promise","Promise","reject","_reject","notify","progress","then","onFulfilled","onRejected","onProgress","MAP_EXCEL_OPERATOR","greaterThanOrEqual","lessThanOrEqual","ERROR_LOG","readExcel","deferred","FileReader","async","J","loadAsync","zip","strings","leave","SEL_SHARED_STRING","SEL_TEXT","readStrings","relationships","readRelationships","theme","scheme","colorScheme","xl","tag","SEL_SCHEME_SYSCLR","toCSSColor","SEL_SCHEME_RGBCLR","swap","arr","readTheme","byType","fonts","numFmts","fills","namedStyles","inlineStyles","xf","getXf","borderId","integer","fillId","fontId","numFmtId","pivotButton","quotePrefix","xfId","addBool","protection","locked","getColor","defaultThemeColor","rgb","indexed","INDEXED_COLORS","themeColor","tint","toHSL","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","diagonalUp","diagonalDown","diagonal","side","SEL_NAMED_STYLE","SEL_INLINE_STYLE","vertical","wrapText","readStyles","SEL_SHEET","relId","byId","dim","bytes","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","SEL_CELL","sheetDimensions","SEL_VIEW","activeTab","SEL_DEFINED_NAME","vbProcedure","localSheetId","withErrorLog","loading","sheets","recalcSheets","ready","entry","queueSheet","loadSheets","readWorkbook","readAsArrayBuffer","SEL_COL","SEL_FORMULA","SEL_MERGE","SEL_PANE","SEL_SELECTION","SEL_STRING","SEL_VALUE","SEL_SHEET_VIEW","SEL_HYPERLINK","SEL_PROTECTION","SEL_VALIDATION","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_INSANE","SEL_VALIDATION_SQREF_INSANE","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2_INSANE","SEL_COMMENT","SEL_AUTHOR","SEL_COMMENT_TEXT","formulaRange","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","sharedFormulas","nCols","prevCellRef","relsFile","deferredStyles","styleIndex","sty","stop","ht","acRef","xSplit","ySplit","addAutoFilter","colId","ourOp","equal","notEqual","getFilterVal","getCustomFilter","dynamicFilterType","percent","blank","sqref","showErrorMessage","allowBlank","showDropDown","errorTitle","shouldSet","setBorder","setFont","setFill","setFormat","DEFAULT_FORMATS","formatCode","BORDER_WIDTHS","applyName","applyStyle","comments","commentFile","relative_file","authors","authorId","readComments","drawingFile","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","relkeys","getContentType","getFileName","File","Blob","excelToPixels","cx","cy","colOffset","brCell","brX","brY","readDrawings","readSheet","pts","filename","jpg","jpeg","png","gif","wmf","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","Id","Target","Type","entries","names","promises","events$1","loadBinary","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","Workbook","_images","_imgID","_sheetsSearchCache","_onUndoRedo","_validationContext","_names","_sheetChanging","_sheetInsertColumn","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetProgress","_sheetCommandRequest","commandOptions","getWorkbookCommand","cleanupImages","toIndex","fromIndex","sheetName","insertIndex","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","nameref","newSheet","_clearSheets","_loadImages","ids","images","sheetParamsFromJSON","localName","saveJSON","readAsDataURL","_readExcel","toDataURL","toBlob","saveAs","packDate$1","unpackDate$1","equals","binaryCompare","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","parseCriteria","fetchSumRange","continuation","sumRange","_extreme","nth","order","_avg","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","_covariance","ax","ay","$a","$b","toResolve","$value","$m","$n","cos","sin","acos","asin","tan","atan","log","$num","$base","PI","$radians","rad","$degrees","deg","$x","$y","$number","$significance","$mode","$multiple","mult","$digits","$numbers","prod","$a1","$a2","coef","$values","seen","$args","$m1","$c1","$m2","$c2","m1","$range","numericPredicate","$criteria","$sumRange","$array","$nth","res","$percent","discard","$data","$bins","bins","$order","asc","variance","stddev","significance","$array1","$array2","_fact","fact","_combinations","f1","f2","p1","p2","_percentile","rank","_percentile_inc","_percentile_exc","$k","$p","$quarter","AGGREGATE_FUNCS","fetchValuesForAggregate","fetchValues","_binom_dist","cumulative","weeksInYear","_days_360","method","d1","d2","$funcId","$options","funcId","$ref","ignoreHidden","$successes","$trials","$probability","$cumulative","$alpha","alpha","$successes_min","$successes_max","$number_f","$number_s","$probability_s","$row","$col","$abs","$sheet","$index","$approx","approx","resultCol","$areanum","areanum","colRange","$thing","$type","cmp","$rows","$cols","$height","$width","resultRow","$year","$month","$date","fw","sy","dow","wk","$hours","$minutes","$seconds","$time","$start_date","$months","$days","$holidays","holidays","inc","$end_date","$method","$text","$min","$max","literals","roman","arabicToRoman","$roman","rom","romanToArabic","$radix","$minLen","radix","minLen","$code","RX_NON_PRINTABLE","Hyperlink","$decimals","dec","denomitator","$text1","$text2","$substring","$string","$start","string","$noCommas","noCommas","$length","$newText","newText","$oldText","oldText","$format","$link","$value_if_error","valueIfError","RXCACHE","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","$lower_limit","$upper_limit","ll","ul","ERF","ERFC","GAMMALN","GAMMA","$beta","GAMMA_DIST","GAMMA_INV","$z","NORM_S_DIST","NORM_S_INV","$mean","$stddev","NORM_INV","$A","$B","betastd_cdf","cdf","BETALN","betastd_pdf","BETA_INV","$deg_freedom","chisq_left","chisq_right","chisq_left_inv","$actual_range","$expected_range","ac","obsv","expect","eij","chisq_test","$lambda","lnf","$deg_freedom1","$deg_freedom2","Fdist","arr1","arr2","n1","n2","va1","_var_sq","_mean","va2","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","$tails","gr1","gr2","tail","t_st","df","md","m2","v1","v2","u1","u2","q1","q2","f_abs","$standard_dev","$size","z","$x_range","$prob_range","x_","p_","lw","$known_y","$known_x","y_","pearson","s3","t2","$const","$stats","linest","Y","X","konst","stats","$new_x","trend","new_X","$rate","$nper","$pmt","$pv","FV","$fv","rate","nper","pmt","fv","h1","PMT","pv","$guess","guess","root_newton","h2","$per","IPMT","per","$start_period","$end_period","tn","ts","te","monthlyPayment","cip","flows","npv","npv1","$nominal_rate","$npery","nominal_rate","npery","$effect_rate","effect_rate","$dates","$cost","$salvage","$life","$period","cost","salvage","life","period","db","$factor","factor","prior","dep","$no_switch","no_switch","interest","_getGDA","gda","oldValue","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","$settlement","$maturity","$frequency","$basis","settlement","maturity","frequency","basis","_daysBetween","_borderCoupons","settl","matur","freq","sett","mat","$issue","$par","issue","par","year_days","daysInYear2","$first_interest","$calc_method","brace","prev1","next1","nrc","accr","annual","_numCoupons","periods","_edate","_borderCoupons_fw","$pr","$redemption","pr","redemption","$investment","investment","$discount","discount","$yld","yld","beg_settl","settl_end","beg_end","den","yf","dsm","MAX_IT","EPS","FP_MIN","S","an","cof","ser","pi","BETA","gamma_inc","ap","gln","g_series","aj","bj","g_contfrac","ab","plow","beta_lentz","del","qab","qam","qap","betastd_inv","cds","me","whipNumberArrays","_mat_mean","Mat","_mat_devsq","mean","sq","Xt","line_1","Y1","y_y1","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","W","max_it","eps","f_d","ipmt","commonEngine","SpreadsheetWidget","options$1","_controller","_autoRefresh","_bindWorkbookEvents","_bindViewEvents","_resizeHandler","_keyDownHandler","_keyDown","controlKey","activeSheetIndex","nextSheetName","prevSheetName","createSheetEditor","_handleTypographicalEmphasis","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","_viewUpdate","_viewMessage","_onContextMenu","dateToNumber","defineFunction","kendoSpreadsheetArgs","argsAsync","registerEditor","__meta__","category","description","chunk"],"sources":["kendo.spreadsheet-common.cmn.chunk.js"],"mappings":"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","ignoreList":[],"sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('kendo.drawing.cmn.chunk.js'), require('kendo.date-math.cmn.chunk.js'), require('kendo.common.cmn.chunk.js'), require('kendo.jszip-esm.cmn.chunk.js')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'kendo.drawing.cmn.chunk', 'kendo.date-math.cmn.chunk', 'kendo.common.cmn.chunk', 'kendo.jszip-esm.cmn.chunk'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.kendo = global.kendo || {}, global.kendo._globals = global.kendo._globals || {}, global.kendo._globals.SpreadsheetCommonCmnChunk = {}), global.kendo._globals.DrawingCmnChunk, global.kendo._globals.DateMathCmnChunk, global.kendo._globals.CommonCmnChunk, global.kendo._globals.JszipEsmCmnChunk));\n})(this, (function (exports, kendo_drawing_cmn_chunk_js, kendo_dateMath_cmn_chunk_js, kendo_common_cmn_chunk_js, kendo_jszipEsm_cmn_chunk_js) {\n  const __meta__ = {\n      id: \"spreadsheet-common.cmn.chunk\",\n      name: \"SpreadsheetCommonCmnChunk\",\n      category: \"web\",\n      description: \"A reusable outputed chunk of code\",\n      depends: ['drawing.cmn.chunk', 'date-math.cmn.chunk', 'common.cmn.chunk', 'jszip-esm.cmn.chunk'],\n      hidden: true,\n      chunk: true\n  };\n\n  /* eslint-disable camelcase */\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable max-params */\n  /* eslint-disable no-unused-vars */\n  /* eslint-disable no-else-return */\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable no-bitwise */\n\n  // WARNING\n  // == into === to make JSHint happy will break functionality.\n\n  function columnName(colIndex) {\n      const letter = Math.floor(colIndex / 26) - 1;\n      return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + (colIndex % 26));\n  }\n  function displaySheet(sheet) {\n      if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n          return sheet;\n      }\n      return \"'\" + sheet.replace(/\\x27/g, \"\\\\'\") + \"'\";\n  }\n  function displayRef(sheet, row, col, rel) {\n      let aa = \"\";\n      ++row;\n\n      if (!isFinite(row)) {\n          row = \"\";\n      } else if (rel != null && !(rel & 2)) {\n          row = \"$\" + row;\n      }\n\n      if (!isFinite(col)) {\n          col = \"\";\n      } else {\n          aa = columnName(col);\n          if (rel != null && !(rel & 1)) {\n              aa = \"$\" + aa;\n          }\n      }\n      if (sheet) {\n          return displaySheet(sheet) + \"!\" + aa + row;\n      } else {\n          return aa + row;\n      }\n  }\n\n  /* -----[ References ]----- */\n\n  class Ref {\n      constructor() {\n          this.type = \"ref\";\n          this.sheet = \"\";\n      }\n\n      clone() {\n          return this;\n      }\n      hasSheet() {\n          return this._hasSheet;\n      }\n      simplify() {\n          return this;\n      }\n      setSheet(sheet, hasSheet) {\n          this.sheet = sheet;\n          if (hasSheet != null) {\n              this._hasSheet = hasSheet;\n          }\n          return this;\n      }\n      absolute(_arow, _acol) {\n          return this;\n      }\n      relative(..._args) {\n          return this;\n      }\n      adjust(_row, _col, _trow, _tcol, _forRow, _start, _delta) {\n          return this;\n      }\n      toString() {\n          return this.relative(0, 0, 3, 3).print(0, 0);\n      }\n      forEach(callback, obj) {\n          callback.call(obj, this);\n      }\n      map(callback, obj) {\n          return callback.call(obj, this);\n      }\n      intersect(_ref) {\n          return this;\n      }\n      intersects(ref) {\n          return this.intersect(ref) !== NULLREF;\n      }\n      isCell() {\n          return false;\n      }\n      toRow(_row) {\n          return this;\n      }\n      toColumn(_col) {\n          return this;\n      }\n      // UnionRef overrides these, to access its subranges.\n      first() {\n          return this;\n      }\n      lastRange() {\n          return this;\n      }\n      size() {\n          return 1;\n      }\n      rangeAt(_index) {\n          return this;\n      }\n      nextRangeIndex(_index) {\n          return 0;\n      }\n      previousRangeIndex(_index) {\n          return 0;\n      }\n      eq(reference) {\n          let r1 = this;\n          let r2 = reference;\n          if (r1 === NULLREF || r2 === NULLREF) {\n              return r1 === r2;\n          }\n          // make positions consistent\n          if ((r2 instanceof CellRef) || (r2 instanceof RangeRef && !(r1 instanceof CellRef))) {\n              r1 = reference;\n              r2 = this;\n          }\n          if (r1 instanceof CellRef) { // cell eq *\n              r2 = r2.simplify();\n              return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n          } else if (r1 instanceof RangeRef) { // range eq range/union\n              if (r2 instanceof RangeRef) {\n                  return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n              }\n              if (r2 instanceof UnionRef) {\n                  return r2.single() && r1.eq(r2.refs[0]);\n              }\n          } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) { // union eq union\n              const refs1 = r1.refs;\n              const refs2 = r2.refs;\n              if (refs1.length != refs2.length) {\n                  return false;\n              }\n              for (let i = 0, len = refs1.length; i < len; i++) {\n                  if (!refs1[i].eq(refs2[i])) {\n                      return false;\n                  }\n              }\n              return true;\n          }\n          return r1 === r2;   // XXX'll support it.\n      }\n      concat(ref) {\n          return new UnionRef([this, ref]);\n      }\n      replaceAt(_index, ref) {\n          return ref;\n      }\n      forEachColumnIndex(callback) {\n          this.forEachAxisIndex('col', callback);\n      }\n      forEachRowIndex(callback) {\n          this.forEachAxisIndex('row', callback);\n      }\n      forEachRow(_callback) {\n          //\n      }\n      forEachColumn(_callback) {\n          //\n      }\n      forEachAxisIndex(axis, callback) {\n          let sorted = [];\n          let method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n\n          this[method](function(ref) {\n              let index = ref.first()[axis];\n              if (sorted.indexOf(index) === -1) {\n                  sorted.push(index);\n              }\n          });\n\n          sorted.sort(function(a, b) {\n              return a > b ? 1 : (a < b ? -1 : 0);\n          }).forEach(callback);\n      }\n      valid() {\n          return false;\n      }\n      renameSheet(oldSheetName, newSheetName) {\n          if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n              this.sheet = newSheetName;\n              return true;\n          }\n      }\n  }\n\n  Ref.display = displayRef;\n\n  /* -----[ Null reference ]----- */\n  class NULLREFClass extends Ref {\n      print() {\n          return \"#NULL!\";\n      }\n      eq(ref) {\n          return ref === this;\n      }\n      forEach() {}\n  }\n  const NULLREF = new NULLREFClass();\n\n  /* -----[ Name reference ]----- */\n\n  class NameRef extends Ref {\n      constructor(name) {\n          super();\n          this.name = name;\n          this.ref = \"name\";\n      }\n\n      clone() {\n          return new NameRef(this.name)\n              .setSheet(this.sheet, this.hasSheet());\n      }\n      print() {\n          let ret = displaySheet(this.name);\n          if (this.hasSheet()) {\n              ret = displaySheet(this.sheet) + \"!\" + ret;\n          }\n          return ret;\n      }\n  }\n\n  /* -----[ Cell reference ]----- */\n\n  class CellRef extends Ref {\n      constructor(row, col, rel) {\n          super();\n          this.row = row;\n          this.col = col;\n          this.rel = rel || 0;\n          this.ref = \"cell\";\n      }\n\n      clone() {\n          return new CellRef(this.row, this.col, this.rel)\n              .setSheet(this.sheet, this.hasSheet());\n      }\n\n      intersect(ref) {\n          if (ref instanceof CellRef) {\n              if (this.eq(ref)) {\n                  return this;\n              } else {\n                  return NULLREF;\n              }\n          }\n          return ref.intersect(this);\n      }\n\n      print(trow, tcol, mod) {\n          let col = this.col, row = this.row, rel = this.rel, abs;\n          if (trow == null && rel) {\n              let sheet = this.hasSheet() ? displaySheet(this.sheet) + \"!\" : \"\";\n              if (isFinite(col)) {\n                  col = rel & 1 ? (\"C[\" + col + \"]\") : (\"C\" + (col + 1));\n              } else {\n                  col = \"\";\n              }\n              if (isFinite(row)) {\n                  row = rel & 2 ? (\"R[\" + row + \"]\") : (\"R\" + (row + 1));\n              } else {\n                  row = \"\";\n              }\n              return sheet + row + col;\n          } else {\n              abs = this.absolute(trow, tcol);\n              if (mod) {\n                  // Hacks`absolute()`\n                  row = abs.row % 0x100000;\n                  col = abs.col % 0x4000;\n                  if (row < 0) {\n                      row += 0x100000;\n                  }\n                  if (col < 0) {\n                      col += 0x4000;\n                  }\n                  return displayRef(this._hasSheet && this.sheet, row, col, rel);\n              }\n              return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : \"#REF!\";\n          }\n      }\n      absolute(arow, acol) {\n          let ret = this.clone();\n          if ((ret.rel & 3) === 0) {\n              return ret;    // already absolute\n          }\n\n          // Hacks0x4000 (max col) and 0x100000 (max row).  This\n          // fixes importing relative references in definedName-s from Excel.  Example in\n          // Excel3, open the Name Manager (in Formula tab) and define name\n          // TEST with value Sheet1!A1:C3.  The serialization of this name in XLSX is:\n          //\n          //     <definedName name=\"TEST\">Sheet1!XFA1048575:XFC1</definedName>\n          //\n          // This is insane, of course, but oh well.  Excel.  If you type in E3 =SUM(TEST) it\n          // works (it actually sums the cells), but if you type =SUM(Sheet1!XFA1048575:XFC1)\n          // you get back zero.  Let's see why SUM(TEST) works:\n          //\n          //     XFA1048575:XFC1                   E3\n          //     (zero-based indexes below)\n          //\n          //     R[1048574]C[16380]:R[0]C[16382] + R2C4 = R1048576C16384:R2C16386\n          //                                            % (0x100000, 0x4000)\n          //                                            = R0C0:R2C2 (== A1:C3)\n          //\n          // So XFA1048575:XFC1 is relocated to E3 at evaluation time, and because we take\n          // rows modulo 0x100000 and cols modulo 0x4000, we get back the correct range.\n          //\n          // IMO Excel should disallow A1-style relative references in name definitions\n          // (simply because the meaning of the A1:C3 you type in Name Manager depends on the\n          // active cell) and only allow R1C1 notation — that's unambiguous.  But it doesn't.\n          // Moreover, R1C1-style refs in XLSX are explicitly forbidden by the spec, and the\n          // hacks above are not documented — how else could we have fun implementing a XLSX\n          // reader?\n          if (ret.rel & 1) {\n              // relative col, add anchor\n              ret.col = (ret.col + acol) % 0x4000;\n          }\n          if (ret.rel & 2) {\n              // relative row, add anchor\n              ret.row = (ret.row + arow) % 0x100000;\n          }\n\n          ret.rel = 0;\n          return ret;\n      }\n      toRangeRef() {\n          return new RangeRef(this, this);\n      }\n      relative(arow, acol, rel) {\n          if (rel == null) {\n              rel = this.rel;\n          }\n          let row = rel & 2 ? this.row - arow : this.row;\n          let col = rel & 1 ? this.col - acol : this.col;\n          return new CellRef(row, col, rel)\n              .setSheet(this.sheet, this.hasSheet());\n      }\n      height() {\n          return 1;\n      }\n      width() {\n          return 1;\n      }\n      toString() {\n          return displayRef(null, this.row, this.col, 3);\n      }\n      isCell() {\n          return true;\n      }\n      leftColumn() {\n          return this;\n      }\n      rightColumn() {\n          return this;\n      }\n      topRow() {\n          return this;\n      }\n      bottomRow() {\n          return this;\n      }\n      forEachRow(callback) {\n          callback(this.toRangeRef());\n      }\n      forEachColumn(callback) {\n          callback(this.toRangeRef());\n      }\n      adjust(row, col, trow, tcol, forRow, start, delta) {\n          let ref = this.absolute(row, col);\n          if (forRow) {\n              if (ref.row >= start) {\n                  if (delta < 0 && ref.row < start - delta) {\n                      return NULLREF;\n                  }\n                  ref.row += delta;\n              }\n          } else {\n              if (ref.col >= start) {\n                  if (delta < 0 && ref.col < start - delta) {\n                      return NULLREF;\n                  }\n                  ref.col += delta;\n              }\n          }\n          if (trow != null && tcol != null) {\n              ref = ref.relative(trow, tcol, this.rel);\n          }\n          return ref;\n      }\n      valid() {\n          if (this.rel) {\n              throw new Error(\"valid() called on relative reference\");\n          }\n          let col = this.col, row = this.row;\n          return !((isFinite(col) && col < 0) || (isFinite(row) && row < 0));\n      }\n  }\n\n  /* -----[ Range reference ]----- */\n\n  class RangeRef extends Ref {\n      constructor(tl, br) {\n          super();\n          this.ref = \"range\";\n          if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n              // \"3D\" reference\n              this.endSheet = br.sheet;\n          }\n          // we want to drop any sheet information from the cells here.\n          this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n          this.bottomRight = new CellRef(br.row, br.col, br.rel);\n          this.normalize();\n      }\n      clone() {\n          return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n      }\n      _containsRange(range) {\n          return this._containsCell(range.topLeft)\n                  && this._containsCell(range.bottomRight);\n      }\n      _containsCell(cell) {\n          return cell.sheet == this.sheet\n                  && cell.row >= this.topLeft.row\n                  && cell.col >= this.topLeft.col\n                  && cell.row <= this.bottomRight.row\n                  && cell.col <= this.bottomRight.col;\n      }\n      contains(ref) {\n          if (ref instanceof Array) {\n              let that = this;\n\n              return ref.some(function(_ref) { return Boolean(that.contains(_ref)); });\n          }\n          if (ref instanceof CellRef) {\n              return this._containsCell(ref);\n          }\n          if (ref instanceof RangeRef) {\n              return this._containsRange(ref);\n          }\n          return false;\n      }\n      _intersectRange(ref) {\n          if (this.sheet != ref.sheet) {\n              return NULLREF;\n          }\n          let a_left = this.topLeft.col;\n          let a_top = this.topLeft.row;\n          let a_right = this.bottomRight.col;\n          let a_bottom = this.bottomRight.row;\n          let b_left = ref.topLeft.col;\n          let b_top = ref.topLeft.row;\n          let b_right = ref.bottomRight.col;\n          let b_bottom = ref.bottomRight.row;\n          if (a_left <= b_right &&\n                  b_left <= a_right &&\n                  a_top <= b_bottom &&\n                  b_top <= a_bottom) {\n              return new RangeRef(\n                  // topLeft\n                  new CellRef(Math.max(a_top, b_top),\n                              Math.max(a_left, b_left)),\n                  // bottomRight\n                  new CellRef(Math.min(a_bottom, b_bottom),\n                              Math.min(a_right, b_right))\n              ).setSheet(this.sheet, this.hasSheet());\n          } else {\n              return NULLREF;\n          }\n      }\n      intersect(ref) {\n          if (ref instanceof CellRef) {\n              return this._containsCell(ref) ? ref : NULLREF;\n          }\n          if (ref instanceof RangeRef) {\n              return this._intersectRange(ref).simplify();\n          }\n          if (ref instanceof UnionRef) {\n              return ref.intersect(this);\n          }\n          return NULLREF;        // can't handle NameRef-s here.\n      }\n      simplify() {\n          if (this.isCell()) {\n              return new CellRef(\n                  this.topLeft.row,\n                  this.topLeft.col,\n                  this.topLeft.rel\n              ).setSheet(this.sheet, this.hasSheet());\n          }\n          return this;\n      }\n      normalize() {\n          let a = this.topLeft, b = this.bottomRight;\n          let r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n          let rr1 = a.rel & 2, rc1 = a.rel & 1;\n          let rr2 = b.rel & 2, rc2 = b.rel & 1;\n          let tmp, changes = false;\n          // do not attempt to normalize unless relativeness of rows and cols are the same.\n          // https://github.com/telerik/kendo-ui-core/issues/4278\n          if (rr1 === rr2 && rc1 === rc2) {\n              if (r1 > r2) {\n                  changes = true;\n                  tmp = r1; r1 = r2; r2 = tmp;\n                  tmp = rr1; rr1 = rr2; rr2 = tmp;\n              }\n              if (c1 > c2) {\n                  changes = true;\n                  tmp = c1; c1 = c2; c2 = tmp;\n                  tmp = rc1; rc1 = rc2; rc2 = tmp;\n              }\n              if (changes) {\n                  this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                  this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n              }\n          }\n          return this;\n      }\n      print(trow, tcol, mod) {\n          if (mod || this.absolute(trow, tcol).valid()) {\n              let ret = this.topLeft.print(trow, tcol, mod)\n                      + \":\"\n                      + this.bottomRight.print(trow, tcol, mod);\n              if (this.hasSheet()) {\n                  ret = displaySheet(this.sheet)\n                          + (this.endSheet ? \":\" + displaySheet(this.endSheet) : \"\")\n                          + \"!\" + ret;\n              }\n              return ret;\n          }\n          return \"#REF!\";\n      }\n      absolute(arow, acol) {\n          return new RangeRef(\n              this.topLeft.absolute(arow, acol),\n              this.bottomRight.absolute(arow, acol)\n          ).setSheet(this.sheet, this.hasSheet());\n      }\n      relative(arow, acol, relTL, relBR) {\n          if (relBR == null) {\n              relBR = relTL;\n          }\n          return new RangeRef(\n              this.topLeft.relative(arow, acol, relTL),\n              this.bottomRight.relative(arow, acol, relBR)\n          ).setSheet(this.sheet, this.hasSheet());\n      }\n      height() {\n          if (this.topLeft.rel != this.bottomRight.rel) {\n              throw new Error(\"Mixed relative/absolute references\");\n          }\n          return this.bottomRight.row - this.topLeft.row + 1;\n      }\n      width() {\n          if (this.topLeft.rel != this.bottomRight.rel) {\n              throw new Error(\"Mixed relative/absolute references\");\n          }\n          return this.bottomRight.col - this.topLeft.col + 1;\n      }\n      collapse() {\n          return this.topLeft.toRangeRef();\n      }\n      leftColumn() {\n          return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n      }\n      rightColumn() {\n          return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n      }\n      topRow() {\n          return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n      }\n      bottomRow() {\n          return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n      }\n      toRangeRef() {\n          return this;\n      }\n      toRow(row) {\n          row += Math.max(0, this.topLeft.row);\n          return new RangeRef(\n              new CellRef(row, this.topLeft.col),\n              new CellRef(row, this.bottomRight.col)\n          ).setSheet(this.sheet, this.hasSheet());\n      }\n      toColumn(col) {\n          col += Math.max(0, this.topLeft.col);\n          return new RangeRef(\n              new CellRef(this.topLeft.row, col),\n              new CellRef(this.bottomRight.row, col)\n          ).setSheet(this.sheet, this.hasSheet());\n      }\n      toCell(row, col) {\n          row += Math.max(0, this.topLeft.row);\n          col += Math.max(0, this.topLeft.col);\n          return new CellRef(row, col, 0)\n              .setSheet(this.sheet, this.hasSheet());\n      }\n      forEachRow(callback) {\n          let startRow = this.topLeft.row;\n          let endRow = this.bottomRight.row;\n          let startCol = this.topLeft.col;\n          let endCol = this.bottomRight.col;\n\n          for (let i = startRow; i <= endRow; i++) {\n              callback(new RangeRef(\n                  new CellRef(i, startCol),\n                  new CellRef(i, endCol)\n              ));\n          }\n      }\n      forEachColumn(callback) {\n          let startRow = this.topLeft.row;\n          let endRow = this.bottomRight.row;\n          let startCol = this.topLeft.col;\n          let endCol = this.bottomRight.col;\n\n          for (let i = startCol; i <= endCol; i++) {\n              callback(new RangeRef(\n                  new CellRef(startRow, i),\n                  new CellRef(endRow, i)\n              ));\n          }\n      }\n      intersecting(refs) {\n          return refs.filter((ref) => ref.toRangeRef().intersects(this));\n      }\n\n      union(refs, callback) {\n          let intersecting = this.intersecting(refs);\n\n          let topLeftRow = this.topLeft.row;\n          let topLeftCol = this.topLeft.col;\n          let bottomRightRow = this.bottomRight.row;\n          let bottomRightCol = this.bottomRight.col;\n\n          let modified = false;\n\n          intersecting.forEach(function(ref) {\n              ref = ref.toRangeRef();\n              if (ref.topLeft.row < topLeftRow) {\n                  modified = true;\n                  topLeftRow = ref.topLeft.row;\n              }\n\n              if (ref.topLeft.col < topLeftCol) {\n                  modified = true;\n                  topLeftCol = ref.topLeft.col;\n              }\n\n              if (ref.bottomRight.row > bottomRightRow) {\n                  modified = true;\n                  bottomRightRow = ref.bottomRight.row;\n              }\n\n              if (ref.bottomRight.col > bottomRightCol) {\n                  modified = true;\n                  bottomRightCol = ref.bottomRight.col;\n              }\n\n              if (callback) {\n                  callback(ref);\n              }\n          });\n\n          let result = new RangeRef(\n              new CellRef(topLeftRow, topLeftCol),\n              new CellRef(bottomRightRow, bottomRightCol)\n          );\n\n          if (modified) {\n              return result.union(refs, callback);\n          } else {\n              return result;\n          }\n      }\n      resize(options) {\n          let limit = Math.max.bind(Math, 0);\n          function num(value) { return value || 0; }\n\n          let top = this.topLeft.row + num(options.top);\n          let left = this.topLeft.col + num(options.left);\n          let bottom = this.bottomRight.row + num(options.bottom);\n          let right = this.bottomRight.col + num(options.right);\n\n          if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n              return NULLREF;\n          } else if (top <= bottom && left <= right) {\n              return new RangeRef(new CellRef(limit(top), limit(left)),\n                                  new CellRef(limit(bottom), limit(right)));\n          } else {\n              return NULLREF;\n          }\n      }\n      move(rows, cols) {\n          return new RangeRef(\n              new CellRef(this.topLeft.row + rows,\n                          this.topLeft.col + cols),\n              new CellRef(this.bottomRight.row + rows,\n                          this.bottomRight.col + cols)\n          );\n      }\n      first() {\n          return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n      }\n      isCell() {\n          return !this.endSheet && this.topLeft.eq(this.bottomRight);\n      }\n      toString() {\n          return this.topLeft + \":\" + this.bottomRight;\n      }\n      adjust(row, col, trow, tcol, forRow, start, delta) {\n          let tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n          let tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n          if (tl === NULLREF && tr === NULLREF) {\n              return NULLREF;\n          }\n          if (tl === NULLREF) {\n              tl = this.topLeft.absolute(row, col);\n              if (forRow) {\n                  tl.row = start;\n              } else {\n                  tl.col = start;\n              }\n              if (trow != null && tcol != null) {\n                  tl = tl.relative(trow, tcol, this.topLeft.rel);\n              }\n          } else if (tr === NULLREF) {\n              tr = this.bottomRight.absolute(row, col);\n              if (forRow) {\n                  tr.row = start - 1;\n              } else {\n                  tr.col = start - 1;\n              }\n              if (trow != null && tcol != null) {\n                  tr = tr.relative(trow, tcol, this.bottomRight.rel);\n              }\n          }\n          return new RangeRef(tl, tr)\n              .setSheet(this.sheet, this.hasSheet())\n              .simplify();\n      }\n      valid() {\n          return this.topLeft.valid() && this.bottomRight.valid();\n      }\n  }\n\n  /* -----[ Union reference ]----- */\n\n  class UnionRef extends Ref {\n      constructor(refs) {\n          super();\n          this.refs = refs;\n          this.length = refs.length;\n      }\n      clone() {\n          return new UnionRef(this.refs.slice());\n      }\n      intersect(ref) {\n          let a = [];\n          for (let i = 0; i < this.length; ++i) {\n              let x = ref.intersect(this.refs[i]);\n              if (x !== NULLREF) {\n                  a.push(x);\n              }\n          }\n          if (a.length > 0) {\n              return new UnionRef(a).simplify();\n          }\n          return NULLREF;\n      }\n      simplify() {\n          // eslint-disable-next-line max-len\n          let u = new UnionRef(this.refs.reduce(function(a, ref) {\n              ref = ref.simplify();\n              if (ref !== NULLREF) {\n                  a.push(ref);\n              }\n              return a;\n          }, []));\n          if (u.empty()) {\n              return NULLREF;\n          }\n          if (u.single()) {\n              return u.refs[0];\n          }\n          return u;\n      }\n      absolute(arow, acol) {\n          return new UnionRef(this.refs.map(function(ref) {\n              return ref.absolute(arow, acol);\n          }));\n      }\n      forEach(callback, obj) {\n          this.refs.forEach(function(ref) {\n              if (ref instanceof UnionRef) {\n                  ref.forEach(callback, obj);\n              } else {\n                  callback.call(obj, ref);\n              }\n          }, obj);\n      }\n      toRangeRef() {\n          return this.refs[0].toRangeRef();\n      }\n      contains(theRef) {\n          return this.refs.some(function(ref) { return ref.contains(theRef); });\n      }\n      map(callback, obj) {\n          let refs = [];\n          this.forEach(function(ref) {\n              refs.push(callback.call(obj, ref));\n          });\n          return new UnionRef(refs);\n      }\n      first() {\n          return this.refs[0].first();\n      }\n      lastRange() {\n          return this.refs[this.length - 1];\n      }\n      size() {\n          return this.length;\n      }\n      single() {\n          return this.length == 1;\n      }\n      empty() {\n          return this.length === 0;\n      }\n      isCell() {\n          return this.single() && this.refs[0].isCell();\n      }\n      rangeAt(index) {\n          return this.refs[index];\n      }\n      nextRangeIndex(index) {\n          if (index === this.length - 1) {\n              return 0;\n          } else {\n              return index + 1;\n          }\n      }\n      previousRangeIndex(index) {\n          if (index === 0) {\n              return this.length - 1;\n          } else {\n              return index - 1;\n          }\n      }\n      concat(ref) {\n          return new UnionRef(this.refs.concat([ref]));\n      }\n      print(row, col, mod) {\n          return this.refs.map(function(ref) { return ref.print(row, col, mod); }).join(\",\");\n      }\n\n      replaceAt(index, ref) {\n          let newRefs = this.refs.slice();\n          newRefs.splice(index, 1, ref);\n          return new UnionRef(newRefs);\n      }\n\n      leftColumn() {\n          return this.map(function(ref) {\n              return ref.leftColumn();\n          });\n      }\n      rightColumn() {\n          return this.map(function(ref) {\n              return ref.rightColumn();\n          });\n      }\n      topRow() {\n          return this.map(function(ref) {\n              return ref.topRow();\n          });\n      }\n      bottomRow() {\n          return this.map(function(ref) {\n              return ref.bottomRow();\n          });\n      }\n      forEachRow(callback) {\n          this.forEach(function(ref) {\n              ref.forEachRow(callback);\n          });\n      }\n      forEachColumn(callback) {\n          this.forEach(function(ref) {\n              ref.forEachColumn(callback);\n          });\n      }\n      adjust(row, col, trow, tcol, forRow, start, delta) {\n          return this.map(function(ref) {\n              return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n          }).simplify();\n      }\n      toString() {\n          return this.refs.map(function(ref) {\n              return ref.toString();\n          }).join(\", \");\n      }\n      valid() {\n          for (let i = this.refs.length; --i >= 0;) {\n              if (this.refs[i].valid()) {\n                  return false;\n              }\n          }\n          return true;\n      }\n      renameSheet(oldSheetName, newSheetName) {\n          this.refs.forEach(function(ref) {\n              ref.renameSheet(oldSheetName, newSheetName);\n          });\n      }\n  }\n\n  const FIRSTREF = new CellRef(0, 0);\n\n  const SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n  SHEETREF.print = function() {\n      return \"#SHEET\";\n  };\n\n  /* eslint-disable key-spacing */\n  const messages = {};\n  messages.view = {\n      nameBox: \"Name Box\",\n      errors: {\n          modifyMerged: \"Cannot change part of a merged cell.\",\n          openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n          shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n          insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n          insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n          filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n          sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n          cantSortMultipleSelection: \"Cannot sort multiple selection\",\n          cantSortNullRef: \"Cannot sort empty selection\",\n          cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n          validationError: \"The value that you entered violates the validation rules set on the cell.\",\n          cannotModifyDisabled: \"Cannot modify disabled cells.\",\n          insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n          insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n      },\n      tabs: {\n          home: \"Home\",\n          insert: \"Insert\",\n          data: \"Data\"\n      }\n  };\n\n  messages.menus = {\n      \"cut\"          : \"Cut\",\n      \"copy\"         : \"Copy\",\n      \"paste\"        : \"Paste\",\n      \"merge\"        : \"Merge\",\n      \"unmerge\"      : \"Unmerge\",\n      \"delete\"       : \"Delete\",\n      \"hide\"         : \"Hide\",\n      \"unhide\"       : \"Unhide\",\n      \"bringToFront\" : \"Bring to front\",\n      \"sendToBack\"   : \"Send to back\"\n  };\n\n  messages.workbook = {\n      defaultSheetName: \"Sheet\"\n  };\n\n  const options = {\n      name: \"Spreadsheet\",\n      toolbar: true,\n      sheetsbar: true,\n      rows: 200,\n      columns: 50,\n      rowHeight: 20,\n      columnWidth: 64,\n      headerHeight: 20,\n      headerWidth: 32,\n      excel: {\n          fileName: \"Workbook.xlsx\",\n          forceProxy: false,\n          proxyURL: \"\",\n      },\n      messages: messages,\n      pdf: {\n          // which part of the workbook to be exported\n          area: \"workbook\",\n          fileName: \"Workbook.pdf\",\n          proxyURL: \"\",\n          // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n          // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n          // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n          // by content.\n          paperSize: \"a4\",\n          // True to reverse the paper dimensions if needed such that width is the larger edge.\n          landscape: true,\n          // An object containing { left, top, bottom, right } margins with units.\n          margin: null,\n          // Optional information for the PDF Info dictionary; all strings except for the date.\n          title: null,\n          author: null,\n          subject: null,\n          keywords: null,\n          creator: \"Kendo UI PDF Generator\",\n          // Creation Date; defaults to new Date()\n          date: null\n      },\n      defaultCellStyle: {\n          fontFamily: \"Arial\",\n          fontSize: 12\n      },\n      useCultureDecimals: false,\n      locale: 'en'\n  };\n\n  const ALL_REASONS = {\n      recalc: true,\n      selection: true,\n      activeCell: true,\n      layout: true,\n      sheetSelection: true,\n      resize: true,\n      editorChange: false,\n      editorClose: false\n  };\n\n  const keys = {\n      INSERT: 45,\n      DELETE: 46,\n      BACKSPACE: 8,\n      TAB: 9,\n      ENTER: 13,\n      ESC: 27,\n      LEFT: 37,\n      UP: 38,\n      RIGHT: 39,\n      DOWN: 40,\n      END: 35,\n      HOME: 36,\n      SPACEBAR: 32,\n      PAGEUP: 33,\n      PAGEDOWN: 34,\n      F2: 113,\n      F10: 121,\n      F11: 122,\n      F12: 123,\n      NUMPAD_PLUS: 107,\n      NUMPAD_MINUS: 109,\n      NUMPAD_DOT: 110,\n      B: 66,\n      I: 73,\n      U: 85,\n      N: 78,\n      H: 72,\n      A: 65,\n      R: 82\n  };\n\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable no-prototype-builtins */\n\n  const RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\n\n  function isUnicodeLetter(ch) {\n      return RX_UNICODE_LETTER.test(ch);\n  }\n\n  function memoize(f) {\n      let cache = Object.create(null);\n      return function() {\n          let id = \"\";\n          for (let i = arguments.length; --i >= 0;) {\n              id += \":\" + arguments[i];\n          }\n          return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\n      };\n  }\n\n  function arabicToRoman(n) {\n      let literals = {\n          1: \"i\", 10: \"x\", 100: \"c\",\n          2: \"ii\", 20: \"xx\", 200: \"cc\",\n          3: \"iii\", 30: \"xxx\", 300: \"ccc\",\n          4: \"iv\", 40: \"xl\", 400: \"cd\",\n          5: \"v\", 50: \"l\", 500: \"d\",\n          6: \"vi\", 60: \"lx\", 600: \"dc\",\n          7: \"vii\", 70: \"lxx\", 700: \"dcc\",\n          8: \"viii\", 80: \"lxxx\", 800: \"dccc\",\n          9: \"ix\", 90: \"xc\", 900: \"cm\",\n          1000: \"m\"\n      };\n      let values = [ 1000,\n                     900 , 800, 700, 600, 500, 400, 300, 200, 100,\n                     90 , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\n                     9 , 8 , 7 , 6 , 5 , 4 , 3 , 2 , 1 ];\n      let roman = \"\";\n      while (n > 0) {\n          if (n < values[0]) {\n              values.shift();\n          } else {\n              roman += literals[values[0]];\n              n -= values[0];\n          }\n      }\n      return roman;\n  }\n\n  function romanToArabic(r) {\n      r = r.toLowerCase();\n      let digits = {\n          i: 1,\n          v: 5,\n          x: 10,\n          l: 50,\n          c: 100,\n          d: 500,\n          m: 1000\n      };\n      let value = 0, prev = 0;\n      for (let i = 0; i < r.length; ++i) {\n          let v = digits[r.charAt(i)];\n          if (!v) {\n              return null;\n          }\n          value += v;\n          if (v > prev) {\n              value -= 2 * prev;\n          }\n          prev = v;\n      }\n      return value;\n  }\n\n  function withExit(f, obj) {\n      try {\n          return f.call(obj, function(value) {\n              throw new Return(value);\n          });\n      } catch (ex) {\n          if (ex instanceof Return) {\n              return ex.value;\n          }\n          throw ex;\n      }\n      function Return(value) {\n          this.value = value;\n      }\n  }\n\n  const getterCache = {};\n\n  getterCache[\"undefined\"] = (obj) => obj;\n\n  const FIELD_REGEX = /\\[(?:(\\d+)|['\"](.*?)['\"])\\]|((?:(?!\\[.*?\\]|\\.).)+)/g;\n  function getter(field, safe) {\n      const key = field + safe;\n\n      if (getterCache[key]) {\n          return getterCache[key];\n      }\n\n      const fields = [];\n      field.replace(FIELD_REGEX, (_, index, indexAccessor, field) => {\n          fields.push(isPresent(index) ? index : indexAccessor || field);\n          return undefined;\n      });\n\n      getterCache[key] = (obj) => {\n          let result = obj;\n          for (let idx = 0; idx < fields.length; idx++) {\n              result = result[fields[idx]];\n              if (!isPresent(result) && safe) {\n                  return result;\n              }\n          }\n\n          return result;\n      };\n\n      return getterCache[key];\n  }\n\n  function deepExtend(destination) {\n      let i = 1,\n          length = arguments.length;\n\n      for (i = 1; i < length; i++) {\n          deepExtendOne(destination, arguments[i]);\n      }\n\n      return destination;\n  }\n\n  function deepExtendOne(destination, source) {\n      let property,\n          propValue,\n          propType,\n          destProp;\n\n      for (property in source) {\n          if (property === '__proto__' || property === 'constructor') {\n              continue;\n          }\n\n          propValue = source[property];\n          propType = typeof propValue;\n\n          if (propValue instanceof Date) {\n              destination[property] = new Date(propValue.getTime());\n          } else if (isFunction(propValue?.clone)) {\n              destination[property] = propValue.clone();\n          } else if (propType === 'object' && propValue !== null && isPlainObject(propValue)) {\n              // Check if the property is a plain object before attempting to merge deeply\n              destProp = destination[property];\n              if (typeof destProp !== 'object' || destProp === null) {\n                  destination[property] = {};\n              }\n\n              deepExtendOne(destination[property], propValue);\n          } else if (propType !== 'undefined') {\n              destination[property] = propValue;\n          }\n      }\n\n      return destination;\n  }\n\n  function guid() {\n      let id = \"\", i, random, chars = \"abcdef\";\n\n      id += chars[Math.floor(Math.random() * Math.floor(chars.length))];\n\n      for (i = 1; i < 32; i++) {\n          random = Math.random() * 16 | 0;\n\n          if (i === 8 || i === 12 || i === 16 || i === 20) {\n              id += \"-\";\n          }\n          id += (i === 12 ? 4 : (i === 16 ? (random & 3 | 8) : random)).toString(16);\n      }\n\n      return id;\n  }\n\n  const support = {};\n\n  const scrollbar = function(refresh) {\n      if (!isNaN(support._scrollbar) && !refresh) {\n          return support._scrollbar;\n      }\n\n      let div = document.createElement(\"div\"),\n          result;\n\n      div.style.overflow = \"scroll\";\n      div.style.overflowX = \"hidden\";\n      div.style.zoom = \"1\";\n      div.style.clear = \"both\";\n      div.style.display = \"block\";\n\n      div.innerHTML = \"&nbsp;\";\n      document.body.appendChild(div);\n\n      support._scrollbar = result = div.offsetWidth - div.scrollWidth;\n\n      document.body.removeChild(div);\n\n      return result;\n  };\n\n  function toCamelCase(str) {\n      return str.replace(/\\-(\\w)/g, function(strMatch, g1) {\n          return g1.toUpperCase();\n      });\n  }\n\n  function size(obj) {\n      let result = 0, key;\n      for (key in obj) {\n          if (obj.hasOwnProperty(key) && key !== \"toJSON\") { // Ignore fake IE7 toJSON.\n              result++;\n          }\n      }\n\n      return result;\n  }\n\n  const kendoGetComputedStyles = function(element, properties) {\n      let styles = {}, computedStyle;\n\n      if (document.defaultView && document.defaultView.getComputedStyle) {\n          computedStyle = document.defaultView.getComputedStyle(element, \"\");\n\n          if (properties) {\n              properties.forEach(function(value) {\n                  styles[value] = computedStyle.getPropertyValue(value);\n              });\n          }\n      } else {\n          computedStyle = element.currentStyle;\n\n          if (properties) {\n              properties.forEach(function(value) {\n                  styles[value] = computedStyle[toCamelCase(value)];\n              });\n          }\n      }\n\n      if (!size(styles)) {\n          styles = computedStyle;\n      }\n\n      return styles;\n  };\n\n  const insertAfter = function(newElement, after) {\n      after.parentNode.insertBefore(newElement, after.nextSibling);\n  };\n\n  const _activeElement$1 = function() {\n      try {\n          return document.activeElement;\n      } catch (e) {\n          return document.documentElement.activeElement;\n      }\n  };\n\n  const isPresent = (value) => value !== null && value !== undefined;\n  const isBlank = (value) => !isPresent(value);\n  const isDate = (value) => value && value.getTime;\n  const isString = (value) => typeof value === \"string\";\n  const isNumeric = (value) => !isNaN(value - parseFloat(value));\n  const isFunction = (fn) => typeof fn === \"function\";\n  const isPlainObject = function(obj) {\n      if (!obj || toString.call(obj) !== \"[object Object]\") {\n          return false;\n      }\n\n      const proto = Object.getPrototypeOf(obj);\n      return proto === null || proto.constructor === Object;\n  };\n\n  class CalcError {\n\n      constructor(code) {\n          if (code instanceof CalcError) {\n              return code;\n          }\n          this.code = code;\n      }\n\n      toString() {\n          return '#' + this.code + (this.code === 'NAME' ? '?' : '!');\n      }\n  }\n\n  let intlValue = {};\n\n  const intl = (value) => {\n      if (value) {\n          intlValue = value;\n      } else {\n          return intlValue;\n      }\n  };\n\n  const culture = () => {\n      return intl().localeInfo();\n  };\n\n  function createKendoObj(calc, CalcError, Ref, CellRef, RangeRef) {\n      const kendo = {};\n      kendo.spreadsheet = { calc, CalcError, Ref, CellRef, RangeRef };\n      kendo.culture = () => culture();\n\n      return kendo;\n  }\n\n  /* eslint-disable max-params */\n  /* eslint-disable complexity */\n  /* eslint-disable no-unused-vars */\n\n\n  let calc = {\n      runtime: {\n          FUNCS: Object.create(null),\n      }\n  };\n\n  let FUNCS$1 = calc.runtime.FUNCS;\n\n  /* -----[ Context ]----- */\n\n  class Context {\n      constructor(callback, formula, ss, parent) {\n          this.callback = callback;\n          this.formula = formula;\n          this.ss = ss;\n          this.parent = parent;\n      }\n\n      resolve(val) {\n          var self = this;\n          if (val instanceof Ref) {\n              self.resolveCells([ val ], function() {\n                  self._resolve(val);\n              });\n          } else {\n              self._resolve(val);\n          }\n      }\n\n      error(val) {\n          return new CalcError(val);\n      }\n\n      _resolve(val) {\n          if (val === undefined) {\n              val = null;\n          } else if (Array.isArray(val)) {\n              val = this.asMatrix(val);\n          } else {\n              val = maybeRoundFloatErrors(val);\n          }\n          var f = this.formula;\n          if (f.arrayFormulaRange) {\n              // when this is an array formula, make sure we return a Matrix.  The value already\n              // *should* be a Matrix, so this won't incur speed penalty in normal cases.\n              val = this.asMatrix(val) || this.asMatrix([[ val ]]);\n          } else if (val instanceof RangeRef) {\n              val = this._arrayArg(val);\n          }\n          f.value = val;\n          if (this.ss.onFormula(f) && this.callback) {\n              this.callback.call(f, val);\n          }\n      }\n\n      resolveCells(a, f) {\n          var context = this, formulas = [];\n\n          (function loop(a) {\n              for (var i = 0; i < a.length; ++i) {\n                  var x = a[i];\n                  if (x instanceof Ref) {\n                      add(context.getRefCells(x));\n                  }\n                  if (Array.isArray(x)) {\n                      // make sure we resolve cells in literal matrices\n                      loop(x);\n                  }\n              }\n          })(a);\n\n          if (!formulas.length) {\n              return f.call(context);\n          }\n\n          for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n              fetch(formulas[i]);\n          }\n          function fetch(formula) {\n              formula.exec(context.ss, function() {\n                  if (!--pending) {\n                      f.call(context);\n                  }\n              }, context);\n          }\n          function add(a) {\n              for (var i = 0; i < a.length; ++i) {\n                  var cell = a[i];\n                  if (cell.formula) {\n                      formulas.push(cell.formula);\n                  }\n              }\n              return true;\n          }\n      }\n\n      cellValues(a, wantNulls) {\n          var ret = [];\n          for (var i = 0; i < a.length; ++i) {\n              var val = a[i];\n              if (val instanceof Ref) {\n                  val = this.getRefData(val, wantNulls);\n                  ret = ret.concat(val);\n              } else if (Array.isArray(val)) {\n                  ret = ret.concat(this.cellValues(val, wantNulls));\n              } else if (val instanceof Matrix) {\n                  ret = ret.concat(this.cellValues(val.data, wantNulls));\n              } else {\n                  ret.push(val);\n              }\n          }\n          return ret;\n      }\n\n      fetchName(ref, callback) {\n          var f = this.formula;\n          var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n          if (val instanceof Formula$1) {\n              // clone and relocate to calling formula, so that relative references in a named\n              // formula would work as expected.\n              val = val.clone(f.sheet, f.row, f.col, true);\n\n              // XXX: I don't like this dependency here; basically we only need ss.onFormula to\n              // return true and do nothing else.\n              var ss = new calc.ValidationFormulaContext(this.ss.workbook);\n\n              val.exec(ss, callback, this);\n          } else {\n              if (val instanceof Ref) {\n                  // relocate for relative refs\n                  val = val.absolute(f.row, f.col);\n                  if (val instanceof RangeRef && this.ss.isMerged(val)) {\n                      val = val.topLeft;\n                  }\n                  if (!val.sheet) {\n                      val.sheet = f.sheet;\n                  }\n              }\n              callback(val == null ? new CalcError(\"NAME\") : val);\n          }\n      }\n\n      force(val) {\n          if (val instanceof Ref) {\n              return this.getRefData(val);\n          }\n          return val;\n      }\n\n      func(fname, callback, args) {\n          fname = fname.toLowerCase();\n          var f = FUNCS$1[fname];\n          if (f) {\n              return f.call(this, callback, args);\n          }\n          callback(new CalcError(\"NAME\"));\n      }\n\n      bool(val) {\n          if (val instanceof Ref) {\n              val = this.getRefData(val);\n          }\n          if (typeof val == \"string\") {\n              return val.toLowerCase() == \"true\";\n          }\n          if (typeof val == \"number\") {\n              return val !== 0;\n          }\n          if (typeof val == \"boolean\") {\n              return val;\n          }\n          return val != null;\n      }\n\n      _arrayArg(ref) { // not necessarily a reference though\n          var f = this.formula;\n          if (!f.arrayFormulaRange && ref instanceof RangeRef) {\n              // if formula wasn't saved with Ctrl-Shift-Enter but a range is passed, Excel does\n              // something special:\n              //\n              // - if range is Wx1 (horizontal array) and current formula resides within the\n              //   horizontal bounds of the range, the appropriate cell is selected.  Example:\n              //   A1..D1 contain 1, 2, 3, 4 and we have in B2: =A1:D1, then B2 will get 2 (the\n              //   value in A2).  If the same formula is typed outside the horizontal span of the\n              //   range, say in E2: =A1:D1, then #VALUE! is returned.\n              //\n              // - similarly, if the range is 1xH (vertical array), the formula must reside within\n              //   the vertical bounds of the range and it gets the corresponding cell; otherwise,\n              //   #VALUE!.\n              if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                  return this.getRefData(new CellRef(ref.topLeft.row, f.col).setSheet(ref.sheet));\n              }\n              if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                  return this.getRefData(new CellRef(f.row, ref.topLeft.col).setSheet(ref.sheet));\n              }\n              return new CalcError(\"VALUE\");\n          } else {\n              return this.asMatrix(ref);\n          }\n      }\n\n      asMatrix(range) {\n          if (range instanceof Matrix) {\n              return range;\n          }\n          let self = this;\n          if (range instanceof RangeRef) {\n              let tl = range.topLeft;\n              let top = tl.row, left = tl.col;\n              let cells = self.getRefCells(range);\n              let m = new Matrix(self);\n              if (isFinite(range.width())) {\n                  m.width = range.width();\n              }\n              if (isFinite(range.height())) {\n                  m.height = range.height();\n              }\n              if (!isFinite(top)) {\n                  top = 0;\n              }\n              if (!isFinite(left)) {\n                  left = 0;\n              }\n              cells.forEach(function(cell) {\n                  m.set(cell.row - top,\n                        cell.col - left,\n                        cell.value);\n              });\n              return m;\n          }\n          if (Array.isArray(range) && range.length > 0) {\n              let m = new Matrix(self), row = 0;\n              range.forEach(function(line) {\n                  let col = 0;\n                  let h = 1;\n                  line.forEach(function(el) {\n                      let isRange = el instanceof RangeRef;\n                      if (el instanceof Ref && !isRange) {\n                          el = self.getRefData(el);\n                      }\n                      if (isRange || Array.isArray(el)) {\n                          el = self.asMatrix(el);\n                      }\n                      if (el instanceof Matrix) {\n                          el.each(function(el, r, c) {\n                              m.set(row + r, col + c, el);\n                          });\n                          h = Math.max(h, el.height);\n                          col += el.width;\n                      } else {\n                          if (typeof el === \"string\" && el.length && !isNaN(el)) {\n                              el = Number(el);\n                          }\n\n                          m.set(row, col++, el);\n                      }\n                  });\n                  row += h;\n              });\n              return m;\n          }\n      }\n\n      getRefCells(refs, hiddenInfo, wantNulls) {\n          var f = this.formula;\n          return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n      }\n\n      getRefData(ref, wantNulls) {\n          var f = this.formula;\n          return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n      }\n\n      workbook() {\n          return this.ss.workbook;\n      }\n  }\n\n  function argmax(i, end, f) {\n      var max = f(i), pos = i;\n      while (++i < end) {\n          var v = f(i);\n          if (v > max) {\n              max = v;\n              pos = i;\n          }\n      }\n      return pos;\n  }\n\n  class Matrix {\n      constructor(context) {\n          this.context = context;\n          this.height = 0;\n          this.width = 0;\n          this.data = [];\n      }\n      clone() {\n          var m = new Matrix(this.context);\n          m.height = this.height;\n          m.width = this.width;\n          m.data = this.data.map(function(row) { return row.slice(); });\n          return m;\n      }\n      get(row, col) {\n          var line = this.data[row];\n          var val = line ? line[col] : null;\n          return val instanceof Ref ? this.context.getRefData(val) : val;\n      }\n      getNA(row, col) {\n          if (this.height == 1) {\n              row = 0;\n          }\n          if (this.width == 1) {\n              col = 0;\n          }\n          if (row < this.height && col < this.width) {\n              return this.get(row, col);\n          }\n          return new CalcError(\"N/A\");\n      }\n      set(row, col, data) {\n          var line = this.data[row];\n          if (line == null) {\n              line = this.data[row] = [];\n          }\n          line[col] = data;\n          if (row >= this.height) {\n              this.height = row + 1;\n          }\n          if (col >= this.width) {\n              this.width = col + 1;\n          }\n      }\n      each(f, includeEmpty) {\n          for (var row = 0; row < this.height; ++row) {\n              for (var col = 0; col < this.width; ++col) {\n                  var val = this.get(row, col);\n                  if (includeEmpty || val != null) {\n                      val = f.call(this.context, val, row, col);\n                      if (val !== undefined) {\n                          return val;\n                      }\n                  }\n              }\n          }\n      }\n      map(f, includeEmpty) {\n          var m = new Matrix(this.context);\n          this.each(function(el, row, col) {\n              // here `this` is actually the context\n              m.set(row, col, f.call(this, el, row, col));\n          }, includeEmpty);\n          return m;\n      }\n      eachRow(f) {\n          for (var row = 0; row < this.height; ++row) {\n              var val = f.call(this.context, row);\n              if (val !== undefined) {\n                  return val;\n              }\n          }\n      }\n      eachCol(f) {\n          for (var col = 0; col < this.width; ++col) {\n              var val = f.call(this.context, col);\n              if (val !== undefined) {\n                  return val;\n              }\n          }\n      }\n      mapRow(f) {\n          var m = new Matrix(this.context);\n          this.eachRow(function(row) {\n              m.set(row, 0, f.call(this.context, row));\n          });\n          return m;\n      }\n      mapCol(f) {\n          var m = new Matrix(this.context);\n          this.eachCol(function(col) {\n              m.set(0, col, f.call(this.context, col));\n          });\n          return m;\n      }\n      toString() {\n          return JSON.stringify(this.data);\n      }\n      transpose() {\n          var m = new Matrix(this.context);\n          this.each(function(el, row, col) {\n              m.set(col, row, el);\n          });\n          return m;\n      }\n      unit(n) {\n          this.width = this.height = n;\n          var a = this.data = new Array(n);\n          for (var i = n; --i >= 0;) {\n              var row = a[i] = new Array(n);\n              for (var j = n; --j >= 0;) {\n                  row[j] = i == j ? 1 : 0;\n              }\n          }\n          return this;\n      }\n      multiply(b) {\n          var a = this, m = new Matrix(a.context);\n          for (var row = 0; row < a.height; ++row) {\n              for (var col = 0; col < b.width; ++col) {\n                  var s = 0;\n                  for (var i = 0; i < a.width; ++i) {\n                      var va = a.get(row, i);\n                      var vb = b.get(i, col);\n                      if (typeof va != \"number\" || typeof vb != \"number\") {\n                          throw new CalcError(\"VALUE\");\n                      }\n                      s += va * vb;\n                  }\n                  m.set(row, col, s);\n              }\n          }\n          return m;\n      }\n      adds(b, s) {\n          var a = this, m = new Matrix(a.context);\n          var sign = s ? -1 : 1;\n          for (var row = 0; row < a.height; ++row) {\n              for (var col = 0; col < a.width; ++col) {\n                  var x = a.get(row, col),\n                      y = b.get(row, col);\n                  m.set(row, col, x + sign * y);\n              }\n          }\n          return m;\n      }\n      determinant() {\n          var a = this.clone().data;\n          var n = a.length;\n          var d = 1, C, L, i, k;\n          for (C = 0; C < n; C++) {\n              for (L = C; (L < n) && (!a[L][C]); L++);\n              if (L == n) {\n                  return 0;\n              }\n              if (L != C) {\n                  d = -d;\n                  for (k = C; k < n; k++) {\n                      var t = a[C][k];\n                      a[C][k] = a[L][k];\n                      a[L][k] = t;\n                  }\n              }\n              for (i = C + 1; i < n; i++) {\n                  for (k = C + 1; k < n; k++) {\n                      a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                  }\n              }\n              d *= a[C][C];\n          }\n          return d;\n      }\n      inverse() {\n          let n = this.width;\n          let m = this.augment(new Matrix(this.context).unit(n));\n          let a = m.data;\n          let tmp;\n\n          // Gaussian elimination\n          // https://en.wikipedia.org/wiki/Gaussian_elimination#Finding_the_inverse_of_a_matrix\n\n          // 1. Get zeros below main diagonal\n          for (let k = 0; k < n; ++k) {\n              let imax = argmax(k, n, function(i) { return a[i][k]; });\n              if (!a[imax][k]) {\n                  return null; // singular matrix\n              }\n              if (k != imax) {\n                  tmp = a[k];\n                  a[k] = a[imax];\n                  a[imax] = tmp;\n              }\n              for (let i = k + 1; i < n; ++i) {\n                  for (let j = k + 1; j < 2 * n; ++j) {\n                      a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                  }\n                  a[i][k] = 0;\n              }\n          }\n\n          // 2. Get 1-s on main diagonal, dividing by pivot\n          for (let i = 0; i < n; ++i) {\n              for (let f = a[i][i], j = 0; j < 2 * n; ++j) {\n                  a[i][j] /= f;\n              }\n          }\n\n          // 3. Get zeros above main diagonal.  Actually, we only care to compute the right side\n          // here (that will be the inverse), so in the inner loop below we go while j >= n,\n          // instead of j >= k.\n          for (let k = n; --k >= 0;) {\n              for (let i = k; --i >= 0;) {\n                  if (a[i][k]) {\n                      for (let j = 2 * n; --j >= n;) {\n                          a[i][j] -= a[k][j] * a[i][k];\n                      }\n                  }\n              }\n          }\n\n          return m.slice(0, n, n, n);\n      }\n      augment(m) {\n          var ret = this.clone(), n = ret.width;\n          m.each(function(val, row, col) {\n              ret.set(row, col + n, val);\n          });\n          return ret;\n      }\n      slice(row, col, height, width) {\n          var m = new Matrix(this.context);\n          for (var i = 0; i < height; ++i) {\n              for (var j = 0; j < width; ++j) {\n                  m.set(i, j, this.get(row + i, col + j));\n              }\n          }\n          return m;\n      }\n\n      // XXX: debug\n      // dump() {\n      //     this.data.forEach(function(row){\n      //         window.console.log(row.map(function(val){\n      //             var str = val.toFixed(3).replace(/\\.?0*$/, function(s){\n      //                 return [ \"\", \" \", \"  \", \"   \", \"    \" ][s.length];\n      //             });\n      //             if (val >= 0) { str = \" \" + str; }\n      //             return str;\n      //         }).join(\"  \"));\n      //     });\n      // }\n  }\n\n  /* -----[ Formula ]----- */\n\n  function sameRef(r1, r2) {\n      // note: r1.eq(r2) will not do, because it returns true for A1 and A1:A1 (CellRef\n      // vs. RangeRef).  To properly undo we need to assert that the references are exactly the\n      // same (including type).\n      if (r1.constructor !== r2.constructor) {\n          return false;\n      }\n      if (r1 instanceof CellRef) {\n          return r1.sheet == r2.sheet\n              && r1.row == r2.row\n              && r1.col == r2.col\n              && r1.rel == r2.rel;\n      }\n      if (r1 instanceof RangeRef) {\n          return sameRef(r1.topLeft , r2.topLeft)\n              && sameRef(r1.bottomRight , r2.bottomRight)\n              && r1.endSheet == r2.endSheet;\n      }\n      if (r1 instanceof UnionRef) {\n          var i = r1.refs.length;\n          if (i != r2.refs.length) {\n              return false;\n          }\n          while (--i >= 0) {\n              if (!sameRef(r1.refs[i], r2.refs[i])) {\n                  return false;\n              }\n          }\n      }\n      return true;\n  }\n\n  let Formula$1 = class Formula {\n      constructor(refs, handler, printer, sheet, row, col, arrayFormulaRange) {\n          this.refs = refs;\n          this.handler = handler;\n          this.print = printer;\n          this.absrefs = null;\n          this.sheet = sheet;\n          this.row = row;\n          this.col = col;\n          this.onReady = [];\n          this.pending = false;\n          this.arrayFormulaRange = arrayFormulaRange;\n      }\n      setArrayFormulaRange(ref) {\n          this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n      }\n      clone(sheet, row, col, forceRefs) {\n          var lcsheet = sheet.toLowerCase();\n          var refs = this.refs;\n          var range = this.arrayFormulaRange;\n          if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n              refs = refs.map(function(ref) {\n                  if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                      ref = ref.clone().setSheet(sheet);\n                  }\n                  return ref;\n              });\n              if (range) {\n                  range = range.clone().setSheet(sheet);\n              }\n          }\n          return new Formula(refs, this.handler, this.print, sheet, row, col, range);\n      }\n      deepClone() {\n          var refs = this.refs.map(function(ref) { return ref.clone(); });\n          return new Formula(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n      }\n      resolve(val) {\n          this.pending = false;\n          this.onReady.forEach(function(callback) {\n              callback(val);\n          });\n      }\n      exec(ss, callback, parentContext) {\n          if (\"value\" in this) {\n              if (callback) {\n                  callback(this.value);\n              }\n          } else {\n              if (callback) {\n                  this.onReady.push(callback);\n              }\n\n              var ctx = new Context(this.resolve, this, ss, parentContext);\n              var level = 0;\n              // if the call chain leads back to this same formula, we have a circular dependency.\n              while (parentContext) {\n                  if (parentContext.formula === this) {\n                      this.pending = false;\n                      ctx.resolve(new CalcError(\"CIRCULAR\"));\n                      return;\n                  }\n                  parentContext = parentContext.parent;\n                  ++level;\n              }\n\n              // pending is still useful for ASYNC formulas\n              if (this.pending) {\n                  return;\n              }\n              this.pending = true;\n\n              var next = function() {\n                  // compute and cache the absolute references\n                  if (!this.absrefs) {\n                      this.absrefs = this.refs.map(function(ref) {\n                          return ref.absolute(this.row, this.col);\n                      }, this);\n                  }\n\n                  // finally invoke the handler given to us by the compiler in calc.js\n                  this.handler.call(ctx);\n              }.bind(this);\n\n              if (level < 20) {\n                  next();\n              } else {\n                  setTimeout(next, 0);\n              }\n          }\n      }\n      reset() {\n          this.onReady = [];\n          this.pending = false;\n          delete this.value;\n      }\n      renameSheet(oldSheetName, newSheetName) {\n          oldSheetName = oldSheetName.toLowerCase();\n          this.absrefs = null;\n          if (this.sheet.toLowerCase() == oldSheetName) {\n              this.sheet = newSheetName;\n          }\n          this.refs.forEach(function(ref) {\n              ref.renameSheet(oldSheetName, newSheetName);\n          });\n      }\n      adjust(affectedSheet, operation, start, delta) {\n          affectedSheet = affectedSheet.toLowerCase();\n          var formulaRow = this.row;\n          var formulaCol = this.col;\n          var formulaSheet = this.sheet.toLowerCase();\n          var formulaMoves = false;\n          if (formulaSheet == affectedSheet) {\n              // move formula if it's after the change point\n              if (operation == \"row\" && formulaRow >= start) {\n                  this.row += delta;\n                  formulaMoves = true;\n              }\n              if (operation == \"col\" && formulaCol >= start) {\n                  this.col += delta;\n                  formulaMoves = true;\n              }\n          }\n          var newFormulaRow = this.row;\n          var newFormulaCol = this.col;\n          this.absrefs = null;\n          var prevRefs = this.refs;\n          var modified = formulaMoves;\n          this.refs = prevRefs.map(function(ref) {\n              var newRef = adjust(ref);\n              if (!modified && !sameRef(newRef, ref)) {\n                  modified = true;\n              }\n              return newRef;\n          });\n\n          var prevRange = this.arrayFormulaRange;\n          if (prevRange) {\n              this.arrayFormulaRange = adjust(prevRange);\n              if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                  modified = true;\n              }\n          }\n\n          if (modified) {\n              // return a clone of the original formula.  needed to undo operations like\n              // deleteRow, which can transform a reference into NULL.\n              return new Formula(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n          }\n\n          function adjust(ref) {\n              if (ref === NULLREF) {\n                  return ref;\n              }\n              if (ref.sheet.toLowerCase() != affectedSheet) {\n                  if (formulaMoves) {\n                      // a reference to another sheet should still point to the same location\n                      // after adjustment; thus if row/col was removed before formula, relative\n                      // references must be adjusted by delta.\n                      if (operation == \"row\" && formulaRow >= start) {\n                          ref = ref.relative(delta, 0);\n                      }\n                      if (operation == \"col\" && formulaCol >= start) {\n                          ref = ref.relative(0, delta);\n                      }\n                  }\n                  return ref;\n              }\n              return ref.adjust(\n                  formulaRow, formulaCol,\n                  newFormulaRow, newFormulaCol,\n                  operation == \"row\",\n                  start, delta\n              );\n          }\n      }\n      toString() {\n          return this.print(this.row, this.col);\n      }\n  };\n\n  // spreadsheet functions --------\n\n  FUNCS$1[\"if\"] = function(callback, args) {\n      var self = this;\n      var co = args[0], th = args[1], el = args[2];\n      // XXX: I don't like this resolveCells here.  We should try to declare IF with\n      // defineFunction.\n      this.resolveCells([ co ], function() {\n          var comatrix = self.asMatrix(co);\n          if (comatrix) {\n              // XXX: calling both branches in this case, since we'll typically need values from\n              // both.  We could optimize and call them only when first needed, but oh well.\n              th(function(th) {\n                  el(function(el) {\n                      var thmatrix = self.asMatrix(th);\n                      var elmatrix = self.asMatrix(el);\n                      callback(comatrix.map(function(val, row, col) {\n                          if (val instanceof CalcError) {\n                              return val;\n                          } else if (self.bool(val)) {\n                              return thmatrix ? thmatrix.get(row, col) : th;\n                          } else {\n                              return elmatrix ? elmatrix.get(row, col) : el;\n                          }\n                      }));\n                  });\n              });\n          } else {\n              co = this.force(co);\n              if (co instanceof CalcError) {\n                  callback(co);\n              } else if (self.bool(co)) {\n                  th(callback);\n              } else {\n                  el(callback);\n              }\n          }\n      });\n  };\n\n  FUNCS$1[\"φ\"] = function(callback) {\n      callback((1 + Math.sqrt(5)) / 2);\n  };\n\n  // Lasciate ogni speranza, voi ch'entrate.\n  //\n  // XXX: document this function.\n  function compileArgumentChecks(functionName, args) {\n      var arrayArgs = \"function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; \";\n      var resolve = \"function resolve(args, callback) { var toResolve = [], i = 0; \";\n      var name, forced, main = \"'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; \", haveForced = false;\n      var canBeArrayArg = false, hasArrayArgs = false;\n      main += args.map(comp).join(\"\");\n      main += \"if (i < args.length) return new CalcError('N/A'); \";\n      main += \"return xargs; } \";\n      arrayArgs += \"return { args: xargs, width: width, height: height, arrays: arrays }; } \";\n\n      var f;\n      if (haveForced) {\n          resolve += \"this.resolveCells(toResolve, callback); } \";\n          f = new Function(\"kendo\", \"CalcError\", \"round\", main + resolve + arrayArgs + \" return { resolve: resolve, check: check, arrayArgs: arrayArgs };\");\n      } else {\n          f = new Function(\"kendo\", \"CalcError\", \"round\", main + \" return { check: check };\");\n      }\n      f = f(calc.kendo, CalcError, limitPrecision$1);\n      if (!hasArrayArgs) {\n          delete f.arrayArgs;\n      }\n      return f;\n\n      function comp(x) {\n          name = x[0];\n          var code = \"{ \";\n          if (Array.isArray(name)) {\n              arrayArgs += \"while (i < args.length) { \";\n              resolve += \"while (i < args.length) { \";\n              code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n              code += \"while (i < args.length) { \";\n              code += x.map(comp).join(\"\");\n              code += \"} \";\n              code += \"xargs = stack.pop(); \";\n              resolve += \"} \";\n              arrayArgs += \"} \";\n          } else if (name == \"+\") {\n              arrayArgs += \"while (i < args.length) { \";\n              resolve += \"while (i < args.length) { \";\n              code += \"if (i >= args.length) return new CalcError('N/A'); \";\n              code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n              code += \"do { \";\n              code += x.slice(1).map(comp).join(\"\");\n              code += \"} while (i < args.length); \";\n              code += \"xargs = stack.pop(); \";\n              resolve += \"} \";\n              arrayArgs += \"} \";\n          } else if (name == \"?\") {\n              // standalone assertion without a new argument\n              code += \"if (!(\" + cond(x[1]) + \")) return new CalcError(err); \";\n          } else {\n              var type = x[1];\n              if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                  var wantNulls = /!$/.test(type[0]);\n                  var n = type[2];\n                  force();\n                  code += \"try {\"\n                      + \"var $\" + name + \" = this.cellValues(args.slice(i\";\n                  if (n) {\n                      code += \", i + \" + n;\n                  }\n                  code += \")\" + (wantNulls ? \",true\" : \"\") + \").reduce(function(ret, $\" + name + \"){ \";\n                  if (type[0].charAt(0) != \"#\") {\n                      code += \"if ($\" + name + \" instanceof CalcError) throw $\" + name + \"; \";\n                  }\n                  code += \"if (\" + cond(type[1]) + \") ret.push($\" + name + \"); \";\n                  code += \"return ret; \";\n                  code += \"}.bind(this), []); \";\n                  if (n) {\n                      code += \"i += \" + n + \"; \";\n                  } else {\n                      code += \"i = args.length; \";\n                  }\n                  code += \"xargs.push($\" + name + \")\"\n                      + \"} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } \";\n                  resolve += \"toResolve.push(args.slice(i)); \";\n              } else if (type == \"rest\") {\n                  code += \"xargs.push(args.slice(i)); i = args.length; \";\n              } else {\n                  if ((canBeArrayArg = /^\\*/.test(name))) {\n                      hasArrayArgs = true;\n                      name = name.substr(1);\n                  }\n                  code += \"var $\" + name + \" = args[i++]; \";\n                  var allowError = false;\n                  if (/!$/.test(type)) {\n                      type = type.substr(0, type.length - 1);\n                      allowError = true;\n                  } else {\n                      code += \"if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n                  }\n                  code += typeCheck(type, allowError) + \"xargs.push($\" + name + \"); \";\n              }\n          }\n          code += \"} \";\n          return code;\n      }\n\n      function force() {\n          if (forced) {\n              return \"$\" + name + \"\";\n          }\n          haveForced = true;\n          forced = true;\n          resolve += \"toResolve.push(args[i++]); \";\n          return \"($\" + name + \" = this.force($\" + name + \"))\";\n      }\n\n      function forceNum(round) {\n          return \"(\"\n              + (round\n                 ? (\"(typeof \" + force() + \" == 'number' ? ($\" + name + \" = round($\" + name + \"), true) : false) || \")\n                 : (\"(typeof \" + force() + \" == 'number') || \"))\n              + \"(typeof $\" + name + \" == 'boolean' ? ($\" + name + \" = +$\" + name + \", true) : false) || \"\n              + \"(typeof $\" + name + \" == 'string' && !/^(?:=|true|false)/i.test($\" + name + \") ? (\"\n              + \"tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $\" + name + \"), \"\n              + \"/^date|number|percent$/.test(tmp.type) ? ($\" + name + \" = +tmp.value, true) : false\"\n              + \") : false)\"\n              + \")\";\n      }\n\n      function typeCheck(type, allowError) {\n          forced = false;\n          var ret = \"if (!(\" + cond(type) + \")) { \";\n          if (forced && !allowError) {\n              ret += \" if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n          }\n          ret += \"return new CalcError(err); } \";\n          if (!forced) {\n              resolve += \"i++; \";\n          }\n          if (canBeArrayArg) {\n              arrayArgs += \"var $\" + name + \" = this._arrayArg(args[i]); \"\n                  + \"if ($\" + name + \") { \"\n                  + \"xargs.push($\" + name + \"); \"\n                  + \"width = Math.max(width, $\" + name + \".width); \"\n                  + \"height = Math.max(height, $\" + name + \".height); \"\n                  + \"arrays.push(true) } else { \"\n                  + \"xargs.push(args[i]); \"\n                  + \"arrays.push(false); } i++; \";\n          } else {\n              arrayArgs += \"xargs.push(args[i++]); arrays.push(false); \";\n          }\n          return ret;\n      }\n\n      function cond(type) {\n          if (Array.isArray(type)) {\n              if (type[0] == \"or\") {\n                  return \"(\" + type.slice(1).map(cond).join(\") || (\") + \")\";\n              }\n              if (type[0] == \"and\") {\n                  return \"(\" + type.slice(1).map(cond).join(\") && (\") + \")\";\n              }\n              if (type[0] == \"values\") {\n                  return \"(\" + type.slice(1).map(function(val) {\n                      return force() + \" === \" + val;\n                  }).join(\") || (\") + \")\";\n              }\n              if (type[0] == \"null\") {\n                  return \"(\" + cond(\"null\") + \" ? (($\" + name + \" = \" + type[1] + \"), true) : false)\";\n              }\n              if (type[0] == \"between\" || type[0] == \"[between]\") {\n                  return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\" + name + \" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n              }\n              if (type[0] == \"(between)\") {\n                  return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\" + name + \" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n              }\n              if (type[0] == \"(between]\") {\n                  return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\" + name + \" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n              }\n              if (type[0] == \"[between)\") {\n                  return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\" + name + \" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n              }\n              if (type[0] == \"assert\") {\n                  var err = type[2] || \"N/A\";\n                  return \"((\" + type[1] + \") ? true : (err = \" + JSON.stringify(err) + \", false))\";\n              }\n              if (type[0] == \"not\") {\n                  return \"!(\" + cond(type[1]) + \")\";\n              }\n              throw new Error(\"Unknown array type condition: \" + type[0]);\n          }\n          if (type == \"number\" || type == \"datetime\") {\n              return forceNum(true);\n          }\n          if (type == \"number!\") {\n              return \"(typeof \" + force() + \" == 'number' ? ($\" + name + \" = round($\" + name + \"), true) : false)\";\n          }\n          if (type == \"integer\" || type == \"date\") {\n              return \"(\" + forceNum() + \" && (($\" + name + \" |= 0), true))\";\n          }\n          if (type == \"divisor\") {\n              return \"(\" + forceNum(true) + \" && ($\" + name + \" == 0 ? ((err = 'DIV/0'), false) : true))\";\n          }\n          if (type == \"number+\") {\n              return \"(\" + forceNum(true) + \" && ($\" + name + \" >= 0 ? true : ((err = 'NUM'), false)))\";\n          }\n          if (type == \"integer+\") {\n              return \"(\" + forceNum() + \" && (($\" + name + \" |= 0) >= 0 ? true : ((err = 'NUM'), false)))\";\n          }\n          if (type == \"number++\") {\n              return \"(\" + forceNum(true) + \" && ($\" + name + \" > 0 ? true : ((err = 'NUM'), false)))\";\n          }\n          if (type == \"integer++\") {\n              return \"(\" + forceNum() + \" && (($\" + name + \" |= 0) > 0 ? true : ((err = 'NUM'), false)))\";\n          }\n          if (type == \"string\") {\n              return \"((typeof \" + force() + \" == 'string' || typeof $\" + name + \" == 'boolean' || typeof $\" + name + \" == 'number') ? ($\" + name + \" += '', true) : ($\" + name + \" === undefined ? (($\" + name + \" = ''), true) : false))\";\n          }\n          if (type == \"boolean\") {\n              return \"(typeof \" + force() + \" == 'boolean')\";\n          }\n          if (type == \"logical\") {\n              return \"(typeof \" + force() + \" == 'boolean' || (typeof $\" + name + \" == 'number' ? ($\" + name + \" = !!$\" + name + \", true) : false))\";\n          }\n          if (type == \"matrix\") {\n              force();\n              return \"((m = this.asMatrix($\" + name + \")) ? ($\" + name + \" = m) : false)\";\n          }\n          if (type == \"#matrix\") {\n              return \"((m = this.asMatrix($\" + name + \")) ? ($\" + name + \" = m) : false)\";\n          }\n          if (type == \"ref\") {\n              return \"($\" + name + \" instanceof kendo.spreadsheet.Ref)\";\n          }\n          if (type == \"area\") {\n              return \"($\" + name + \" instanceof kendo.spreadsheet.CellRef || $\" + name + \" instanceof kendo.spreadsheet.RangeRef)\";\n          }\n          if (type == \"cell\") {\n              return \"($\" + name + \" instanceof kendo.spreadsheet.CellRef)\";\n          }\n          if (type == \"null\") {\n              return \"(\" + force() + \" == null)\";\n          }\n          if (type == \"anyvalue\") {\n              return \"(\" + force() + \" != null && i <= args.length)\";\n          }\n          if (type == \"forced\") {\n              return \"(\" + force() + \", i <= args.length)\";\n          }\n          if (type == \"anything\") {\n              return \"(i <= args.length)\";\n          }\n          if (type == \"blank\") {\n              return \"(\" + force() + \" == null || $\" + name + \" === '')\";\n          }\n          throw new Error(\"Can't check for type: \" + type);\n      }\n  }\n\n  function limitPrecision$1(num, digits) {\n      return num === parseInt(num, 10) ? num : +num.toPrecision(digits || 16);\n  }\n\n  function maybeRoundFloatErrors(num, digits) {\n      if (typeof num == \"number\") {\n          return limitPrecision$1(num, digits);\n      } else {\n          return num;\n      }\n  }\n\n  function withErrorHandling(obj, f, args) {\n      if (args instanceof CalcError) {\n          return args;\n      }\n      try {\n          return f.apply(obj, args);\n      } catch (ex) {\n          if (ex instanceof CalcError) {\n              return ex;\n          } else {\n              throw ex;\n          }\n      }\n  }\n\n  function makeSyncFunction(handler, resolve, check, arrayArgs) {\n      return function(callback, args) {\n          function doit() {\n              if (arrayArgs) {\n                  let x = arrayArgs.call(this, args);\n                  args = x.args;\n                  if (x.width > 0 && x.height > 0) {\n                      let result = new Matrix(this);\n                      for (let row = 0; row < x.height; ++row) {\n                          for (let col = 0; col < x.width; ++col) {\n                              let xargs = [];\n                              for (let i = 0; i < args.length; ++i) {\n                                  if (x.arrays[i]) {\n                                      xargs[i] = args[i].getNA(row, col);\n                                  } else {\n                                      xargs[i] = args[i];\n                                  }\n                              }\n                              xargs = check.call(this, xargs);\n                              result.set(row, col, withErrorHandling(this, handler, xargs));\n                          }\n                      }\n                      return callback(result);\n                  }\n              }\n              let xargs = check.call(this, args);\n              callback(withErrorHandling(this, handler, xargs));\n          }\n          if (resolve) {\n              resolve.call(this, args, doit);\n          } else {\n              doit.call(this);\n          }\n      };\n  }\n\n  function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n      return function(callback, args) {\n          function doit() {\n              if (arrayArgs) {\n                  let x = arrayArgs.call(this, args);\n                  args = x.args;\n                  if (x.width > 0 && x.height > 0) {\n                      let result = new Matrix(this);\n                      let count = x.width * x.height;\n                      let makeCallback = function(row, col) {\n                          return function(value) {\n                              result.set(row, col, value);\n                              --count;\n                              if (count === 0) {\n                                  return callback(result);\n                              }\n                          };\n                      };\n                      for (let row = 0; row < x.height && count > 0; ++row) {\n                          for (let col = 0; col < x.width && count > 0; ++col) {\n                              let xargs = [];\n                              for (let i = 0; i < args.length; ++i) {\n                                  if (x.arrays[i]) {\n                                      xargs[i] = args[i].getNA(row, col);\n                                  } else {\n                                      xargs[i] = args[i];\n                                  }\n                              }\n                              xargs = check.call(this, xargs);\n                              if (xargs instanceof CalcError) {\n                                  result.set(row, col, xargs);\n                                  --count;\n                                  if (count === 0) {\n                                      return callback(result);\n                                  }\n                              } else {\n                                  xargs.unshift(makeCallback(row, col));\n                                  handler.apply(this, xargs);\n                              }\n                          }\n                      }\n                      return;\n                  }\n              }\n              let x = check.call(this, args);\n              if (x instanceof CalcError) {\n                  callback(x);\n              } else {\n                  x.unshift(callback);\n                  handler.apply(this, x);\n              }\n          }\n          if (resolve) {\n              resolve.call(this, args, doit);\n          } else {\n              doit.call(this);\n          }\n      };\n  }\n\n  function defineFunction(name, func) {\n      name = name.toLowerCase();\n      FUNCS$1[name] = func;\n      return {\n          args: function(args, log) {\n              var code = compileArgumentChecks(name, args);\n              // XXX: DEBUG\n              if (log) {\n                  if (code.arrayArgs) {window.console.log(code.arrayArgs.toString());}\n                  if (code.resolve) {window.console.log(code.resolve.toString());}\n                  if (code.check) {window.console.log(code.check.toString());}\n              }\n              var f = FUNCS$1[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n              f.kendoSpreadsheetArgs = args;\n              return this;\n          },\n          argsAsync: function(args, log) {\n              var code = compileArgumentChecks(name, args);\n              // XXX: DEBUG\n              if (log) {\n                  if (code.arrayArgs) {window.console.log(code.arrayArgs.toString());}\n                  if (code.resolve) {window.console.log(code.resolve.toString());}\n                  if (code.check) {window.console.log(code.check.toString());}\n              }\n              var f = FUNCS$1[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n              f.kendoSpreadsheetArgs = args;\n              return this;\n          }\n      };\n  }\n\n  function defineBuiltinFunction$1(name, isAsync, x, impl) {\n      FUNCS$1[name] = isAsync\n          ? makeAsyncFunction(impl, x.resolve, x.check, x.arrayArgs)\n          : makeSyncFunction(impl, x.resolve, x.check, x.arrayArgs);\n  }\n\n  /* -----[ date calculations ]----- */\n\n  // Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n\n  function dateToJulianDays(y, m, d) {\n      m++;\n      return ((1461 * (y + 4800 + ((m - 14) / 12 | 0))) / 4 | 0) +\n          ((367 * (m - 2 - 12 * ((m - 14) / 12 | 0))) / 12 | 0) -\n          ((3 * (((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n          d - 32075;\n  }\n\n  function julianDaysToDate(jd) {\n      var l, n, j, i, m, d, y;\n      l = jd + 68569;\n      n = (4 * l) / 146097 | 0;\n      l = l - ((146097 * n + 3) / 4 | 0);\n      i = (4000 * (l + 1) / 1461001) | 0;\n      l = l - ((1461 * i) / 4 | 0) + 31;\n      j = (80 * l) / 2447 | 0;\n      d = l - ((2447 * j) / 80 | 0);\n      l = j / 11 | 0;\n      m = j + 2 - (12 * l);\n      y = 100 * (n - 49) + i + l;\n      m--;\n      return {\n          year  : y,\n          month : m,\n          date  : d,\n          day   : (jd + 1) % 7,\n          ord   : ORDINAL_ADD_DAYS[isLeapYear$1(y)][m] + d\n      };\n  }\n\n  // This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n  // implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\n  var BASE_DATE = dateToJulianDays(1900, 0, -1);\n\n  var DAYS_IN_MONTH = [ 31, 28, 31,\n                        30, 31, 30,\n                        31, 31, 30,\n                        31, 30, 31 ];\n\n  var ORDINAL_ADD_DAYS = [\n      [ 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 ], // non-leap year\n      [ 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 ]  // leap year\n  ];\n\n  function isLeapYear$1(yr) {\n      if (yr % 4) {\n          return 0;\n      }\n      if (yr % 100) {\n          return 1;\n      }\n      if (yr % 400) {\n          return 0;\n      }\n      return 1;\n  }\n\n  function daysInYear$1(yr) {\n      return isLeapYear$1(yr) ? 366 : 365;\n  }\n\n  function daysInMonth$1(yr, mo) {\n      return (isLeapYear$1(yr) && mo == 1) ? 29 : DAYS_IN_MONTH[mo];\n  }\n\n  function validDate(yr, mo, da) {\n      return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth$1(yr, mo - 1);\n  }\n\n  function unpackDate$2(serial) {\n      return julianDaysToDate((serial | 0) + BASE_DATE);\n  }\n\n  function packDate$2(year, month, date) {\n      return dateToJulianDays(year, month, date) - BASE_DATE;\n  }\n\n  var MS_IN_MIN = 60 * 1000;\n  var MS_IN_HOUR = 60 * MS_IN_MIN;\n  var MS_IN_DAY = 24 * MS_IN_HOUR;\n\n  function unpackTime$1(serial) {\n      var frac = serial - (serial | 0);\n      if (frac < 0) {\n          frac++;\n      }\n      var ms = Math.round(MS_IN_DAY * frac);\n      var hours = Math.floor(ms / MS_IN_HOUR);\n      ms -= hours * MS_IN_HOUR;\n      var minutes = Math.floor(ms / MS_IN_MIN);\n      ms -= minutes * MS_IN_MIN;\n      var seconds = Math.floor(ms / 1000);\n      ms -= seconds * 1000;\n      return {\n          hours: hours,\n          minutes: minutes,\n          seconds: seconds,\n          milliseconds: ms\n      };\n  }\n\n  function serialToDate$2(serial) {\n      var d = unpackDate$2(serial), t = unpackTime$1(serial);\n      return new Date(d.year, d.month, d.date,\n                      t.hours, t.minutes, t.seconds, t.milliseconds);\n  }\n\n  function packTime$1(hh, mm, ss, ms) {\n      return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n  }\n\n  function dateToSerial$2(date) {\n      var time = packTime$1(date.getHours(),\n                          date.getMinutes(),\n                          date.getSeconds(),\n                          date.getMilliseconds());\n      date = packDate$2(date.getFullYear(),\n                      date.getMonth(),\n                      date.getDate());\n      if (date < 0) {\n          return date - 1 + time;\n      } else {\n          return date + time;\n      }\n  }\n\n  function parseDate(str, format) {\n      if (format) {\n          format = calc.formatting.makeDateFormat(format);\n      }\n      const parseExactDate = intl().parseDate;\n      return parseExactDate(str, format)\n          || parseExactDate(str)\n          || parseExactDate(str, [\n              \"MMMM dd yyyy\",\n              \"MMMM dd yy\",\n              \"MMM dd yyyy\",\n              \"MMM dd yy\",\n              \"dd MMMM yyyy\",\n              \"dd MMMM yy\",\n              \"dd MMM yyyy\",\n              \"dd MMM yy\",\n              \"MMMM dd, yyyy\",\n              \"MMMM dd, yy\",\n              \"MMM dd, yyyy\",\n              \"MMM dd, yy\",\n              \"MMMM dd\",\n              \"MMM dd\",\n              \"MMMM yyyy\",\n              \"MMM yyyy\",\n              \"dd MMMM\",\n              \"dd MMM\"\n          ]);\n  }\n\n  function defineAlias$1(alias, name) {\n      var orig = FUNCS$1[name];\n      if (!orig) {\n          throw new Error(\"Function \" + name + \" is not yet defined\");\n      }\n      if (!orig.kendoSpreadsheetAliases) {\n          orig.kendoSpreadsheetAliases = [ name ];\n      }\n      orig.kendoSpreadsheetAliases.push(alias);\n      FUNCS$1[alias] = orig;\n  }\n\n  class ParseError {\n      constructor(message, pos) {\n          this.message = message;\n          this.pos = pos;\n      }\n      toString() {\n          return this.message;\n      }\n  }\n\n  function InputStream(input) {\n      let pos = 0;\n      return {\n          next        : next,\n          peek        : peek,\n          eof         : eof,\n          croak       : croak,\n          readWhile   : readWhile,\n          readEscaped : readEscaped,\n          lookingAt   : lookingAt,\n          skip        : skip,\n          forward     : forward,\n          pos         : location\n      };\n      function location() {\n          return pos;\n      }\n      function next() {\n          let ch = input.charAt(pos++);\n          return ch;\n      }\n      function peek() {\n          return input.charAt(pos);\n      }\n      function eof() {\n          return peek() === \"\";\n      }\n      function croak(msg) {\n          throw new ParseError(msg + \" (input: \" + input + \")\", pos);\n      }\n      function skip(ch) {\n          if (typeof ch == \"string\") {\n              if (input.substr(pos, ch.length) !== ch) {\n                  croak(\"Expected \" + ch);\n              }\n              forward(ch.length);\n          } else if (ch instanceof RegExp) {\n              let m = ch.exec(input.substr(pos));\n              if (m) {\n                  forward(m[0].length);\n                  return m;\n              }\n          } else {\n              // assuming RegExp match data\n              forward(ch[0].length);\n          }\n      }\n      function forward(n) {\n          while (n-- > 0) {\n              next();\n          }\n      }\n      function readEscaped(end) {\n          let escaped = false, str = \"\";\n          while (!eof()) {\n              let ch = next();\n              if (escaped) {\n                  str += ch;\n                  escaped = false;\n              } else if (ch === \"\\\\\") {\n                  escaped = true;\n              } else if (ch === end) {\n                  break;\n              } else {\n                  str += ch;\n              }\n          }\n          return str;\n      }\n      function readWhile(predicate) {\n          let str = \"\";\n          while (!eof() && predicate(peek(), str)) {\n              str += next();\n          }\n          return str;\n      }\n      function lookingAt(rx) {\n          return rx.exec(input.substr(pos));\n      }\n  }\n\n  /* -----[ exports ]----- */\n\n  calc.runtime.CalcError = CalcError;\n  calc.runtime.Formula = Formula$1;\n  calc.runtime.Matrix = Matrix;\n  calc.runtime.packDate = packDate$2;\n  calc.runtime.unpackDate = unpackDate$2;\n  calc.runtime.packTime = packTime$1;\n  calc.runtime.unpackTime = unpackTime$1;\n  calc.runtime.serialToDate = serialToDate$2;\n  calc.runtime.dateToSerial = dateToSerial$2;\n  calc.runtime.daysInMonth = daysInMonth$1;\n  calc.runtime.validDate = validDate;\n  calc.runtime.isLeapYear = isLeapYear$1;\n  calc.runtime.daysInYear = daysInYear$1;\n  calc.runtime.parseDate = parseDate;\n  calc.runtime.limitPrecision = limitPrecision$1;\n  calc.runtime.defineBuiltinFunction = defineBuiltinFunction$1;\n  calc.runtime.defineAlias = defineAlias$1;\n  calc.runtime.InputStream = InputStream;\n  calc.runtime.ParseError = ParseError;\n\n  /* eslint-disable indent */\n\n  function Node() {\n      this.node = null;\n  }\n  Node.prototype = {\n      remove: function() {\n          if (this.node.parentNode) {\n              this.node.parentNode.removeChild(this.node);\n          }\n          this.attr = {};\n      },\n      attr: {},\n      text: function() {\n          return \"\";\n      }\n  };\n  function NullNode() {\n  }\n  NullNode.prototype = {\n      nodeName: \"#null\",\n      attr: { style: {} },\n      children: [],\n      remove: function() {\n      }\n  };\n  let NULL_NODE = new NullNode();\n  function Element(nodeName, attr, children) {\n      this.nodeName = nodeName;\n      this.attr = attr || {};\n      this.children = children || [];\n  }\n  Element.prototype = new Node();\n  Element.prototype.appendTo = function(parent) {\n      let node = typeof(this.nodeName) === \"string\" ? document.createElement(this.nodeName) : this.nodeName;\n      let children = this.children;\n      for (let index = 0; index < children.length; index++) {\n          children[index].render(node, NULL_NODE);\n      }\n      parent.appendChild(node);\n      return node;\n  };\n  Element.prototype.render = function(parent, cached) {\n      let node;\n      if (cached.nodeName !== this.nodeName) {\n          cached.remove();\n          node = this.appendTo(parent);\n      } else {\n          node = cached.node;\n          let index;\n          let children = this.children;\n          let length = children.length;\n          let cachedChildren = cached.children;\n          let cachedLength = cachedChildren.length;\n          if (Math.abs(cachedLength - length) > 2) {\n              this.render({\n                  appendChild: function(node) {\n                      parent.replaceChild(node, cached.node);\n                  }\n              }, NULL_NODE);\n              return;\n          }\n          for (index = 0; index < length; index++) {\n              children[index].render(node, cachedChildren[index] || NULL_NODE);\n          }\n          for (index = length; index < cachedLength; index++) {\n              cachedChildren[index].remove();\n          }\n      }\n      this.node = node;\n      this.syncAttributes(cached.attr);\n      this.removeAttributes(cached.attr);\n  };\n  Element.prototype.syncAttributes = function(cachedAttr) {\n      let attr = this.attr;\n      for (let name in attr) {\n          let value = attr[name];\n          let cachedValue = cachedAttr[name];\n          if (name === \"style\") {\n              this.setStyle(value, cachedValue);\n          } else if (value !== cachedValue) {\n              this.setAttribute(name, value, cachedValue);\n          }\n      }\n  };\n  Element.prototype.setStyle = function(style, cachedValue) {\n      let node = this.node;\n      let key;\n      if (cachedValue) {\n          for (key in style) {\n              if (style[key] !== cachedValue[key]) {\n                  node.style[key] = style[key];\n              }\n          }\n      } else {\n          for (key in style) {\n              node.style[key] = style[key];\n          }\n      }\n  };\n  Element.prototype.removeStyle = function(cachedStyle) {\n      let style = this.attr.style || {};\n      let node = this.node;\n      for (let key in cachedStyle) {\n          if (style[key] === undefined) {\n              node.style[key] = \"\";\n          }\n      }\n  };\n  Element.prototype.removeAttributes = function(cachedAttr) {\n      let attr = this.attr;\n      for (let name in cachedAttr) {\n          if (name === \"style\") {\n              this.removeStyle(cachedAttr.style);\n          } else if (attr[name] === undefined) {\n              this.removeAttribute(name);\n          }\n      }\n  };\n  Element.prototype.removeAttribute = function(name) {\n      let node = this.node;\n      if (name === \"style\") {\n          node.style.cssText = \"\";\n      } else if (name === \"className\") {\n          node.className = \"\";\n      } else {\n          node.removeAttribute(name);\n      }\n  };\n  Element.prototype.setAttribute = function(name, value) {\n      let node = this.node;\n      if (node[name] !== undefined) {\n          node[name] = value;\n      } else {\n          node.setAttribute(name, value);\n      }\n  };\n  Element.prototype.text = function() {\n      let str = \"\";\n      for (let i = 0; i < this.children.length; ++i) {\n          str += this.children[i].text();\n      }\n      return str;\n  };\n  function TextNode(nodeValue) {\n      this.nodeValue = String(nodeValue);\n  }\n  TextNode.prototype = new Node();\n  TextNode.prototype.nodeName = \"#text\";\n  TextNode.prototype.render = function(parent, cached) {\n      let node;\n      if (cached.nodeName !== this.nodeName) {\n          cached.remove();\n          node = document.createTextNode(this.nodeValue);\n          parent.appendChild(node);\n      } else {\n          node = cached.node;\n          if (this.nodeValue !== cached.nodeValue) {\n              if (node.parentNode) {\n                  // sometimes in IE parentNode is null (reason unknown),\n                  // and IE throws an error when you try to set a\n                  // parentless' nodeValue, because why not.\n                  node.nodeValue = this.nodeValue;\n              }\n          }\n      }\n      this.node = node;\n  };\n  TextNode.prototype.text = function() {\n      return this.nodeValue;\n  };\n  function HtmlNode(html) {\n      this.html = html;\n  }\n  HtmlNode.prototype = {\n      nodeName: \"#html\",\n      attr: {},\n      remove: function() {\n          for (let index = 0; index < this.nodes.length; index++) {\n             let el = this.nodes[index];\n             if (el.parentNode) {\n                 el.parentNode.removeChild(el);\n             }\n         }\n      },\n      render: function(parent, cached) {\n          if (cached.nodeName !== this.nodeName || cached.html !== this.html) {\n             cached.remove();\n             let lastChild = parent.lastChild;\n             insertHtml(parent, this.html);\n             this.nodes = [];\n             for (let child = lastChild ? lastChild.nextSibling : parent.firstChild; child; child = child.nextSibling) {\n                 this.nodes.push(child);\n             }\n         } else {\n             this.nodes = cached.nodes.slice(0);\n         }\n      }\n  };\n\n  function insertHtml(node, html) {\n      const HTML_CONTAINER = document.createElement(\"div\");\n      HTML_CONTAINER.innerHTML = html;\n      while (HTML_CONTAINER.firstChild) {\n          node.appendChild(HTML_CONTAINER.firstChild);\n      }\n  }\n  function html(value) {\n      return new HtmlNode(value);\n  }\n  function element(nodeName, attrs, children) {\n      return new Element(nodeName, attrs, children);\n  }\n  function text$1(value) {\n      return new TextNode(value);\n  }\n  function Tree(root) {\n      this.root = root;\n      this.children = [];\n  }\n  Tree.prototype = {\n      html: html,\n      element: element,\n      text: text$1,\n      render: function(children) {\n          let cachedChildren = this.children;\n          let index;\n          let length;\n          for (index = 0, length = children.length; index < length; index++) {\n              let cached = cachedChildren[index];\n              if (!cached) {\n                  cached = NULL_NODE;\n              } else if (!cached.node || !cached.node.parentNode) {\n                  cached.remove();\n                  cached = NULL_NODE;\n              }\n              children[index].render(this.root, cached);\n          }\n          for (index = length; index < cachedChildren.length; index++) {\n              cachedChildren[index].remove();\n          }\n          this.children = children;\n      }\n  };\n\n  const dom = {\n      html: html,\n      text: text$1,\n      element: element,\n      Tree: Tree,\n      Node: Node\n  };\n\n  //--------------------------------------------------- custom number format.\n\n\n  let RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n  let RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n\n  /* eslint-disable complexity */\n\n  /* The proper amount of suffering for whoever designed the Excel\n     Custom Number Format would be to have him implement the\n     formatter himself. */\n\n  function parse$2(input) {\n      input = calc.runtime.InputStream(input);\n      let sections = [], haveConditional = false, decimalPart;\n      while (!input.eof()) {\n          let sec = readSection();\n          sections.push(sec);\n          if (sec.cond) {\n              haveConditional = true;\n          }\n      }\n      // From https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4:\n      //\n      //    A number format can have up to four sections of code, separated by semicolons. These\n      //    code sections define the format for positive numbers, negative numbers, zero values,\n      //    and text, in that order.\n      //\n      //    You do not have to include all code sections in your custom number format. If you\n      //    specify only two code sections for your custom number format, the first section is\n      //    used for positive numbers and zeros, and the second section is used for negative\n      //    numbers. If you specify only one code section, it is used for all numbers. If you want\n      //    to skip a code section and include a code section that follows it, you must include\n      //    the ending semicolon for the section that you skip.\n      //\n      // However, if sections have conditionals, it is not clear if:\n      //\n      //    - still at most four are allowed\n      //    - is the last section still for text\n      //\n      // We will assume that if no sections have conditionals, then there must be at most 4, and\n      // they will be interpreted in the order above.  If the first section contains a\n      // conditional, then there can be any number of them; if the last one is not conditional\n      // then it will be interpreted as text format.\n      if (!haveConditional) {\n          if (sections.length === 1) {\n              sections[0].cond = \"num\";\n          } else if (sections.length === 2) {\n              sections[0].cond = { op: \">=\", value: 0 };\n              sections[1].cond = { op: \"<\", value: 0 };\n          } else if (sections.length >= 3) {\n              sections[0].cond = { op: \">\", value: 0 };\n              sections[1].cond = { op: \"<\", value: 0 };\n              sections[2].cond = { op: \"=\", value: 0 };\n              if (sections.length > 3) {\n                  sections[3].cond = \"text\";\n                  sections = sections.slice(0, 4);\n              }\n          }\n      }\n      return sections;\n      function maybeColor() {\n          let m = input.skip(RX_COLORS);\n          if (m) {\n              return m[1].toLowerCase();\n          }\n      }\n      function maybeCondition() {\n          let m = input.skip(RX_CONDITION);\n          if (m) {\n              let val = parseFloat(m[2]);\n              if (!isNaN(val)) {\n                  return { op: m[1], value: val, custom: true };\n              }\n          }\n      }\n      function readFormat() {\n          let format = [], tok, prev = null;\n          while (!input.eof() && (tok = readNext())) {\n              // disambiguate: m/mm might mean month or minutes depending on surrounding context.\n              if (tok.type === \"date\") {\n                  if (prev && /^(el)?time$/.test(prev.type) && prev.part === \"h\"\n                      && tok.part === \"m\" && tok.format < 3) {\n                      // m or mm that follows hours should display minutes\n                      tok.type = \"time\";\n                  }\n              } else if (/^(el)?time$/.test(tok.type) && tok.part === \"s\") {\n                  if (prev && prev.type === \"date\" && prev.part === \"m\"\n                      && prev.format < 3) {\n                      // m or mm followed by seconds should display minutes\n                      prev.type = \"time\";\n                  }\n              }\n              if (!(/^(?:str|space|fill)$/.test(tok.type))) {\n                  prev = tok;\n              }\n              format.push(tok);\n          }\n          return format;\n      }\n      function maybeFraction(tok) {\n          if (tok.type !== \"date\" || (tok.part === \"m\" && tok.format < 3)) {\n              let m = input.skip(/^\\.(0+)/);\n              if (m) {\n                  tok.fraction = m[1].length;\n                  if (tok.type === \"date\") {\n                      tok.type = \"time\";\n                  }\n              }\n          }\n          return tok;\n      }\n      function readNext() {\n          let ch, m;\n          // numbers\n          if ((m = input.skip(/^([#0?]+)(?:,([#0?]+))+/))) {\n              // thousands separator.  seems convenient to treat\n              // this as a single token.\n              return { type: \"digit\", sep: true, format: m[1] + m[2], decimal: decimalPart };\n          }\n          if ((m = input.skip(/^[#0?]+/))) {\n              return { type: \"digit\", sep: false, format: m[0], decimal: decimalPart };\n          }\n          // XXX: handle this one!\n          if ((m = input.skip(/^(e)([+-])/i))) {\n              return { type: \"exp\", ch: m[1], sign: m[2] };\n          }\n          // dates\n          if ((m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy|y)/i))) {\n              m = m[1].toLowerCase();\n              return maybeFraction({ type: \"date\", part: m.charAt(0), format: m.length });\n          }\n          // time (interpret as a date)\n          if ((m = input.skip(/^(hh?|ss?)/i))) { // m and mm are handled above\n              m = m[1].toLowerCase();\n              return maybeFraction({ type: \"time\", part: m.charAt(0), format: m.length });\n          }\n          // elapsed time (interpret as interval of days)\n          if ((m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i))) {\n              m = m[1].toLowerCase();\n              return maybeFraction({ type: \"eltime\", part: m.charAt(0), format: m.length });\n          }\n          if ((m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i))) {\n              m = m[1].split(\"/\");\n              return { type: \"ampm\", am: m[0], pm: m[1] };\n          }\n          switch ((ch = input.next())) { // JSHint sadness\n            case \";\":\n              return null;\n            case \"\\\\\":\n              // quotes next character\n              return { type: \"str\", value: input.next() };\n            case '\"':\n              return { type: \"str\", value: input.readEscaped(ch) };\n            case \"@\":\n              return { type: \"text\" };\n            case \"_\":\n              // whitespace of the width of following character\n              return { type: \"space\", value: input.next() };\n            case \"*\":\n              // fills cell width with the following character\n              return { type: \"fill\", value: input.next() };\n            case \".\":\n              if (input.lookingAt(/^\\s*[#0?]/)) {\n                  decimalPart = true;\n                  return { type: \"dec\" };\n              }\n              return { type: \"str\", value: \".\" };\n            case \"%\":\n              return { type: \"percent\" };\n            case \",\":\n              return { type: \"comma\" };\n          }\n          // whatever we can't make sense of, output literally.\n          return { type: \"str\", value: ch };\n      }\n      function readSection() {\n          decimalPart = false;\n          let color = maybeColor(), cond = maybeCondition();\n          if (!color && cond) {\n              color = maybeColor();\n          }\n          return {\n              color: color,\n              cond: cond,\n              body: readFormat()\n          };\n      }\n  }\n\n  function print$1(sections) {\n      return sections.map(printSection).join(\";\");\n      function printSection(sec) {\n          let out = \"\";\n          if (sec.color) {\n              out += \"[\" + sec.color + \"]\";\n          }\n          if (sec.cond) {\n              if (!(sec.cond === \"text\" || sec.cond === \"num\")) {\n                  out += \"[\" + sec.cond.op + sec.cond.value + \"]\";\n              }\n          }\n          out += sec.body.map(printToken).join(\"\");\n          return out;\n      }\n      function maybeFraction(fmt, tok) {\n          if (tok.fraction) {\n              fmt += \".\" + padLeft(\"\", tok.fraction, \"0\");\n          }\n          return fmt;\n      }\n      function printToken(tok) {\n          if (tok.type === \"digit\") {\n              if (tok.sep) {\n                  return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n              } else {\n                  return tok.format;\n              }\n          } else if (tok.type === \"exp\") {\n              return tok.ch + tok.sign;\n          } else if (tok.type === \"date\" || tok.type === \"time\") {\n              return maybeFraction(padLeft(\"\", tok.format, tok.part), tok);\n          } else if (tok.type === \"eltime\") {\n              return maybeFraction(\"[\" + padLeft(\"\", tok.format, tok.part) + \"]\", tok);\n          } else if (tok.type === \"ampm\") {\n              return tok.am + \"/\" + tok.pm;\n          } else if (tok.type === \"str\") {\n              return JSON.stringify(tok.value);\n          } else if (tok.type === \"text\") {\n              return \"@\";\n          } else if (tok.type === \"space\") {\n              return \"_\" + tok.value;\n          } else if (tok.type === \"fill\") {\n              return \"*\" + tok.value;\n          } else if (tok.type === \"dec\") {\n              return \".\";\n          } else if (tok.type === \"percent\") {\n              return \"%\";\n          } else if (tok.type === \"comma\") {\n              return \",\";\n          }\n      }\n  }\n\n  function adjustDecimals(sections, x) {\n      sections.forEach(function(sec) {\n          let diff = x;\n          if (sec.cond === \"text\") {\n              return;\n          }\n          let body = sec.body, adjusted = false, i = body.length;\n          while (diff !== 0 && --i >= 0) {\n              let tok = body[i];\n              if (tok.type === \"digit\") {\n                  if (tok.decimal) {\n                      adjusted = true;\n                      if (diff > 0) {\n                          tok.format += padLeft(\"\", diff, \"0\");\n                      } else if (diff < 0) {\n                          let tmp = tok.format.length;\n                          tok.format = tok.format.substr(0, tmp + diff);\n                          diff += tmp - tok.format.length;\n                      }\n                      if (tok.format.length === 0) {\n                          body.splice(i, 1);\n                          while (--i >= 0) {\n                              tok = body[i];\n                              if (tok.type === \"digit\" && tok.decimal) {\n                                  ++i;\n                                  break;\n                              }\n                              if (tok.type === \"dec\") {\n                                  body.splice(i, 1);\n                                  break;\n                              }\n                          }\n                      }\n                  }\n                  if (diff > 0) {\n                      break;\n                  }\n              }\n          }\n          if (!adjusted && diff > 0) {\n              // no decimal part was found, insert one after the last digit token.\n              body.splice(\n                  i + 1, 0, {\n                      type    : \"dec\"\n                  }, {\n                      type    : \"digit\",\n                      sep     : false,\n                      decimal : true,\n                      format  : padLeft(\"\", diff, \"0\")\n                  }\n              );\n          }\n      });\n  }\n\n  function TokenStream2(parts) {\n      let index = 0;\n      return {\n          next: function() {\n              return parts[index++];\n          },\n          eof: function() {\n              return index >= parts.length;\n          },\n          ahead: function(n, f) {\n              if (index + n <= parts.length) {\n                  let val = f.apply(null, parts.slice(index, index + n));\n                  if (val) {\n                      index += n;\n                  }\n                  return val;\n              }\n          },\n          restart: function() {\n              index = 0;\n          }\n      };\n  }\n\n  let runtime$1 = {\n      unpackDate: calc.runtime.unpackDate,\n      unpackTime: calc.runtime.unpackTime,\n\n      date: function(culture, d, part, length) {\n          switch (part) {\n            case \"d\":\n              switch (length) {\n              case 1: return d.date;\n              case 2: return padLeft(d.date, 2, \"0\");\n              case 3: return culture.calendar.days.format.abbreviated[d.day];\n              case 4: return culture.calendar.days.format.wide[d.day];\n              }\n              break;\n            case \"m\":\n              switch (length) {\n              case 1: return d.month + 1;\n              case 2: return padLeft(d.month + 1, 2, \"0\");\n              case 3: return culture.calendar.months.format.abbreviated[d.month];\n              case 4: return culture.calendar.months.format.wide[d.month];\n              case 5: return culture.calendar.months.format.narrow[d.month];\n              }\n              break;\n            case \"y\":\n              switch (length) {\n              case 1: return d.year;\n              case 2: return d.year % 100;\n              case 4: return d.year;\n              }\n              break;\n          }\n          return \"##\";\n      },\n\n      time: function(t, part, length, ampm, fraclen) {\n          let ret, fraction;\n          switch (part) {\n            case \"h\":\n              ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, \"0\");\n              if (fraclen) {\n                  fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n              }\n              break;\n            case \"m\":\n              ret = padLeft(t.minutes, length, \"0\");\n              if (fraclen) {\n                  fraction = (t.seconds + t.milliseconds / 1000) / 60;\n              }\n              break;\n            case \"s\":\n              ret = padLeft(t.seconds, length, \"0\");\n              if (fraclen) {\n                  fraction = t.milliseconds / 1000;\n              }\n              break;\n          }\n          if (fraction) {\n              ret += runtime$1.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n          }\n          return ret;\n      },\n\n      eltime: function(value, part, length, fraclen) {\n          let ret, fraction;\n          switch (part) {\n            case \"h\":\n              ret = value * 24;\n              break;\n            case \"m\":\n              ret = value * 24 * 60;\n              break;\n            case \"s\":\n              ret = value * 24 * 60 * 60;\n              break;\n          }\n          if (fraclen) {\n              fraction = ret - (ret | 0);\n          }\n          ret = padLeft(ret | 0, length, \"0\");\n          if (fraction) {\n              ret += runtime$1.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n          }\n          return ret;\n      },\n\n      fill: function(ch) {\n          // XXX: how to implement this?\n          return ch;\n      },\n\n      // formatting integer part is slightly different than decimal\n      // part, so they're implemented in two functions.  For the\n      // integer part we need to walk the value and the format\n      // backwards (right-to-left).\n\n      formatInt: function(culture, value, parts, declen, sep) {\n          // toFixed is perfect for rounding our value; if there is\n          // no format for decimals, for example, we want the number\n          // rounded up.\n          value = runtime$1.toFixed(value, declen).replace(/\\..*$/, \"\");\n          let lastPart = parts[parts.length - 1];\n\n          if (declen > 0 && lastPart[parts.length - 1] != \"0\") {\n              // if the rounded number is zero and we have decimal\n              // format, consider it a non-significant digit (Excel\n              // won't display the leading zero for 0.2 in format #.#).\n              // the zero won't e omitted if using 0.0 format\n              if (value === \"0\") { value = \"\"; }\n              else if (value === \"-0\") { value = \"-\"; }\n          }\n\n          let shouldInsertMinus = false;\n          let iv = value.length - 1;\n          let result = [];\n          let len = 0, str;\n\n          function add(ch, skipMinus) {\n              if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                  str = culture.numbers.symbols.group + str;\n              }\n              if (skipMinus && ch === \"-\") {\n                  shouldInsertMinus = true;\n                  ch = \"0\";\n              }\n              str = ch + str;\n              len++;\n          }\n\n          for (let j = parts.length; --j >= 0;) {\n              let format = parts[j];\n              str = \"\";\n              for (let k = format.length; --k >= 0;) {\n                  let chf = format.charAt(k);\n                  if (iv < 0) {\n                      if (chf == \"0\") {\n                          add(\"0\");\n                      } else if (chf == \"?\") {\n                          add(\" \");\n                      }\n                  } else {\n                      if (value == \"0\" && chf == \"?\") {\n                          add(\" \");\n                      } else if (chf == \"0\") {\n                          add(value.charAt(iv), true);\n                      } else {\n                          add(value.charAt(iv));\n                      }\n                      iv--;\n                  }\n              }\n              if (j === 0) {\n                  while (iv >= 0) {\n                      add(value.charAt(iv--));\n                  }\n              }\n              result.unshift(str);\n          }\n\n          if (shouldInsertMinus) {\n              result[0] = \"-\" + result[0];\n          }\n\n          return result;\n      },\n\n      // for decimal part we walk in normal direction and pad on the\n      // right if required (for '0' or '?' chars).\n\n      formatDec: function(value, parts, declen) {\n          value = runtime$1.toFixed(value, declen);\n          let pos = value.indexOf(\".\");\n          if (pos >= 0) {\n              value = value.substr(pos + 1).replace(/0+$/, \"\");\n          } else {\n              value = \"\";\n          }\n\n          let iv = 0;\n          let result = [];\n\n          for (let j = 0; j < parts.length; ++j) {\n              let format = parts[j];\n              let str = \"\";\n              for (let k = 0; k < format.length; ++k) {\n                  let chf = format.charAt(k);\n                  if (iv < value.length) {\n                      str += value.charAt(iv++);\n                  } else if (chf == \"0\") {\n                      str += \"0\";\n                  } else if (chf == \"?\") {\n                      str += \" \";\n                  }\n              }\n              result.push(str);\n          }\n\n          return result;\n      },\n\n      // JS's toFixed is broken, it's only OK to use it on integers.\n      toFixed: function(value, decimals) {\n          return (function toFixed(value, last) {\n              if (!isFinite(value)) {\n                  return \"#NUM!\";\n              }\n\n              // deal early with the trivial cases\n              if (value < 0) {    // JS's Math.round is broken with negative numbers\n                  return \"-\" + toFixed(-value);\n              }\n\n              if (decimals === 0) { // no decimals\n                  return String(Math.round(value));\n              }\n\n              if (value === Math.round(value) && !/e/i.test(String(value))) { // value is integer and not too big\n                  return value.toFixed(decimals);\n              }\n\n              // this handles cases like 0.3.toFixed(20) == \"0.29999999999999998890\", or\n              // 2.1825.toFixed(20) = \"2.18250000000000010658\".\n              // https://github.com/telerik/kendo-ui-core/issues/3520#issuecomment-333768221\n              // https://twitter.com/mcbazon/status/1035828655652593665\n              let num = digNumber(value);\n              let intpart = num.intpart;\n              let decpart = num.decpart;\n              if (decpart.length <= decimals) {\n                  while (decpart.length < decimals) {\n                      decpart += \"0\";\n                  }\n                  return intpart + \".\" + decpart;\n              }\n\n              if (last) {\n                  // \"we should definitely not get here\" (famous last words).  Let's MAKE SURE\n                  // there's no more recursion.\n                  return intpart + \".\" + decpart.substr(0, decimals);\n              }\n\n              // if there are more decimals than wanted, round and try again.\n              // it should not recurse more than once.\n              let f = Math.pow(10, decimals);\n              return toFixed(Math.round(value * f) / f, true);\n\n          })(Number(value.toFixed(14))); /* restrict to 14 decimals, because 0.1 + 0.2 ===\n                                          * 0.30000000000000004 */\n      }\n\n  };\n\n  function checkCondition(condition, a, b) {\n      switch (condition.op) {\n        case \"=\":\n          return a == b;\n        case \"<\":\n          return a < b;\n        case \">\":\n          return a > b;\n        case \"<=\":\n          return a <= b;\n        case \">=\":\n          return a >= b;\n      }\n      throw new Error(`Unknown condition operator: ${JSON.stringify(condition)}`);\n  }\n\n  function compileFormatPart(format) {\n      let input = TokenStream2(format.body);\n      let hasDate = false;\n      let hasTime = false;\n      let hasAmpm = false;\n      let percentCount = 0;\n      let currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n      let scaleCount = 0;\n      let separeThousands = false;\n      let declen = 0;\n      let intFormat = [], decFormat = [];\n      let condition = format.cond;\n\n      function checkComma(a, b) {\n          if ((a.type === \"digit\" && b.type === \"comma\") || (a.type === \"comma\" && a.hidden && b.type === \"comma\")) {\n              b.hidden = true;\n              scaleCount++;\n          }\n      }\n      while (!input.eof()) {\n          input.ahead(2, checkComma);\n          let tok = input.next();\n          if (tok.type === \"percent\") {\n              percentCount++;\n          }\n          else if (tok.type === \"digit\") {\n              if (tok.decimal) {\n                  declen += tok.format.length;\n                  decFormat.push(tok.format);\n              } else {\n                  intFormat.push(tok.format);\n                  if (tok.sep) {\n                      separeThousands = true;\n                  }\n              }\n          }\n          else if (tok.type === \"time\") {\n              hasTime = true;\n          }\n          else if (tok.type === \"date\") {\n              hasDate = true;\n          }\n          else if (tok.type === \"ampm\") {\n              hasAmpm = hasTime = true;\n          }\n      }\n\n      return function interpret(result, value, culture) {\n          let intPart, decPart, isNegative, date, time;\n          if (condition === \"text\") {\n              if (!(typeof value == \"string\" || value instanceof CalcError)) {\n                  return false;\n              }\n          }\n          else if (condition === \"num\") {\n              if (typeof value != \"number\") {\n                  return false;\n              }\n          }\n          else if (condition) {\n              if (typeof value != \"number\") {\n                  return false;\n              }\n              if (!checkCondition(condition, value, condition.value)) {\n                  return false;\n              }\n              if (!condition.custom) {\n                  value = Math.abs(value);\n              }\n          }\n          if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n              if (typeof value != \"number\") {\n                  return false;\n              }\n          }\n          if (format.color) {\n              result.color = format.color;\n          }\n          if (percentCount > 0) {\n              value *= Math.pow(100, percentCount);\n          }\n          if (scaleCount > 0) {\n              value /= Math.pow(1000, scaleCount);\n          }\n          if (intFormat.length) {\n              intPart = runtime$1.formatInt(culture, value, intFormat, declen, separeThousands);\n              isNegative = parseInt(intPart[0]) < 0;\n          }\n          if (decFormat.length) {\n              decPart = runtime$1.formatDec(value, decFormat, declen);\n          }\n          if (intFormat.length || decFormat.length) {\n              result.type = \"number\";\n          }\n          if (hasDate) {\n              date = runtime$1.unpackDate(value);\n          }\n          if (hasTime) {\n              time = runtime$1.unpackTime(value);\n          }\n          if (hasDate || hasTime) {\n              result.type = \"date\";\n          }\n          let matchedCurrency = false, output = \"\";\n          input.restart();\n          while (!input.eof()) {\n              let tok = input.next();\n              if (tok.type === \"dec\") {\n                  output += culture.numbers.symbols.decimal;\n              }\n              else if (tok.type === \"comma\" && !tok.hidden) {\n                  output += ',';\n              }\n              else if (tok.type === \"percent\") {\n                  result.type = \"percent\";\n                  output += culture.numbers.symbols.percentSign;\n              }\n              else if (tok.type === \"str\") {\n                  if (currency.test(tok.value)) {\n                      result.type = \"currency\";\n                      if (isNegative) {\n                          output += \"-\";\n                          matchedCurrency = true;\n                      }\n                  }\n                  output += tok.value;\n              }\n              else if (tok.type === \"text\") {\n                  result.type = \"text\";\n                  output += value; // XXX: sure not `tok.value`?\n              }\n              else if (tok.type === \"space\") {\n                  if (output) {\n                      result.body.push(output);\n                  }\n                  output = \"\";\n                  result.body.push(tok);\n              }\n              else if (tok.type === \"fill\") {\n                  output += runtime$1.fill(tok.value);\n              }\n              else if (tok.type === \"digit\") {\n                  if (isNegative && intPart[0] && matchedCurrency) {\n                      intPart[0] = intPart[0].replace(\"-\", \"\");\n                  }\n                  output += tok.decimal ? decPart.shift() : intPart.shift();\n              }\n              else if (tok.type === \"date\") {\n                  output += runtime$1.date(culture, date, tok.part, tok.format);\n              }\n              else if (tok.type === \"time\") {\n                  output += runtime$1.time(time, tok.part, tok.format, hasAmpm, tok.fraction);\n              }\n              else if (tok.type === \"eltime\") {\n                  output += runtime$1.eltime(value, tok.part, tok.format, tok.fraction);\n              }\n              else if (tok.type === \"ampm\") {\n                  // XXX: should use culture?  As per the \"spec\", Excel\n                  // displays whatever the token was (AM/PM, a/p etc.)\n                  output += time.hours < 12 ? tok.am : tok.pm;\n              }\n          }\n          if (output) {\n              result.body.push(output);\n          }\n          return true;\n      };\n  }\n\n  let TEXT = compileFormatPart({ cond: \"text\", body: [ { type: \"text\" } ] });\n\n  let compile = memoize(function(format) {\n      let tree = parse$2(format);\n      let parts = tree.map(compileFormatPart);\n      parts.push(TEXT);\n      return function(value, localCulture = culture()) {\n          let result = { body: [] };\n          for (let i = 0; i < parts.length; ++i) {\n              if (parts[i](result, value, localCulture)) {\n                  break;\n              }\n          }\n          return result;\n      };\n  });\n\n  // Attempts to produce a format compatible with kendo.parseDate from our Excel format.  Needed\n  // in runtime.parseDate (passing Excel format to kendo.parseDate will mess up the month or\n  // minutes).  https://github.com/telerik/kendo-ui-core/issues/3797\n  let makeDateFormat = memoize(function(format) {\n      let tree = parse$2(format);\n      let section, found = false, hasAmpm = false;\n      // locate a section that contains date/time formatting.  only the first will be converted.\n      for (let i = 0; i < tree.length; ++i) {\n          section = tree[i];\n          for (let j = 0; j < section.body.length; ++j) {\n              if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                  found = true;\n                  if (section.body[j].type === \"ampm\") {\n                      hasAmpm = true;\n                  }\n              }\n          }\n          if (found) {\n              break;\n          }\n      }\n      if (!found) {\n          return null;\n      }\n      return section.body.map(printToken).join(\"\");\n      // a little copy/paste goes a long way\n      function maybeFraction(fmt, tok) {\n          if (tok.fraction) {\n              fmt += padLeft(\"\", Math.max(tok.fraction, 3), \"f\");\n          }\n          return fmt;\n      }\n      function printToken(tok) {\n          if (tok.type === \"digit\") {\n              if (tok.sep) {\n                  return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n              } else {\n                  return tok.format;\n              }\n          }\n          else if (tok.type === \"exp\") {\n              return tok.ch + tok.sign;\n          }\n          else if (tok.type === \"date\" || tok.type === \"time\") {\n              let part = tok.part;\n              if (tok.type === \"date\" && /^m/.test(part)) {\n                  part = \"M\"; // month, not minutes\n              }\n              else if (tok.type === \"time\" && /^h/.test(part)) {\n                  if (!hasAmpm) {\n                      // 24-hours clock is H or HH\n                      part = part.toUpperCase();\n                  }\n              }\n              return maybeFraction(padLeft(\"\", tok.format, part), tok);\n          }\n          else if (tok.type === \"ampm\") {\n              return \"tt\";\n          }\n          else if (tok.type === \"str\") {\n              // XXX: this is a bit wrong.  it doesn't look like kendo.toString / kendo.parseDate\n              // support arbitrary text (in Excel formats that's quoted), for example:\n              //    kendo.toString(new Date(), \"here's the day dude: dd\")\n              //  → \"3ere'8 t3e 19ay 19u19e: 19\"   (it's 19th June, 3 o'clock, probably 8 seconds)\n              return tok.value;\n          }\n          else if (tok.type === \"space\") {\n              return \" \";\n          }\n          else if (tok.type === \"dec\") {\n              return \".\";\n          }\n          else if (tok.type === \"percent\") {\n              return \"%\";\n          }\n          else if (tok.type === \"comma\") {\n              return \",\";\n          }\n          else {\n              return \"\";\n          }\n      }\n  });\n\n  function padLeft(val, width, ch) {\n      val += \"\";\n      while (val.length < width) {\n          val = ch + val;\n      }\n      return val;\n  }\n\n  function padRight(val, width, ch) {\n      val += \"\";\n      while (val.length < width) {\n          val += ch;\n      }\n      return val;\n  }\n\n  // given a number, return { intpart, decpart } as strings.  the main difficulty here is that JS\n  // will stringify really large values in scientific notation (e.g. 1.23e+30, which is actually\n  // the integer 1230000000000000000000000000000).\n  function digNumber(num) {\n      let str = String(num).toLowerCase();\n      let intpart, decpart, m;\n      let pos = str.indexOf(\".\");\n      if (pos < 0) {\n          pos = str.indexOf(\"e\");\n          if (pos < 0) {\n              intpart = str;\n              decpart = \"\";\n          } else {\n              intpart = str.substr(0, pos);\n              decpart = str.substr(pos);\n          }\n      } else {\n          intpart = str.substr(0, pos);\n          decpart = str.substr(pos + 1);\n      }\n      if ((m = /(\\d*)e([-+]?\\d+)/.exec(decpart))) {\n          let exp = parseInt(m[2], 10);\n          if (exp >= 0) {\n              decpart = padRight(m[1], exp, \"0\");\n              intpart += decpart.substr(0, exp);\n              decpart = decpart.substr(exp);\n          } else {\n              intpart = padLeft(intpart, -exp, \"0\");\n              decpart = intpart.substr(exp) + m[1];\n              intpart = intpart.substr(0, intpart.length + exp);\n          }\n      }\n      return { intpart: intpart || \"0\", decpart: decpart };\n  }\n\n  /* -----[ exports ]----- */\n  function text(f) {\n      let a = f.body;\n      let text = \"\";\n      for (let i = 0; i < a.length; ++i) {\n          let el = a[i];\n          if (typeof el == \"string\") {\n              text += el;\n          } else if (el.type === \"space\") {\n              text += \" \";\n          }\n      }\n      return text;\n  }\n\n  const formatting = {\n      compile : compile,\n      parse: parse$2,\n      format: function(value, format, culture) {\n          let f = compile(format)(value, culture);\n          let span = dom.element(\"span\");\n          span.__dataType = f.type;\n          let a = f.body;\n          if (f.color) {\n              span.attr.style = { color: f.color };\n          }\n          for (let i = 0; i < a.length; ++i) {\n              let el = a[i];\n              if (typeof el == \"string\") {\n                  span.children.push(dom.text(el));\n              } else if (el.type === \"space\") {\n                  span.children.push(dom.element(\"span\", {\n                      style: { visibility: \"hidden\" }\n                  }, [ dom.text(el.value) ]));\n              }\n          }\n          return span;\n      },\n      text: function(value, format, culture) {\n          let f = compile(format)(value, culture);\n          return text(f);\n      },\n      textAndColor: function(value, format, culture) {\n          let f = compile(format)(value, culture);\n          return { text: text(f), color: f.color, type: f.type };\n      },\n      type: function(value, format, culture) {\n          return compile(format)(value, culture).type;\n      },\n      adjustDecimals: function(format, diff) {\n          let ast = parse$2(format);\n          adjustDecimals(ast, diff);\n          return print$1(ast);\n      },\n      makeDateFormat: makeDateFormat\n  };\n\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable space-infix-ops */\n  /* eslint-disable indent */\n  /* eslint-disable no-empty */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable consistent-return */\n  /* eslint-disable block-scoped-var */\n  /* eslint-disable no-redeclare */\n  /* eslint-disable no-var */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable complexity */\n  /* eslint-disable max-params */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable key-spacing */\n  /* eslint-disable default-case */\n  /* eslint-disable camelcase */\n  /* eslint-disable brace-style */\n  /* eslint-disable no-else-return */\n  /* eslint-disable no-constant-condition */\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable space-before-blocks */\n  /* eslint-disable no-unused-labels */\n\n\n  const kendo = createKendoObj(calc, CalcError, Ref, CellRef, RangeRef);\n  calc.kendo = kendo; // XXX\n  calc.formatting = formatting;\n\n  // --------------------------------------------calc.js\n\n  // Excel formula parser and compiler to JS.\n  // some code adapted from http://lisperator.net/pltut/\n\n  // these two will hold the same operators, except that when the comma is used as decimal\n  // separator, the union operator must be the semicolon (;) instead of comma.\n  let OPERATORS_STANDARD = Object.create(null);\n  let OPERATORS_COMMA = Object.create(null);\n\n  (function(ops){\n      ops.forEach(function(cls, i){\n          cls.forEach(function(op){\n              OPERATORS_STANDARD[op] = ops.length - i;\n              OPERATORS_COMMA[op === \",\" ? \";\" : op] = ops.length - i;\n          });\n      });\n  })([\n      [ \":\" ],\n      [ \" \" ],\n      [ \",\" ],\n      [ \"%\" ],\n      [ \"^\" ],\n      [ \"*\", \"/\" ],\n      [ \"+\", \"-\" ],\n      [ \"&\" ],\n      [ \"=\", \"<\", \">\", \"<=\", \">=\", \"<>\" ]\n  ]);\n\n  let OPERATORS = OPERATORS_STANDARD;\n\n  let SEPARATORS = {\n      DEC: \".\",\n      ARG: \",\",\n      COL: \",\"\n  };\n\n  function setDecimalSeparator(sep) {\n      SEPARATORS.DEC = sep;\n      SEPARATORS.ARG = sep === \",\" ? \";\" : \",\";\n      SEPARATORS.COL = sep === \",\" ? \"\\\\\" : \",\";\n      OPERATORS = sep === \",\" ? OPERATORS_COMMA : OPERATORS_STANDARD;\n  }\n\n  calc.withDecimalSeparator = function(sep, f) {\n      if (SEPARATORS.DEC === sep) {\n          return f();\n      }\n      let save = SEPARATORS.DEC;\n      setDecimalSeparator(sep);\n      try {\n          return f();\n      } finally {\n          setDecimalSeparator(save);\n      }\n  };\n\n  calc._separators = SEPARATORS;\n\n  let TRUE = { type: \"bool\", value: true };\n  let FALSE = { type: \"bool\", value: false };\n\n  function getcol(str) {\n      str = str.toUpperCase();\n      let col = 0;\n      for (let i = 0; i < str.length; ++i) {\n          col = col * 26 + str.charCodeAt(i) - 64;\n      }\n      return col - 1;\n  }\n\n  function getrow(str) {\n      return parseInt(str, 10) - 1;\n  }\n\n  function parseReference(name, noThrow) {\n      if (name.toLowerCase() === \"#sheet\") {\n          return SHEETREF;\n      }\n      OUT: {\n          // this is redundant, but let's keep it fast for the most\n          // common case — A1.  If this fails, we'll try to employ the\n          // whole tokenizer.\n          let m;\n          if ((m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name))) {\n              let row = getrow(m[4]), col = getcol(m[2]);\n              if (row < 0x100000 && col < 0x4000) {\n                  return new CellRef(getrow(m[4]), getcol(m[2]));\n              }\n              // no NameRef-s from this function\n              break OUT;\n          }\n          let stream = TokenStream(name, {});\n          let a = [];\n          while (true) {\n              let ref = stream.next();\n              if (ref instanceof CellRef) {\n                  // this function always makes absolute references\n                  ref.rel = 0;\n              } else if (ref instanceof RangeRef) {\n                  ref.topLeft.rel = 0;\n                  ref.bottomRight.rel = 0;\n              } else {\n                  break OUT;\n              }\n              a.push(ref);\n              if (stream.eof()) {\n                  break;\n              }\n              if (!stream.is(\"op\", SEPARATORS.ARG)) {\n                  break OUT;\n              }\n              stream.next();\n          }\n          return a.length === 1 ? a[0] : new UnionRef(a);\n      }\n      if (!noThrow) {\n          throw new Error(\"Cannot parse reference: \" + name);\n      }\n  }\n\n  function parseFormula(sheet, row, col, input) {\n      let refs = [];\n      input = TokenStream(input, { row: row, col: col });\n      let is = input.is;\n\n      return {\n          type: \"exp\",\n          ast: parseExpression(true),\n          refs: refs,\n          sheet: sheet,\n          row: row,\n          col: col\n      };\n\n      function addReference(ref) {\n          ref.index = refs.length;\n          refs.push(ref);\n          return ref;\n      }\n\n      function skip(type, value, allowEOF) {\n          if (is(type, value)) {\n              return input.next();\n          } else {\n              let tok = input.peek();\n              if (tok) {\n                  input.croak(\"Expected \" + type + \" «\" + value + \"» but found \" + tok.type + \" «\" + tok.value + \"»\");\n              } else if (!allowEOF) {\n                  input.croak(\"Expected \" + type + \" «\" + value + \"»\");\n              }\n          }\n      }\n\n      function parseExpression(commas) {\n          return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n      }\n\n      function parseSymbol(tok) {\n          if (tok.upper === \"TRUE\" || tok.upper === \"FALSE\") {\n              return tok.upper === \"TRUE\" ? TRUE : FALSE;\n          }\n          return addReference(new NameRef(tok.value));\n      }\n\n      function parseFuncall() {\n          let fname = input.next();\n          fname = fname.value;\n          skip(\"punc\", \"(\");\n          let args = [];\n          while (1) {\n              if (is(\"punc\", \")\")) {\n                  break;\n              }\n              if (is(\"op\", SEPARATORS.ARG)) {\n                  args.push({ type: \"null\" });\n                  input.next();\n                  continue;\n              }\n              args.push(parseExpression(false));\n              if (input.eof() || is(\"punc\", \")\")) {\n                  break;\n              }\n              skip(\"op\", SEPARATORS.ARG);\n          }\n          skip(\"punc\", \")\", true);\n          return {\n              type: \"func\",\n              func: fname,\n              args: args\n          };\n      }\n\n      function fixReference(ref) {\n          if (!ref.hasSheet()) {\n              ref.setSheet(sheet);\n          }\n          return addReference(ref);\n      }\n\n      function parseAtom() {\n          let exp;\n          if (is(\"ref\")) {\n              exp = fixReference(input.next());\n          }\n          else if (is(\"func\")) {\n              exp = parseFuncall();\n          }\n          else if (is(\"punc\", \"(\")) {\n              input.next();\n              exp = parseExpression(true);\n              skip(\"punc\", \")\", true);\n          }\n          else if (is(\"punc\", \"{\")) {\n              input.next();\n              exp = parseArray();\n              skip(\"punc\", \"}\", true);\n          }\n          else if (is(\"num\") || is(\"str\") || is(\"error\")) {\n              exp = input.next();\n          }\n          else if (is(\"sym\")) {\n              exp = parseSymbol(input.next());\n          }\n          else if (is(\"op\", \"+\") || is(\"op\", \"-\")) {\n              exp = {\n                  type: \"prefix\",\n                  op: input.next().value,\n                  exp: parseAtom()\n              };\n          }\n          else if (!input.peek()) {\n              input.croak(\"Incomplete expression\");\n          }\n          else if (is(\"punc\", \"[\")) {\n              input.croak(\"External reference not supported\");\n          }\n          else {\n              input.croak(\"Parse error\");\n          }\n          return maybePercent(exp);\n      }\n\n      function parseArray() {\n          let row = [], value = [ row ], first = true;\n          while (!input.eof() && !is(\"punc\", \"}\")) {\n              if (first) {\n                  first = false;\n              } else if (is(null, \";\")) {\n                  value.push(row = []);\n                  input.next();\n              } else {\n                  skip(null, SEPARATORS.COL);\n              }\n              row.push(parseExpression(false));\n          }\n          return {\n              type: \"matrix\",\n              value: value\n          };\n      }\n\n      function maybeIntersect(exp) {\n          if (is(\"punc\", \"(\") || is(\"ref\") || is(\"num\") || is(\"func\")) {\n              return {\n                  type: \"binary\",\n                  op: \" \",\n                  left: exp,\n                  right: parseExpression(false)\n              };\n          } else {\n              return exp;\n          }\n      }\n\n      function maybePercent(exp) {\n          if (is(\"op\", \"%\")) {\n              input.next();\n              return maybePercent({\n                  type: \"postfix\",\n                  op: \"%\",\n                  exp: exp\n              });\n          } else {\n              return exp;\n          }\n      }\n\n      function maybeBinary(left, my_prec, commas) {\n          let tok = is(\"op\");\n          if (tok && (commas || tok.value !== SEPARATORS.ARG)) {\n              let his_prec = OPERATORS[tok.value];\n              if (his_prec > my_prec) {\n                  input.next();\n                  let right = maybeBinary(parseAtom(), his_prec, commas);\n                  return maybeBinary({\n                      type: \"binary\",\n                      op: tok.value === \";\" ? \",\" : tok.value, // translate union back to comma\n                      left: left,\n                      right: right\n                  }, my_prec, commas);\n              }\n          }\n          return left;\n      }\n  }\n\n  function parseNameDefinition(name, def) {\n      let nameRef = parseFormula(null, 0, 0, name);\n      if (!(nameRef.ast instanceof NameRef)) {\n          throw new calc.runtime.ParseError(\"Invalid name: \" + name);\n      }\n      nameRef = nameRef.ast;\n\n      if (!(def instanceof Ref)) {\n          let defAST = parseFormula(nameRef.sheet, 0, 0, def);\n          if (defAST.ast instanceof Ref) {\n              def = defAST.ast;   // single reference\n          } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n              def = defAST.ast.value; // constant\n          } else {\n              def = makeFormula(defAST); // formula\n          }\n      }\n\n      return {\n          name: nameRef,\n          value: def\n      };\n  }\n\n  function print(exp, refs, row, col, mod) {\n      return print(exp.ast, exp, 0);\n\n      function print(node, parent, prec) {\n          switch (node.type) {\n            case \"num\":\n              return calc._separators.DEC == \".\" ? JSON.stringify(node.value)\n                  : JSON.stringify(node.value).replace(\".\", calc._separators.DEC);\n\n            case \"bool\":\n              return node.value;\n\n            case \"error\":\n              return \"#\" + node.value;\n\n            case \"str\":\n              return JSON.stringify(node.value);\n\n            case \"ref\":\n              return withParens(() =>\n                  refs[node.index].print(row, col, mod));\n\n            case \"prefix\":\n              return withParens(() =>\n                  node.op + print(node.exp, node, OPERATORS[node.op]));\n\n            case \"postfix\":\n              return withParens(() =>\n                  print(node.exp, node, OPERATORS[node.op]) + node.op);\n\n            case \"binary\":\n              return withParens(() => {\n                  let left = parenthesize(\n                      print(node.left, node, OPERATORS[node.op]),\n                      node.left instanceof NameRef && node.op === \":\"\n                  );\n                  let right = parenthesize(\n                      print(node.right, node, OPERATORS[node.op]),\n                      node.right instanceof NameRef && node.op === \":\"\n                  );\n                  if (/^[,;]/.test(node.op)) {\n                      return left + calc._separators.ARG + right;\n                  } else {\n                      return left + node.op + right;\n                  }\n              });\n\n            case \"func\":\n              return node.func + \"(\"\n                  + node.args.map(arg => print(arg, node, 0)).join(calc._separators.ARG + \" \") + \")\";\n\n            case \"matrix\":\n              return \"{ \" + node.value.map(tr => tr.map(td => print(td, node, 0)).join(calc._separators.COL)).join(\"; \") + \" }\";\n\n            case \"null\":\n              return \"\";\n          }\n\n          throw new Error(\"Cannot print node \" + node.type);\n\n          function withParens(f) {\n              let op = node.op;\n              let needParens = (OPERATORS[op] < prec\n                                || (!prec && op === \",\")\n                                || (parent.type === \"prefix\" && prec === OPERATORS[op] && parent.op === \"-\")\n                                || (parent.type === \"binary\" && prec === OPERATORS[op] && node === parent.right));\n              return parenthesize(f(), needParens);\n          }\n      }\n\n      function parenthesize(code, cond) {\n          return cond ? \"(\" + code + \")\" : code;\n      }\n  }\n\n  function makePrinter(exp) {\n      return function(row, col, mod) {\n          return print(exp, this.refs, row, col, mod);\n      };\n  }\n\n  /// BEGIN interpreter\n\n  function evRef(ctx, node, k) {\n      return node.ref === \"name\"\n          ? ctx.fetchName(node, k)\n          : k(ctx.formula.absrefs[node.index]);\n  }\n\n  function evFuncIf(ctx, co, th, el, k) {\n      return evaluate(ctx, co, co => ctx.func(\"if\", k, [\n          co,\n          k => evaluate(ctx, th, k),\n          k => evaluate(ctx, el, k)\n      ]));\n  }\n\n  function evFuncAnd(ctx, args, k) {\n      return args.length === 0 ? k(true)\n          : args.length === 1 ? evaluate(ctx, args[0], co => k(ctx.bool(co)))\n          : evaluate(ctx, args[0], co =>\n              ctx.bool(co)\n                  ? evFuncAnd(ctx, args.slice(1), k)\n                  : k(false));\n  }\n\n  function evFuncOr(ctx, args, k) {\n      return args.length === 0 ? k(false)\n          : args.length === 1 ? evaluate(ctx, args[0], co => k(ctx.bool(co)))\n          : evaluate(ctx, args[0], co =>\n              ctx.bool(co)\n                  ? k(true)\n                  : evFuncOr(ctx, args.slice(1), k));\n  }\n\n  function evFunc(ctx, node, k) {\n      switch (node.func.toLowerCase()) {\n        case \"if\":\n          return evFuncIf(ctx, node.args[0], node.args[1] || TRUE, node.args[2] || FALSE, k);\n        case \"and\":\n          return evFuncAnd(ctx, node.args, k);\n        case \"or\":\n          return evFuncOr(ctx, node.args, k);\n        case \"true\":\n          return k(true);\n        case \"false\":\n          return k(false);\n      }\n      return evArguments(ctx, node.args, 0, args => ctx.func(node.func, k, args));\n  }\n\n  function evArguments(ctx, args, i, k, ret = []) {\n      return i === args.length\n          ? k(ret)\n          : evaluate(ctx, args[i], val => (\n              ret[i] = val,\n              evArguments(ctx, args, i + 1, k, ret)\n          ));\n  }\n\n  function evBinary(ctx, node, k) {\n      return evaluate(ctx, node.left, left =>\n          evaluate(ctx, node.right, right =>\n              ctx.func(\"binary\" + node.op, k, [ left, right ])));\n  }\n\n  function evUnary(ctx, node, k) {\n      return evaluate(ctx, node.exp, exp =>\n          ctx.func(\"unary\" + node.op, k, [ exp ]));\n  }\n\n  function evMatrix(ctx, { value }, k) {\n      let a = [];\n      return (function loop(i){\n          return i === value.length ? k(a)\n              : evArguments(ctx, value[i], 0, row =>\n                  (a[i] = row, loop(i + 1)));\n      })(0);\n  }\n\n  function evaluate(ctx, node, k) {\n      switch (node.type) {\n        case \"ref\":\n          return evRef(ctx, node, k);\n        case \"num\":\n        case \"str\":\n        case \"null\":\n        case \"bool\":\n          return k(node.value);\n        case \"error\":\n          return k(ctx.error(node.value));\n        case \"prefix\":\n        case \"postfix\":\n          return evUnary(ctx, node, k);\n        case \"binary\":\n          return evBinary(ctx, node, k);\n        case \"func\":\n          return evFunc(ctx, node, k);\n        case \"matrix\":\n          return evMatrix(ctx, node, k);\n      }\n      throw new Error(\"Cannot evaluate \" + node.type);\n  }\n\n  function makeInterpreter({ ast }) {\n      return function() {\n          // `this` is the Context object (runtime.js), so don't attempt\n          // to make this an arrow function.\n          return evaluate(this, ast, val => this.resolve(val));\n      };\n  }\n\n  /// END interpreter\n\n  let FORMULA_CACHE = Object.create(null);\n\n  function makeFormula(exp) {\n      let printer = makePrinter(exp);\n      let hash = printer.call(exp); // needs .refs\n      let formula = FORMULA_CACHE[hash];\n      if (formula) {\n          // we need to clone because formulas cache the result; even if the formula is the same,\n          // its value will depend on its location, hence we need different objects.  Still, using\n          // this cache is a good idea because we'll reuse the same refs array, handler and\n          // printer, instead of allocating new ones (and we skip compiling it).\n          return formula.clone(exp.sheet, exp.row, exp.col);\n      }\n\n      formula = new calc.runtime.Formula(exp.refs, makeInterpreter(exp), printer, exp.sheet, exp.row, exp.col);\n      FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n      return formula;\n  }\n\n  function identity$1(x) {\n      return x;\n  }\n\n  function TokenStream(input, options) {\n      input = RawTokenStream(calc.runtime.InputStream(input), options);\n      let ahead = input.ahead;\n      let skip = input.skip;\n      let token = null;\n      let fixCell = options.row != null && options.col != null\n          ? function(cell) {\n              if (cell.rel & 1) {\n                  cell.col -= options.col;\n              }\n              if (cell.rel & 2) {\n                  cell.row -= options.row;\n              }\n              return cell;\n          }\n          : identity$1;\n\n      let addPos = options.forEditor\n          ? function(thing, startToken, endToken) {\n              thing.begin = startToken.begin;\n              thing.end = endToken.end;\n              return thing;\n          }\n          : identity$1;\n\n      return {\n          peek  : peek,\n          next  : next,\n          croak : input.croak,\n          eof   : input.eof,\n          is    : is\n      };\n\n      function is(type, value) {\n          let tok = peek();\n          return tok != null\n              && (type == null || tok.type === type)\n              && (value == null || tok.value === value)\n              ? tok : null;\n      }\n\n      function peek() {\n          if (token == null) {\n              token = readNext();\n          }\n          return token;\n      }\n\n      function next() {\n          if (token != null) {\n              let tmp = token;\n              token = null;\n              return tmp;\n          }\n          return readNext();\n      }\n\n      function readNext() {\n          let ret;\n          let t = input.peek();\n          if (t) {\n              if (t.type === \"sym\" || t.type === \"rc\" || t.type === \"num\") {\n                  ret = ahead(8, refRange3D)\n                      || ahead(6, refCell3D)\n                      || ahead(6, refSheetRange)\n                      || ahead(4, refSheetCell)\n                      || ahead(4, refRange)\n                      || ahead(2, refCell)\n                      || ahead(2, funcall);\n              }\n              if (!ret) {\n                  ret = input.next();\n              }\n          }\n          return ret;\n      }\n\n      function toCell(tok, isFirst) {\n          if (tok.type === \"rc\") {\n              // RC notation is read properly without knowing where\n              // we are, so no need to fixCell on this one.\n              // However, if only absolute refs were asked for (from\n              // i.e. parseReference) I feel it's alright to yell\n              // about it here.\n              if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                  input.croak(\"Cannot read relative cell in RC notation\");\n              }\n              return new CellRef(tok.row, tok.col, tok.rel);\n          }\n          if (tok.type === \"num\") {\n              if (tok.value <= 1048577) {\n                  // whole row\n                  return fixCell(new CellRef(\n                      getrow(tok.value),\n                      isFirst ? -Infinity : +Infinity,\n                      2\n                  ));\n              } else {\n                  return null;\n              }\n          }\n          // otherwise it's \"sym\".  The OOXML spec (SpreadsheetML\n          // 18.2.5) defines the maximum value to be interpreted as\n          // a cell reference to be XFD1048576.\n          let name = tok.value;\n          let m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n          if (m) {\n              let row = getrow(m[4]), col = getcol(m[2]);\n              if (row <= 1048576 && col <= 16383) {\n                  return fixCell(new CellRef(\n                      getrow(m[4]),\n                      getcol(m[2]),\n                      (m[1] ? 0 : 1) | (m[3] ? 0 : 2)\n                  ));\n              } else {\n                  return null;\n              }\n          }\n          let abs = name.charAt(0) === \"$\";\n          if (abs) {\n              name = name.substr(1);\n          }\n          if (/^\\d+$/.test(name)) {\n              let row = getrow(name);\n              if (row <= 1048576) {\n                  return fixCell(new CellRef(\n                      getrow(name),\n                      isFirst ? -Infinity : +Infinity,\n                      (abs ? 0 : 2)\n                  ));\n              }\n          } else {\n              let col = getcol(name);\n              if (col <= 16383) {\n                  return fixCell(new CellRef(\n                      isFirst ? -Infinity : +Infinity,\n                      getcol(name),\n                      (abs ? 0 : 1)\n                  ));\n              }\n          }\n      }\n\n      // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) :(f) C3(g) not followed by paren (h)\n      function refRange3D(a, b, c, d, e, f, g, h) {\n          if (a.type === \"sym\" &&\n              b.type === \"op\" && b.value === \":\" &&\n              c.type === \"sym\" &&\n              d.type === \"punc\" && d.value === \"!\" &&\n              (e.type === \"sym\" || e.type === \"rc\" || (e.type === \"num\" && e.value === e.value | 0)) &&\n              f.type === \"op\" && f.value === \":\" &&\n              (g.type === \"sym\" || g.type === \"rc\" || (g.type === \"num\" && g.value === g.value | 0)) &&\n              g.type === e.type &&\n              !(h.type === \"punc\" && h.value === \"(\" && !g.space))\n          {\n              let tl = toCell(e, true), br = toCell(g, false);\n              if (tl && br) {\n                  // skip them except the last one, we only wanted to\n                  // ensure it's not paren.\n                  skip(7);\n                  return addPos(new RangeRef(\n                      tl.setSheet(a.value, true),\n                      br.setSheet(c.value, true)\n                  ).setSheet(a.value, true), a, g);\n              }\n          }\n      }\n\n      // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) not followed by paren (f)\n      function refCell3D(a, b, c, d, e, f) {\n          if (a.type === \"sym\" &&\n              b.type === \"op\" && b.value === \":\" &&\n              c.type === \"sym\" &&\n              d.type === \"punc\" && d.value === \"!\" &&\n              (e.type === \"sym\" || e.type === \"rc\" || (e.type === \"num\" && e.value === e.value | 0)) &&\n              !(f.type === \"punc\" && f.value === \"(\" && !e.space))\n          {\n              let tl = toCell(e);\n              if (tl) {\n                  skip(5);\n                  let br = tl.clone();\n                  return addPos(new RangeRef(\n                      tl.setSheet(a.value, true),\n                      br.setSheet(c.value, true)\n                  ).setSheet(a.value, true), a, e);\n              }\n          }\n      }\n\n      // Sheet1(a) !(b) A1(c) :(d) C3(e) not followed by paren (f)\n      function refSheetRange(a, b, c, d, e, f) {\n          if (a.type === \"sym\" &&\n              b.type === \"punc\" && b.value === \"!\" &&\n              (c.type === \"sym\" || c.type === \"rc\" || (c.type === \"num\" && c.value === c.value | 0)) &&\n              d.type === \"op\" && d.value === \":\" &&\n              (e.type === \"sym\" || e.type === \"rc\" || (e.type === \"num\" && e.value === e.value | 0)) &&\n              !(f.type === \"punc\" && f.value === \"(\" && !e.space))\n          {\n              let tl = toCell(c, true), br = toCell(e, false);\n              if (tl && br) {\n                  skip(5);\n                  return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n              }\n          }\n      }\n\n      // Sheet1(a) !(b) A1(c) not followed by paren (d)\n      function refSheetCell(a, b, c, d) {\n          if (a.type === \"sym\" &&\n              b.type === \"punc\" && b.value === \"!\" &&\n              (c.type === \"sym\" || c.type === \"rc\" || (c.type === \"num\" && c.value === c.value | 0)) &&\n              !(d.type === \"punc\" && d.value === \"(\" && !c.space))\n          {\n              skip(3);\n              let x = toCell(c);\n              if (!x || !isFinite(x.row)) {\n                  x = new NameRef(c.value);\n              }\n              return addPos(x.setSheet(a.value, true), a, c);\n          }\n      }\n\n      // A1(a) :(b) C3(c) not followed by paren (d)\n      function refRange(a, b, c, d) {\n          if ((a.type === \"sym\" || a.type === \"rc\" || (a.type === \"num\" && a.value === a.value | 0)) &&\n              (b.type === \"op\" && b.value === \":\") &&\n              (c.type === \"sym\" || c.type === \"rc\" || (c.type === \"num\" && c.value === c.value | 0)) &&\n              !(d.type === \"punc\" && d.value === \"(\" && !c.space))\n          {\n              let tl = toCell(a, true), br = toCell(c, false);\n              if (tl && br) {\n                  skip(3);\n                  return addPos(new RangeRef(tl, br), a, c);\n              }\n          }\n      }\n\n      // A1(a) not followed by paren (b)\n      function refCell(a, b) {\n          if ((a.type === \"sym\" || a.type === \"rc\") && !(b.type === \"punc\" && b.value === \"(\" && !a.space)) {\n              let x = toCell(a);\n              if (x && isFinite(x.row) && isFinite(x.col)) {\n                  skip(1);\n                  return addPos(x, a, a);\n              }\n          }\n      }\n\n      function funcall(a, b) {\n          if (a.type === \"sym\" && b.type === \"punc\" && b.value === \"(\" && !a.space) {\n              a.type = \"func\";\n              skip(1);\n              return a;       // already has position\n          }\n      }\n  }\n\n  function isWhitespace(ch) {\n      return \" \\t\\r\\n\\xa0\\u200b\".indexOf(ch) >= 0;\n  }\n\n  let EOF = { type: \"eof\" };\n\n  function RawTokenStream(input, options) {\n      let tokens = [], index = 0;\n      let readWhile = input.readWhile;\n\n      return {\n          next  : next,\n          peek  : peek,\n          eof   : eof,\n          croak : input.croak,\n          ahead : ahead,\n          skip  : skip\n      };\n\n      function isDigit(ch) {\n          return (/[0-9]/i.test(ch));\n      }\n\n      function isIdStart(ch) {\n          return (/[a-z$_]/i.test(ch) || isUnicodeLetter(ch));\n      }\n\n      function isId(ch) {\n          return isIdStart(ch) || isDigit(ch) || ch === \".\";\n      }\n\n      function isOpChar(ch) {\n          return ch in OPERATORS;\n      }\n\n      function isPunc(ch) {\n          return \"\\\\!;(){}[]\".indexOf(ch) >= 0;\n      }\n\n      function readNumber() {\n          // XXX: TODO: exponential notation\n          let has_dot = false;\n          let number = readWhile(function(ch){\n              if (ch === SEPARATORS.DEC) {\n                  if (has_dot) {\n                      return false;\n                  }\n                  has_dot = true;\n                  return true;\n              }\n              return isDigit(ch);\n          });\n          if (number === SEPARATORS.DEC) {\n              return { type: \"punc\", value: SEPARATORS.DEC };\n          } else {\n              return { type: \"num\", value: parseFloat(number.replace(SEPARATORS.DEC, \".\")) };\n          }\n      }\n\n      function symbol(id, quote) {\n          return {\n              type  : \"sym\",\n              value : id,\n              upper : id.toUpperCase(),\n              space : isWhitespace(input.peek()),\n              quote : quote\n          };\n      }\n\n      function getRC(a, b, c) {\n          if (!a && !b && !c) {\n              return null;\n          }\n          if ((!a && !c) || (a && c)) {\n              let num = b ? parseInt(b, 10) : 0;\n              return a ? num : num - 1;\n          }\n      }\n\n      function readSymbol() {\n          let m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n          if (m) {\n              let row = getRC(m[1], m[2], m[3]);\n              let col = getRC(m[4], m[5], m[6]);\n              if (row != null && col != null) {\n                  input.skip(m);\n                  return {\n                      type: \"rc\",\n                      row: row,\n                      col: col,\n                      rel: ((m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) // col\n                            |\n                            (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0) // row\n                           )\n                  };\n              }\n          }\n          return symbol(readWhile(isId));\n      }\n\n      function readString() {\n          input.next();\n          return { type: \"str\", value: input.readEscaped('\"') };\n      }\n\n      function readSheetName() {\n          input.next();\n          return symbol(input.readEscaped(\"'\"), true);\n      }\n\n      function readOperator() {\n          return {\n              type  : \"op\",\n              value : readWhile(function(ch, op){\n                  return (op + ch) in OPERATORS;\n              })\n          };\n      }\n\n      function readPunc() {\n          return {\n              type  : \"punc\",\n              value : input.next()\n          };\n      }\n\n      function readNext() {\n          if (input.eof()) {\n              return null;\n          }\n          let ch = input.peek(), m;\n          if (ch === '\"') {\n              return readString();\n          }\n          if (ch === \"'\") {\n              return readSheetName();\n          }\n          if (isDigit(ch) || ch === SEPARATORS.DEC) {\n              return readNumber();\n          }\n          if (isIdStart(ch)) {\n              return readSymbol();\n          }\n          if (isOpChar(ch)) {\n              return readOperator();\n          }\n          if (isPunc(ch)) {\n              return readPunc();\n          }\n          if ((m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i))) {\n              input.skip(m);\n              return { type: \"error\", value: m[1] };\n          }\n          if (!options.forEditor) {\n              input.croak(\"Can't handle character with code: \" + ch.charCodeAt(0));\n          }\n          return { type: \"error\", value: input.next() };\n      }\n\n      function peek() {\n          while (tokens.length <= index) {\n              readWhile(isWhitespace);\n              let begin = input.pos();\n              let tok = readNext();\n              if (options.forEditor && tok) {\n                  tok.begin = begin;\n                  tok.end = input.pos();\n              }\n              tokens.push(tok);\n          }\n          return tokens[index];\n      }\n\n      function next() {\n          let tok = peek();\n          if (tok) {\n              index++;\n          }\n          return tok;\n      }\n\n      function ahead(n, f) {\n          let pos = index, a = [];\n          while (n-- > 0) {\n              a.push(next() || EOF);\n          }\n          index = pos;\n          return f.apply(a, a);\n      }\n\n      function skip(n) {\n          index += n;\n      }\n\n      function eof() {\n          return peek() == null;\n      }\n  }\n\n  //// exports\n\n  let FORMAT_PARSERS = [];\n\n  let registerFormatParser = calc.registerFormatParser = function(p) {\n      FORMAT_PARSERS.push(p);\n  };\n\n  calc.parse = function(sheet, row, col, input, format) {\n      if (input instanceof Date) {\n          return { type: \"date\", value: calc.runtime.dateToSerial(input) };\n      }\n      if (typeof input == \"number\") {\n          return { type: \"number\", value: input };\n      }\n      if (typeof input == \"boolean\") {\n          return { type: \"boolean\", value: input };\n      }\n      input += \"\";\n      if (/^'/.test(input)) {\n          return {\n              type: \"string\",\n              value: input.substr(1)\n          };\n      }\n      // trivial (integer) percent values; more complex formats are handled below via\n      // registerFormatParser; this case could be dropped completely.\n      if (/^-?[0-9]+%$/.test(input)) {\n          let str = input.substr(0, input.length - 1);\n          let num = parseFloat(str);\n          if (!isNaN(num) && num === str) {\n              return {\n                  type: \"percent\",\n                  value: num / 100\n              };\n          }\n      }\n      if (/^=/.test(input)) {\n          input = input.substr(1);\n          if (/\\S/.test(input)) {\n              return parseFormula(sheet, row, col, input);\n          } else {\n              return {\n                  type: \"string\",\n                  value: \"=\" + input\n              };\n          }\n      }\n      for (let i = 0; i < FORMAT_PARSERS.length; ++i) {\n          let result = FORMAT_PARSERS[i](input, format);\n          if (result) {\n              return result;\n          }\n      }\n      if (input.toLowerCase() === \"true\") {\n          return { type: \"boolean\", value: true };\n      }\n      if (input.toLowerCase() === \"false\") {\n          return { type: \"boolean\", value: false };\n      }\n      let date = calc.runtime.parseDate(input, format);\n      if (date) {\n          return { type: \"date\", value: calc.runtime.dateToSerial(date) };\n      }\n      let num = parseFloat(input);\n      if (!isNaN(num) && input.length > 0 && num === input) {\n          format = null;\n          if (num !== Math.floor(num)) {\n              format = \"0.\" + String(num).split(\".\")[1].replace(/\\d/g, \"0\");\n          }\n          return {\n              type: \"number\",\n              value: num,\n              format: format\n          };\n      }\n      return {\n          type: \"string\",\n          value: input\n      };\n  };\n\n  function tokenize(input, row, col) {\n      let tokens = [];\n      input = TokenStream(input, { forEditor: true, row: row, col: col });\n      while (!input.eof()) {\n          tokens.push(next());\n      }\n      let tok = tokens[0];\n      if (tok.type === \"op\" && tok.value === \"=\") {\n          tok.type = \"startexp\";\n      }\n      return tokens;\n\n      function next() {\n          let tok = input.next();\n          if (tok.type === \"sym\") {\n              if (tok.upper === \"TRUE\") {\n                  tok.type = \"bool\";\n                  tok.value = true;\n              } else if (tok.upper === \"FALSE\") {\n                  tok.type = \"bool\";\n                  tok.value = false;\n              }\n          } else if (tok.type === \"ref\") {\n              tok = {\n                  type  : \"ref\",\n                  ref   : (row != null && col != null ? tok.absolute(row, col) : tok),\n                  begin : tok.begin,\n                  end   : tok.end\n              };\n          }\n          return tok;\n      }\n  }\n\n  // The `sqref` attribute in dataValidation (XLSX) will contain a space-separated list of\n  // references.  This helper is called from excel-reader.js to parse them.\n  function parseSqref(input, row, col) {\n      row = row || 0;\n      col = col || 0;\n      input = TokenStream(input, { row: row, col: col });\n      let refs = [];\n      while (!input.eof()) {\n          let ref = input.next();\n          if (ref.type !== \"ref\") {\n              throw new calc.runtime.ParseError(\"Expecting a reference but got: \" + JSON.stringify(ref));\n          }\n          refs.push(ref.absolute(row, col));\n      }\n      return refs;\n  }\n\n  calc.parseNameDefinition = parseNameDefinition;\n  calc.parseFormula = parseFormula;\n  calc.parseReference = parseReference;\n  calc.compile = makeFormula;\n  calc.parseSqref = parseSqref;\n\n  calc.tokenize = tokenize;\n\n  /* -----[ a few special formats ]----- */\n\n  // various time formats\n  registerFormatParser(function(input, existingFormat){\n      let m, date = 0, format = \"\";\n      // have date part?\n      if (!existingFormat) {\n          existingFormat = culture().calendar.patterns.d;\n      }\n      if ((m = /^(\\d+)([-/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input))) {\n          let mo = parseInt(m[1], 10);\n          let sep = m[2];\n          let da = parseInt(m[3], 10);\n          let yr = parseInt(m[4], 10);\n          if (yr < 30) {\n              yr += 2000;\n          } else if (yr < 100) {\n              yr += 1900;\n          }\n          let monthFirst = existingFormat ? existingFormat.indexOf(\"M\") < existingFormat.indexOf(\"d\") : true;\n          if (mo > 12 || !monthFirst) {\n              let tmp = mo;\n              mo = da;\n              da = tmp;\n              monthFirst = false;\n          }\n          if (!calc.runtime.validDate(yr, mo, da)) {\n              return null;\n          }\n          date = calc.runtime.packDate(yr, mo - 1, da);\n          if (date < 0) { date--; }\n          if (monthFirst) {\n              format = [\"mm\", \"dd\", \"yyyy\"].join(sep);\n          } else {\n              format = [\"dd\", \"mm\", \"yyyy\"].join(sep);\n          }\n          format += m[5];\n          input = input.substr(m[0].length); // skip the date\n      }\n      // hh:mm\n      if ((m = /^(\\d+):(\\d+)$/.exec(input))) {\n          let hh = parseInt(m[1], 10);\n          let mm = parseInt(m[2], 10);\n          return {\n              type   : \"date\",\n              format : format + \"hh:mm\",\n              value  : date + calc.runtime.packTime(hh, mm, 0, 0)\n          };\n      }\n      // mm:ss.ms\n      if ((m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n          let mm = parseInt(m[1], 10);\n          let ss = parseInt(m[2], 10);\n          let ms = parseFloat(m[3]) * 1000;\n          return {\n              type   : \"date\",\n              format : format + \"mm:ss.00\",\n              value  : date + calc.runtime.packTime(0, mm, ss, ms)\n          };\n      }\n      // hh:mm:ss\n      if ((m = /^(\\d+):(\\d+):(\\d+)$/.exec(input))) {\n          let hh = parseInt(m[1], 10);\n          let mm = parseInt(m[2], 10);\n          let ss = parseInt(m[3], 10);\n          return {\n              type   : \"date\",\n              format : format + \"hh:mm:ss\",\n              value  : date + calc.runtime.packTime(hh, mm, ss, 0)\n          };\n      }\n      // hh:mm:ss.ms\n      if ((m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n          let hh = parseInt(m[1], 10);\n          let mm = parseInt(m[2], 10);\n          let ss = parseInt(m[3], 10);\n          let ms = parseFloat(m[4]) * 1000;\n          return {\n              type   : \"date\",\n              format : format + \"hh:mm:ss.00\",\n              value  : date + calc.runtime.packTime(hh, mm, ss, ms)\n          };\n      }\n  });\n\n  // Support numeric formats with thousands separator and/or currency symbol, like `1,234,567.00`,\n  // `$1234`, `123,456.78 $` etc.  I apologize for this code.\n  registerFormatParser(function(input){\n      let m, n;\n      const intlService = intl();\n      var numbers = intlService.localeInfo().numbers;\n      let comma = numbers.symbols.group;\n      let dot = numbers.symbols.decimal;\n      let localeCurrency = numbers.localeCurrency;\n      if (!localeCurrency && intlService.localeCurrency) {\n          localeCurrency = intlService.localeCurrency();\n      }\n      let currency = numbers.currencies[localeCurrency].symbol;\n      let rxnum = getNumberRegexp(comma, dot);\n      let rxcur = new RegExp(\"^\\\\s*\\\\\" + currency + \"\\\\s*\");\n      let sign = 1;\n      let format = \"\";\n      let suffix = \"\";\n      let has_currency = false;\n      let has_percent = false;\n\n      input = calc.runtime.InputStream(input.replace(/^\\s+|\\s+$/g, \"\"));\n\n      // has minus before currency?\n      if (input.skip(/^-\\s*/)) {\n          sign = -1;\n      }\n\n      // has currency before number?\n      if ((m = input.skip(rxcur))) {\n          has_currency = true;\n          format += '\"' + m[0] + '\"';\n      }\n\n      // has minus after currency?\n      if (input.skip(/^-\\s*/)) {\n          if (sign < 0) {\n              return null;    // not a number\n          }\n          sign = -1;\n      }\n\n      // read the number itself\n      if (!(n = input.skip(rxnum))) {\n          return null;        // not a number\n      }\n      format += \"0\";\n\n      // has currency after number?\n      if ((m = input.skip(rxcur))) {\n          if (has_currency) {\n              return null;    // either before or after, not both.\n          }\n          has_currency = true;\n          suffix = '\"' + m[0] + '\"';\n      }\n\n      // has percent after number?\n      if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n          has_percent = true;\n          suffix = m[0];      // no quotes this time, % is special in format\n      }\n\n      if (!input.eof()) {\n          return null;        // should anything else follow, not a number\n      }\n\n      if (n[2] || has_currency) {\n          format = format.replace(\"0\", \"#\");\n          format += \",0\";\n      }\n      if (n[3]) {\n          format += \".\" + repeat(\"0\", n[3].length - 1);\n      }\n      let value = n[0]\n          .replace(new RegExp(\"\\\\\" + comma, \"g\"), \"\")\n          .replace(new RegExp(\"\\\\\" + dot, \"g\"), \".\");\n\n      value = parseFloat(value);\n      if (has_percent) {\n          value /= 100;\n      }\n\n      format += suffix;\n      if (has_currency) {\n          format += ';-' + format;\n      }\n\n      return {\n          type: \"number\",\n          currency: has_currency,\n          format: format,\n          value: sign * value\n      };\n  });\n\n  registerFormatParser(function(input){\n      let m;\n      if ((m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input))) {\n          return {\n              type: \"number\",\n              value: parseFloat(input) / 100,\n              format: \"0.\" + repeat(\"0\", m[2].length) + m[3]\n          };\n      }\n  });\n\n  let NUMBER_FORMAT_RX = {};\n  function getNumberRegexp(comma, dot) {\n      let id = comma + dot;\n      let rx = NUMBER_FORMAT_RX[id];\n      if (!rx) {\n          rx = \"^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)\";\n          rx = rx.replace(/DOT/g, \"\\\\\" + dot).replace(/COM/g, \"\\\\\" + comma);\n          rx = new RegExp(rx);\n          NUMBER_FORMAT_RX[id] = rx;\n      }\n      return rx;\n  }\n\n  function repeat(str, len) {\n      let out = \"\";\n      while (len-- > 0) {\n          out += str;\n      }\n      return out;\n  }\n\n  /*************************************************************************************/\n\n  class FormulaContext {\n      constructor(workbook) {\n          this.workbook = workbook;\n      }\n\n      getRefCells(ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n          let sheet, formula, value, i;\n          if (ref instanceof CellRef) {\n              sheet = this.workbook.sheetByName(ref.sheet);\n              if (!sheet || !ref.valid()) {\n                  return [{\n                      value: new CalcError(\"REF\")\n                  }];\n              }\n              formula = sheet.formula(ref);\n              value = sheet.range(ref.row, ref.col).value();\n\n              if (wantNulls || formula != null || value != null) {\n                  return [{\n                      formula: formula,\n                      value: value,\n                      row: ref.row,\n                      col: ref.col,\n                      sheet: ref.sheet,\n                      hidden: hiddenInfo ? (sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0) : false\n                  }];\n              } else {\n                  return [];\n              }\n          }\n          if (ref instanceof RangeRef) {\n              i = this.workbook.sheetIndex(ref.sheet);\n              let states = [], n = i;\n              if (ref.endSheet) {\n                  // \"3D\" reference.\n                  n = this.workbook.sheetIndex(ref.endSheet);\n                  if (i > n) {\n                      let tmp = i;\n                      i = n;\n                      n = tmp;\n                  }\n              }\n\n              if (i < 0 || n < 0 || !ref.valid()) {\n                  return [{\n                      value: new CalcError(\"REF\")\n                  }];\n              }\n\n              // XXX: This is nicer, but significantly slower.\n              // Should investigate why, or add some options to make\n              // it faster (i.e. probably because it adds all cell\n              // properties, while we only need value and formula).\n              //\n              //     let add = function(row, col, data){\n              //         data.row = row;\n              //         data.col = col;\n              //         data.sheet = sheet.name();\n              //         states.push(data);\n              //     };\n              //     while (i <= n) {\n              //         sheet = this.workbook.sheetByIndex(i++);\n              //         sheet.forEach(ref, add);\n              //     }\n              //\n              // For now keep doing it \"manually\".\n\n              while (i <= n) {\n                  sheet = this.workbook.sheetByIndex(i++);\n                  let tl = sheet._grid.normalize(ref.topLeft);\n                  let br = sheet._grid.normalize(ref.bottomRight);\n\n                  let startCellIndex = sheet._grid.cellRefIndex(tl);\n                  let endCellIndex = sheet._grid.cellRefIndex(br);\n\n                  let values = sheet._properties.iterator(\"value\", startCellIndex, endCellIndex);\n\n                  for (let col = tl.col; col <= br.col; ++col) {\n                      for (let row = tl.row; row <= br.row; ++row) {\n                          let index = sheet._grid.index(row, col);\n                          formula = sheet._properties.get(\"formula\", index);\n                          value = values.at(index);\n                          if (wantNulls || formula != null || value != null) {\n                              states.push({\n                                  formula : formula,\n                                  value   : value,\n                                  row     : row,\n                                  col     : col,\n                                  sheet   : sheet.name(),\n                                  hidden  : hiddenInfo ? (sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0) : false\n                              });\n                          }\n                      }\n                  }\n              }\n\n              return states;\n          }\n          if (ref instanceof UnionRef) {\n              let a = [];\n              for (i = 0; i < ref.refs.length; ++i) {\n                  a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n              }\n              return a;\n          }\n          if (ref instanceof NameRef) {\n              let val = this.nameValue(ref, fsheet, frow, fcol);\n              // XXX: revise this\n              if (val instanceof Ref) {\n                  return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n              }\n              return [{\n                  value: val == null ? new CalcError(\"NAME\") : val\n              }];\n          }\n          return [];\n      }\n\n      isMerged(ref) {\n          let sheet = this.workbook.sheetByName(ref.sheet);\n          return sheet.isMerged(ref);\n      }\n\n      nameValue(ref, fsheet, frow, fcol) {\n          let val;\n          if (ref.hasSheet()) {\n              // qualified name\n              val = this.workbook.nameValue(this._displayString(ref.print()));\n          } else {\n              // try local name\n              ref = ref.clone().setSheet(fsheet, true);\n              val = this.workbook.nameValue(this._displayString(ref.print()));\n              if (val == null) {\n                  // try global name\n                  val = this.workbook.nameValue(this._displayString(ref.name));\n              }\n              if (val == null) {\n                  // try without _displayString\n                  val = this.workbook.nameValue(ref.print()) || this.workbook.nameValue(ref.name);\n              }\n          }\n          if (val instanceof Ref) {\n              val = val.absolute(frow, fcol);\n          }\n          return val;\n      }\n\n      getData(ref, fsheet, frow, fcol, wantNulls) {\n          let single = ref instanceof CellRef;\n          if (ref instanceof NameRef) {\n              single = this.workbook.nameValue(ref.name) instanceof CellRef;\n          }\n          let data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function(cell) {\n              let val = cell.value;\n              if (val instanceof calc.runtime.Formula) {\n                  val = val.value;\n              }\n              return val;\n          });\n          return single ? data[0] : data;\n      }\n\n      onFormula(f) {\n          let sheet = this.workbook.sheetByName(f.sheet);\n          let row = f.row, col = f.col, value = f.value;\n          let currentFormula = sheet.formula({ row: row, col: col });\n          if (currentFormula !== f) {\n              // could have been deleted or modified in the mean time,\n              // if the formula was asynchronous.  ignore this result.\n              return false;\n          }\n\n          let arrayRange = f.arrayFormulaRange;\n          if (arrayRange) {\n              // `value` will always be a Matrix in this case;\n              // enforced in runtime.js (Context::_resolve).  We\n              // must fill only cells in arrayRange.\n              let tlRow, tlCol;\n              let width = value.width;\n              let height = value.height;\n              sheet.forEach(arrayRange, function(row, col) {\n                  if (tlRow === undefined) {\n                      tlRow = row;\n                      tlCol = col;\n                  }\n                  let vrow = row - tlRow;\n                  let vcol = col - tlCol;\n                  let val;\n                  if (vrow < height && vcol < width) {\n                      val = value.get(vrow, vcol);\n                  } else {\n                      val = new CalcError(\"N/A\");\n                  }\n                  sheet._value(row, col, val);\n              });\n          }\n          else {\n              // formulas may return references.  if a range or union,\n              // we'll just save the first cell.\n              if (value instanceof Ref) {\n                  value = this.getData(value, f.sheet, row, col);\n                  if (Array.isArray(value)) {\n                      value = value[0];\n                  }\n                  if (value === undefined) {\n                      value = null; // clear contents\n                  }\n              }\n\n              // when not saved as an array formula, a formula\n              // returning a Matrix will just save the first value.\n              if (value instanceof calc.runtime.Matrix) {\n                  value = value.get(0, 0);\n              }\n\n              sheet._value(row, col, value);\n          }\n\n          clearTimeout(sheet._formulaContextRefresh);\n          sheet._formulaContextRefresh = setTimeout(function() {\n              sheet.batch(function() {}, { layout: true });\n          }, 50);\n\n          return true;\n      }\n      _displayString(val) {\n          if (/^[a-z_][a-z0-9_]*$/i.test(val)) {\n              return val;\n          }\n          return \"'\" + val.replace(/\\x27/g, \"\\\\'\") + \"'\";\n      }\n  }\n\n  class ValidationFormulaContext extends FormulaContext {\n      onFormula() {\n          return true;\n      }\n  }\n\n  calc.ValidationFormulaContext = ValidationFormulaContext;\n\n  /* eslint-disable no-param-reassign */\n\n  let KEY_NAMES$1 = {\n      8: 'backspace',\n      9: 'tab',\n      13: 'enter',\n      27: 'esc',\n      37: 'left',\n      38: 'up',\n      39: 'right',\n      40: 'down',\n      35: 'end',\n      36: 'home',\n      32: 'spacebar',\n      33: 'pageup',\n      34: 'pagedown',\n      46: 'delete',\n      113: ':edit'\n  };\n\n  const Mac = () => navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n  let isAlphaNum = function(keyCode) {\n      if ((keyCode > 47 && keyCode < 58) || // number keys\n          (keyCode > 64 && keyCode < 91) || // letter keys\n          (keyCode > 95 && keyCode < 112) || // numpad keys\n          (keyCode > 185 && keyCode < 193) || // ;=,-./` (in order)\n          (keyCode > 218 && keyCode < 223) || // [\\]' (in order)\n          (keyCode === 229)                   // combined key event?\n          ) {\n          return true;\n      }\n\n      return false;\n  };\n\n  let keyName = function(event) {\n      let keyCode = event.keyCode;\n      let name = KEY_NAMES$1[keyCode];\n\n      if (!name && isAlphaNum(keyCode)) {\n          name = \":alphanum\";\n      }\n\n      // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n      //\n      // Fix for https://github.com/telerik/kendo-ui-core/issues/2284\n      // (starting editor with `=` on Firefox)\n      if (!name && event.key && event.key.length === 1) {\n          name = \":alphanum\";\n      }\n\n      return name;\n  };\n\n  class EventListener {\n      constructor(target, observer, handlers) {\n          this._handlers = {};\n          this.target = target;\n          this._observer = observer || window;\n\n          this.keyDownProxy = this.keyDown.bind(this);\n          this.mouseProxy = this.mouse.bind(this);\n          this.touchProxy = this.touch.bind(this);\n          this.threshold = 5;\n          this._pressLocation = null;\n\n          this._attachEvent(target, \"keydown\", this.keyDownProxy);\n          this._attachEvent(target, \"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n          this._attachEvent(target, \"touchmove touchend\", this.touchProxy);\n\n          this._attachEvent(document.documentElement, \"mousemove mouseup\", this.mouseProxy);\n          this._attachEvent(document.documentElement, \"touchmove touchend\", this.touchProxy);\n\n          if (handlers) {\n              for (let key in handlers) {\n                  this.on(key, handlers[key]);\n              }\n          }\n      }\n\n      _attachEvent(element, events, handler) {\n          events.split(' ').forEach(eventType => { element.addEventListener(eventType, handler); });\n      }\n\n      _removeEvent(element, events, handler) {\n          events.split(' ').forEach(eventType => { element.removeEventListener(eventType, handler); });\n      }\n\n      keyDown(e) {\n          // Do not handle keys for Toolbar Tab switch shortcuts\n          if (e.altKey && (e.key === \"n\" || e.key === \"h\" || e.key === \"a\")) {\n              return;\n          }\n\n          this.handleEvent(e, keyName(e));\n      }\n\n      touch(e) {\n          this.handleEvent(e, e.type);\n      }\n\n      mouse(e) {\n          let rightClick;\n\n          if (e.which) {\n              rightClick = (e.which === 3);\n          } else if (e.button) {\n              rightClick = (e.button === 2);\n          }\n\n          let type = e.type;\n\n          if (type === \"mousedown\") {\n              if (rightClick) {\n                  type = \"rightmousedown\";\n              } else {\n                  this._pressLocation = { x: e.pageX, y: e.pageY };\n              }\n          }\n\n          if (type === \"mouseup\") {\n              if (!rightClick) {\n                  this._pressLocation = null;\n              }\n          }\n\n          if (type === \"mousemove\" && this._pressLocation) {\n              let dx = this._pressLocation.x - e.pageX;\n              let dy = this._pressLocation.y - e.pageY;\n              let distance = Math.sqrt(dx * dx + dy * dy);\n\n              if (distance > this.threshold) {\n                  type = \"mousedrag\";\n              }\n          }\n\n          this.handleEvent(e, type);\n      }\n\n      handleEvent(e, name) {\n          let eventKey = \"\";\n\n          e.mod = Mac() ? e.metaKey : (e.ctrlKey && !e.altKey);\n\n          if (e.altKey) {\n              eventKey += \"alt+\";\n          }\n\n          if (e.shiftKey) {\n              eventKey += \"shift+\";\n          }\n\n          if (e.ctrlKey) {\n              eventKey += \"ctrl+\";\n          }\n\n          eventKey += name;\n\n          let catchAllHandler = this._handlers['*+' + name];\n\n          if (catchAllHandler) {\n              catchAllHandler.call(this._observer, e, eventKey);\n          }\n\n          let handler = this._handlers[eventKey];\n\n          if (handler) {\n              handler.call(this._observer, e, eventKey);\n          }\n      }\n\n      on(event, callback) {\n          let handlers = this._handlers;\n\n          if (typeof callback === \"string\") {\n              callback = this._observer[callback];\n          }\n\n          if (typeof event === \"string\") {\n              event = event.split(\",\");\n          }\n\n          event.forEach(function(e) {\n              handlers[e] = callback;\n          });\n      }\n\n      destroy() {\n          this._removeEvent(this.target, \"keydown\", this.keyDownProxy);\n          this._removeEvent(this.target, \"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n          this._removeEvent(this.target, \"touchmove touchend\", this.touchProxy);\n\n          this._removeEvent(document.documentElement, \"mousemove mouseup\", this.mouseProxy);\n          this._removeEvent(document.documentElement, \"touchmove touchend\", this.touchProxy);\n      }\n  }\n\n  /* eslint-disable default-case */\n  /* eslint-disable no-else-return */\n  /* eslint-disable key-spacing */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable brace-style */\n  /* eslint-disable consistent-return */\n\n\n  let alphaNumRegExp = /:alphanum$/;\n\n  let ACTIONS = {\n      \"up\": \"up\",\n      \"down\": \"down\",\n      \"left\": \"left\",\n      \"right\": \"right\",\n      \"home\": \"first-col\",\n      \"end\": \"last-col\",\n      \"ctrl+left\": \"word-left\",\n      \"ctrl+right\": \"word-right\",\n      \"ctrl+up\": \"word-up\",\n      \"ctrl+down\": \"word-down\",\n      \"ctrl+home\": \"first\",\n      \"ctrl+end\": \"last\",\n      \"pageup\": \"prev-page\",\n      \"pagedown\": \"next-page\"\n  };\n\n  let ENTRY_ACTIONS = {\n      \"tab\": \"next\",\n      \"shift+tab\": \"previous\",\n      \"enter\": \"lower\",\n      \"shift+enter\": \"upper\",\n      \"delete\": \"clearContents\",\n      \"backspace\": \"clearContents\",\n      \"shift+:alphanum\": \"edit\",\n      \"alt+:alphanum\": \"edit\",\n      \":alphanum\": \"edit\",\n      \"ctrl+:alphanum\": \"ctrl\",\n      \"alt+ctrl+:alphanum\": \"edit\",\n      \":edit\": \"edit\"\n  };\n\n  let CONTAINER_EVENTS = {\n      \"wheel\": \"onWheel\",\n      \"*+mousedown\": \"onMouseDown\",\n      \"contextmenu\": \"onContextMenu\",\n      \"*+mousedrag\": \"onMouseDrag\",\n      \"*+mouseup\": \"onMouseUp\",\n      \"*+dblclick\": \"onDblClick\",\n      \"mousemove\": \"onMouseMove\"\n  };\n\n  let CLIPBOARD_EVENTS = {\n      \"pageup\": \"onPageUp\",\n      \"pagedown\": \"onPageDown\",\n      \"mouseup\": \"onMouseUp\",\n      \"*+cut\": \"onCut\",\n      \"*+paste\": \"onPaste\",\n      \"*+copy\": \"onCopy\"\n  };\n\n  let EDITOR_EVENTS = {\n      \"esc\": \"onEditorEsc\",\n      \"enter\": \"onEditorBlur\",\n      \"alt+enter\": \"insertNewline\",\n      \"shift+enter\": \"onEditorBlur\",\n      \"tab\": \"onEditorBlur\",\n      \"shift+tab\": \"onEditorBlur\",\n      \"shift+ctrl+enter\": \"onEditorArrayFormula\"\n  };\n\n  let FORMULABAR_EVENTS = Object.assign({ focus: \"onEditorBarFocus\" }, EDITOR_EVENTS);\n  let FORMULAINPUT_EVENTS = Object.assign({ focus: \"onEditorCellFocus\" }, EDITOR_EVENTS);\n\n  let SELECTION_MODES = {\n      cell: \"range\",\n      rowheader: \"row\",\n      columnheader: \"column\",\n      topcorner: \"sheet\",\n      autofill: \"autofill\"\n  };\n\n  // function toActionSelector(selectors) {\n  //     return selectors.map(function(action) {\n  //         return '[data-action=\"' + action + '\"]';\n  //     }).join(\",\");\n  // }\n\n  // let COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([ 'cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below' ]);\n  // let UNHIDE_ACTION_SELECTORS = toActionSelector([ 'unhide-row', 'unhide-column' ]);\n\n  let ACTION_KEYS = [];\n  let SHIFT_ACTION_KEYS = [];\n  let ENTRY_ACTION_KEYS = [];\n\n  for (let key in ACTIONS) {\n      ACTION_KEYS.push(key);\n      SHIFT_ACTION_KEYS.push(\"shift+\" + key);\n  }\n\n  for (let key in ENTRY_ACTIONS) {\n      ENTRY_ACTION_KEYS.push(key);\n  }\n\n  CLIPBOARD_EVENTS[ACTION_KEYS] = \"onAction\";\n  CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = \"onShiftAction\";\n  CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = \"onEntryAction\";\n\n  FORMULAINPUT_EVENTS[ACTION_KEYS] = \"onEditorAction\";\n  FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = \"onEditorShiftAction\";\n\n  class Controller {\n      constructor(view, workbook) {\n          this.view = view;\n          this.workbook(workbook);\n          this.container = view.container;\n          this.clipboardElement = view.clipboard;\n          // this.cellContextMenu = view.cellContextMenu;\n          // this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n          // this.colHeaderContextMenu = view.colHeaderContextMenu;\n          // this.drawingContextMenu = view.drawingContextMenu;\n          this.scroller = view.scroller;\n          this.tabstrip = view.tabstrip;\n          this.sheetsbar = view.sheetsbar;\n\n          view.nameEditor.bind(\"enter\", this.onNameEditorEnter.bind(this));\n          view.nameEditor.bind(\"cancel\", this.onNameEditorCancel.bind(this));\n          view.nameEditor.bind(\"select\", this.onNameEditorSelect.bind(this));\n          view.nameEditor.bind(\"delete\", this.onNameEditorDelete.bind(this));\n\n          this.editor = view.editor;\n          this.editor.bind(\"change\", this.onEditorChange.bind(this));\n          this.editor.bind(\"activate\", this.onEditorActivate.bind(this));\n          this.editor.bind(\"deactivate\", this.onEditorDeactivate.bind(this));\n          this.editor.bind(\"update\", this.onEditorUpdate.bind(this));\n\n          this.listener = new EventListener(this.container, this, CONTAINER_EVENTS);\n\n          this.scrollHandler = this.onScroll.bind(this);\n          this.mouseDownHandler = this.onMouseDown.bind(this);\n\n          view.scroller.addEventListener(\"scroll\", this.scrollHandler);\n          view.scroller.addEventListener(\"mousedown\", this.mouseDownHandler);\n\n          this._enableEditorEvents();\n\n          if (this.sheetsbar) {\n              this.sheetsbar.bind(\"select\", this.onSheetBarSelect.bind(this));\n              this.sheetsbar.bind(\"reorder\", this.onSheetBarReorder.bind(this));\n              this.sheetsbar.bind(\"rename\", this.onSheetBarRename.bind(this));\n              this.sheetsbar.bind(\"remove\", this.onSheetBarRemove.bind(this));\n          }\n\n          // this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n          // this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n          // this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n          // this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n\n          // this is necessary for Windows to catch prevent context menu correctly\n          // this.cellContextMenu.element\n          //     .add(this.rowHeaderContextMenu.element)\n          //     .add(this.colHeaderContextMenu.element)\n          //     .add(this.drawingContextMenu.element)\n          //     .on(\"contextmenu\", false);\n\n          // if (this.tabstrip) {\n          //     this.tabstrip.bind(\"action\", this.onCommandRequest.bind(this));\n          //     this.tabstrip.bind(\"dialog\", this.onDialogRequest.bind(this));\n          // }\n      }\n\n      executeCommand(options) {\n          return this._execute(options);\n      }\n\n      _enableEditorEvents(enable) {\n          if (enable === undefined || enable) {\n              this.keyListener = new EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n              this.barKeyListener = new EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n              this.inputKeyListener = new EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n          } else {\n              this.keyListener.destroy();\n              this.barKeyListener.destroy();\n              this.inputKeyListener.destroy();\n          }\n      }\n\n      _execute(options) {\n          let result = this._workbook.execute(options);\n\n          if (options.command === \"EditCommand\" && !result) {\n              this._workbook.trigger(\"change\", { editorClose: true });\n          }\n\n          if (result) {\n              this._preventNavigation = true;\n              if (result.reason === \"error\") {\n                  this.editor.deactivate(true); // make sure we don't call any change hooks\n                  this.view.showError(result, function() {\n                      // we only get here in case of a validation error when the user decided to retry.\n                      // this.activateEditor(false);\n                      // reset to last input from user\n                      // this.editor.value(this._lastEditorValue);\n                      // however, set _value manually such that it'll detect change properly.  ugly :-\\\n                      // this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                      // seems like a nice UX to have the whole input selected\n                      // this.editor.select();\n                  }.bind(this));\n              } else {\n                  this.view.openDialog(result.reason);\n              }\n          }\n\n          return result;\n      }\n\n      _activeTooltip() {\n          return this._workbook.activeSheet().activeCell().simplify().toString();\n      }\n\n      onContextMenuSelect(e) {\n          let action = e.item.getAttribute('data-action'); // $(e.item).data(\"action\");\n          let command;\n          switch (action) {\n          case \"cut\":\n              command = { command: \"ToolbarCutCommand\", options: { workbook: this._workbook } };\n              break;\n          case \"copy\":\n              command = { command: \"ToolbarCopyCommand\", options: { workbook: this._workbook } };\n              break;\n          case \"paste\":\n              command = { command: \"ToolbarPasteCommand\", options: { workbook: this._workbook } };\n              break;\n          case \"delete-drawing\":\n              command = { command: \"DeleteDrawingCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n              break;\n          case \"bring-to-front\":\n              command = { command: \"BringToFrontCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n              break;\n          case \"send-to-back\":\n              command = { command: \"SendToBackCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n              break;\n          case \"unmerge\":\n              command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n              break;\n          case \"merge\":\n              this.view.openDialog(\"merge\");\n              break;\n          case \"hide-row\":\n              command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n              break;\n          case \"hide-column\":\n              command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n              break;\n          case \"unhide-row\":\n              command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n              break;\n          case \"unhide-column\":\n              command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n              break;\n          case \"delete-row\":\n              command = { command: \"DeleteRowCommand\" };\n              break;\n          case \"delete-column\":\n              command = { command: \"DeleteColumnCommand\" };\n              break;\n          }\n\n          if (command) {\n              this._execute(command);\n          }\n      }\n\n      onSheetBarRemove(e) {\n          let sheet = this._workbook.sheetByName(e.name);\n\n          //TODO: move to model!\n          if (!sheet) {\n              return;\n          }\n\n          this._workbook.removeSheet(sheet);\n      }\n\n      destroy() {\n          this.view.scroller.removeEventListener(\"scroll\", this.scrollHandler);\n          this.view.scroller.removeEventListener(\"mousedown\", this.mouseDownHandler);\n\n          this.listener.destroy();\n          this._enableEditorEvents(false);\n          this.keyListener.destroy();\n          this.inputKeyListener.destroy();\n      }\n\n      onSheetBarSelect(e) {\n          let sheet;\n          let workbook = this._workbook;\n\n          if (e.isAddButton) {\n              if (this._workbook.trigger(\"insertSheet\")) {\n                  return;\n              }\n\n              sheet = workbook.insertSheet();\n          } else {\n              sheet = workbook.sheetByName(e.name);\n          }\n\n          //TODO: move to model\n          if (workbook.activeSheet().name() !== sheet.name()) {\n              if (this._workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                  return;\n              }\n\n              if (!this.editor.canInsertRef(false)) {\n                  this.editor.deactivate();\n              }\n\n              workbook.activeSheet(sheet);\n          }\n      }\n\n      onSheetBarReorder(e) {\n          let workbook = this._workbook;\n          let sheet = workbook.sheetByIndex(e.oldIndex);\n          let activeSheet = workbook.activeSheet();\n          let activeSheetName = activeSheet.name();\n\n          workbook.moveSheetToIndex(sheet, e.newIndex);\n\n          if (activeSheetName !== sheet.name()) {\n              if (workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                  workbook.activeSheet(activeSheet);\n                  return;\n              }\n\n              if (!this.editor.canInsertRef(false)) {\n                  this.editor.deactivate();\n              }\n\n              workbook.activeSheet(sheet);\n          }\n      }\n\n      onSheetBarRename(e) {\n          let sheet = this._workbook.sheetByIndex(e.sheetIndex);\n\n          if (this._workbook.sheetByName(e.name)) {\n              this.view.showError({ reason: \"error\", type: \"duplicateSheetName\" });\n              return;\n          }\n\n          this._workbook.renameSheet(sheet, e.name);\n\n          this.clipboardElement.focus();\n      }\n\n      sheet(sheet) {\n          this.navigator = sheet.navigator();\n          this.axisManager = sheet.axisManager();\n      }\n\n      workbook(workbook) {\n          this._workbook = workbook;\n          this.clipboard = workbook.clipboard();\n          workbook.bind(\"commandRequest\", this.onCommandRequest.bind(this));\n      }\n\n      refresh() {\n          let editor = this.editor;\n          let workbook = this._workbook;\n          let sheet = workbook.activeSheet();\n\n          this._viewPortHeight = this.view.scroller.clientHeight;\n          this.navigator.height(this._viewPortHeight);\n\n          if (!editor.isActive() && !this.isEditorDisabled) {\n              editor.enable(sheet.selection().enable() !== false);\n              this.resetEditorValue();\n          }\n\n          let ref = sheet.selection()._ref.simplify();\n          let def = this._workbook.nameForRef(ref, sheet.name());\n          this.view.nameEditor.value(def.name);\n      }\n\n      onScroll() {\n          this.view.render({ scroll: true });\n      }\n\n      onWheel(event) {\n          let deltaX = event.deltaX;\n          let deltaY = event.deltaY;\n\n          if (event.deltaMode === 1) {\n              deltaX *= 10;\n              deltaY *= 10;\n          }\n\n          this.scrollWith(deltaX, deltaY);\n\n          event.preventDefault();\n      }\n\n      onAction(event, action) {\n          let sheet = this._workbook.activeSheet();\n          sheet._activeDrawing = null;\n          this.navigator.moveActiveCell(ACTIONS[action]);\n          event.preventDefault();\n      }\n\n      onPageUp() {\n          this.scrollDown(-this._viewPortHeight);\n      }\n\n      onPageDown() {\n          this.scrollDown(this._viewPortHeight);\n      }\n\n      onEntryAction(event, action) {\n          let sheet = this._workbook.activeSheet();\n\n          if (event.mod) {\n              let key = String.fromCharCode(event.keyCode);\n              let shouldPrevent = true;\n\n              switch (key) {\n              case \"A\":\n                  sheet._activeDrawing = null;\n                  this.navigator.selectAll();\n                  break;\n              case \"Y\":\n                  this._workbook.undoRedoStack.redo();\n                  break;\n              case \"Z\":\n                  this._workbook.undoRedoStack.undo();\n                  break;\n              default:\n                  shouldPrevent = false;\n                  break;\n              }\n              if (shouldPrevent) {\n                  event.preventDefault();\n              }\n          } else {\n              let disabled = sheet.selection().enable() === false;\n              let casual = action !== \":edit\";\n\n              if (action == \"delete\" || action == \"backspace\") {\n                  if (sheet._activeDrawing) {\n                      this._execute({\n                          command: \"DeleteDrawingCommand\",\n                          options: { drawing: sheet._activeDrawing }\n                      });\n                  } else if (!disabled) {\n                      this._execute({ command: \"ClearContentCommand\" });\n                  }\n                  event.preventDefault();\n              } else if (alphaNumRegExp.test(action) || !casual) {\n                  sheet._activeDrawing = null;\n                  if (disabled) {\n                      event.preventDefault();\n                      return;\n                  }\n                  if (casual) {\n                      this.editor.value(\"\");\n                  }\n                  this.activateEditor(casual);\n              } else {\n                  this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                  event.preventDefault();\n              }\n          }\n      }\n\n      onShiftAction(event, action) {\n          this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n          event.preventDefault();\n      }\n\n      onMouseMove(event) {\n          let sheet = this._workbook.activeSheet();\n\n          if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n              return;\n          }\n\n          let object = this.objectAt(event);\n          if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n              sheet.positionResizeHandle(object.ref);\n          } else {\n              sheet.removeResizeHandle();\n          }\n\n          sheet._renderComment(object.type == \"cell\" ? object.ref : null);\n      }\n\n      onMouseDown(event) {\n          let object = this.objectAt(event);\n          if (object.pane) {\n              this.originFrame = object.pane;\n          }\n\n          if (this._startResizingDrawing(event, object)) {\n              event.stopPropagation();\n              return;\n          }\n\n          let sheet = this._workbook.activeSheet();\n          // let win = this.container.closest('[' + kendo.attr(\"role\") + '=\"window\"]');\n          // if (win.length) {\n          //     win = kendo.widgetInstance(win);\n          //     if (win && win.options.modal) {\n          //         event.stopPropagation();\n          //     }\n          // }\n\n          sheet._activeDrawing = null;\n          if (object.type === \"drawing\") {\n              sheet._activeDrawing = object.drawing;\n              object.copy = object.drawing.clone();\n              object.startBox = sheet.drawingBoundingBox(object.copy);\n              sheet.startDragging(object);\n              sheet.triggerChange({ dragging: true });\n              event.preventDefault();\n              return;\n          }\n\n          if (object.type === \"outside\") {\n              event.preventDefault();\n              event.stopPropagation();\n              return;\n          }\n\n          if (object.type === \"editor\") {\n              // XXX: canceling the edits, because they might not\n              // validate.  Not sure it's the Right Thing.\n              this.onEditorEsc();\n              this.openCustomEditor();\n              event.preventDefault();\n              return;\n          }\n\n          if (this.editor.canInsertRef(false) && object.ref) {\n              this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n              this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n              event.preventDefault();\n              return;\n          } else {\n              this._preventNavigation = false;\n              this.editor.deactivate();\n              if (this._preventNavigation) {\n                  return;     // validation error\n              }\n          }\n\n          if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n              sheet.startResizing({ x: object.x, y: object.y });\n              event.preventDefault();\n              return;\n          }\n\n          if (object.type === \"filtericon\") {\n              this.openFilterMenu(event);\n              event.preventDefault();\n              return;\n          }\n\n          this._selectionMode = SELECTION_MODES[object.type];\n          this.appendSelection = event.mod;\n          this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n      }\n\n      _startResizingDrawing(event) {\n          let handle = event.target.closest(\".k-spreadsheet-drawing-handle\");\n          if (handle) {\n              let location = this.translateCoords(event);\n              let direction = handle.getAttribute(\"data-direction\");\n              let sheet = this._workbook.activeSheet();\n              let drawing = sheet._activeDrawing;\n              sheet.startDragging({\n                  pane     : this.originFrame,\n                  drawing  : drawing,\n                  copy     : drawing.clone(),\n                  startBox : sheet.drawingBoundingBox(drawing),\n                  resize   : direction,\n                  //aspect   : drawing.width / drawing.height,\n                  startX   : location.x,\n                  startY   : location.y\n              });\n              return true;\n          }\n      }\n\n      onContextMenu(event) {\n          let sheet = this._workbook.activeSheet();\n\n          event.preventDefault();\n\n          if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n              return;\n          }\n\n          // emit close here if necessary\n\n          let object = this.objectAt(event);\n\n          if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n              return;\n          }\n\n          if (object.ref) {\n              this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n          } else if (object.type == \"drawing\") {\n              this.navigator.selectDrawingForContextMenu(object.drawing);\n          }\n\n          let isComposite = this.navigator._sheet.select() instanceof UnionRef;\n          let showUnhide = false;\n          let showUnmerge = false;\n\n          if (object.type == \"columnheader\") {\n              showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n          } else if (object.type == \"rowheader\") {\n              showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n          } else if (object.type == \"drawing\") ; else {\n              showUnmerge = this.navigator.selectionIncludesMergedCells();\n          }\n\n          this._workbook.trigger(\"contextmenu\", {\n              objectRef: object.ref,\n              targetType: object.type,\n              isComposite,\n              showUnhide,\n              showUnmerge,\n              originalEvent: event\n          });\n      }\n\n      prevent(event) {\n          event.preventDefault();\n      }\n\n      constrainResize(type, ref) {\n          let sheet = this._workbook.activeSheet();\n          let resizeHandle = sheet.resizeHandlePosition();\n\n          return !resizeHandle || type === \"outside\" || type === \"topcorner\" || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n      }\n\n      _dragDrawing(event) {\n          let sheet = this._workbook.activeSheet();\n          let drag = sheet.draggingInProgress();\n          if (!drag) {\n              return false;\n          }\n\n          let location = this.translateCoords(event);\n          let drawing = drag.drawing;\n          let deltaX = location.x - drag.startX;\n          let deltaY = location.y - drag.startY;\n\n          if (drag.resize == \"SE\") {\n              if (drag.aspect) {\n                  if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                      drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                      drawing.height = drawing.width / drag.aspect;\n                  } else {\n                      drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                      drawing.width = drawing.height * drag.aspect;\n                  }\n              } else {\n                  drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                  drawing.height = Math.max(drag.copy.height + deltaY, 20);\n              }\n          }\n          else if (drag.resize == \"E\") {\n              drawing.width = Math.max(drag.copy.width + deltaX, 20);\n          }\n          else if (drag.resize == \"S\") {\n              drawing.height = Math.max(drag.copy.height + deltaY, 20);\n          }\n          else if (drag.resize == \"N\") {\n              if (drag.copy.height - deltaY > 20) {\n                  drawing.height = drag.copy.height - deltaY;\n                  drawing.offsetY = drag.copy.offsetY + deltaY;\n              }\n          }\n          else if (drag.resize == \"W\") {\n              if (drag.copy.width - deltaX > 20) {\n                  drawing.width = drag.copy.width - deltaX;\n                  drawing.offsetX = drag.copy.offsetX + deltaX;\n              }\n          }\n          else if (drag.resize == \"NE\") {\n              drawing.width = Math.max(drag.copy.width + deltaX, 20);\n              if (drag.copy.height - deltaY > 20) {\n                  drawing.height = drag.copy.height - deltaY;\n                  drawing.offsetY = drag.copy.offsetY + deltaY;\n              }\n          }\n          else if (drag.resize == \"SW\") {\n              drawing.height = Math.max(drag.copy.height + deltaY, 20);\n              if (drag.copy.width - deltaX > 20) {\n                  drawing.width = drag.copy.width - deltaX;\n                  drawing.offsetX = drag.copy.offsetX + deltaX;\n              }\n          }\n          else if (drag.resize == \"NW\") {\n              if (drag.copy.height - deltaY > 20) {\n                  drawing.height = drag.copy.height - deltaY;\n                  drawing.offsetY = drag.copy.offsetY + deltaY;\n              }\n              if (drag.copy.width - deltaX > 20) {\n                  drawing.width = drag.copy.width - deltaX;\n                  drawing.offsetX = drag.copy.offsetX + deltaX;\n              }\n          }\n          // just moving (no resize)\n          else {\n              drawing.offsetX = drag.copy.offsetX + deltaX;\n              drawing.offsetY = drag.copy.offsetY + deltaY;\n          }\n\n          sheet.triggerChange({ dragging: true });\n\n          return true;\n      }\n\n      onMouseDrag(event) {\n          if (this._selectionMode === \"sheet\") {\n              return;\n          }\n\n          let location = { clientX: event.clientX, clientY: event.clientY };\n          let sheet = this._workbook.activeSheet();\n\n          if (this._dragDrawing(event)) {\n              return;\n          }\n\n          let object = this.objectAt(location);\n\n          if (sheet.resizingInProgress()) {\n\n              if (!this.constrainResize(object.type, object.ref)) {\n                  sheet.resizeHintPosition({ x: object.x, y: object.y });\n              }\n\n              return;\n          }\n\n          if (object.type === \"outside\") {\n              this.startAutoScroll(object);\n              return;\n          }\n\n          if (this.originFrame === object.pane) {\n              this.selectToLocation(location);\n          } else { // cross frame selection\n              let frame = this.originFrame._grid;\n\n              if (object.x > frame.right) ;\n\n              if (object.y > frame.bottom) {\n                  this.scrollTop();\n              }\n\n              if (object.y < frame.top || object.x < frame.left) {\n                  this.startAutoScroll(object, location);\n              } else {\n                  this.selectToLocation(location);\n              }\n          }\n\n          event.preventDefault();\n      }\n\n      onMouseUp(event) {\n          let sheet = this._workbook.activeSheet();\n          sheet.completeResizing();\n          sheet.completeDragging();\n\n          this.navigator.completeSelection();\n          this.stopAutoScroll();\n\n          let editor = this.editor.activeEditor();\n          if (!editor) {\n              return;\n          }\n          let el = event.target;\n          while (el) {\n              if (el === editor.element) {\n                  return;\n              }\n              el = el.parentNode;\n          }\n\n          let object = this.objectAt(event);\n          if (object && object.ref && editor.canInsertRef(false)) {\n              editor.refAtPoint(sheet);\n              sheet._setFormulaSelections(editor.highlightedRefs());\n          }\n      }\n\n      onDblClick(event) {\n          let object = this.objectAt(event);\n          let disabled = this._workbook.activeSheet().selection().enable() === false;\n\n          if (object.type !== \"cell\" || disabled) {\n              return;\n          }\n\n          let sel = this._workbook.activeSheet().selection();\n          this.activateEditor(!sel.value() && !sel.formula());\n          this.onEditorUpdate();\n      }\n\n      onCut(e) {\n          let self = this;\n          setTimeout(function() {\n              self.clipboard.menuInvoked = (e === undefined);\n              self._execute({\n                  command: \"CutCommand\",\n                  options: { workbook: self.view._workbook, event: e }\n              });\n          });\n      }\n\n      clipBoardValue() {\n          return this.clipboardElement.html();\n      }\n\n      _pasteImage(blob) {\n          let self = this;\n          let img = new window.Image();\n          img.src = window.URL.createObjectURL(blob);\n          img.onload = function() {\n              self._execute({\n                  command: \"InsertImageCommand\",\n                  options: {\n                      blob: blob,\n                      width: img.width,\n                      height: img.height\n                  }\n              });\n          };\n          setTimeout(function() {\n              window.URL.revokeObjectURL(img.src);\n          }, 10);\n      }\n\n      onPaste(e) {\n          let self = this;\n          let html = \"\";\n          let plain = \"\";\n          self.clipboard.menuInvoked = (e === undefined);\n          if (e) {\n              let clipboardData = e.clipboardData;\n              if (clipboardData && clipboardData.getData) {\n                  e.preventDefault();\n                  let hasHTML = false;\n                  let hasPlainText = false;\n                  // Firefox uses DOMStringList, needs special handling\n                  if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                      hasHTML = clipboardData.types.contains(\"text/html\");\n                      hasPlainText = clipboardData.types.contains(\"text/plain\");\n                  } else if (Array.isArray(clipboardData.types)) {\n                      hasHTML = clipboardData.types.indexOf(\"text/html\") >= 0;\n                      hasPlainText = clipboardData.types.indexOf(\"text/plain\") >= 0;\n                  } else {\n                      hasHTML = /text\\/html/.test(clipboardData.types);\n                      hasPlainText = /text\\/plain/.test(clipboardData.types);\n                  }\n                  if (hasHTML) {\n                      html = clipboardData.getData('text/html').trim();\n                  }\n                  if (hasPlainText) {\n                      plain = clipboardData.getData('text/plain').trim();\n                  }\n                  if (!html && !plain && clipboardData.items && clipboardData.items.length) {\n                      for (let i = 0; i < clipboardData.items.length; ++i) {\n                          let item = clipboardData.items[i];\n                          if (item.kind === \"file\" && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                              return self._pasteImage(item.getAsFile());\n                          }\n                      }\n                  }\n              } else {\n                  if (window.clipboardData.files && window.clipboardData.files.length) {\n                      let file = window.clipboardData.files[0];\n                      if (/^image\\/(?:png|jpe?g|gif)$/i.test(file.type)) {\n                          return self._pasteImage(file);\n                      }\n                  }\n\n                  plain = window.clipboardData.getData(\"Text\");\n                  if (plain) {\n                      plain = plain.trim();\n                  }\n\n                  // There's no way to get the HTML clipboard contents in IE other than letting\n                  // the browser handle the event (it pastes into our clipboardElement), and then\n                  // we can read the HTML from there.  Need to allow a small timeout for this.\n                  self.clipboardElement.empty();\n                  setTimeout(function() {\n                      html = self.clipboardElement.html();\n                      if (html || plain) {\n                          self.clipboard.external({ html: html, plain: plain });\n                          self._execute({\n                              command: \"PasteCommand\",\n                              options: { workbook: self.view._workbook, event: e }\n                          });\n                      }\n                  });\n\n                  return;\n              }\n          } else {\n              self.clipboard.menuInvoked = true;\n          }\n\n          if (!html && !plain) {\n              return;\n          }\n          self.clipboard.external({ html: html, plain: plain });\n          self._execute({\n              command: \"PasteCommand\",\n              options: { workbook: self.view._workbook, event: e }\n          });\n      }\n\n      onCopy(e) {\n          this.clipboard.menuInvoked = (e === undefined);\n          this._execute({\n              command: \"CopyCommand\",\n              options: { workbook: this.view._workbook, event: e }\n          });\n      }\n\n  ////////////////////////////////////////////////////////////////////\n\n      scrollTop() {\n          this.scroller.scrollTop = 0;\n      }\n\n      scrollLeft() {\n          this.scroller.scrollLeft = 0;\n      }\n\n      scrollDown(value) {\n          this.scroller.scrollTop += value;\n      }\n\n      scrollRight(value) {\n          this.scroller.scrollLeft += value;\n      }\n\n      scrollWith(right, down) {\n          this.scroller.scrollTop += down;\n          this.scroller.scrollLeft += right;\n      }\n\n      translateCoords(location) {\n          let box = this.container.getBoundingClientRect();\n          return {\n              x: location.clientX - box.left,\n              y: location.clientY - box.top\n          };\n      }\n\n      objectAt(location, noDrawing) {\n          if (!location) {\n              return;\n          }\n          const loc = this.translateCoords(location);\n          return this.view.objectAt(loc.x, loc.y, noDrawing);\n      }\n\n      selectToLocation(cellLocation) {\n          let object = this.objectAt(cellLocation, true);\n\n          if (object.pane && object.ref) { // cell, rowheader or columnheader\n              this.extendSelection(object);\n              this.lastKnownCellLocation = cellLocation;\n              this.originFrame = object.pane;\n          }\n\n          this.stopAutoScroll();\n      }\n\n      extendSelection(object) {\n          this.navigator.extendSelection(object.ref, this._selectionMode);\n      }\n\n      autoScroll() {\n          let x = this._autoScrollTarget.x;\n          let y = this._autoScrollTarget.y;\n          let boundaries = this.originFrame._grid;\n          let scroller = this.view.scroller;\n          let scrollStep = 8;\n\n          let scrollLeft = scroller.scrollLeft;\n          let scrollTop = scroller.scrollTop;\n\n          if (x < boundaries.left) {\n              this.scrollRight(-scrollStep);\n          }\n          if (x > boundaries.right) {\n              this.scrollRight(scrollStep);\n          }\n          if (y < boundaries.top) {\n              this.scrollDown(-scrollStep);\n          }\n          if (y > boundaries.bottom) {\n              this.scrollDown(scrollStep);\n          }\n\n          if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n              this.selectToLocation(this.finalLocation);\n          } else {\n              this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n          }\n      }\n\n      startAutoScroll(viewObject, location) {\n          if (!this._scrollInterval) {\n              this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n          }\n\n          this.finalLocation = location || this.lastKnownCellLocation;\n\n          this._autoScrollTarget = viewObject;\n      }\n\n      stopAutoScroll() {\n          clearInterval(this._scrollInterval);\n          this._scrollInterval = null;\n      }\n\n      openCustomEditor() {\n          this.view.openCustomEditor();\n      }\n\n      openFilterMenu(event) {\n          let object = this.objectAt(event);\n          let sheet = this._workbook.activeSheet();\n          let column = sheet.filterColumn(object.ref);\n          let filterMenu = this.view.createFilterMenu(column);\n\n          filterMenu.bind(\"action\", this.onCommandRequest.bind(this));\n          filterMenu.bind(\"action\", filterMenu.close.bind(filterMenu));\n\n          filterMenu.openFor(event.target, event);\n      }\n\n  ////////////////////////////////////////////////////////////////////\n\n      _saveEditorValue(arrayFormula) {\n          let sheet = this.editor._range.sheet();\n          let value = this.editor.value();\n          if (this._workbook.activeSheet() !== sheet) {\n              // remove highlighted refs (XXX: which are mostly wrong, BTW)\n              this._workbook.activeSheet()._setFormulaSelections();\n              // go back to the original sheet\n              this._workbook.activeSheet(sheet);\n          }\n          sheet.isInEditMode(false);\n          this._lastEditorValue = value;\n          this._execute({\n              command: \"EditCommand\",\n              options: {\n                  value: value,\n                  arrayFormula: arrayFormula\n              }\n          });\n      }\n\n      onEditorChange() {\n          this._saveEditorValue(false);\n      }\n\n      onEditorArrayFormula() {\n          this._saveEditorValue(true);\n          this.editor.deactivate(true);\n      }\n\n      onEditorActivate() {\n          let workbook = this._workbook;\n          let sheet = workbook.activeSheet();\n\n          sheet._setFormulaSelections(this.editor.highlightedRefs());\n          sheet.isInEditMode(true);\n      }\n\n      onEditorDeactivate() {\n          let sheet = this._workbook.activeSheet();\n\n          sheet.isInEditMode(false);\n          sheet._setFormulaSelections([]);\n      }\n\n      onEditorUpdate() {\n          this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n      }\n\n      onEditorBarFocus() {\n          let disabled = this._workbook.activeSheet().selection().enable() === false;\n          if (disabled) {\n              return;\n          }\n          this.editor\n              .activate({\n                  range: this._workbook.activeSheet().selection(),\n                  rect: this.view.activeCellRectangle(),\n                  tooltip: this._activeTooltip()\n              });\n      }\n\n      onEditorCellFocus() {\n          this.editor.scale();\n      }\n\n      onEditorEsc() {\n          this.resetEditorValue();\n          this.editor.deactivate();\n\n          this.clipboardElement.focus();\n      }\n\n      insertNewline(e) {\n          e.preventDefault();\n          this.editor.insertNewline();\n      }\n\n      onEditorBlur(e, action) {\n          if (e.defaultPrevented || this.editor.isFiltered()) {\n              return;\n          }\n\n          this._preventNavigation = false;\n          this.editor.deactivate();\n\n          if (!this._preventNavigation) {\n              this.clipboardElement.focus();\n              this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n          }\n\n          if (action === 'tab') {\n              e.preventDefault();\n          }\n      }\n\n      onEditorAction(event, action) {\n          if (event.defaultPrevented) {\n              return;\n          }\n\n          let editor = this.editor;\n          let sheet = this._workbook.activeSheet();\n\n          if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n              this.deactivateEditor();\n              this.navigator.moveActiveCell(ACTIONS[action]);\n              event.preventDefault();\n          } else if (editor.canInsertRef(true)) {\n              this.navigator.moveActiveCell(ACTIONS[action]);\n              editor.activeEditor().refAtPoint(sheet);\n              sheet._setFormulaSelections(editor.highlightedRefs());\n              event.preventDefault();\n          }\n      }\n\n      onEditorShiftAction(event, action) {\n          let editor = this.editor;\n          let sheet = this._workbook.activeSheet();\n\n          if (editor.canInsertRef(true)) {\n              this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n\n              editor.activeEditor().refAtPoint(sheet);\n              sheet._setFormulaSelections(editor.highlightedRefs());\n\n              event.preventDefault();\n          }\n      }\n\n  ////////////////////////////////////////////////////////////////////\n      resetEditorValue() {\n          let sheet = this._workbook.activeSheet();\n          let ref = sheet.activeCell();\n          let input = this._workbook._inputForRef(ref);\n          let x = sheet.range(ref).intersectingArrayFormula();\n          if (x) {\n              input = \"=\" + x.formula;\n          }\n          this.editor.value(input, Boolean(x));\n      }\n\n      activateEditor(casual) {\n          // This flag will be false when F2 has been pressed, and\n          // true when editing is \"casual\", i.e., user just started\n          // typing.  In this case we want arrow keys to do cell\n          // navigation rather than move the cursor.\n          // https://github.com/telerik/kendo-ui-core/issues/3644\n          this._casualEditing = casual;\n\n          this.editor.activate({\n              range: this._workbook.activeSheet().selection(),\n              rect: this.view.activeCellRectangle(),\n              tooltip: this._activeTooltip()\n          }).focus();\n      }\n\n      deactivateEditor() {\n          this.view.editor.deactivate();\n      }\n\n      onCommandRequest(e) {\n          if (e.command) {\n              this._execute(e);\n          } else {\n              this._workbook.undoRedoStack[e.action]();\n          }\n      }\n\n      onDialogRequest(e) {\n          let additionalOptions = {\n              pdfExport: this._workbook.options.pdf,\n              excelExport: this._workbook.options.excel\n          };\n\n          if (e.options) {\n              deepExtend(e.options, additionalOptions);\n          } else {\n              e.options = additionalOptions;\n          }\n\n          this.view.openDialog(e.name, e.options);\n      }\n\n      onNameEditorEnter({ value }) {\n          let ref;\n          let workbook = this._workbook;\n          let sheet = workbook.activeSheet();\n          let name = value !== undefined ? value : this.view.nameEditor.value();\n\n          // 1. does it look like a reference, or already defined\n          // name?  If so, just select it (don't define/modify any\n          // names)\n          ref = calc.parseReference(name, true) || workbook.nameValue(name);\n          if (ref instanceof Ref) {\n              if (ref.sheet && ref.sheet.toLowerCase() !== sheet.name().toLowerCase()) {\n                  // reference points to another sheet, select it if found\n                  let tmp = workbook.sheetByName(ref.sheet);\n                  if (tmp) {\n                      workbook.activeSheet(tmp);\n                      sheet = tmp;\n                  }\n              }\n              sheet.range(ref).select();\n              return;\n          }\n\n          ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n\n          // XXX: should we check if a name is already defined for this range, and update it instead?\n          // Excel just adds a new one, and provides a more complete Name Manager dialog.\n          //let def = workbook.nameForRef(ref, sheet.name());\n\n          // just define new name\n          this._execute({\n              command: \"DefineNameCommand\",\n              options: { name: name, value: ref }\n          });\n\n          this.clipboardElement.focus();\n      }\n      onNameEditorCancel() {\n          this.clipboardElement.focus();\n      }\n      onNameEditorSelect(ev) {\n          let name = ev.name;\n          let workbook = this._workbook;\n          let sheet = workbook.activeSheet();\n          let ref = workbook.nameValue(name);\n          if (ref instanceof Ref) {\n              if (ref.sheet && ref.sheet.toLowerCase() !== sheet.name().toLowerCase()) {\n                  // reference points to another sheet, select it if found\n                  let tmp = workbook.sheetByName(ref.sheet);\n                  if (tmp) {\n                      workbook.activeSheet(tmp);\n                      sheet = tmp;\n                  }\n              }\n              sheet.range(ref).select();\n              return;\n          }\n          this.clipboardElement.focus();\n      }\n      onNameEditorDelete(ev) {\n          this._execute({\n              command: \"DeleteNameCommand\",\n              options: { name: ev.name }\n          });\n          this.clipboardElement.focus();\n      }\n  }\n\n  class RangeTreeNode {\n      constructor(level, value, left, right) {\n          this.level = level;\n          this.value = value;\n          this.left = left;\n          this.right = right;\n      }\n  }\n\n  const NilNode = {\n      left: undefined,\n      right: undefined,\n      level: 0\n  };\n  NilNode.left = NilNode;\n  NilNode.right = NilNode;\n\n  function skew(n) {\n      let node = n;\n      if (node.left.level === node.level) {\n          let temp = node;\n          node = node.left;\n          temp.left = node.right;\n          node.right = temp;\n      }\n\n      return node;\n  }\n\n  function split(n) {\n      let node = n;\n      if (node.right.right.level === node.level) {\n          let temp = node;\n          node = node.right;\n          temp.right = node.left;\n          node.left = temp;\n          node.level += 1;\n      }\n\n      return node;\n  }\n\n  function insert(node, value) {\n      if (node === NilNode) {\n          return new RangeTreeNode(1, value, NilNode, NilNode);\n      } else if (node.value.start > value.start) {\n          node.left = insert(node.left, value);\n      } else {\n          node.right = insert(node.right, value);\n      }\n\n      return split(skew(node));\n  }\n\n  function remove(n, value) {\n      let node = n;\n      if (node === NilNode) {\n          return node;\n      }\n\n      let diff = node.value.start - value.start;\n      if (diff === 0) {\n          if (node.left !== NilNode && node.right !== NilNode) {\n              let heir = node.left;\n\n              while (heir.right !== NilNode) {\n                  heir = heir.right;\n              }\n\n              node.value = heir.value;\n              node.left = remove(node.left, node.value);\n          } else if (node.left === NilNode) {\n              node = node.right;\n          } else {\n              node = node.left;\n          }\n      } else if (diff > 0) {\n          node.left = remove(node.left, value);\n      } else {\n          node.right = remove(node.right, value);\n      }\n\n      if (node.left.level < (node.level - 1) || node.right.level < (node.level - 1)) {\n          node.level -= 1;\n          if (node.right.level > node.level) {\n              node.right.level = node.level;\n          }\n\n          node = skew(node);\n          node.right = skew(node.right);\n          node.right.right = skew(node.right.right);\n          node = split(node);\n          node.right = split(node.right);\n      }\n\n      return node;\n  }\n\n  class ValueRange {\n      // start;\n      // end;\n      // value;\n\n      constructor(start, end, value) {\n          this.start = start;\n          this.end = end;\n          this.value = value;\n      }\n\n      intersects(range) {\n          return range.start <= this.end && range.end >= this.start;\n      }\n\n      clone() {\n          return new ValueRange(this.start, this.end, this.value);\n      }\n  }\n\n  class RangeTree {\n      // root;\n      constructor() {\n          this.root = NilNode;\n      }\n\n      insert(value) {\n          this.root = insert(this.root, value);\n      }\n\n      remove(value) {\n          this.root = remove(this.root, value);\n      }\n\n      findrange(value) {\n          let node = this.root;\n\n          while (node !== NilNode) {\n              if (value < node.value.start) {\n                  node = node.left;\n              } else if (value > node.value.end) {\n                  node = node.right;\n              } else {\n                  return node.value;\n              }\n          }\n\n          return null;\n      }\n\n      values() {\n          let result = [];\n          values(this.root, result);\n          return result;\n      }\n\n      intersecting(start, end) {\n          let ranges = [];\n          intersecting(this.root, new ValueRange(start, end), ranges);\n          return ranges;\n      }\n\n      map(callback) {\n          let tree = new RangeTree();\n          map(tree, this.root, callback);\n          return tree;\n      }\n\n      forEach(callback) {\n          forEach(this.root, callback);\n      }\n\n      clone() {\n          return this.map(function(value) {\n              return value.clone();\n          });\n      }\n\n      first() {\n          let first = this.root;\n          while (first.left !== NilNode) {\n              first = first.left;\n          }\n\n          return first;\n      }\n\n      last() {\n          let last = this.root;\n          while (last.right !== NilNode) {\n              last = last.right;\n          }\n\n          return last;\n      }\n  }\n\n  function values(node, result) {\n      if (node === NilNode) {\n          return;\n      }\n\n      values(node.left, result);\n      result.push(node.value);\n      values(node.right, result);\n  }\n\n  function intersecting(node, range, ranges) {\n      if (node === NilNode) {\n          return;\n      }\n\n      let value = node.value;\n\n      if (range.start < value.start) {\n          intersecting(node.left, range, ranges);\n      }\n\n      if (value.intersects(range)) {\n          ranges.push(value);\n      }\n\n      if (range.end > value.end) {\n          intersecting(node.right, range, ranges);\n      }\n  }\n\n  function map(tree, root, callback) {\n      if (root === NilNode) {\n          return;\n      }\n      map(tree, root.left, callback);\n      tree.insert(callback(root.value));\n      map(tree, root.right, callback);\n  }\n\n  function forEach(root, callback) {\n      if (root === NilNode) {\n          return;\n      }\n      forEach(root.left, callback);\n      callback(root.value);\n      forEach(root.right, callback);\n  }\n\n  class RangeList {\n      // tree;\n      constructor(start, end, value) {\n          if (end === undefined) {\n              this.tree = start;\n          } else {\n              this.tree = new RangeTree();\n              this.tree.insert(new ValueRange(start, end, value));\n          }\n      }\n\n      values() {\n          return this.tree.values();\n      }\n\n      map(callback) {\n          return new RangeList(this.tree.map(callback));\n      }\n\n      forEach(callback) {\n          this.tree.forEach(callback);\n      }\n\n      intersecting(start, end) {\n          return this.tree.intersecting(start, end);\n      }\n\n      first() {\n          return this.tree.first().value;\n      }\n\n      last() {\n          return this.tree.last().value;\n      }\n\n      insert(start, end, value) {\n          return this.tree.insert(new ValueRange(start, end, value));\n      }\n\n      value(s, e, value) {\n          let start = s, end = e;\n          if (value === undefined) {\n              if (end === undefined) {\n                  end = start;\n              }\n              return this.intersecting(start, end)[0].value;\n          }\n\n          let ranges = this.tree.intersecting(start - 1, end + 1);\n\n          if (ranges.length) {\n              let firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n\n              if (firstRange.end < start) {\n                  if (firstRange.value === value) {\n                      start = firstRange.start;\n                  } else {\n                      ranges.shift();\n                  }\n              }\n\n              if (lastRange.start > end) {\n                  if (lastRange.value === value) {\n                      end = lastRange.end;\n                  } else {\n                      ranges.pop();\n                  }\n              }\n\n              for (let i = 0, length = ranges.length; i < length; i++) {\n                  let range = ranges[i];\n                  let rangeValue = range.value;\n                  let rangeStart = range.start;\n                  let rangeEnd = range.end;\n\n                  this.tree.remove(range);\n\n                  if (rangeStart < start) {\n                      if (rangeValue !== value) {\n                          this.insert(rangeStart, start - 1, rangeValue);\n                      } else {\n                          start = rangeStart;\n                      }\n                  }\n\n                  if (rangeEnd > end) {\n                      if (rangeValue !== value) {\n                          this.insert(end + 1, rangeEnd, rangeValue);\n                      } else {\n                          end = rangeEnd;\n                      }\n                  }\n              }\n          }\n\n          this.insert(start, end, value);\n      }\n\n      expandedValues(start, end) {\n          let ranges = this.intersecting(start, end);\n          let result = [];\n\n          let rangeIndex = 0;\n\n          for (let i = start; i <= end; i++) {\n              if (ranges[rangeIndex].end < i) {\n                  rangeIndex ++;\n              }\n\n              result.push({ index: i - start, value: ranges[rangeIndex].value });\n          }\n\n          return result;\n      }\n\n      sortedIndices(start, end, valueComparer, indices) {\n          let result = this.expandedValues(start, end);\n\n          let comparer = function(a, b) {\n              if (a.value === b.value) {\n                  return a.index - b.index;\n              }\n\n              return valueComparer(a.value, b.value);\n          };\n\n          if (indices) {\n              comparer = function(a, b) {\n                  let x = indices[a.index];\n                  let y = indices[b.index];\n\n                  if (x.value === y.value) {\n                      return valueComparer(a.value, b.value);\n                  }\n\n                  return a.index - b.index;\n              };\n          }\n\n          result.sort(comparer);\n\n          return result;\n      }\n\n      sort(start, end, indices) {\n          if (this.intersecting(start, end).length === 1) {\n              return;\n          }\n\n          let expValues = this.expandedValues(start, end);\n\n          for (let i = 0, len = indices.length; i < len; i++) {\n              this.value(i + start, i + start, expValues[indices[i].index].value);\n          }\n      }\n\n      copy(sourceStart, sourceEnd, targetStart) {\n          let intValues = this.intersecting(sourceStart, sourceEnd);\n\n          let start = targetStart;\n          let end;\n\n          for (let i = 0, len = intValues.length; i < len; i++) {\n              let rangeStart = intValues[i].start;\n\n              if (rangeStart < sourceStart) {\n                  rangeStart = sourceStart;\n              }\n\n              let rangeEnd = intValues[i].end;\n\n              if (rangeEnd > sourceEnd) {\n                  rangeEnd = sourceEnd;\n              }\n\n              end = start + (rangeEnd - rangeStart);\n\n              this.value(start, end, intValues[i].value);\n\n              start = ++end;\n          }\n      }\n\n      iterator(start, end) {\n          return new Iterator(start, end, this.intersecting(start, end));\n      }\n\n      getState() {\n          return this.tree.clone();\n      }\n\n      setState(state) {\n          this.tree = state.clone();\n      }\n\n      toJSON() {\n          return this.values();\n      }\n\n      fromJSON(vals) {\n          vals.forEach((v) => {\n              this.value(v.start, v.end, v.value);\n          });\n      }\n  }\n\n  class Iterator {\n      constructor(start, end, ranges) {\n          this.start = start;\n          this.end = end;\n          this.index = 0;\n          this.ranges = ranges;\n      }\n\n      unique() {\n          return this.ranges.map(function(range) {\n              return range.value;\n          });\n      }\n\n      at(index) {\n          while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n              this.index ++;\n          }\n\n          return this.ranges[this.index] && this.ranges[this.index].value;\n      }\n\n      forEach(callback) {\n          for (let i = this.start; i <= this.end; i++) {\n              callback(this.at(i), i);\n          }\n\n          this.index = 0;\n      }\n  }\n\n  class SparseRangeList extends RangeList {\n      constructor(start, end, value) {\n          super(start, end, value);\n          this._defaultValue = value;\n          this.tree = new RangeTree();\n          this.range = new ValueRange(start, end, value);\n      }\n\n      intersecting(s, end) {\n          let start = s;\n          let ranges = this.tree.intersecting(start, end);\n          let result = [];\n          let range;\n\n          if (!ranges.length) {\n              return [this.range];\n          }\n\n          for (let i = 0, len = ranges.length; i < len; i++) {\n              range = ranges[i];\n              if (range.start > start) {\n                  result.push(new ValueRange(start, range.start - 1, this.range.value));\n              }\n\n              result.push(range);\n              start = range.end + 1;\n          }\n\n          if (range.end < end) {\n              result.push(new ValueRange(range.end + 1, end, this.range.value));\n          }\n\n          return result;\n      }\n\n      insert(start, end, v) {\n          let value = v;\n          if (value == null) {\n              value = this._defaultValue;\n          }\n          if (value !== this.range.value) {\n              this.tree.insert(new ValueRange(start, end, value));\n          }\n      }\n\n      lastRangeStart() {\n          let node = this.tree.root;\n\n          if (node === NilNode) {\n              return this.range.start;\n          }\n\n          while (node.right !== NilNode) {\n              node = node.right;\n          }\n\n          return node.value.end + 1;\n      }\n  }\n\n  /* eslint-disable default-case */\n  /* eslint-disable camelcase */\n  /* eslint-disable no-param-reassign */\n\n\n  class Property {\n      constructor(list) {\n          this.list = list;\n      }\n\n      get(index) {\n          return this.parse(this.list.value(index, index));\n      }\n\n      set(start, end, value) {\n          if (value === undefined) {\n              value = end;\n              end = start;\n          }\n\n          this.list.value(start, end, value);\n      }\n\n      parse(value) {\n          return value;\n      }\n\n      copy(start, end, dst) {\n          this.list.copy(start, end, dst);\n      }\n\n      iterator(start, end) {\n          return this.list.iterator(start, end);\n      }\n  }\n  class JsonProperty extends Property {\n      set(start, end, value) {\n          this.list.value(start, end, JSON.stringify(value));\n      }\n\n      parse(value) {\n          return JSON.parse(value);\n      }\n  }\n  class ValueProperty extends Property {\n      constructor(values, formats) {\n          super(values);\n          this.formats = formats;\n      }\n\n      set(start, end, value) {\n          if (value instanceof Date) {\n              value = calc.runtime.dateToSerial(value);\n              if (!this.formats.value(start,end)) {\n                  this.formats.value(start, end, toExcelFormat$1(culture().calendar.patterns.d));\n              }\n          } else if (typeof value == \"number\") {\n              value = calc.runtime.limitPrecision(value);\n          }\n\n          this.list.value(start, end, value);\n      }\n  }\n  function toExcelFormat$1(format) {\n      return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n  }\n\n  const propertyBagSpec = [\n      { property: Property, name: \"format\", value: null, sortable: true, serializable: true },\n      { property: ValueProperty, name: \"value\", value: null, sortable: true, serializable: true, depends: \"format\" },\n      { property: Property, name: \"formula\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"background\", value: null, sortable: true, serializable: true },\n      { property: JsonProperty, name: \"vBorders\", value: null, sortable: false, serializable: false },\n      { property: JsonProperty, name: \"hBorders\", value: null, sortable: false, serializable: false },\n      { property: JsonProperty, name: \"dBorders\", value: null, sortable: false, serializable: true },\n      { property: Property, name: \"color\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"fontFamily\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"underline\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"fontSize\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"italic\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"bold\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"textAlign\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"indent\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"verticalAlign\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"wrap\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"validation\", value: null, sortable: false, serializable: true },\n      { property: Property, name: \"enable\", value: null, sortable: false, serializable: true },\n      { property: Property, name: \"link\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"editor\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"comment\", value: null, sortable: true, serializable: true },\n      { property: Property, name: \"html\", value: null, sortable: true, serializable: true }\n  ];\n\n  class PropertyBag {\n      constructor(rowCount, columnCount, defaultValues) {\n          defaultValues = defaultValues || {};\n          let cellCount = rowCount * columnCount - 1;\n\n          this.specs = propertyBagSpec;\n          this.rowCount = rowCount;\n          this.columnCount = columnCount;\n          this.cellCount = cellCount;\n          this.properties = {};\n          this.lists = {};\n\n          this.specs.forEach(function(spec) {\n              let name = spec.name;\n              let value = defaultValues[name];\n              if (value === undefined) {\n                  value = spec.value;\n              }\n              this.lists[name] = new SparseRangeList(0, cellCount, value);\n              let prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n              prop.spec = spec;\n          }, this);\n\n          // XXX: this is a hack but I have no better ideas at this\n          // point.  The getState() method in a SparseRangeList\n          // clones the tree (which just copies values over), but\n          // formulas are objects maintaining complex state.\n          // https://github.com/telerik/kendo-ui-core/issues/2816\n          this.lists.formula.tree.clone = cloneFormulaTree;\n          this.lists.validation.tree.clone = cloneFormulaTree;\n      }\n\n      _resize(new_rows, new_cols) {\n          let self = this;\n          let old_rows = self.rowCount;\n          let cell_count = new_rows * new_cols - 1;\n          function scaleIndex(index) {\n              let col = index / old_rows | 0;\n              let row = index % old_rows;\n              return col * new_rows + row;\n          }\n          function scaleNode(node) {\n              // node is a ValueRange from rangelist.js\n              // start/end are rowCount * col + row\n              node.start = scaleIndex(node.start);\n              node.end = scaleIndex(node.end);\n          }\n          Object.keys(self.lists).forEach(function(name) {\n              let list = self.lists[name];\n              if (new_rows !== old_rows) {\n                  list.forEach(scaleNode);\n              }\n              list.range.end = cell_count;\n          });\n          self.rowCount = new_rows;\n          self.columnCount = new_cols;\n          self.cellCount = cell_count;\n      }\n\n      getState() {\n          let state = {};\n\n          this.specs.forEach(function(spec) {\n              state[spec.name] = this.lists[spec.name].getState();\n          }, this);\n\n          return state;\n      }\n\n      setState(state) {\n          this.specs.forEach(function(spec) {\n              this.lists[spec.name].setState(state[spec.name]);\n          }, this);\n      }\n\n      get(name, index) {\n          if (index === undefined) {\n              return this.lists[name];\n          }\n\n          switch (name) {\n          case \"borderRight\":\n              index += this.rowCount;\n              /* falls through */\n          case \"borderLeft\":\n              name = \"vBorders\";\n              break;\n\n          case \"borderBottom\":\n              index++;\n              /* falls through */\n          case \"borderTop\":\n              name = \"hBorders\";\n              break;\n          }\n          return index > this.cellCount ? null : this.properties[name].get(index);\n      }\n\n      set(name, start, end, value) {\n          switch (name) {\n          case \"borderRight\":\n              start += this.rowCount;\n              end += this.rowCount;\n              /* falls through */\n          case \"borderLeft\":\n              name = \"vBorders\";\n              break;\n\n          case \"borderBottom\":\n              start++;\n              end++;\n              /* falls through */\n          case \"borderTop\":\n              name = \"hBorders\";\n              break;\n          }\n          if (start <= end && end <= this.cellCount) {\n              this.properties[name].set(start, end, value);\n          }\n      }\n\n      fromJSON(index, value) {\n          for (let si = 0; si < this.specs.length; si++) {\n              let spec = this.specs[si];\n\n              if (spec.serializable) {\n                  if (value[spec.name] !== undefined) {\n                      this.set(spec.name, index, index, value[spec.name], false);\n                  }\n              }\n          }\n\n          [ \"borderLeft\", \"borderRight\", \"borderTop\", \"borderBottom\" ].forEach(function(b) {\n              if (value[b] !== undefined) {\n                  this.set(b, index, index, value[b]);\n              }\n          }, this);\n      }\n\n      copy(sourceStart, sourceEnd, targetStart) {\n          this.specs.forEach(function(spec) {\n              this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n          }, this);\n      }\n\n      iterator(name, start, end) {\n          let prop = this.properties[name];\n          let iter = prop.iterator(start, end), at = iter.at;\n          let cellCount = this.cellCount;\n          iter.at = function(index) {\n              return index > cellCount ? null : prop.parse(at.call(iter, index));\n          };\n          iter.name = name;\n          iter.value = prop.spec.value;\n          return iter;\n      }\n\n      sortable() {\n          return this.specs.filter(function(spec) { return spec.sortable; })\n              .map(function(spec) {\n                  return this.lists[spec.name];\n              }, this);\n      }\n\n      iterators(start, end) {\n          return this.specs.reduce(function(ret, spec) {\n              if (spec.serializable) {\n                  ret.push(this.iterator(spec.name, start, end));\n              }\n              return ret;\n          }.bind(this), []);\n      }\n\n      forEach(start, end, callback) {\n          let iterators = this.iterators(start, end);\n          let hBorders = this.iterator(\"hBorders\", start, end + 1);\n          let leftBorders = this.iterator(\"vBorders\", start, end);\n          let rightBorders = this.iterator(\"vBorders\", start + this.rowCount, end + this.rowCount);\n          let values, index;\n\n          function addBorder(name, iterator, index) {\n              let val = iterator.at(index);\n              if (val !== iterator.value) {\n                  values[name] = val;\n              }\n          }\n\n          for (index = start; index <= end; index++) {\n              values = {};\n\n              for (let i = 0; i < iterators.length; i++) {\n                  let iterator = iterators[i];\n                  let value = iterator.at(index);\n\n                  if (value !== iterator.value) {\n                      values[iterator.name] = value;\n                  }\n              }\n\n              addBorder(\"borderLeft\", leftBorders, index);\n              addBorder(\"borderRight\", rightBorders, index + this.rowCount);\n              addBorder(\"borderTop\", hBorders, index);\n              if ((index + 1) % this.rowCount) {\n                  addBorder(\"borderBottom\", hBorders, index + 1);\n              }\n\n              callback(values);\n          }\n      }\n\n      forEachProperty(callback) {\n          for (let name in this.properties) {\n              callback(this.properties[name]);\n          }\n      }\n  }\n  function cloneFormulaValue(x) {\n      x = x.clone();\n      x.value = x.value.deepClone(); // x.value is Formula or Validation\n      return x;\n  }\n  function cloneFormulaTree() {\n      let tree = this.map(cloneFormulaValue);\n      tree.clone = cloneFormulaTree; // because it's a new RangeTree now\n      return tree;\n  }\n  const ALL_PROPERTIES = propertyBagSpec.reduce(function(a, spec) {\n      if (spec.serializable) {\n          a.push(spec.name);\n      }\n      return a;\n  }, [ \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\" ]);\n\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable no-useless-call */\n  /* eslint-disable camelcase */\n  /* eslint-disable default-case */\n\n\n  let TRANSPOSE_FORMAT = \"_matrix({0})\";\n  let DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n\n  function compileValidation(sheet, row, col, validation) {\n      let validationHandler;\n      let comparer;\n      let parsedFromDate;\n      let parsedToDate;\n      if (typeof validation === \"string\") {\n          validation = JSON.parse(validation);\n      }\n      if (validation.from) {\n          if (validation.dataType === \"list\" && !validation.fromIsListValue) {\n              // We need to convert the {...} validation.from value to a string, so that it would work when exported to XLSX\n              if (validation.from.indexOf(\"{\") > -1) {\n                  validation.from = validation.from.replace(/\\\"/g,\"\").replace(\"{\",\"\\\"\").replace(\"}\", \"\\\"\");\n              }\n              validation.from = intl().format(TRANSPOSE_FORMAT, validation.from);\n              validation.fromIsListValue = true;\n          }\n          if (validation.dataType === \"date\") {\n              parsedFromDate = calc.runtime.parseDate(validation.from);\n              if (parsedFromDate) {\n                  validation.from = intl().format(DATE_FORMAT, validation.from);\n                  validation.fromIsDateValue = true;\n              }\n          }\n          validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n      }\n      if (validation.to) {\n          if (validation.dataType === \"date\") {\n              parsedToDate = calc.runtime.parseDate(validation.to);\n              if (parsedToDate) {\n                  validation.to = intl().format(DATE_FORMAT, validation.to);\n                  validation.toIsDateValue = true;\n              }\n          }\n          validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n      }\n      if (validation.dataType === \"custom\") {\n          comparer = validationExport.validationComparers.custom;\n      } else if (validation.dataType === \"list\") {\n          comparer = validationExport.validationComparers.list;\n      } else {\n          comparer = validationExport.validationComparers[validation.comparerType];\n      }\n      if (!comparer) {\n          throw intl().format(\"'{0}' comparer is not implemented.\", validation.comparerType);\n      }\n      validationHandler = function(valueToCompare) { //add 'valueFormat' arg when add isDate comparer\n          let toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n          if (valueToCompare === null || valueToCompare === \"\") {\n              if (this.allowNulls) {\n                  this.value = true;\n              } else {\n                  this.value = false;\n              }\n          } else if (this.dataType === \"custom\") {\n              this.value = comparer(valueToCompare, this.from_value, toValue);\n          } else if (this.dataType === \"list\") {\n              let data = this._getListData();\n              this.value = comparer(valueToCompare, data, toValue);\n          } else {\n              //TODO: TYPE CHECK IS REQUIRED ONLY FOR DATE TYPE WHEN SPECIAL COMPARER (ISDATE) IS USED\n              this.value = comparer(valueToCompare, this.from_value, toValue);\n          }\n          return this.value;\n      };\n      const resultOptions = Object.assign({}, validation);\n      resultOptions.handler = validationHandler;\n      resultOptions.sheet = sheet;\n      resultOptions.row = row;\n      resultOptions.col = col;\n      return new Validation(resultOptions);\n  }\n  class Validation {\n      constructor(options) {\n          this.handler = options.handler;\n          this.from = options.from;\n          this.to = options.to;\n          this.dataType = options.dataType; //date, time etc\n          this.comparerType = options.comparerType; //greaterThan, EqaulTo etc\n          this.type = options.type ? options.type : \"warning\"; //info, warning, reject\n          this.allowNulls = options.allowNulls ? true : false;\n          this.fromIsDateValue = options.fromIsDateValue ? true : false;\n          this.toIsDateValue = options.toIsDateValue ? true : false;\n          this.showButton = options.showButton;\n          this.fromIsListValue = options.fromIsListValue ? true : false;\n          //TODO: address to be range / cell ref, and adjust it based on it\n          this.sheet = options.sheet;\n          this.row = options.row;\n          this.col = options.col;\n          if (options.tooltipMessageTemplate) {\n              this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n          }\n          if (options.tooltipTitleTemplate) {\n              this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n          }\n          if (options.messageTemplate) {\n              this.messageTemplate = options.messageTemplate;\n          }\n          if (options.titleTemplate) {\n              this.titleTemplate = options.titleTemplate;\n          }\n      }\n      _formatMessages(format) {\n          let from = this.from ? this.from_value : \"\";\n          let to = this.to ? this.to_value : \"\";\n          let fromFormula = this.from ? this.from.toString() : \"\";\n          let toFormula = this.to ? this.to.toString() : \"\";\n          let dataType = this.dataType;\n          let type = this.type;\n          let comparerType = this.comparerType;\n          return intl().format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n      }\n      _setMessages() {\n          this.title = \"\";\n          this.message = \"\";\n          if (this.tooltipTitleTemplate) {\n              this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n          }\n          if (this.tooltipMessageTemplate) {\n              this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n          }\n          if (this.titleTemplate) {\n              this.title = this._formatMessages(this.titleTemplate);\n          }\n          if (this.messageTemplate) {\n              this.message = this._formatMessages(this.messageTemplate);\n          }\n      }\n      _getListData() {\n          if (!this.from_value || !this.from_value.data) {\n              return [];\n          }\n          let cube = this.from_value.data;\n          let i;\n          let y;\n          let data = [];\n          for (i = 0; i < cube.length; i++ ) {\n              let array = cube[i];\n              if (array) {\n                  for (y = 0; y < array.length; y++ ) {\n                      data.push(array[y]);\n                  }\n              }\n          }\n          return data;\n      }\n      clone(sheet, row, col) {\n          let options = this._getOptions();\n          if (options.from) {\n              options.from = options.from.clone(sheet, row, col);\n          }\n          if (options.to) {\n              options.to = options.to.clone(sheet, row, col);\n          }\n          const optionsResult = Object.assign({}, options);\n          optionsResult.handler = this.handler;\n          optionsResult.sheet = sheet;\n          optionsResult.row = row;\n          optionsResult.col = col;\n          return new Validation(optionsResult);\n      }\n      deepClone() {\n          let v = new Validation(this);\n          v.from = v.from.deepClone();\n          if (v.to) {\n              v.to = v.to.deepClone();\n          }\n          return v;\n      }\n      exec(ss, compareValue, compareFormat, callback) {\n          let self = this;\n          function getValue(val) {\n              if (val instanceof Ref) {\n                  val = ss.getData(val);\n                  if (Array.isArray(val)) {\n                      val = val[0];\n                  }\n              }\n              return val;\n          }\n          let calculateFromCallBack = function(val) {\n              self.from_value = getValue(val);\n              self.value = self.handler.call(self, compareValue, compareFormat);\n              self._setMessages();\n              if (callback) {\n                  callback(self.value);\n              }\n          };\n          if (self.to) {\n              self.to.exec(ss, function(val) {\n                  self.to_value = getValue(val);\n                  self.from.exec(ss, calculateFromCallBack);\n              });\n          } else {\n              self.from.exec(ss, calculateFromCallBack);\n          }\n      }\n      reset() {\n          if (this.from) {\n              this.from.reset();\n          }\n          if (this.to) {\n              this.to.reset();\n          }\n          delete this.value;\n      }\n      adjust(affectedSheet, operation, start, delta) {\n          let prevFrom, prevTo, modified;\n          let formulaRow = this.row;\n          let formulaCol = this.col;\n          if (this.from) {\n              prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n          }\n          if (this.to) {\n              prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n          }\n          if (this.sheet.toLowerCase() === affectedSheet.toLowerCase()) {\n              switch (operation) {\n              case \"row\":\n                  if (formulaRow >= start) {\n                      modified = true;\n                      this.row += delta;\n                  }\n                  break;\n              case \"col\":\n                  if (formulaCol >= start) {\n                      modified = true;\n                      this.col += delta;\n                  }\n                  break;\n              }\n          }\n          if (modified || prevFrom || prevTo) {\n              let v = new Validation(this);\n              v.from = prevFrom;\n              v.to = prevTo;\n              v.row = formulaRow;\n              v.col = formulaCol;\n              return v;\n          }\n      }\n      toJSON() {\n          let options = this._getOptions();\n          if (options.from) {\n              options.from = options.from.toString();\n              if (options.dataType === \"list\") {\n                  options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, \"$1\");\n                  delete options.fromIsListValue;\n              }\n              if (options.dataType === \"date\") {\n                  if (this.fromIsDateValue) {\n                      options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                      delete options.fromIsDateValue;\n                  }\n              }\n          }\n          if (options.to) {\n              options.to = options.to.toString();\n              if (options.dataType === \"date\") {\n                  if (this.toIsDateValue) {\n                      options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                      delete options.toIsDateValue;\n                  }\n              }\n          }\n          return options;\n      }\n      _getOptions() {\n          return {\n              from: this.from,\n              to: this.to,\n              dataType: this.dataType,\n              type: this.type,\n              comparerType: this.comparerType,\n              row: this.row,\n              col: this.col,\n              sheet: this.sheet,\n              allowNulls: this.allowNulls,\n              fromIsListValue: this.fromIsListValue,\n              fromIsDateValue: this.fromIsDateValue,\n              toIsDateValue: this.toIsDateValue,\n              tooltipMessageTemplate: this.tooltipMessageTemplate,\n              tooltipTitleTemplate: this.tooltipTitleTemplate,\n              //TODO: export generated messages instead?\n              messageTemplate: this.messageTemplate,\n              titleTemplate: this.titleTemplate,\n              showButton: this.showButton\n          };\n      }\n  }\n  const validationExport = {};\n  validationExport.compile = compileValidation;\n  validationExport.validationComparers = {\n      greaterThan: function(valueToCompare, from) {\n          return valueToCompare > from;\n      },\n      lessThan: function(valueToCompare, from) {\n          return valueToCompare < from;\n      },\n      between: function(valueToCompare, from, to) {\n          return valueToCompare >= from && valueToCompare <= to;\n      },\n      equalTo: function(valueToCompare, from) {\n          return valueToCompare === from;\n      },\n      notEqualTo: function(valueToCompare, from) {\n          return valueToCompare !== from;\n      },\n      greaterThanOrEqualTo: function(valueToCompare, from) {\n          return valueToCompare >= from;\n      },\n      lessThanOrEqualTo: function(valueToCompare, from) {\n          return valueToCompare <= from;\n      },\n      notBetween: function(valueToCompare, from, to) {\n          return valueToCompare < from || valueToCompare > to;\n      },\n      custom: function(valueToCompare, from) {\n          return from;\n      },\n      list: function(valueToCompare, data) {\n          return data.indexOf(valueToCompare) > -1;\n      }\n  };\n  validationExport.Validation = Validation;\n\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable curly */\n  /* eslint-disable space-infix-ops */\n  /* eslint-disable indent */\n  /* eslint-disable no-empty */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable consistent-return */\n  /* eslint-disable block-scoped-var */\n  /* eslint-disable no-redeclare */\n  /* eslint-disable no-var */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable complexity */\n  /* eslint-disable max-params */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable key-spacing */\n  /* eslint-disable default-case */\n  /* eslint-disable camelcase */\n  /* eslint-disable brace-style */\n  /* eslint-disable no-else-return */\n  /* eslint-disable no-constant-condition */\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable space-before-blocks */\n\n  const { measureText } = kendo_drawing_cmn_chunk_js.u;\n\n  let PROPERTIES = [\n      \"color\", \"fontFamily\", \"underline\",\n      \"italic\", \"bold\", \"textAlign\", \"indent\",\n      \"verticalAlign\", \"background\", \"format\", \"link\", \"editor\",\n      \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\",\n      \"comment\", \"html\"\n  ];\n  let Range$1 = class Range {\n      constructor(ref, sheet) {\n          this._sheet = sheet;\n          this._ref = ref;\n      }\n\n      clone() {\n          return new Range(this._ref.clone(), this._sheet);\n      }\n\n      skipHiddenCells() {\n          let refs = [];\n          let self = this, sheet = self._sheet;\n          let skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n          let skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n          self._ref.forEach(function(ref) {\n              ref = self._normalize(ref.toRangeRef());\n              let tl = ref.topLeft, br = ref.bottomRight;\n              let rows = partition(tl.row, br.row, skipHiddenRows);\n              let cols = partition(tl.col, br.col, skipHiddenCols);\n              for (let i = 0; i < rows.length; ++i) {\n                  for (let j = 0; j < cols.length; ++j) {\n                      refs.push(new RangeRef(\n                          new CellRef(rows[i].begin, cols[j].begin),\n                          new CellRef(rows[i].end, cols[j].end)\n                      ));\n                  }\n              }\n          });\n          return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n      }\n\n      _normalize(ref) {\n          return this._sheet._grid.normalize(ref);\n      }\n\n      _set(name, value, noTrigger) {\n          let self = this;\n          let sheet = self._sheet;\n          self._ref.forEach(function(ref) {\n              let result = ref;\n              let valueProp = name === \"value\" || name === \"formula\" || name === \"link\";\n\n              // Set values/formulas/links only to the topLeft cell when merged\n              if (valueProp && ref.topLeft) {\n                  let topLeftRef = new CellRef(ref.topLeft.row, ref.topLeft.col);\n\n                  sheet.forEachMergedCell(function(f) {\n                      if (f.intersects(topLeftRef)) {\n                          result = topLeftRef;\n                      }\n                  });\n              }\n\n              sheet._set(result.toRangeRef(), name, value);\n          });\n          if (!noTrigger) {\n              sheet.triggerChange({\n                  recalc  : name === \"formula\" || name === \"value\" || name === \"validation\",\n                  value   : value,\n                  range   : self,\n                  ref     : self._ref,\n                  isValue : name === \"value\"\n              });\n          }\n          return self;\n      }\n\n      _get(name) {\n          return this._sheet._get(this._ref.toRangeRef(), name);\n      }\n\n      _property(name, value) {\n          if (value === undefined) {\n              return this._get(name);\n          } else {\n              return this._set(name, value);\n          }\n      }\n\n      value(value) {\n          if (value !== undefined) {\n              // When value is set through the public API we must clear the\n              // formula.  Don't trigger change (third parameter), it'll be\n              // done when setting the value below\n              this._set(\"formula\", null, true);\n          }\n          return this._property(\"value\", value);\n      }\n\n      html(value) {\n          return this._property(\"html\", value);\n      }\n\n      resize(direction) {\n          let ref = this._resizedRef(direction);\n          return new Range(ref, this._sheet);\n      }\n\n      _resizedRef(direction) {\n          return this._ref.map(function(ref) {\n              return ref.toRangeRef().resize(direction);\n          });\n      }\n\n      input(value, options) {\n          options = Object.assign({ arrayFormula: false }, options);\n          let existingFormat = this._get(\"format\"), x;\n          if (value !== undefined) {\n              let tl = this._ref.toRangeRef().topLeft;\n              x = calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n              this._sheet.batch(function() {\n                  let formula = null;\n                  if (x.type === \"exp\") {\n                      formula = calc.compile(x);\n                  } else if (existingFormat !== \"@\") {\n                      let existingFormatType = existingFormat &&\n                          formatting.type(x.value, existingFormat);\n                      if (x.type === \"date\" && existingFormatType !== \"date\") {\n                          this.format(x.format || toExcelFormat(culture().calendar.patterns.d));\n                      } else if (x.type === \"percent\" && existingFormatType !== \"percent\") {\n                          this.format(x.value * 100 === (x.value * 100 | 0) ? \"0%\" : \"0.00%\");\n                      } else if (x.format) {\n                          if (!existingFormat || x.currency ||\n                              (existingFormatType === \"number\" && x.type === \"number\" &&\n                                  x.format.length > existingFormat.length)) {\n                              this.format(x.format);\n                          }\n                      }\n                  } else if (x.type !== \"string\") {\n                      x.value = value;\n                  }\n                  this.formula(formula, options.arrayFormula);\n                  if (!formula) {\n                      // value() will clear the formula.  Lucky for us,\n                      // x.value is undefined so it actually won't, but let's\n                      // be explicit and only set value if formula is not\n                      // present.\n                      this.value(x.value);\n                  }\n              }.bind(this), {\n                  recalc       : true,\n                  value        : value,\n                  ref          : this._ref,\n                  editorChange : this._sheet.isInEditMode(),\n                  isValue      : true\n              });\n\n              return this;\n          } else {\n              value = this._get(\"value\");\n              let formula = this._get(\"formula\");\n              let type = existingFormat && !formula && formatting.type(value, existingFormat);\n\n              if (formula) {\n                  // it's a Formula object which stringifies to the\n                  // formula as text (without the starting `=`).\n                  value = \"=\" + formula;\n              } else OUT: {\n                  if (existingFormat && type === \"date\") {\n                      // check if we could parse back the displayed value.\n                      // https://github.com/telerik/kendo/issues/5335\n                      let t1 = formatting.text(value, existingFormat);\n                      x = calc.parse(null, null, null, t1, existingFormat); // it's not a formula so we don't need sheet/row/col\n                      let t2 = formatting.text(x.value, existingFormat);\n                      if (t1 === t2) {\n                          value = t1;\n                          break OUT;\n                      }\n                  }\n                  if (type === \"date\") {\n                      const intlVal = intl();\n                      value = intlVal.toString(calc.runtime.serialToDate(value), culture().calendar.patterns.d, intlVal.locale);\n                  } else if (type === \"percent\") {\n                      value = calc.runtime.limitPrecision(value * 100) + \"%\";\n                  } else if (typeof value == \"string\" &&\n                              (/^[=']/.test(value) ||\n                              (/^(?:true|false)$/i).test(value) ||\n                              looksLikeANumber(value))) {\n                      value = \"'\" + value;\n                  } else if (this._sheet._useCultureDecimals() &&\n                              typeof value == \"number\" &&\n                              value !== Math.floor(value)) {\n                      value = String(value).replace(\".\", culture().numbers.symbols.decimal);\n                  }\n              }\n\n              return value;\n          }\n      }\n\n      enable(value) {\n          if (value === undefined) {\n              return !withExit(function(exit) {\n                  this._sheet.forEach(this._ref, function(_, __, data) {\n                      if (data.enable === false) {\n                          exit(true);\n                      }\n                  });\n              }, this);\n          }\n\n          return this._property(\"enable\", value);\n      }\n\n      formula(value, arrayFormula) {\n          let self = this;\n          if (value === undefined) {\n              let f = self._get(\"formula\");\n              return f ? \"\" + f : null; // stringify if present\n          }\n          if (arrayFormula) {\n              // when setting an array formula, we want to set it on\n              // the first cell only, as it will fill the whole\n              // range.\n              let ref = this._ref.toRangeRef();\n              value = self._sheet.range(ref.topLeft)\n                  ._set(\"formula\", value)\n                  ._get(\"formula\"); // make sure we get the compiled Formula, not a string\n\n              if (value) {    // could be null.\n                  // this will be used in FormulaContext -- it's the\n                  // range that the formula must populate.\n                  value.setArrayFormulaRange(ref);\n              }\n          } else {\n              self._set(\"formula\", value);\n          }\n          return self;\n      }\n\n      intersectingArrayFormula() {\n          let ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n          return withExit(function(exit) {\n              this._sheet._forFormulas(function(f) {\n                  let r = f.arrayFormulaRange;\n                  if (r && (r = ref.intersect(r)) !== NULLREF) {\n                      exit({ formula: f, intersection: r });\n                  }\n              });\n          }, this);\n      }\n\n      canEditArrayFormula() {\n          let x = this.intersectingArrayFormula();\n          if (x) {\n              // we want to allow editing only when the new range is\n              // at least as big as the original range (i.e. no\n              // cells removed)\n              return x.formula.arrayFormulaRange.eq(x.intersection);\n          }\n          return true;\n      }\n\n      validation(value) {\n          //TODO: Accept objects only?\n\n          if (value === undefined) {\n              let f = this._get(\"validation\");\n\n              return f ? f.toJSON() : null; // stringify if present\n          }\n          return this._property(\"validation\", value);\n      }\n\n      _getValidationState() {\n          let ref = this._ref.toRangeRef();\n          let topLeftRow = ref.topLeft.row;\n          let topLeftCol = ref.topLeft.col;\n          let bottomRightRow = ref.bottomRight.row;\n          let bottomRightCol = ref.bottomRight.col;\n          let ci, ri;\n\n          for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n              for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                  let validation = this._sheet._validation(ri, ci);\n\n                  if (validation && validation.type === \"reject\" && validation.value === false) {\n                      return validation;\n                  }\n              }\n          }\n\n          return false;\n      }\n\n      merge() {\n          this._ref = this._sheet._merge(this._ref);\n          return this;\n      }\n\n      unmerge() {\n          let mergedCells = this._sheet._mergedCells;\n\n          this._ref.forEach(function(ref) {\n              ref.toRangeRef().intersecting(mergedCells).forEach(function(mergedRef) {\n                  mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n              });\n          });\n\n          this._sheet.triggerChange({});\n\n          return this;\n      }\n\n      select() {\n          this._sheet.select(this._ref);\n\n          return this;\n      }\n\n      values(values) {\n          if (this._ref instanceof UnionRef) {\n              throw new Error(\"Unsupported for multiple ranges.\");\n          }\n\n          if (this._ref === NULLREF) {\n              if (values !== undefined) {\n                  throw new Error(\"Unsupported for NULLREF.\");\n              } else {\n                  return [];\n              }\n          }\n\n          let ref = this._ref.toRangeRef();\n          let topLeftRow = ref.topLeft.row;\n          let topLeftCol = ref.topLeft.col;\n          let bottomRightRow = ref.bottomRight.row;\n          let bottomRightCol = ref.bottomRight.col;\n          let ci, ri;\n\n          if (values === undefined) {\n              values = new Array(ref.height());\n\n              for (let vi = 0; vi < values.length; vi++) {\n                  values[vi] = new Array(ref.width());\n              }\n\n              for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                  for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                      values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                  }\n              }\n\n              return values;\n          } else {\n              this._sheet._set(ref, \"formula\", null);\n\n              for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                  for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                      let row = values[ri - topLeftRow];\n\n                      if (row) {\n                          let value = row[ci - topLeftCol];\n\n                          if (value !== undefined) {\n                              this._sheet._value(ri, ci, value);\n                          }\n                      }\n                  }\n              }\n\n              this._sheet.triggerChange({ recalc: true, ref: ref });\n\n              return this;\n          }\n      }\n\n      _properties(props, isAutofill) {\n          if (this._ref instanceof UnionRef) {\n              throw new Error(\"Unsupported for multiple ranges.\");\n          }\n\n          if (this._ref === NULLREF) {\n              if (props !== undefined) {\n                  throw new Error(\"Unsupported for NULLREF.\");\n              } else {\n                  return [];\n              }\n          }\n\n          let ref = this._ref.toRangeRef();\n          let topLeftRow = ref.topLeft.row;\n          let topLeftCol = ref.topLeft.col;\n          let bottomRightRow = ref.bottomRight.row;\n          let bottomRightCol = ref.bottomRight.col;\n          let ci, ri;\n          let sheet = this._sheet;\n\n          if (props === undefined) {\n              props = new Array(ref.height());\n              sheet.forEach(ref, function(row, col, data) {\n                  row -= topLeftRow;\n                  col -= topLeftCol;\n                  let line = props[row] || (props[row] = []);\n                  line[col] = data;\n              });\n              return props;\n          } else {\n              let data;\n              ref = ref.clone();\n              let setProp = function(propName) {\n                  let propValue = data[propName];\n                  ref.topLeft.row = ref.bottomRight.row = ri;\n                  ref.topLeft.col = ref.bottomRight.col = ci;\n\n                  if (propName === \"value\") {\n                      sheet._set(ref, \"formula\", null);\n                  }\n\n                  sheet._set(ref, propName, propValue);\n              };\n\n              let isValue = false;\n              for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                  if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                      continue;\n                  }\n                  for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                      if (!isAutofill && sheet.isHiddenRow(ri)) {\n                          continue;\n                      }\n                      if (isAutofill && sheet.isFilteredRow(ri)) {\n                          continue;\n                      }\n                      let row = props[ri - topLeftRow];\n                      if (row) {\n                          data = row[ci - topLeftCol];\n                          if (data) {\n                              const keys = Object.keys(data);\n                              keys.forEach(setProp);\n                              isValue = isValue || keys.includes(\"value\");\n                          }\n                      }\n                  }\n              }\n              sheet.triggerChange({ recalc: true, ref: this._ref, isValue: isValue });\n              return this;\n          }\n      }\n\n      clear(options) {\n          options = options || {};\n          let clearAll = options.clearAll || !Object.keys(options).length;\n\n          let sheet = this._sheet;\n\n          let reason = {\n              recalc: clearAll || options.contentsOnly,\n              ref: this._ref,\n              isValue: true\n          };\n\n          sheet.batch(function() {\n\n              if (reason.recalc) {\n                  this.formula(null);\n              }\n\n              if (clearAll) {\n                  this.validation(null);\n              }\n\n              if (clearAll || options.formatOnly) {\n                  PROPERTIES.forEach(function(x) {\n                      if (!(options.keepBorders && /^border/i.test(x))) {\n                          this[x](null);\n                      }\n                  }.bind(this));\n                  this.fontSize(null);\n                  this.wrap(null);\n                  this.unmerge();\n              }\n\n          }.bind(this), reason);\n\n          return this;\n      }\n\n      clearContent() {\n          return this.clear({ contentsOnly: true });\n      }\n\n      clearFormat() {\n          return this.clear({ formatOnly: true });\n      }\n\n      isSortable() {\n          return !this.cantSort();\n      }\n\n      cantSort() {\n          if (this._ref instanceof UnionRef) {\n              return { code: \"cantSortMultipleSelection\",\n                          message: \"Unsupported for multiple ranges.\" };\n          }\n          if (this._ref === NULLREF) {\n              return { code: \"cantSortNullRef\",\n                          message: \"Unsupported for NULLREF.\" };\n          }\n          let mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n          let primary = mc.primary;\n          let secondary = mc.secondary;\n          let width = null, height = null;\n          let cant = {};\n          try {\n              this._sheet.forEach(this, function(row, col) {\n                  let id = new CellRef(row, col).print();\n                  let merged = primary[id];\n                  if (merged) {\n                      if (width === null) {\n                          width = merged.width();\n                          height = merged.height();\n                      } else if (!(width === merged.width() && height === merged.height())) {\n                          throw cant;\n                      }\n                  } else if (!secondary[id] && mc.hasMerged) {\n                      throw cant;\n                  }\n              });\n          } catch (ex) {\n              if (ex !== cant) {\n                  throw ex;\n              }\n              return {\n                  code: \"cantSortMixedCells\",\n                  message: \"Unsupported for range containing cells of different shapes.\"\n              };\n          }\n          return false;\n      }\n\n      sort(spec) {\n          let reason = this.cantSort();\n          if (reason) {\n              throw new Error(reason.message);\n          }\n\n          if (spec === undefined) {\n              spec = { column: 0 };\n          }\n\n          spec = spec instanceof Array ? spec : [spec];\n\n          this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n              if (typeof spec === \"number\") {\n                  spec = { column: spec };\n              }\n\n              return {\n                  index: spec.column === undefined ? index : spec.column,\n                  ascending: spec.ascending === undefined ? true : spec.ascending\n              };\n          }));\n\n          return this;\n      }\n\n      isFilterable() {\n          return !(this._ref instanceof UnionRef);\n      }\n\n      filter(spec) {\n          if (this._ref instanceof UnionRef) {\n              throw new Error(\"Unsupported for multiple ranges.\");\n          }\n\n          if (spec === false) {\n              this.clearFilters();\n          } else {\n              spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n\n              this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                  return {\n                      index: spec.column === undefined ? spec.index === undefined ? index : spec.index : spec.column,\n                      filter: spec.filter\n                  };\n              }));\n          }\n\n          return this;\n      }\n\n      clearFilter(spec) {\n          this._sheet.clearFilter(spec);\n      }\n\n      clearFilters() {\n          let filter = this._sheet.filter();\n          let spec = [];\n\n          if (filter) {\n              for (let i = 0; i < filter.columns.length; i++) {\n                  spec.push(filter.columns[i].index);\n              }\n\n              this._sheet.batch(function() {\n                  this.clearFilter(spec);\n                  this._filter = null;\n              }, { layout: true, filter: true });\n          }\n      }\n\n      hasFilter() {\n          let filter = this._sheet.filter();\n          return Boolean(filter);\n      }\n\n      leftColumn() {\n          return new Range(this._ref.leftColumn(), this._sheet);\n      }\n\n      rightColumn() {\n          return new Range(this._ref.rightColumn(), this._sheet);\n      }\n\n      topRow() {\n          return new Range(this._ref.topRow(), this._sheet);\n      }\n\n      bottomRow() {\n          return new Range(this._ref.bottomRow(), this._sheet);\n      }\n\n      column(column) {\n          return new Range(this._ref.toColumn(column), this._sheet);\n      }\n\n      row(row) {\n          return new Range(this._ref.toRow(row), this._sheet);\n      }\n\n      forEachRow(callback) {\n          this._ref.forEachRow(function(ref) {\n              callback(new Range(ref, this._sheet));\n          }.bind(this));\n      }\n\n      forEachColumn(callback) {\n          this._ref.forEachColumn(function(ref) {\n              callback(new Range(ref, this._sheet));\n          }.bind(this));\n      }\n\n      sheet() {\n          return this._sheet;\n      }\n\n      topLeft() {\n          return this._ref.toRangeRef().topLeft;\n      }\n\n      intersectingMerged() {\n          let sheet = this._sheet;\n          let mergedCells = [];\n\n          sheet._mergedCells.forEach(function(ref) {\n              if (ref.intersects(this._ref)) {\n                  mergedCells.push(ref.toString());\n              }\n          }.bind(this));\n\n          return mergedCells;\n      }\n\n      getState(propertyName) {\n          let topLeft = this._ref.first();\n          let state = {\n              ref     : topLeft,\n              data    : [],\n              origRef : this._ref,\n\n              // save row heights\n              rows    : this._sheet._rows.getState()\n          };\n          let properties;\n          if (!propertyName) {\n              properties = ALL_PROPERTIES;\n              state.mergedCells = this.intersectingMerged();\n          } else if (propertyName === \"input\") {\n              properties = [\"value\", \"formula\"];\n          } else if (propertyName === \"border\") {\n              properties = [\"borderLeft\", \"borderTop\", \"borderRight\", \"borderBottom\"];\n          } else {\n              properties = [propertyName];\n          }\n\n          let data = state.data;\n          this.forEachCell(function(row, col, cell) {\n              let cellState = {};\n              let dr = row - topLeft.row;\n              let dc = col - topLeft.col;\n              if (!data[dr]) {\n                  data[dr] = [];\n              }\n              data[dr][dc] = cellState;\n\n              properties.forEach(function(property) {\n                  let value = typeof cell[property] == \"undefined\" ? null : cell[property];\n                  if (value instanceof calc.runtime.Formula ||\n                      value instanceof validationExport.Validation) {\n                      value = value.deepClone();\n                  }\n                  cellState[property] = value;\n              });\n          });\n\n          return state;\n      }\n\n      setState(state, clipboard) {\n          let sheet = this._sheet;\n          let origin = this._ref.first();\n          let rowDelta = state.ref.row - origin.row;\n          let colDelta = state.ref.col - origin.col;\n          let internalClipboard = clipboard && !clipboard.isExternal();\n          let externalClipboard = clipboard && !internalClipboard;\n\n          sheet.batch(function() {\n              if (state.mergedCells) {\n                  this.unmerge();\n              }\n\n              if (!clipboard) {\n                  // restore row heights.  they won't be available\n                  // when this function is called from the clipboard\n                  // code.\n                  this._sheet._rows.setState(state.rows);\n              }\n\n              let row = origin.row;\n              let hasFilter = this.hasFilter();\n              state.data.forEach(function(data, dr) {\n                  if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                      return;\n                  }\n                  let col = origin.col;\n                  data.forEach(function(cellState, dc) {\n                      if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                          return;\n                      }\n                      let range = clipboard ? sheet.range(row, col)\n                          : sheet.range(origin.row + dr, origin.col + dc);\n                      if (range.enable()) {\n                          for (let property in cellState) {\n                              if (property !== \"value\") {\n                                  // make sure value comes last (after the loop),\n                                  // because if we set value here and get get to\n                                  // formula later and cellState.formula is null,\n                                  // it'll clear the value.\n\n                                  // when pasting, do not copy \"disabled\" state\n                                  if (!(clipboard && property === \"enable\")) {\n                                      range._set(property, cellState[property]);\n                                  }\n                              }\n                          }\n                          if (!cellState.formula) {\n                              // only need to set the value if we don't have a\n                              // formula.  Go through the lower level setter rather\n                              // than range.value(...), because range.value will clear\n                              // the formula!  chicken and egg issues.\n                              if (externalClipboard) {\n                                  // https://github.com/telerik/kendo-ui-core/issues/1688\n                                  // if we have a paste from external source, we should parse the\n                                  // value as if it were inputted.  This allows to treat numbers\n                                  // as numbers, or `=sum(a1:b2)` as formula (Google Sheets does\n                                  // the same).  A difference though is that we can't store an\n                                  // invalid Formula and display #ERROR, like G.S. does, so in\n                                  // case of a parse error we'll just set the value as string.\n                                  try {\n                                      if (cellState.value == null) {\n                                          range._set(\"value\", null);\n                                      } else {\n                                          range.input(cellState.value);\n                                      }\n                                  } catch (ex) {\n                                      range._set(\"value\", cellState.value);\n                                  }\n                              } else {\n                                  range._set(\"value\", cellState.value);\n                              }\n                          }\n                      }\n                      col++;\n                  });\n                  row++;\n              });\n\n              if (state.mergedCells) {\n                  state.mergedCells.forEach(function(merged) {\n                      merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                      sheet.range(merged).merge();\n                  }, this);\n              }\n          }.bind(this), { recalc: true, ref: this._ref });\n      }\n\n      _adjustRowHeight() {\n          let that = this;\n          let sheet = that._sheet;\n          let mc = sheet._getMergedCells(that._ref.toRangeRef());\n          let primary = mc.primary;\n          let secondary = mc.secondary;\n\n          sheet.batch(function() {\n              that.forEachRow(function(rowRange) {\n                  let row = rowRange._ref.topLeft.row;\n                  let height = sheet.rowHeight(row);\n                  if (!height) {\n                      // do not adjust if hidden.\n                      // https://github.com/telerik/kendo-ui-core/issues/6272\n                      // (case 2)\n                      return;\n                  }\n                  rowRange.forEachCell(function(row, col, cell) {\n                      let id = new CellRef(row, col).print();\n                      if (secondary[id]) {\n                          return;\n                      }\n                      let merged = primary[id];\n                      let width;\n                      if (merged) {\n                          width = sheet._columns.sum(merged.topLeft.col,\n                                                      merged.bottomRight.col);\n                      } else {\n                          width = sheet.columnWidth(col);\n                      }\n                      let data = cell.value;\n                      if (cell.format && data != null) {\n                          data = formatting.format(data, cell.format);\n                      }\n                      let textHeight = getTextHeight(\n                          data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                      height = Math.max(height, textHeight);\n                  });\n                  sheet.rowHeight(row, height);\n              });\n          }, { layout: true });\n      }\n\n      forEachCell(callback) {\n          this._ref.forEach(function(ref) {\n              this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n          }.bind(this));\n      }\n\n      hasValue() {\n          let defStyle = this._sheet._defaultCellStyle;\n          return withExit(function(exit) {\n              this.forEachCell(function(row, col, cell) {\n                  // we must not consider cells that only have same values\n                  // as defaultCellStyle, or otherwise we will forbid\n                  // inserting rows/cols in an empty sheet.\n                  for (let key in cell) {\n                      let val = cell[key];\n                      if (val !== undefined && val !== null && val !== defStyle[key]) {\n                          exit(true);\n                      }\n                  }\n              });\n          }, this);\n      }\n\n      wrap(flag) {\n          if (flag === undefined) {\n              return Boolean(this._property(\"wrap\"));\n          }\n          this._property(\"wrap\", flag);\n          if (flag !== null) {\n              this._adjustRowHeight();\n          }\n          return this;\n      }\n\n      fontSize(size) {\n          if (size === undefined) {\n              return this._property(\"fontSize\");\n          }\n          this._property(\"fontSize\", size);\n          if (size !== null) {\n              this._adjustRowHeight();\n          }\n          return this;\n      }\n\n      draw(options, callback) {\n          this._sheet.draw(this, options, callback);\n      }\n\n      insideBorders(value) {\n          return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n      }\n\n      insideVerticalBorders(value) {\n          this._ref.forEach(function(ref) {\n              if (ref instanceof RangeRef && ref.width() > 1) {\n                  ref = ref.clone();\n                  ref.topLeft.col++;\n                  this._sheet.range(ref)._set(\"vBorders\", value);\n              }\n          }, this);\n          return this;\n      }\n\n      insideHorizontalBorders(value) {\n          this._ref.forEach(function(ref) {\n              if (ref instanceof RangeRef && ref.height() > 1) {\n                  ref = ref.clone();\n                  ref.topLeft.row++;\n                  this._sheet.range(ref)._set(\"hBorders\", value);\n              }\n          }, this);\n          return this;\n      }\n  };\n  function partition(begin, end, predicate) {\n      while (begin <= end && predicate(begin)) {\n          begin++;\n      }\n      if (begin > end) {\n          return [];\n      }\n      for (let i = begin + 1; i <= end; ++i) {\n          if (predicate(i)) {\n              return [\n                      { begin: begin, end: i - 1 }\n              ].concat(partition(i + 1, end, predicate));\n          }\n      }\n      return [{ begin: begin, end: end }];\n  }\n  PROPERTIES.forEach(function(property) {\n      Range$1.prototype[property] = function(value) {\n          return this._property(property, value);\n      };\n  });\n  function toExcelFormat(format) {\n      return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n  }\n  function looksLikeANumber(str) {\n      // XXX: could do with just a regexp instead of calling parse.\n      return !(/^=/.test(str)) && (/number|percent/).test(calc.parse(null, 0, 0, str).type);\n  }\n\n  function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n      const measureBox = document.createElement(\"div\");\n\n      measureBox.style.setProperty('position', 'absolute', 'important');\n      measureBox.style.setProperty('top', '-4000px', 'important');\n      measureBox.style.setProperty('height', 'auto', 'important');\n      measureBox.style.setProperty('padding', '1px 3px', 'important');\n      measureBox.style.setProperty('box-sizing', 'border-box', 'important');\n      measureBox.style.setProperty('margin', '0', 'important');\n      measureBox.style.setProperty('border', '1px solid black', 'important');\n      measureBox.style.setProperty('line-height', 'normal', 'important');\n      measureBox.style.setProperty('visibility', 'hidden', 'important');\n      measureBox.style.setProperty('white-space', 'pre-wrap');\n\n      let styles = {\n          \"baselineMarkerSize\" : 0,\n          \"width\" : (wrap === true) ? width + \"px\" : \"auto\",\n          \"font-size\" : (fontSize || 12) + \"px\",\n          \"font-family\" : fontFamily || \"Arial\",\n          \"white-space\" : (wrap === true) ? \"pre-wrap\" : \"pre\",\n          \"overflow-wrap\" : (wrap === true) ? \"break-word\" : \"normal\",\n          \"word-wrap\" : (wrap === true) ? \"break-word\" : \"normal\"\n      };\n\n      return measureText(text, styles, { box: measureBox, normalizeText: false }).height;\n  }\n\n  // --------------------------------------------------------------- autofill.js\n\n  var runtime = calc.runtime;\n  var Formula = runtime.Formula;\n\n  var ERR_INCOMPATIBLE = \"incompatibleRanges\";\n  var ERR_NO_DIRECTION = \"noFillDirection\";\n\n  var FillError = Range$1.FillError = function(msg) {\n      this.code = msg;\n  };\n\n  // `srcRange`: the range containing data that we wish to fill.  `direction`: 0↓, 1→, 2↑, 3←.  So\n  // when bit 0 is set we're doing horizontal filling, and when bit 1 is set we're doing it in\n  // reverse order.\n  Range$1.prototype._previewFillFrom = function(srcRange, direction) {\n      var destRange = this, sheet = destRange._sheet;\n      if (typeof srcRange == \"string\") {\n          srcRange = sheet.range(srcRange);\n      }\n      var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n      var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n\n      if (src.intersects(dest)) {\n          // the UI will send e.g. C2:C8.fillFrom(C7:D8) (intersecting ranges).  this figures out\n          // the actual destination range.\n          if (src.eq(dest)) {\n              return null; // nothing to do\n          }\n          dest = dest.clone();\n          if (src.topLeft.eq(dest.topLeft)) {\n              if (src.width() == dest.width()) {\n                  dest.topLeft.row += src.height();\n                  direction = 0;\n              } else if (src.height() == dest.height()) {\n                  dest.topLeft.col += src.width();\n                  direction = 1;\n              } else {\n                  throw new FillError(ERR_INCOMPATIBLE);\n              }\n          } else if (src.bottomRight.eq(dest.bottomRight)) {\n              if (src.width() == dest.width()) {\n                  dest.bottomRight.row -= src.height();\n                  direction = 2;\n              } else if (src.height() == dest.height()) {\n                  dest.bottomRight.col -= src.width();\n                  direction = 3;\n              } else {\n                  throw new FillError(ERR_INCOMPATIBLE);\n              }\n          } else {\n              throw new FillError(ERR_INCOMPATIBLE);\n          }\n          return sheet.range(dest)._previewFillFrom(srcRange, direction);\n      }\n\n      if (direction == null) {\n          // try to determine based on ranges location/geometry\n          if (src.topLeft.col == dest.topLeft.col) {\n              // assume vertical filling\n              direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n          } else if (src.topLeft.row == dest.topLeft.row) {\n              direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n          } else {\n              throw new FillError(ERR_NO_DIRECTION);\n          }\n      }\n      var horizontal = direction & 1;\n      var descending = direction & 2;\n      if ((horizontal && src.height() != dest.height()) ||\n          (!horizontal && src.width() != dest.width())) {\n          throw new FillError(ERR_INCOMPATIBLE);\n      }\n      var data = srcRange._properties(), n;\n      if (!horizontal) {\n          data = transpose(data);\n          n = dest.height();\n      } else {\n          n = dest.width();\n      }\n      var fill = new Array(data.length);\n      var hint = null;\n      for (var i = 0; i < data.length; ++i) {\n          var s = data[i];\n          var f = findSeries(s);\n          var a = fill[i] = new Array(n);\n          for (var j = 0; j < n; ++j) {\n              var idx = descending ? -j - 1 : s.length + j;\n              var srcIdx = descending ? s.length - (j % s.length) - 1 : (j % s.length);\n              var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n              if (cell.value != null) {\n                  hint = cell.value;\n              }\n          }\n      }\n      if (!horizontal) {\n          fill = transpose(fill);\n      }\n      return { props: fill, direction: direction, dest: destRange, hint: hint };\n  };\n\n  Range$1.prototype.fillFrom = function(srcRange, direction) {\n      var x = this._previewFillFrom(srcRange, direction);\n      x.dest._properties(x.props, true);\n      return x.dest;\n  };\n\n  // This is essentially the FORECAST function, see ./runtime.functions.2.js.\n  // It receives an array of values, and returns a function that \"predicts\"\n  // the value in cell N.\n  function linearRegression(data) {\n      var N = data.length;\n      var mx = (N + 1) / 2, my = data.reduce(function(a, b){\n          return a + b;\n      }, 0) / N;\n      var s1 = 0, s2 = 0;\n      for (var i = 0; i < N; i++) {\n          var t1 = (i + 1) - mx, t2 = data[i] - my;\n          s1 += t1 * t2;\n          s2 += t1 * t1;\n      }\n      if (!s2) {\n          return function(N){\n              return data[N % data.length];\n          };\n      }\n      var b = s1 / s2, a = my - b * mx;\n      return function(N) {\n          return a + b * (N + 1);\n      };\n  }\n\n  function findSeries(properties) {\n      function findStep(a) {\n          var diff = a[1] - a[0];\n          for (var i = 2; i < a.length; ++i) {\n              if (a[i] - a[i-1] != diff) {\n                  return null;\n              }\n          }\n          return diff;\n      }\n      function getData(a) {\n          return a.map(function(v){\n              return v.number;\n          });\n      }\n      var series = [];\n      var data = properties.map(function(x){\n          return x.formula || x.value;\n      });\n      forEachSeries(data, function(begin, end, type, a){\n          var f, values;\n          if (type == \"number\") {\n              values = getData(a);\n\n              // This code would increase a date even if a single cell was selected.  Seems it's\n              // not desirable so I commented it out.\n              // https://github.com/telerik/kendo-ui-core/issues/3565\n              //\n              // if (values.length == 1 && (begin > 0 || end < data.length ||\n              //                            formatType(values[0], properties[begin].format) == \"date\")) {\n              //     values.push(values[0] + 1);\n              // }\n\n              f = linearRegression(values);\n          } else if (type == \"string\" || type == \"formula\" || type == \"boolean\") {\n              // formulas are simply copied over; the sheet will internally clone the objects\n              f = function(N, i) {\n                  return data[i];\n              };\n          } else if (Array.isArray(type)) {\n              if (a.length == 1) {\n                  f = function(N) {\n                      return type[(a[0].number + N) % type.length];\n                  };\n              } else {\n                  // figure out the step\n                  var diff = findStep(getData(a));\n                  if (diff == null) {\n                      // seemingly no pattern, just repeat those strings\n                      f = function(N) {\n                          return a[(N) % a.length].value;\n                      };\n                  } else {\n                      f = function(N) {\n                          var idx = a[0].number + diff * N;\n                          return type[idx % type.length];\n                      };\n                  }\n              }\n          } else if (type != \"null\") {\n              values = getData(a);\n              if (values.length == 1) {\n                  values.push(values[0] + 1);\n              }\n              values = linearRegression(values);\n              f = function(N, i) {\n                  return data[i].replace(/^(.*[\\D0]+)\\d+/, \"$1\" + values(N, i));\n              };\n          } else {\n              f = function() { return null; };\n          }\n          var s = { f: f, begin: begin, end: end, len: end - begin };\n          for (var i = begin; i < end; ++i) {\n              series[i] = s;\n          }\n      });\n      return function(N, i) {\n          var s = series[i];\n          var q = N / data.length | 0;\n          var r = N % data.length;\n          var n = q * s.len + r - s.begin;\n          var value = s.f(n, i);\n          var props = clone$1(properties[i]);\n          delete props.enable;\n          if (value instanceof Formula) {\n              props.formula = value;\n          } else {\n              props.value = value;\n          }\n          return props;\n      };\n  }\n\n  function clone$1(obj) {\n      var copy = {};\n      Object.keys(obj || {}).forEach(function(key){\n          copy[key] = obj[key];\n      });\n      return copy;\n  }\n\n  function forEachSeries(data, f) {\n      var prev = null, start = 0, a = [], type;\n      for (var i = 0; i < data.length; ++i) {\n          type = getType(data[i]);\n          a.push(type);\n          if (prev != null && type.type !== prev.type) {\n              f(start, i, prev.type, a.slice(start, i));\n              start = i;\n          }\n          prev = type;\n      }\n      f(start, i, prev.type, a.slice(start, i));\n  }\n\n  function getType(el) {\n      if (typeof el == \"number\") {\n          return { type: \"number\", number: el };\n      }\n      if (typeof el == \"string\") {\n          var lst = findStringList(el);\n          if (lst) {\n              return lst;\n          }\n          var m = /^(.*\\D)(\\d+)/.exec(el);\n          if (m) {\n              el = el.replace(/^(.*\\D)\\d+/, \"$1-######\");\n              return { type: el, match: m, number: parseFloat(m[2]) };\n          }\n          return { type: \"string\" };\n      }\n      if (typeof el == \"boolean\") {\n          return { type: \"boolean\" };\n      }\n      if (el == null) {\n          return { type: \"null\" };\n      }\n      if (el instanceof Formula) {\n          return { type: \"formula\" };\n      }\n      window.console.error(el);\n      throw new Error(\"Cannot fill data\");\n  }\n\n  function stringLists() {\n      const calendar = culture().calendar;\n      return [\n          calendar.days.format.abbreviated,\n          calendar.days.format.wide,\n          calendar.months.format.abbreviated,\n          calendar.months.format.wide\n      ];\n  }\n\n  function findStringList(str) {\n      var strl = str.toLowerCase();\n      var lists = stringLists();\n      for (var i = 0; i < lists.length; ++i) {\n          var a = lists[i];\n          for (var j = a.length; --j >= 0;) {\n              var el = a[j].toLowerCase();\n              if (el == strl) {\n                  return { type: a, number: j, value: str };\n              }\n          }\n      }\n  }\n\n  function transpose(a) {\n      var height = a.length, width = a[0].length;\n      var t = [];\n      for (var i = 0; i < width; ++i) {\n          t[i] = [];\n          for (var j = 0; j < height; ++j) {\n              t[i][j] = a[j][i];\n          }\n      }\n      return t;\n  }\n\n  /* eslint-disable no-loop-func */\n  /* eslint-disable no-param-reassign */\n  const STRING$1 = 'string';\n  const FUNCTION = 'function';\n\n  let preventDefault = function() {\n      this._defaultPrevented = true;\n  };\n\n  let isDefaultPrevented = function() {\n      return this._defaultPrevented === true;\n  };\n\n  class Observable {\n      constructor() {\n          this._events = {};\n      }\n\n      bind(eventName, handlers, one) {\n          let that = this,\n              idx,\n              eventNames = typeof eventName === STRING$1 ? [eventName] : eventName,\n              length,\n              original,\n              handler,\n              handlersIsFunction = typeof handlers === FUNCTION,\n              events;\n\n          if (handlers === undefined) {\n              for (idx in eventName) {\n                  that.bind(idx, eventName[idx]);\n              }\n              return that;\n          }\n\n          for (idx = 0, length = eventNames.length; idx < length; idx++) {\n              eventName = eventNames[idx];\n\n              handler = handlersIsFunction ? handlers : handlers[eventName];\n\n              if (handler) {\n                  if (one) {\n                      original = handler;\n                      handler = function() {\n                          that.unbind(eventName, handler);\n                          original.apply(that, arguments);\n                      };\n                      handler.original = original;\n                  }\n                  events = that._events[eventName] = that._events[eventName] || [];\n                  events.push(handler);\n              }\n          }\n\n          return that;\n      }\n\n      one(eventNames, handlers) {\n          return this.bind(eventNames, handlers, true);\n      }\n\n      first(eventName, handlers) {\n          let that = this,\n              idx,\n              eventNames = typeof eventName === STRING$1 ? [eventName] : eventName,\n              length,\n              handler,\n              handlersIsFunction = typeof handlers === FUNCTION,\n              events;\n\n          for (idx = 0, length = eventNames.length; idx < length; idx++) {\n              eventName = eventNames[idx];\n\n              handler = handlersIsFunction ? handlers : handlers[eventName];\n\n              if (handler) {\n                  events = that._events[eventName] = that._events[eventName] || [];\n                  events.unshift(handler);\n              }\n          }\n\n          return that;\n      }\n\n      trigger(eventName, e) {\n          let that = this,\n              events = that._events[eventName],\n              idx,\n              length;\n\n          if (events) {\n              e = e || {};\n\n              e.sender = that;\n\n              e._defaultPrevented = false;\n\n              e.preventDefault = preventDefault;\n\n              e.isDefaultPrevented = isDefaultPrevented;\n\n              events = events.slice();\n\n              for (idx = 0, length = events.length; idx < length; idx++) {\n                  events[idx].call(that, e);\n              }\n\n              return e._defaultPrevented === true;\n          }\n\n          return false;\n      }\n\n      unbind(eventName, handler) {\n          let that = this,\n              events = that._events[eventName],\n              idx;\n\n          if (eventName === undefined) {\n              that._events = {};\n          } else if (events) {\n              if (handler) {\n                  for (idx = events.length - 1; idx >= 0; idx--) {\n                      if (events[idx] === handler || events[idx].original === handler) {\n                          events.splice(idx, 1);\n                      }\n                  }\n              } else {\n                  that._events[eventName] = [];\n              }\n          }\n\n          return that;\n      }\n  }\n\n  class Widget extends Observable {\n      constructor(element, options) {\n          super();\n\n          this.element = element;\n          this.events = [];\n          this.options = options;\n\n          // this.bind(this.events, options);\n      }\n\n      setOptions(options) {\n          this._setEvents(options);\n          deepExtend({}, this.options, options);\n      }\n\n      _setEvents(options) {\n          let that = this,\n              idx = 0,\n              length = that.events.length,\n              e;\n\n          for (; idx < length; idx ++) {\n              e = that.events[idx];\n              if (that.options[e] && options[e]) {\n                  that.unbind(e, that.options[e]);\n                  if (that._events && that._events[e]) {\n                      delete that._events[e];\n                  }\n              }\n          }\n\n          that.bind(that.events, options);\n      }\n\n      resize(force) {\n          const size = this.getSize(),\n              currentSize = this._size;\n\n          if (force || (size.width > 0 || size.height > 0) && (!currentSize || size.width !== currentSize.width || size.height !== currentSize.height)) {\n              this._size = size;\n              this._resize(size, force);\n              this.trigger(\"resize\", size);\n          }\n      }\n\n      getSize() {\n          return { width: this.element.offsetWidth, height: this.element.offsetHeight };\n      }\n\n      destroy() {\n          this.unbind();\n      }\n  }\n\n  /* eslint-disable no-param-reassign */\n\n  const _activeElement = function() {\n      try {\n          return document.activeElement;\n      } catch (e) {\n          return document.documentElement.activeElement;\n      }\n  };\n\n  class SheetEditor extends Observable {\n      constructor(view) {\n          super();\n\n          this.events = [\n              \"activate\",\n              \"deactivate\",\n              \"change\",\n              \"update\"\n          ];\n\n          this.view = view;\n          this.formulaBar = view.formulaBar;\n          this._active = false;\n\n          this.barInput = view.formulaBar.formulaInput;\n          this.cellInput = view.formulaInput;\n\n          this.barInput.syncWith(this.cellInput);\n          this.cellInput.syncWith(this.barInput);\n\n          this.barInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n          this.cellInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n\n          this.barInput.bind(\"blur\", this._blur.bind(this));\n          this.cellInput.bind(\"blur\", this._blur.bind(this));\n      }\n\n      _blur() {\n          this.deactivate();\n      }\n\n      _triggerUpdate() {\n          this.trigger(\"update\", { value: this.value() });\n      }\n\n      activeEditor() {\n          let editor = null;\n          let activeElement = _activeElement();\n\n          if (this.barElement() === activeElement) {\n              editor = this.barInput;\n          } else if (this.cellElement() === activeElement) {\n              editor = this.cellInput;\n          }\n\n          return editor;\n      }\n\n      activate(options) {\n          let viewElement = this.view.element,\n              viewWidth, scrollerElement, scrollbarWidth;\n\n          this._active = true;\n          this._rect = options.rect;\n          this._range = options.range;\n\n          this.cellInput.position(options.rect);\n          this.cellInput.resize(options.rect);\n          this.cellInput.tooltip(options.tooltip);\n          this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n          this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n\n          if (viewElement) {\n              viewWidth = viewElement.offsetWidth;\n              scrollerElement = viewElement.querySelector(\".k-spreadsheet-scroller\");\n              scrollbarWidth = scrollerElement.offsetWidth - scrollerElement.clientWidth;\n\n              this.cellInput.element.style.maxWidth = (viewWidth - scrollbarWidth - parseFloat(this.cellInput.element.style.left)) + \"px\";\n          }\n\n          this.trigger(\"activate\");\n\n          return this;\n      }\n\n      deactivate(noChange) {\n          let cellInput = this.cellInput;\n\n          if (!this._active) {\n              return;\n          }\n\n          this._active = false;\n\n          if (!noChange && cellInput.value() !== this._value) {\n              this.trigger(\"change\", {\n                  value: cellInput.value(),\n                  range: this._range\n              });\n          }\n\n          this._rect = null;\n          cellInput.hide();\n          this.trigger(\"deactivate\");\n      }\n\n      enable(enable) {\n          this.barInput.enable(enable);\n          this.cellInput.enable(enable);\n      }\n\n      barElement() {\n          return this.barInput.element;\n      }\n\n      cellElement() {\n          return this.cellInput.element;\n      }\n\n      focus(inputType) {\n          inputType = inputType || \"cell\";\n\n          if (inputType === \"cell\") {\n              this.cellInput.element.focus();\n              this.cellInput.end();\n          } else {\n              this.barInput.focus();\n          }\n      }\n\n      isActive() {\n          return this._active;\n      }\n\n      isFiltered() {\n          return this.barInput.popup.visible() || this.cellInput.popup.visible();\n      }\n\n      canInsertRef(isKeyboardAction) {\n          let editor = this.activeEditor();\n          return editor && editor.canInsertRef(isKeyboardAction);\n      }\n\n      highlightedRefs() {\n          let editor = this.activeEditor();\n          let refs = [];\n\n          if (editor) {\n              refs = editor.highlightedRefs();\n          }\n\n          return refs;\n      }\n\n      scale() {\n          this.cellInput.scale();\n      }\n\n      toggleTooltip(rect) {\n          this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n      }\n\n      value(value, isArrayFormula) {\n          if (value === undefined) {\n              return this.barInput.value();\n          }\n\n          if (value === null) {\n              value = \"\";\n          }\n\n          this._value = value;\n\n          this.barInput.value(value);\n          this.cellInput.value(value);\n\n          this.barInput.element.classList.toggle(\"k-spreadsheet-array-formula\", Boolean(isArrayFormula));\n      }\n\n      insertNewline() {\n          this.activeEditor().insertNewline();\n          this.scale();\n      }\n\n      select() {\n          this.activeEditor().select();\n      }\n  }\n\n  function notEqual(oldRect, newRect) {\n      return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n  }\n\n  const ampRegExp = /&/g,\n      ltRegExp = /</g,\n      quoteRegExp = /\"/g,\n      aposRegExp = /'/g,\n      gtRegExp = />/g;\n\n  const htmlEncode = function(value) {\n      return String(value).replace(ampRegExp, \"&amp;\").replace(ltRegExp, \"&lt;\").replace(gtRegExp, \"&gt;\").replace(quoteRegExp, \"&quot;\").replace(aposRegExp, \"&#39;\");\n  };\n\n  class Axis {\n      constructor(count, value) {\n          this._value = value;\n          this._count = count;\n          this.values = new RangeList(0, count - 1, value);\n          this._hidden = new RangeList(0, count - 1, 0);\n          this.scrollBarSize = scrollbar();\n          this._refresh();\n      }\n      _resize(count) {\n          if (count > this._count) {\n              this.values.value(this._count, count - 1, this._value);\n              this._hidden.value(this._count, count - 1, 0);\n          } else if (count < this._count) {\n              this.values.value(count, this._count - 1, 0);\n              this._hidden.value(count, this._count - 1, 0);\n          }\n          this._count = count;\n          this._refresh();\n      }\n      adjust(start, delta) {\n          // adjust this axis for insert/remove rows/cols operation\n          if (delta < 0) {\n              // removing -- copy from start+|delta| to start\n              this.values.copy(start - delta, this._count - 1, start);\n              this._hidden.copy(start - delta, this._count - 1, start);\n          } else {\n              // adding -- copy from start to start+delta, and set\n              // values for inserted things to default.\n              this.values.copy(start, this._count, start + delta);\n              this._hidden.copy(start, this._count, start + delta);\n              this.values.value(start, start + delta - 1, this._value);\n              this._hidden.value(start, start + delta - 1, 0);\n          }\n          this._refresh();\n      }\n      toJSON(field, positions) {\n          let values = [];\n\n          let iterator = this.values.iterator(0, this._count - 1);\n\n          for (let idx = 0; idx < this._count; idx++) {\n              let value = iterator.at(idx);\n              let hidden = this._hidden.value(idx, idx);\n\n              if (value === this._value && !hidden) {\n                  continue;\n              }\n\n              let position = positions[idx];\n\n              if (position === undefined) {\n                  position = values.length;\n\n                  let item = { index: idx };\n\n                  item[field] = value;\n                  if (hidden) {\n                      item.hidden = hidden;\n                  }\n\n                  values.push(item);\n\n                  positions[idx] = position;\n              }\n          }\n\n          return values;\n      }\n      fromJSON(field, values) {\n          for (let idx = 0; idx < values.length; idx++) {\n              let el = values[idx];\n\n              let index = el.index;\n              if (index === undefined) {\n                  index = idx;\n              }\n\n              // when this particular axis is hidden, the value for\n              // the field (\"height\" or \"width\") will be zero, and\n              // in the \"hidden\" field we'll have the actual value\n              // before it was hidden.\n              // https://github.com/telerik/kendo-ui-core/issues/3523\n              let value = el[field];\n\n              if (value === 0) {\n                  this._hidden.value(index, index, el.hidden || this._value);\n                  this.value(index, index, 0);\n              } else {\n                  this.value(index, index, value);\n              }\n          }\n      }\n      hide(index) {\n          if (!this.hidden(index)) {\n              let value = this.value(index, index);\n              this._hidden.value(index, index, value);\n              this.value(index, index, 0);\n          }\n      }\n      hidden(index) {\n          return this._hidden.value(index, index) !== 0;\n      }\n      includesHidden(start, end) {\n          return this._hidden.intersecting(start, end).length > 1;\n      }\n      nextVisible(index) {\n          let end = this._count - 1, i = index;\n          while (++i <= end) {\n              if (!this.hidden(i)) {\n                  return i;\n              }\n          }\n          return index;\n      }\n      nextUntil(index, pred) {\n          let end = this._count - 1, i = index, advanced = false;\n          while (++i <= end) {\n              let val = pred(i, advanced, this.hidden(i));\n              if (typeof val == 'number') {\n                  return val;\n              } else if (val) {\n                  break;\n              }\n              advanced = true;\n          }\n          return i - 1;\n      }\n      nextPage(index, pageSize) {\n          return this.index(this.sum(0, index - 1) + pageSize);\n      }\n      prevPage(index, pageSize) {\n          return this.index(this.sum(0, index) - pageSize);\n      }\n      firstVisible() {\n          let firstHidden = this._hidden.first();\n          if (firstHidden.value === 0) {\n              return 0;\n          }\n          return firstHidden.end + 1;\n      }\n      lastVisible() {\n          let lastHidden = this._hidden.last();\n          if (lastHidden.value === 0) {\n              return this._count - 1;\n          }\n          return lastHidden.start - 1;\n      }\n      prevVisible(index) {\n          let i = index;\n          while (--i >= 0) {\n              if (!this.hidden(i)) {\n                  return i;\n              }\n          }\n          return index;\n      }\n      prevUntil(index, pred) {\n          let i = index, advanced = false;\n          while (--i >= 0) {\n              let val = pred(i, advanced, this.hidden(i));\n              if (typeof val == 'number') {\n                  return val;\n              } else if (val) {\n                  break;\n              }\n              advanced = true;\n          }\n          return i + 1;\n      }\n      unhide(index) {\n          if (this.hidden(index)) {\n              let value = this._hidden.value(index, index);\n              this._hidden.value(index, index, 0);\n              this.value(index, index, value);\n          }\n      }\n      value(start, end, value) {\n          if (value !== undefined) {\n              this.values.value(start, end, value);\n              this._refresh();\n          } else {\n              return this.values.iterator(start, end).at(0);\n          }\n      }\n      sum(start, end) {\n          let values = this.values.iterator(start, end);\n          let sum = 0;\n          for (let idx = start; idx <= end; idx ++) {\n              sum += values.at(idx);\n          }\n          return sum;\n      }\n      locate(start, end, predicate) {\n          let values = this.values.iterator(start, end);\n          let sum = 0;\n          for (let idx = start; idx <= end; idx++) {\n              sum += values.at(idx);\n              let val = predicate(sum);\n              if (val) {\n                  return idx;\n              }\n          }\n          return null;\n      }\n      visible(start, end) {\n          let startSegment = null;\n          let endSegment = null;\n          let lastPage = false;\n          if (end >= this.total + this.scrollBarSize) {\n              lastPage = true;\n          }\n          let ranges = this._pixelValues.intersecting(start, end);\n          startSegment = ranges[0];\n          endSegment = ranges[ranges.length - 1];\n          if (!startSegment) {\n              return { values: this.values.iterator(0, 0), offset: 0 };\n          }\n          let startOffset = start - startSegment.start;\n          // eslint-disable-next-line no-bitwise\n          let startIndex = ((startOffset / startSegment.value.value) >> 0) + startSegment.value.start;\n          let offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n          let endOffset = end - endSegment.start;\n          // eslint-disable-next-line no-bitwise\n          let endIndex = ((endOffset / endSegment.value.value) >> 0) + endSegment.value.start;\n          if (endIndex > endSegment.value.end) {\n              endIndex = endSegment.value.end;\n          }\n          if (lastPage) {\n              offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n          }\n          offset = Math.min(-offset, 0);\n          return {\n              values: this.values.iterator(startIndex, endIndex),\n              offset: offset\n          };\n      }\n      index(value) {\n          let index = 0;\n          let iterator = this.values.iterator(0, this._count - 1);\n          let current = iterator.at(0);\n          while (current < value && index < this._count - 1) {\n              current += iterator.at(++index);\n          }\n          return index;\n      }\n      indexVisible(value) {\n          let index = this.index(value);\n          if (this.hidden(index)) {\n              index = this.prevVisible(index);\n          }\n          return index;\n      }\n      _refresh() {\n          let current = 0;\n          this._pixelValues = this.values.map(function(range) {\n              let start = current;\n              current += (range.end - range.start + 1) * range.value;\n              let end = current - 1;\n              return new ValueRange(start, end, range);\n          });\n          this.total = current;\n      }\n      getState() {\n          return {\n              values: this.values.getState(),\n              hidden: this._hidden.getState(),\n              count: this._count\n          };\n      }\n      setState(state) {\n          this.values.setState(state.values);\n          this._hidden.setState(state.hidden);\n          let nowCount = this._count;\n          if (nowCount > state.count) {\n              this._count = state.count;\n              this._resize(nowCount); // calls _refresh too\n          } else {\n              this._refresh();\n          }\n      }\n  }\n\n  class PaneAxis {\n      constructor(axis, start, count, headerSize) {\n          this._axis = axis;\n          this._start = start;\n          this._count = count;\n          this.hasHeader = start === 0;\n          this.headerSize = headerSize;\n          this.defaultValue = axis._value;\n          this.frozen = count > 0;\n      }\n      viewSize(viewSize) {\n          this._viewSize = viewSize;\n      }\n      sum(start, end) {\n          return this._axis.sum(start, end - 1);\n      }\n      start() {\n          return this.sum(0, this._start);\n      }\n      size() {\n          return this.sum(this._start, this._start + this._count);\n      }\n      index(value, offset) {\n          return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n      }\n      indexVisible(value, offset) {\n          return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n      }\n      // XXX: rename this method\n      paneSegment() {\n          let offset = this.start();\n          let length;\n          if (!this.hasHeader) {\n              offset += this.headerSize;\n          }\n          if (this.frozen) {\n              length = this.size();\n              if (this.hasHeader) {\n                  length += this.headerSize;\n              } else {\n                  length -= this.headerSize;\n              }\n          } else {\n              length = this._viewSize - offset;\n          }\n          return {\n              offset: offset,\n              length: length\n          };\n      }\n      visible(offset) {\n          let start = this.start();\n          let size;\n          if (this.frozen) {\n              size = this.size();\n              if (!this.hasHeader) {\n                  size -= this.headerSize;\n              }\n          } else {\n              size = this._viewSize - start - this.headerSize;\n              start += offset;\n          }\n          let result = this._axis.visible(start, start + size - 1);\n          if (this.frozen) {\n              result.offset = 0;\n          }\n          result.start = start;\n          if (this.hasHeader) {\n              result.offset += this.headerSize;\n              result.start -= this.headerSize;\n          }\n          return result;\n      }\n      contains(start, end) {\n          if (this.frozen) {\n              if (start > this._start + this._count) {\n                  return false;\n              }\n              if (end < this._start) {\n                  return false;\n              }\n              return true;\n          }\n          return end >= this._start;\n      }\n  }\n\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable camelcase */\n\n  class Rectangle {\n      constructor(left, top, width, height) {\n          this.left = left;\n          this.top = top;\n          this.width = width;\n          this.height = height;\n          this.right = this.left + this.width;\n          this.bottom = this.top + this.height;\n      }\n\n      offset(left, top) {\n          return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n      }\n\n      resize(width, height) {\n          return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n      }\n\n      intersects(x, y) {\n          if (x instanceof Rectangle) {\n              return this.intersectsRect(x);\n          }\n          return this.left < x && x < this.left + this.width &&\n                 this.top < y && y < this.top + this.height;\n      }\n\n      intersectsRect(b) {\n          let a = this;\n          return a.left <= b.right\n              && b.left <= a.right\n              && a.top <= b.bottom\n              && b.top <= a.bottom;\n      }\n\n      toDiv(className) {\n          return dom.element(\"div\", {\n              className: className,\n              style: {\n                  width: this.width + \"px\",\n                  height: this.height + \"px\",\n                  top: this.top + \"px\",\n                  left: this.left + \"px\"\n              }\n          });\n      }\n  }\n\n  class Grid {\n      constructor(rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n          this.rowCount = rowCount;\n          this.columnCount = columnCount;\n          this._columns = columns;\n          this._rows = rows;\n          this._headerHeight = headerHeight;\n          this._headerWidth = headerWidth;\n      }\n\n      _resize(new_rows, new_cols) {\n          this.rowCount = new_rows;\n          this.columnCount = new_cols;\n      }\n\n      isAxis(ref) {\n          ref = ref.toRangeRef();\n          let topLeft = ref.topLeft;\n          let bottomRight = ref.bottomRight;\n          return (topLeft.row === 0 && bottomRight.row === this.rowCount - 1) || (topLeft.col === 0 && bottomRight.col === this.columnCount - 1);\n      }\n\n      width(start, end) {\n          return this._columns.sum(start, end);\n      }\n\n      height(start, end) {\n          return this._rows.sum(start, end);\n      }\n\n      totalHeight() {\n          return this._rows.total + this._headerHeight;\n      }\n\n      totalWidth() {\n          return this._columns.total + this._headerWidth;\n      }\n\n      index(row, column) {\n          return column * this.rowCount + row;\n      }\n\n      cellRef(index) {\n          return new CellRef(index % this.rowCount, (index / this.rowCount) >> 0);\n      }\n\n      rowRef(row) {\n          return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n      }\n\n      colRef(col) {\n          return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n      }\n\n      cellRefIndex(ref) {\n          return this.index(ref.row, ref.col);\n      }\n\n      normalize(ref) {\n          if (ref instanceof RangeRef) {\n              return new RangeRef(\n                  this.normalize(ref.topLeft),\n                  this.normalize(ref.bottomRight)\n              ).setSheet(ref.sheet, ref.hasSheet());\n          }\n\n          if (ref instanceof UnionRef) {\n              return ref.map(function(ref) {\n                  return this.normalize(ref);\n              }, this);\n          }\n\n          if (ref instanceof CellRef) {\n              ref = ref.clone();\n              ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n              ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n          }\n\n          return ref;\n      }\n\n      rectangle(ref) {\n          let topLeft = this.normalize(ref.topLeft);\n          let bottomRight = this.normalize(ref.bottomRight);\n          return new Rectangle(\n              this.width(0, topLeft.col - 1),\n              this.height(0, topLeft.row - 1),\n              this.width(topLeft.col, bottomRight.col),\n              this.height(topLeft.row, bottomRight.row)\n          );\n      }\n\n      pane(options) {\n          return new PaneGrid(\n              new PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight),\n              new PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth),\n              this\n          );\n      }\n\n      rangeDimensions(rangeRef) {\n          return {\n              rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n              columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n          };\n      }\n\n      forEach(ref, callback) {\n          let topLeft = this.normalize(ref.topLeft);\n          let bottomRight = this.normalize(ref.bottomRight);\n\n          for (let ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n              for (let ri = topLeft.row; ri <= bottomRight.row; ri ++) {\n                  callback(new CellRef(ri, ci));\n              }\n          }\n      }\n\n      trim(ref, property) {\n          let topLeft = this.normalize(ref.topLeft);\n          let bottomRight = this.normalize(ref.bottomRight);\n          let bottomRightRow = topLeft.row;\n          let bottomRightCol = topLeft.col;\n\n          for (let ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n              let start = this.index(topLeft.row, ci);\n              let end = this.index(bottomRight.row, ci);\n              let values = property.tree.intersecting(start, end);\n              if (values.length) {\n                  let cell = this.cellRef(values[values.length - 1].end);\n                  bottomRightRow = Math.max(bottomRightRow, cell.row);\n                  bottomRightCol = ci;\n              }\n          }\n          return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n      }\n  }\n\n  class PaneGrid {\n      constructor(rows, columns, grid) {\n          this.rows = rows;\n          this.columns = columns;\n          this._grid = grid;\n\n          this.headerHeight = rows.headerSize;\n          this.headerWidth = columns.headerSize;\n          this.hasRowHeader = columns.hasHeader;\n          this.hasColumnHeader = rows.hasHeader;\n      }\n\n      refresh(width, height) {\n          this.columns.viewSize(width);\n          this.rows.viewSize(height);\n\n          let x = this.columns.paneSegment();\n          let y = this.rows.paneSegment();\n\n          this.left = x.offset;\n          this.top = y.offset;\n          this.right = x.offset + x.length;\n          this.bottom = y.offset + y.length;\n\n          this.style = {\n              top: y.offset + \"px\",\n              left: x.offset + \"px\",\n              height: y.length + \"px\",\n              width: x.length + \"px\"\n          };\n      }\n\n      view(left, top) {\n          let rows = this.rows.visible(top);\n          let columns = this.columns.visible(left);\n\n          return {\n              rows: rows,\n              columns: columns,\n\n              rowOffset: rows.offset,\n              columnOffset: columns.offset,\n\n              mergedCellLeft: columns.start,\n              mergedCellTop: rows.start,\n\n              ref: new RangeRef(\n                  new CellRef(rows.values.start, columns.values.start),\n                  new CellRef(rows.values.end, columns.values.end)\n              )\n          };\n      }\n\n      contains(ref) {\n          return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) &&\n              this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n      }\n\n      index(row, column) {\n          return this._grid.index(row, column);\n      }\n\n      boundingRectangle(ref) {\n          return this._grid.rectangle(ref);\n      }\n\n      cellRefIndex(ref) {\n          return this._grid.cellRefIndex(ref);\n      }\n\n      scrollBoundaries(cell) {\n          let position = this.boundingRectangle(cell);\n\n          let boundaries = {\n              top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n              left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n              right: position.right - this.columns._viewSize + this.headerWidth,\n              bottom: position.bottom - this.rows._viewSize + this.headerHeight\n          };\n\n          let widthCompensation = this.columns.defaultValue / 2;\n          let heightCompensation = this.rows.defaultValue / 2;\n\n          boundaries.scrollTop = boundaries.top - heightCompensation;\n          boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n\n          boundaries.scrollLeft = boundaries.left - widthCompensation;\n          boundaries.scrollRight = boundaries.right + widthCompensation;\n          return boundaries;\n      }\n  }\n\n  class Sorter {\n      constructor(grid, lists) {\n          this._grid = grid;\n          this._lists = lists;\n      }\n\n      indices(rangeRef, list, ascending, indices) {\n          let comparer = Sorter.ascendingComparer;\n\n          if (ascending === false) {\n              comparer = Sorter.descendingComparer;\n          }\n\n          return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft),\n                                    this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n      }\n\n      sortBy(ref, column, list, ascending, indices) {\n          let sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n\n          for (let ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n              let start = this._grid.index(ref.topLeft.row, ci);\n              let end = this._grid.index(ref.bottomRight.row, ci);\n\n              for (let li = 0; li < this._lists.length; li++) {\n                  if (start < this._lists[li].lastRangeStart()) {\n                      this._lists[li].sort(start, end, sortedIndices);\n                  }\n              }\n          }\n\n          return sortedIndices;\n      }\n  }\n\n  Sorter.ascendingComparer = function(a, b) {\n      if (a === null && b === null) {\n          return 0;\n      }\n\n      if (a === null) {\n          return 1;\n      }\n\n      if (b === null) {\n          return -1;\n      }\n\n      let typeA = typeof a;\n      let typeB = typeof b;\n\n      if (typeA === 'number') {\n          if (typeB === 'number') {\n              return a - b;\n          }\n          return -1;\n      }\n\n      if (typeA === 'string') {\n          switch (typeB) {\n          case 'number':\n              return 1;\n          case 'string':\n              return a.localeCompare(b);\n          default:\n              return -1;\n          }\n      }\n\n      if (typeA === 'boolean') {\n          switch (typeB) {\n          case 'number':\n              return 1;\n          case 'string':\n              return 1;\n          case 'boolean':\n              return a - b;\n          default:\n              return -1;\n          }\n      }\n\n      if (a instanceof CalcError) {\n          if (b instanceof CalcError) {\n              return 0;\n          }\n          return 1;\n      }\n\n      throw new Error('Cannot compare ' + a + ' and ' + b);\n  };\n\n  Sorter.descendingComparer = function(a, b) {\n      if (a === null && b === null) {\n          return 0;\n      }\n\n      if (a === null) {\n          return 1;\n      }\n\n      if (b === null) {\n          return -1;\n      }\n\n      return Sorter.ascendingComparer(b, a);\n  };\n\n  /* eslint-disable no-constant-condition */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-param-reassign */\n\n\n  class AxisManager {\n      constructor(sheet) {\n          this._sheet = sheet;\n      }\n\n      forEachSelectedColumn(callback) {\n          let sheet = this._sheet;\n\n          sheet.batch(function() {\n              sheet.select().forEachColumnIndex(function(index, i) {\n                  callback(sheet, index, i);\n              });\n          }, { layout: true, recalc: true });\n      }\n\n      forEachSelectedRow(callback) {\n          let sheet = this._sheet;\n\n          sheet.batch(function() {\n              sheet.select().forEachRowIndex(function(index, i) {\n                  callback(sheet, index, i);\n              });\n          }, { layout: true, recalc: true });\n      }\n\n      includesHiddenColumns(ref) {\n          return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n      }\n\n      includesHiddenRows(ref) {\n          return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n      }\n\n      selectionIncludesHiddenColumns() {\n          return this.includesHiddenColumns(this._sheet.select());\n      }\n\n      selectionIncludesHiddenRows() {\n          return this.includesHiddenRows(this._sheet.select());\n      }\n\n      deleteSelectedColumns() {\n          let indexes = [], delta = 0;\n          this.forEachSelectedColumn(function(sheet, index) {\n              index -= delta;\n              if (sheet.isHiddenColumn(index)) {\n                  return;\n              }\n              delta++;\n              let formulas = [];\n              indexes.unshift({\n                  index    : index,\n                  formulas : formulas,\n                  width    : sheet.columnWidth(index)\n              });\n              sheet._saveModifiedFormulas(formulas, function() {\n                  sheet.deleteColumn(index);\n              });\n          });\n          return indexes;\n      }\n\n      deleteSelectedRows() {\n          let indexes = [], delta = 0;\n          this.forEachSelectedRow(function(sheet, index) {\n              index -= delta;\n              if (sheet.isHiddenRow(index)) {\n                  return;\n              }\n              delta++;\n              let formulas = [];\n              indexes.unshift({\n                  index    : index,\n                  formulas : formulas,\n                  height   : sheet.rowHeight(index)\n              });\n              sheet._saveModifiedFormulas(formulas, function() {\n                  sheet.deleteRow(index);\n              });\n          });\n          return indexes;\n      }\n\n      hideSelectedColumns() {\n          this.forEachSelectedColumn(function(sheet, index) {\n              sheet.hideColumn(index);\n          });\n          let sheet = this._sheet;\n          let ref = sheet.select().toRangeRef();\n          let left = ref.topLeft.col;\n          let right = ref.bottomRight.col;\n          let sel = null;\n          while (true) {\n              let hasRight = right < sheet._columns._count;\n              let hasLeft = left >= 0;\n              if (!hasLeft && !hasRight) {\n                  break;\n              }\n              if (hasRight && !sheet.isHiddenColumn(right)) {\n                  sel = right;\n                  break;\n              }\n              if (hasLeft && !sheet.isHiddenColumn(left)) {\n                  sel = left;\n                  break;\n              }\n              left--;\n              right++;\n          }\n          if (sel !== null) {\n              ref = new RangeRef(\n                  new CellRef(0, sel),\n                  new CellRef(sheet._rows._count - 1, sel)\n              );\n              sheet.range(ref).select();\n          }\n      }\n\n      hideSelectedRows() {\n          this.forEachSelectedRow(function(sheet, index) {\n              sheet.hideRow(index);\n          });\n          let sheet = this._sheet;\n          let ref = sheet.select().toRangeRef();\n          let top = ref.topLeft.row;\n          let bottom = ref.bottomRight.row;\n          let sel = null;\n          while (true) {\n              let hasBottom = bottom < sheet._rows._count;\n              let hasTop = top >= 0;\n              if (!hasTop && !hasBottom) {\n                  break;\n              }\n              if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                  sel = bottom;\n                  break;\n              }\n              if (hasTop && !sheet.isHiddenRow(top)) {\n                  sel = top;\n                  break;\n              }\n              top--;\n              bottom++;\n          }\n          if (sel !== null) {\n              ref = new RangeRef(\n                  new CellRef(sel, 0),\n                  new CellRef(sel, sheet._columns._count - 1)\n              );\n              sheet.range(ref).select();\n          }\n      }\n\n      unhideSelectedColumns() {\n          this.forEachSelectedColumn(function(sheet, index) {\n              sheet.unhideColumn(index);\n          });\n      }\n\n      unhideSelectedRows() {\n          this.forEachSelectedRow(function(sheet, index) {\n              sheet.unhideRow(index);\n          });\n      }\n\n      addColumnLeft() {\n          let sheet = this._sheet;\n          let base, count = 0;\n          sheet.batch(function() {\n              sheet.select().forEachColumnIndex(function(index) {\n                  if (!base) {\n                      base = index;\n                  }\n                  sheet.insertColumn(base);\n                  ++count;\n              });\n          }, { recalc: true, layout: true });\n          return { base: base, count: count };\n      }\n\n      addColumnRight() {\n          let sheet = this._sheet;\n          let base, count = 0;\n          sheet.batch(function() {\n              sheet.select().forEachColumnIndex(function(index) {\n                  base = index + 1;\n                  ++count;\n              });\n              for (let i = 0; i < count; ++i) {\n                  sheet.insertColumn(base);\n              }\n          }, { recalc: true, layout: true });\n          return { base: base, count: count };\n      }\n\n      addRowAbove() {\n          let sheet = this._sheet;\n          let base, count = 0;\n          let selectedRows = sheet.select();\n\n          sheet.batch(function() {\n              selectedRows.forEachRowIndex(function(index) {\n                  if (!base) {\n                      base = index;\n                  }\n                  sheet.insertRow(base);\n                  ++count;\n              });\n          }, { recalc: true, layout: true });\n\n          return { base: base, count: count };\n      }\n\n      addRowBelow() {\n          let sheet = this._sheet;\n          let base, count = 0;\n\n          sheet.batch(function() {\n              sheet.select().forEachRowIndex(function(index) {\n                  base = index + 1;\n                  ++count;\n              });\n              for (let i = 0; i < count; ++i) {\n                  sheet.insertRow(base);\n              }\n          }, { recalc: true, layout: true });\n\n          return { base: base, count: count };\n      }\n  }\n\n  /* eslint-disable no-param-reassign */\n\n  class AutoFillCalculator {\n      constructor(grid) {\n          this._grid = grid;\n      }\n\n      rectIsVertical(start, end, x, y) {\n          let startRect = this._grid.rectangle(start.toRangeRef());\n          let endRect = this._grid.rectangle(end.toRangeRef());\n          return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n      }\n\n      autoFillDest(selection, cursor) {\n          let topLeft = selection.topLeft;\n          let bottomRight = selection.bottomRight;\n\n          let quadrant;\n          let lower = cursor.row >= topLeft.row;\n          let further = cursor.col >= topLeft.col;\n\n          if (lower) {\n              quadrant = further ? 4 : 3;\n          } else {\n              quadrant = further ? 2 : 1;\n          }\n\n          let pivot, opposite, cornerResult, expanding;\n\n          if (quadrant === 4) {\n              pivot = topLeft;\n              opposite = bottomRight;\n\n              expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n\n              if (expanding) {\n                  cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n              }\n\n              if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) { // vertical\n                  cornerResult = new CellRef(cursor.row, opposite.col);\n              } else {\n                  cornerResult = new CellRef(opposite.row, cursor.col);\n              }\n          } else if (quadrant === 3) {\n              let bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n\n              if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) { // vertical\n                  pivot = topLeft;\n                  cornerResult = new CellRef(cursor.row, bottomRight.col);\n              } else {\n                  pivot = bottomRight;\n                  cornerResult = new CellRef(topLeft.row, cursor.col);\n              }\n          } else if (quadrant === 2) {\n              let topRight = new CellRef(topLeft.row, bottomRight.col);\n\n              if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) { // horizontal\n                  pivot = topLeft;\n                  cornerResult = new CellRef(bottomRight.row, cursor.col);\n              } else {\n                  pivot = bottomRight;\n                  cornerResult = new CellRef(cursor.row, topLeft.col);\n              }\n          } else {\n              pivot = bottomRight;\n              if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) { // horizontal\n                  cornerResult = new CellRef(cursor.row, topLeft.col);\n              } else {\n                  cornerResult = new CellRef(topLeft.row, cursor.col);\n              }\n          }\n\n          return this._grid.normalize(new RangeRef(pivot, cornerResult));\n      }\n  }\n\n  /* eslint-disable max-params */\n  /* eslint-disable no-empty */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable consistent-return */\n  /* eslint-disable block-scoped-var */\n  /* eslint-disable no-redeclare */\n  /* eslint-disable no-var */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable complexity */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable brace-style */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-else-return */\n  /* eslint-disable default-case */\n  /* eslint-disable no-param-reassign */\n\n\n  class EdgeNavigator {\n      constructor(field, axis, rangeGetter, union) {\n          this.rangeGetter = rangeGetter;\n\n          this.prevLeft = function(index) {\n              var current = union(this.range(index));\n              var range = this.range(axis.prevVisible(current.topLeft[field]));\n              return union(range).topLeft[field];\n          };\n\n          this.nextRight = function(index) {\n              var current = union(this.range(index));\n              var range = this.range(axis.nextVisible(current.bottomRight[field]));\n              return union(range).bottomRight[field];\n          };\n\n          // these two don't look like the other ones, as they \"shrink\"\n          this.nextLeft = function(index) {\n              var range = union(this.range(index));\n              return axis.nextVisible(range.bottomRight[field]);\n          };\n\n          this.prevRight = function(index) {\n              var range = union(this.range(index));\n              return axis.prevVisible(range.topLeft[field]);\n          };\n      }\n\n      boundary(top, bottom) {\n          this.top = top;\n          this.bottom = bottom;\n      }\n\n      range(index) {\n          return this.rangeGetter(index, this.top, this.bottom);\n      }\n  }\n\n  class SheetNavigator {\n      constructor(sheet) {\n          this._sheet = sheet;\n          this.autoFillCalculator = new AutoFillCalculator(sheet._grid);\n\n          this.colEdge = new EdgeNavigator(\"col\", this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n          this.rowEdge = new EdgeNavigator(\"row\", this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n      }\n\n      height(height) {\n          this._viewPortHeight = height;\n      }\n\n      union(ref) {\n          return this._sheet.unionWithMerged(ref);\n      }\n\n      columnRange(col, topRow, bottomRow) {\n          return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n      }\n\n      rowRange(row, leftCol, rightCol) {\n          return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n      }\n\n      selectionIncludesMergedCells() {\n          return this._sheet.select().contains(this._sheet._mergedCells);\n      }\n\n      setSelectionValue(value) {\n          var selection = this._sheet.selection();\n\n          setTimeout(function() {\n              selection.value(value());\n          });\n      }\n\n      selectAll() {\n          this._sheet.select(this._sheet._sheetRef);\n      }\n\n      select(ref, mode, addToExisting) {\n          ref = this.refForMode(ref, mode);\n\n          if (addToExisting) {\n              ref = this._sheet.select().concat(ref);\n          }\n\n          this._sheet.select(ref);\n      }\n\n      refForMode(ref, mode) {\n          var grid = this._sheet._grid;\n\n          switch (mode) {\n          case \"range\":\n              ref = grid.normalize(ref);\n              break;\n          case \"row\":\n              ref = grid.rowRef(ref.row);\n              break;\n          case \"column\":\n              ref = grid.colRef(ref.col);\n              break;\n          case \"sheet\":\n              ref = this._sheet._sheetRef;\n              break;\n          }\n\n          return ref;\n      }\n\n      startSelection(ref, mode, addToExisting, shiftKey, view) {\n          if (mode === \"autofill\") {\n              this._sheet.startAutoFill();\n          } else if (shiftKey && mode === \"range\") {\n              var range = new RangeRef(this._sheet.activeCell().first(), ref);\n              this._sheet.select(range, false, false);\n              this._sheet.startSelection(view);\n          } else {\n              this._sheet.startSelection(view);\n              this.select(ref, mode, addToExisting);\n          }\n      }\n\n      completeSelection() {\n          this._sheet.completeSelection();\n      }\n\n      selectForContextMenu(ref, mode) {\n          var sheet = this._sheet;\n          sheet._activeDrawing = null;\n          if (!sheet.select().contains(this.refForMode(ref, mode))) {\n              this.select(ref, mode);\n          }\n      }\n\n      selectDrawingForContextMenu(drawing) {\n          var sheet = this._sheet;\n          sheet._activeDrawing = drawing;\n          sheet.triggerChange({ selection: true });\n      }\n\n      modifySelection(action) {\n          var direction = this.determineDirection(action);\n\n          var sheet = this._sheet;\n          var viewPortHeight = this._viewPortHeight;\n          var rows = sheet._grid._rows;\n          var columns = sheet._grid._columns;\n\n          var originalSelection = sheet.currentOriginalSelectionRange();\n          var selection = sheet.select().toRangeRef();\n          var activeCell = sheet.activeCell();\n\n          var topLeft = originalSelection.topLeft.clone();\n          var bottomRight = originalSelection.bottomRight.clone();\n          var bottomLeft = new CellRef(bottomRight.row, topLeft.col);\n\n          var scrollInto;\n\n          this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n          this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n\n          switch (direction) {\n          case \"expand-left\": // <| |\n              topLeft.col = this.colEdge.prevLeft(topLeft.col);\n              scrollInto = topLeft;\n              break;\n          case \"shrink-right\": // |>|\n              topLeft.col = this.colEdge.nextLeft(topLeft.col);\n              scrollInto = topLeft;\n              break;\n          case \"expand-right\": // | |>\n              bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n              scrollInto = bottomRight;\n              break;\n          case \"shrink-left\": // |<|\n              bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n              scrollInto = bottomRight;\n              break;\n\n              // four actions below mirror the upper ones, on the vertical axis\n          case \"expand-up\":\n              topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n              scrollInto = topLeft;\n              break;\n          case \"shrink-down\":\n              topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n              scrollInto = topLeft;\n              break;\n          case \"expand-down\":\n              bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n              scrollInto = bottomRight;\n              break;\n          case \"shrink-up\":\n              bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n              scrollInto = bottomRight;\n              break;\n\n              // pageup/down - may need improvement\n          case \"expand-page-up\":\n              topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n              break;\n          case \"shrink-page-up\":\n              bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n              break;\n          case \"expand-page-down\":\n              bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n              break;\n          case \"shrink-page-down\":\n              topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n              break;\n\n          case \"first-col\":\n              topLeft.col = columns.firstVisible();\n              bottomRight.col = activeCell.bottomRight.col;\n              scrollInto = topLeft;\n              break;\n          case \"last-col\":\n              bottomRight.col = columns.lastVisible();\n              topLeft.col = activeCell.topLeft.col;\n              scrollInto = bottomRight;\n              break;\n          case \"first-row\":\n              topLeft.row = rows.firstVisible();\n              bottomRight.row = activeCell.bottomRight.row;\n              scrollInto = topLeft;\n              break;\n          case \"last-row\":\n              bottomRight.row = rows.lastVisible();\n              topLeft.row = activeCell.topLeft.row;\n              scrollInto = bottomRight;\n              break;\n          case \"last\":\n              bottomRight.row = rows.lastVisible();\n              bottomRight.col = columns.lastVisible();\n              topLeft = activeCell.topLeft;\n              scrollInto = bottomRight;\n              break;\n          case \"first\":\n              topLeft.row = rows.firstVisible();\n              topLeft.col = columns.firstVisible();\n              bottomRight = activeCell.bottomRight;\n              scrollInto = topLeft;\n              break;\n\n          case \"expand-word-right\":\n              bottomRight.col = columns.nextUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n              scrollInto = bottomRight;\n              break;\n          case \"shrink-word-right\":\n              topLeft.col = columns.nextUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n              scrollInto = topLeft;\n              break;\n          case \"expand-word-left\":\n              topLeft.col = columns.prevUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n              scrollInto = topLeft;\n              break;\n          case \"shrink-word-left\":\n              bottomRight.col = columns.prevUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n              scrollInto = bottomRight;\n              break;\n          case \"expand-word-up\":\n              topLeft.row = rows.prevUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n              scrollInto = topLeft;\n              break;\n          case \"shrink-word-up\":\n              bottomRight.row = rows.prevUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n              scrollInto = bottomRight;\n              break;\n          case \"expand-word-down\":\n              bottomRight.row = rows.nextUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n              scrollInto = bottomRight;\n              break;\n          case \"shrink-word-down\":\n              topLeft.row = rows.nextUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n              scrollInto = topLeft;\n              break;\n          }\n\n          var newSelection = new RangeRef(topLeft, bottomRight);\n\n          if (!this.union(newSelection).intersects(activeCell)) {\n              // throw new Error(newSelection.print() + \" does not contain \" + activeCell.print());\n              this.modifySelection(direction.replace(\"shrink\", \"expand\"));\n              return;\n          }\n\n          if (scrollInto) {\n              sheet.focus(scrollInto);\n          }\n\n          this.updateCurrentSelectionRange(newSelection);\n      }\n\n      moveActiveCell(direction) {\n          var sheet = this._sheet;\n          var activeCell = sheet.activeCell();\n          var topLeft = activeCell.topLeft;\n          var bottomRight = activeCell.bottomRight;\n\n          var cell = sheet.originalActiveCell();\n          var rows = sheet._grid._rows;\n          var columns = sheet._grid._columns;\n\n          var row = cell.row;\n          var column = cell.col;\n\n          switch (direction) {\n          case \"left\":\n              column = columns.prevVisible(topLeft.col);\n              break;\n          case \"up\":\n              row = rows.prevVisible(topLeft.row);\n              break;\n          case \"right\":\n              column = columns.nextVisible(bottomRight.col);\n              break;\n          case \"down\":\n              row = rows.nextVisible(bottomRight.row);\n              break;\n          case \"first-col\":\n              column = columns.firstVisible();\n              break;\n          case \"last-col\":\n              column = columns.lastVisible();\n              break;\n          case \"first-row\":\n              row = rows.firstVisible();\n              break;\n          case \"last-row\":\n              row = rows.lastVisible();\n              break;\n          case \"last\":\n              row = rows.lastVisible();\n              column = columns.lastVisible();\n              break;\n          case \"first\":\n              row = rows.firstVisible();\n              column = columns.firstVisible();\n              break;\n          case \"next-page\":\n              row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n              break;\n          case \"prev-page\":\n              row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n              break;\n\n          case \"word-right\":\n              column = columns.nextUntil(column, makeWordMovement(sheet, bottomRight, true));\n              break;\n          case \"word-left\":\n              column = columns.prevUntil(column, makeWordMovement(sheet, bottomRight, true));\n              break;\n          case \"word-up\":\n              row = rows.prevUntil(row, makeWordMovement(sheet, bottomRight, false));\n              break;\n          case \"word-down\":\n              row = rows.nextUntil(row, makeWordMovement(sheet, bottomRight, false));\n              break;\n          }\n\n          sheet.select(new CellRef(row, column));\n      }\n\n      navigateInSelection(direction) {\n          var sheet = this._sheet;\n          var activeCell = sheet.activeCell();\n          var topLeft = activeCell.topLeft;\n\n          var cell = sheet.originalActiveCell();\n          var rows = sheet._grid._rows;\n          var columns = sheet._grid._columns;\n\n          var row = cell.row;\n          var column = cell.col;\n\n          var isFirstCell = false;\n          var isLastCell = false;\n\n          var selTopLeft, selBottomRight;\n\n          var topLeftCol = topLeft.col;\n          var topLeftRow = topLeft.row;\n          var tmp;\n\n          function setSelection(sel) {\n              selTopLeft = sel.topLeft;\n              selBottomRight = sel.bottomRight;\n          }\n\n          setSelection(sheet.currentNavigationRange());\n\n          var done = false;\n          var navigatedAway = false;\n\n          while (!done && !navigatedAway) {\n              var current = new CellRef(row, column);\n              var isSingleCellSelected = sheet.singleCellSelection();\n\n              if (isSingleCellSelected) {\n                  isFirstCell = selTopLeft.eq(current) && sheet._sheetRef.topLeft.eq(current);\n                  isLastCell = selBottomRight.eq(current) && sheet._sheetRef.bottomRight.eq(current);\n\n                  if (!isFirstCell) {\n                      isFirstCell = columns.firstVisible() === column && rows.firstVisible() === row;\n                  }\n\n                  if (!isLastCell) {\n                      isLastCell = columns.lastVisible() === column && rows.lastVisible() === row;\n                  }\n              }\n\n              switch (direction) {\n              case \"next\":\n                  if (isLastCell) {\n                      navigatedAway = true;\n                  } else if (selBottomRight.eq(current)) {\n                      setSelection(sheet.nextNavigationRange());\n                      row = selTopLeft.row;\n                      column = selTopLeft.col;\n                  } else {\n                      column = columns.nextVisible(topLeftCol);\n                      if (column === topLeftCol || column > selBottomRight.col) {\n                          column = selTopLeft.col;\n                          tmp = rows.nextVisible(row);\n                          if (tmp === row || tmp > selBottomRight.row) {\n                              row = selTopLeft.row;\n                          } else {\n                              row = tmp;\n                          }\n                      }\n                  }\n                  break;\n              case \"previous\":\n                  if (isFirstCell) {\n                      navigatedAway = true;\n                      this._sheet._workbook._view.element.querySelector('.k-spreadsheet-name-editor .k-input-inner').focus();\n                  } else if (selTopLeft.eq(current)) {\n                      setSelection(sheet.previousNavigationRange());\n                      row = selBottomRight.row;\n                      column = selBottomRight.col;\n                  } else {\n                      column = columns.prevVisible(topLeftCol);\n                      if (column === topLeftCol || column < selTopLeft.col) {\n                          column = selBottomRight.col;\n                          tmp = rows.prevVisible(row);\n                          if (tmp === row || tmp < selTopLeft.row) {\n                              row = selBottomRight.row;\n                          } else {\n                              row = tmp;\n                          }\n                      }\n                  }\n                  break;\n              case \"lower\":\n                  if (selBottomRight.eq(current)) {\n                      setSelection(sheet.nextNavigationRange());\n                      row = selTopLeft.row;\n                      column = selTopLeft.col;\n                  } else {\n                      row = rows.nextVisible(topLeftRow);\n                      if (row === topLeftRow || row > selBottomRight.row) {\n                          row = selTopLeft.row;\n                          tmp = columns.nextVisible(column);\n                          if (tmp === column || tmp > selBottomRight.col) {\n                              column = selTopLeft.col;\n                          } else {\n                              column = tmp;\n                          }\n                      }\n                  }\n                  break;\n              case \"upper\":\n                  if (selTopLeft.eq(current)) {\n                      setSelection(sheet.previousNavigationRange());\n                      row = selBottomRight.row;\n                      column = selBottomRight.col;\n                  } else {\n                      row = rows.prevVisible(topLeftRow);\n                      if (row === topLeftRow || row < selTopLeft.row) {\n                          row = selBottomRight.row;\n                          tmp = columns.prevVisible(column);\n                          if (tmp === column || tmp < selTopLeft.col) {\n                              column = selBottomRight.col;\n                          } else {\n                              column = tmp;\n                          }\n                      }\n                  }\n                  break;\n              default:\n                  throw new Error(\"Unknown entry navigation: \" + direction);\n              }\n\n              done = !this.shouldSkip(row, column);\n              // if (!done) { console.log(\"skipping\", row, column); }\n              topLeftCol = column;\n              topLeftRow = row;\n          }\n\n          if (done) {\n              if (sheet.singleCellSelection()) {\n                  sheet.select(new CellRef(row, column));\n              } else {\n                  sheet.activeCell(new CellRef(row, column));\n              }\n          }\n      }\n\n      extendSelection(ref, mode) {\n          var sheet = this._sheet;\n          var grid = sheet._grid;\n\n          if (mode === \"autofill\") {\n              this.resizeAutoFill(ref);\n              return;\n          }\n          if (mode === \"range\") {\n              ref = grid.normalize(ref);\n          }\n          else if (mode === \"row\") {\n              ref = grid.rowRef(ref.row).bottomRight;\n          } else if (mode === \"column\") {\n              ref = grid.colRef(ref.col).bottomRight;\n          }\n\n          var activeCell = sheet.originalActiveCell().toRangeRef();\n\n          this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n      }\n\n      shouldSkip(row, col) {\n          if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n              return true;\n          }\n          var ref = new CellRef(row, col);\n          var isMerged = false;\n          this._sheet.forEachMergedCell(function(merged) {\n              if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                  isMerged = true;\n              }\n          });\n\n          return isMerged;\n      }\n\n      resizeAutoFill(ref) {\n          var sheet = this._sheet;\n          var selection = sheet.select();\n          var origin = sheet._autoFillOrigin;\n          var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n\n          var punch = this.punch(selection, dest);\n          var hint, direction;\n\n          if (!punch) {\n              var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n              if (preview) {\n                  direction = preview.direction;\n                  hint = preview.hint;\n              }\n          }\n\n          sheet.updateAutoFill(dest, punch, hint, direction);\n      }\n\n      determineDirection(action) {\n          var selection = this._sheet.currentSelectionRange();\n          var activeCell = this._sheet.activeCell();\n\n          // There may be a third, indeterminate state, caused by a merged cell.\n          // In this state, all key movements are treated as shrinks.\n          // The navigator will reverse them if it detects this it will cause the selection to exclude the active cell.\n          var leftMode = activeCell.topLeft.col === selection.topLeft.col;\n          var rightMode = activeCell.bottomRight.col === selection.bottomRight.col;\n          var topMode = activeCell.topLeft.row === selection.topLeft.row;\n          var bottomMode = activeCell.bottomRight.row === selection.bottomRight.row;\n\n          switch (action) {\n          case \"left\":\n              action = rightMode ? \"expand-left\" : \"shrink-left\";\n              break;\n          case \"right\":\n              action = leftMode ? \"expand-right\" : \"shrink-right\";\n              break;\n          case \"up\":\n              action = bottomMode ? \"expand-up\" : \"shrink-up\";\n              break;\n          case \"down\":\n              action = topMode ? \"expand-down\" : \"shrink-down\";\n              break;\n          case \"prev-page\":\n              action = bottomMode ? \"expand-page-up\" : \"shrink-page-up\";\n              break;\n          case \"next-page\":\n              action = topMode ? \"expand-page-down\" : \"shrink-page-down\";\n              break;\n          case \"word-left\":\n              action = rightMode ? \"expand-word-left\" : \"shrink-word-left\";\n              break;\n          case \"word-right\":\n              action = leftMode ? \"expand-word-right\" : \"shrink-word-right\";\n              break;\n          case \"word-up\":\n              action = bottomMode ? \"expand-word-up\" : \"shrink-word-up\";\n              break;\n          case \"word-down\":\n              action = topMode ? \"expand-word-down\" : \"shrink-word-down\";\n              break;\n          }\n\n          return action;\n      }\n\n      updateCurrentSelectionRange(ref) {\n          var sheet = this._sheet;\n          sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n      }\n\n      punch(selection, subset) {\n          var punch;\n          if (subset.topLeft.eq(selection.topLeft)) {\n              if (subset.bottomRight.row < selection.bottomRight.row) {\n                  var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n\n                  punch = new RangeRef(\n                      new CellRef(bottomRow, selection.topLeft.col),\n                      selection.bottomRight\n                  );\n              } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                  var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n\n                  punch = new RangeRef(\n                      new CellRef(selection.topLeft.row, bottomCol),\n                      selection.bottomRight\n                  );\n              }\n          }\n\n          return punch;\n      }\n  }\n\n  function makeWordMovement(sheet, pivot, isCol) {\n      // the general idea is:\n      //\n      // - if we start on a non-empty cell, we should select the\n      //   range of non-empty cells that follow it.  If, however,\n      //   the second cell is empty, then we don't stop there; we\n      //   should skip all the empty cells and stop at the first\n      //   non-empty cell (and select it).\n      //\n      // - if we start on an empty cell, then skip all empty cells\n      //   and select the first non-empty one.\n\n      var firstVal = sheet.range(pivot).value();\n      return function(pos, advanced, hidden) {\n          if (hidden) { return true; }   // skip hidden cells\n          var val = ( isCol ?\n                      sheet.range(pivot.row, pos) :\n                      sheet.range(pos, pivot.col) ).value();\n          if (firstVal === null) {\n              return val === null ? false : pos;\n          } else if (!advanced && val === null) {\n              firstVal = null; // switch to the other mode\n              return false;\n          } else {\n              return val === null;\n          }\n      };\n  }\n\n  /* eslint-disable max-params */\n  /* eslint-disable no-empty */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable consistent-return */\n  /* eslint-disable block-scoped-var */\n  /* eslint-disable no-redeclare */\n  /* eslint-disable no-var */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable complexity */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable brace-style */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-else-return */\n  /* eslint-disable default-case */\n  /* eslint-disable no-param-reassign */\n\n\n  function numberToDate(val) {\n      return val == null ? null : calc.runtime.serialToDate(val);\n  }\n\n  function dateToNumber(val) {\n      return val == null ? null : calc.runtime.dateToSerial(val);\n  }\n\n  var identity = function (o) { return o; };\n\n  class SheetDataSourceBinder {\n      constructor(options) {\n          this.options = Object.assign({ columns: [] }, this.options,\n              // skip undefined properties in options\n              Object.keys(options).reduce((acc, key) => {\n                  if (options[key] !== undefined) acc[key] = options[key];\n                  return acc;\n              }, {})\n          );\n\n          this.columns = this._normalizeColumns(this.options.columns);\n\n          this._sheet();\n          this._dataSource();\n\n          this._header();\n\n          this._boundRowsCount = 0;\n\n          this.dataSource.fetch();\n      }\n\n      _sheet() {\n          this.sheet = this.options.sheet;\n\n          this._sheetChangeHandler = this._sheetChange.bind(this);\n          this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n          this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n\n          this.sheet.bind(\"change\", this._sheetChangeHandler)\n              .bind(\"afterDeleteRow\", this._sheetDeleteRowHandler)\n              .bind(\"afterInsertRow\", this._sheetInsertRowHandler);\n      }\n\n      _sheetInsertRow(e) {\n          if (e.index !== undefined) {\n              this.dataSource.insert(Math.max(e.index - 1, 0), {});\n          }\n      }\n\n      _sheetDeleteRow(e) {\n          if (e.index !== undefined) {\n              var dataSource = this.dataSource;\n              var model = dataSource.view()[e.index - 1];\n\n              if (model) {\n                  dataSource.remove(model);\n              }\n          }\n      }\n\n      _header() {\n          this.sheet.batch(function () {\n              this.columns.forEach(function (column, index) {\n                  this.sheet.range(0, index).value(column.title);\n              }.bind(this));\n          }.bind(this));\n      }\n\n      _sheetChange(e) {\n          if (e.insertRow || e.deleteRow) {\n              // these actions are handled via custom events\n              return;\n          }\n\n          if (e.recalc && e.ref && e.isValue) {\n              var dataSource = this.dataSource;\n              var data = dataSource.view();\n              var columns = this.columns;\n              var values = [];\n              var sheet = this.sheet;\n              var fields, getters, normalizedRef, i, rangeRef, normalizedRefs;\n              var setValues = function (ref) {\n                  ref = ref.toRangeRef();\n                  var record;\n                  var valueIndex = 0;\n                  for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                      record = data[ri - 1]; // skip header row\n\n                      if (!record) {\n                          record = dataSource.insert(ri - 1, {});\n                          data = dataSource.view();\n                      }\n\n                      var colValueIndex = 0;\n                      for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                          var currentValue = values[i][valueIndex][colValueIndex++];\n                          record.set(columns[ci].field, getters[ci](currentValue));\n                      }\n                      valueIndex++;\n                  }\n              };\n\n              if (dataSource.reader.model) {\n                  fields = dataSource.reader.model.fields;\n              }\n\n              if (!columns.length && data.length) {\n                  columns = Object.keys(data[0].toJSON());\n              }\n\n              getters = columns.map(function (column) {\n                  var field = column.field;\n                  if (field && fields && fields[field] && fields[field].type === \"date\") {\n                      return numberToDate;\n                  }\n                  return identity;\n              });\n\n              this._skipRebind = true;\n              normalizedRef = sheet._grid.normalize(e.ref);\n\n              if (!(normalizedRef instanceof UnionRef)) {\n                  normalizedRef = new UnionRef([normalizedRef]);\n              }\n\n              normalizedRefs = normalizedRef.refs;\n\n              normalizedRefs.forEach(function (ref) {\n                  values.push(sheet.range(ref).values());\n              });\n\n              for (i = 0; i < normalizedRefs.length; i++) {\n                  rangeRef = normalizedRefs[i];\n                  rangeRef.forEach(setValues);\n              }\n\n              this._boundRowsCount = dataSource.view().length;\n\n              this._skipRebind = false;\n          }\n      }\n\n      _normalizeColumns(columns) {\n          return columns.map(function (column) {\n              var field = column.field || column;\n              return {\n                  field: field,\n                  title: column.title || field\n              };\n          });\n      }\n\n      _dataSource() {\n          var options = this.options;\n          var dataSource = options.dataSource;\n\n          dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n\n          if (this.dataSource && this._changeHandler) {\n              this.dataSource.unbind(\"change\", this._changeHandler)\n                  .unbind(\"progress\", this._progressHandler)\n                  .unbind(\"error\", this._errorHandler);\n          } else {\n              this._changeHandler = this._change.bind(this);\n              this._progressHandler = this._requestStart.bind(this);\n              this._errorHandler = this._error.bind(this);\n          }\n\n          this.dataSource = this.options.sheet.createSheetDataSource?.(dataSource)\n              .bind(\"change\", this._changeHandler)\n              .bind(\"progress\", this._progressHandler)\n              .bind(\"error\", this._errorHandler);\n      }\n\n      _error() {\n          this._progress(false);\n      }\n\n      _requestStart() {\n          this._progress(true);\n      }\n\n      _progress(toggle) {\n          this.sheet.trigger(\"progress\", {\n              toggle: toggle\n          });\n      }\n\n      _change() {\n          if (this._skipRebind) {\n              return;\n          }\n\n          if (this.sheet.trigger(\"dataBinding\")) {\n              return;\n          }\n\n          var data = this.dataSource.view();\n          var columns = this.columns;\n\n          if (!columns.length && data.length) {\n              this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n              this._header();\n          }\n\n          var getters = columns.map(function (column) {\n              return getter(column.field);\n          });\n\n          this.sheet.batch(function () {\n              var length = Math.max(data.length, this._boundRowsCount, this.sheet._grid.rowCount - 1);\n\n              for (var idx = 0; idx < length; idx++) {\n                  for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                      var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n\n                      //skip header row\n                      this.sheet.range(idx + 1, getterIdx).value(value);\n                  }\n              }\n          }.bind(this));\n\n          this._boundRowsCount = data.length;\n\n          this._progress(false);\n          this.sheet.trigger(\"dataBound\");\n      }\n\n      destroy() {\n          this.dataSource.unbind(\"change\", this._changeHandler)\n              .unbind(\"progress\", this._progressHandler)\n              .unbind(\"error\", this._errorHandler);\n\n          this.sheet.unbind(\"change\", this._sheetChangeHandler)\n              .unbind(\"deleteRow\", this._sheetDeleteRowHandler)\n              .unbind(\"insertRow\", this._sheetInsertRowHandler);\n      }\n  }\n\n  const kendoDate = (function() {\n      function today() {\n          return kendo_dateMath_cmn_chunk_js.g(new Date());\n      }\n\n      function isToday(date) {\n          return kendo_dateMath_cmn_chunk_js.g(date).getTime() === today().getTime();\n      }\n\n      return {\n          dayOfWeek: kendo_dateMath_cmn_chunk_js.d,\n          getDate: kendo_dateMath_cmn_chunk_js.g,\n          isToday: isToday,\n          addDays: kendo_dateMath_cmn_chunk_js.e,\n          today: today,\n          firstDayOfMonth: kendo_dateMath_cmn_chunk_js.f\n      };\n  })();\n\n  /* eslint-disable no-var */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable no-loop-func */\n\n\n  const logic = {\n      or: {\n          concat: (acc, fn) => (a) => acc(a) || fn(a),\n          identity: () => false,\n      },\n      and: {\n          concat: (acc, fn) => (a) => acc(a) && fn(a),\n          identity: () => true,\n      },\n  };\n\n  const operatorsMap = {\n      contains: (a, b) => (a || \"\").indexOf(b) >= 0,\n      doesnotcontain: (a, b) => (a || \"\").indexOf(b) === -1,\n      doesnotendwith: (a, b) =>\n          (a || \"\").indexOf(b, (a || \"\").length - (b || \"\").length) < 0,\n      doesnotstartwith: (a, b) => (a || \"\").lastIndexOf(b, 0) === -1,\n      endswith: (a, b) =>\n          (a || \"\").indexOf(b, (a || \"\").length - (b || \"\").length) >= 0,\n      eq: (a, b) => a === b,\n      gt: (a, b) => a > b,\n      gte: (a, b) => a >= b,\n      isempty: (a) => a === \"\",\n      isnotempty: (a) => a !== \"\",\n      isnotnull: (a) => isPresent(a),\n      isnull: (a) => isBlank(a),\n      lt: (a, b) => a < b,\n      lte: (a, b) => a <= b,\n      neq: (a, b) => a != b, // tslint:disable-line:triple-equals\n      startswith: (a, b) => (a || \"\").lastIndexOf(b, 0) === 0,\n  };\n\n  const dateRegExp = /^\\/Date\\((.*?)\\)\\/$/;\n\n  const convertValue = (value, ignoreCase, accentFoldingFiltering) => {\n      if (value != null && isString(value)) {\n          const date = dateRegExp.exec(value);\n          if (date) {\n              return new Date(+date[1]).getTime();\n          } else if (ignoreCase) {\n              return accentFoldingFiltering\n                  ? value.toLocaleLowerCase(accentFoldingFiltering)\n                  : value.toLowerCase();\n          }\n      } else if (value != null && isDate(value)) {\n          return value.getTime();\n      }\n      return value;\n  };\n\n  const transformFilter = ({\n      field,\n      ignoreCase,\n      value,\n      operator,\n      accentFoldingFiltering,\n  }) => {\n      field = !isPresent(field) ? (a) => a : field;\n\n      ignoreCase = isPresent(ignoreCase) ? ignoreCase : true;\n\n      const itemProp = typedGetter(\n          isFunction(field) ? field : getter(field, true),\n          value,\n          ignoreCase,\n          accentFoldingFiltering\n      );\n\n      value = convertValue(value, ignoreCase, accentFoldingFiltering);\n\n      const op = isFunction(operator) ? operator : operatorsMap[operator];\n\n      return (a) => op(itemProp(a), value, ignoreCase);\n  };\n\n  const typedGetter = (prop, value, ignoreCase, accentFoldingFiltering) => {\n      if (!isPresent(value)) {\n          return prop;\n      }\n\n      let acc = prop;\n\n      if (isString(value)) {\n          const date = dateRegExp.exec(value);\n          if (date) {\n              value = new Date(+date[1]);\n          } else {\n              acc = (a) => {\n                  const x = prop(a);\n                  if (typeof x === \"string\" && ignoreCase) {\n                      return accentFoldingFiltering\n                          ? x.toLocaleLowerCase(accentFoldingFiltering)\n                          : x.toLowerCase();\n                  } else {\n                      return isNumeric(x) ? x + \"\" : x;\n                  }\n              };\n          }\n      }\n\n      if (isDate(value)) {\n          return (a) => {\n              const x = acc(a);\n              return isDate(x) ? x.getTime() : x;\n          };\n      }\n      return acc;\n  };\n\n  const transformCompositeFilter = function (filter) {\n      const accentFoldingFiltering = filter.accentFoldingFiltering;\n      const combiner = logic[filter.logic || \"and\"];\n\n      return filter.filters\n          .filter(isPresent)\n          .map((x) => {\n              const extendedFilter = isPresent(accentFoldingFiltering)\n                  ? deepExtend({}, x, { accentFoldingFiltering })\n                  : x;\n\n              return isPresent(x.filters)\n                  ? transformCompositeFilter(extendedFilter)\n                  : transformFilter(extendedFilter);\n          })\n          .reduce(combiner.concat, combiner.identity);\n  };\n\n  /* eslint-disable max-params */\n  /* eslint-disable no-empty */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable consistent-return */\n  /* eslint-disable block-scoped-var */\n  /* eslint-disable no-redeclare */\n  /* eslint-disable no-var */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable complexity */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable brace-style */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-else-return */\n  /* eslint-disable default-case */\n  /* eslint-disable no-param-reassign */\n\n\n  let filtersObj = {};\n  const dateToSerial$1 = calc.runtime.dateToSerial;\n  const serialToDate$1 = calc.runtime.serialToDate;\n\n  class Filter {\n      prepare() {\n      }\n      value(cell) {\n          return cell.value;\n      }\n      matches() {\n          throw new Error(\"The 'matches' method is not implemented.\");\n      }\n      toJSON() {\n          throw new Error(\"The 'toJSON' method is not implemented.\");\n      }\n  }\n\n  Filter.create = function(options) {\n      var filter = options.filter;\n\n      if (!filter) {\n          throw new Error(\"Filter type not specified.\");\n      }\n\n      var constructor = filtersObj[filter.charAt(0).toUpperCase() + filter.substring(1) + \"Filter\"];\n\n      if (!constructor) {\n          throw new Error(\"Filter type not recognized.\");\n      }\n\n      return new constructor(options);\n  };\n\n  class ValueFilter extends Filter {\n      constructor(options) {\n          super(options);\n\n          this._values = [];\n          this._dates = [];\n          this._blanks = false;\n\n          if (options.values !== undefined) {\n              this._values = options.values;\n          }\n\n          if (options.blanks !== undefined) {\n              this._blanks = options.blanks;\n          }\n\n          if (options.dates !== undefined) {\n              this._dates = options.dates;\n          }\n      }\n\n      value(cell) {\n          var value = cell.value;\n\n          if (this._dates.length > 0 && cell.format && typeof value === \"number\") {\n              var type = formatting.type(value, cell.format);\n\n              if (type === \"date\") {\n                  value = serialToDate$1(value);\n              }\n          }\n\n          return value;\n      }\n\n      matches(value) {\n          if (value === null || value === undefined) {\n              return this._blanks;\n          }\n\n          if (value instanceof Date) {\n              return this._dates.some(function(date) {\n                  return date.year === value.getFullYear() &&\n                      (date.month === undefined || date.month === value.getMonth()) &&\n                      (date.day === undefined || date.day === value.getDate()) &&\n                      (date.hours === undefined || date.hours === value.getHours()) &&\n                      (date.minutes === undefined || date.minutes === value.getMinutes()) &&\n                      (date.seconds === undefined || date.seconds === value.getSeconds());\n              });\n          }\n\n          return this._values.indexOf(value) >= 0;\n      }\n      toJSON() {\n          return {\n              filter: \"value\",\n              blanks: this._blanks,\n              values: this._values.slice(0)\n          };\n      }\n  }\n\n  class CustomFilter extends Filter {\n      constructor(options) {\n          super(options);\n          this._logic = \"and\";\n          if (options.logic !== undefined) {\n              this._logic = options.logic;\n          }\n\n          if (options.criteria === undefined) {\n              throw new Error(\"Must specify criteria.\");\n          }\n\n          this._criteria = options.criteria;\n\n          this._matches = transformCompositeFilter({\n              logic: this._logic,\n              filters: this._criteria,\n              accentFoldingFiltering: culture().name,\n          });\n      }\n      matches(value) {\n          if (value === null) {\n              return false;\n          }\n\n          return this._matches(value);\n      }\n      value(cell) {\n          var value = cell.value;\n          var criterionValue = this._criteria[0].value;\n          var criterionType = criterionValue instanceof Date ? \"date\" : typeof criterionValue;\n          var valueType = typeof value;\n\n          if (cell.format) {\n              valueType = formatting.type(value, cell.format);\n          }\n\n          if (valueType != criterionType) {\n              if (criterionType == \"string\") {\n                  if (cell.format) {\n                      value = formatting.text(value, cell.format);\n                  }\n                  value = value + \"\";\n              }\n          } else if (valueType == \"date\") {\n              value = serialToDate$1(value);\n          }\n\n          return value;\n      }\n      toJSON() {\n          return {\n              filter: \"custom\",\n              logic: this._logic,\n              criteria: this._criteria\n          };\n      }\n  }\n\n  class TopFilter extends Filter {\n      constructor(options) {\n          super(options);\n          this._type = options.type;\n          this._value = options.value;\n          this._values = [];\n      }\n\n      prepare(cells) {\n          var values = cells.map(this.value)\n          .sort()\n          .filter(function(value, index, array) {\n              return index === 0 || value !== array[index - 1];\n          });\n\n          if (this._type === \"topNumber\" || this._type == \"topPercent\") {\n              values.sort(function(x, y) {\n                  return y - x;\n              });\n          } else {\n              values.sort(function(x, y) {\n                  return x - y;\n              });\n          }\n\n          var count = this._value;\n\n          if (this._type === \"topPercent\" || this._type === \"bottomPercent\") {\n              count = (values.length * count / 100) >> 0;\n          }\n\n          this._values = values.slice(0, count);\n      }\n      matches(value) {\n          return this._values.indexOf(value) >= 0;\n      }\n      toJSON() {\n          return {\n              filter: \"top\",\n              type: this._type,\n              value: this._value\n          };\n      }\n  }\n\n  class DynamicFilter extends Filter {\n      constructor(options) {\n          super(options);\n          this._type = options.type;\n\n          this._predicate = this[options.type];\n\n          if (typeof this._predicate !== \"function\") {\n              throw new Error(\"DynamicFilter type '\" + options.type + \"' not recognized.\");\n          }\n      }\n      value(cell) {\n          var value = cell.value;\n\n          if (cell.format) {\n              var type = formatting.type(value, cell.format);\n\n              if (type === \"date\") {\n                  value = serialToDate$1(value);\n              }\n          }\n\n          return value;\n      }\n      prepare(cells) {\n          var sum = 0;\n          var count = 0;\n\n          for (var ci = 0; ci < cells.length; ci++) {\n              var value = this.value(cells[ci]);\n\n              if (typeof value === \"number\") {\n                  sum += value;\n                  count ++;\n              }\n          }\n\n          if (count > 0) {\n              this._average = sum / count;\n          } else {\n              this._average = 0;\n          }\n      }\n      matches(value) {\n          return this._predicate(value);\n      }\n      aboveAverage(value) {\n          if (value instanceof Date) {\n              value = dateToSerial$1(value);\n          }\n\n          if (typeof value !== \"number\") {\n              return false;\n          }\n\n          return value > this._average;\n      }\n      belowAverage(value) {\n          if (value instanceof Date) {\n              value = dateToSerial$1(value);\n          }\n\n          if (typeof value !== \"number\") {\n              return false;\n          }\n\n          return value < this._average;\n      }\n      tomorrow(value) {\n          if (value instanceof Date) {\n              var tomorrow = kendoDate.addDays(kendoDate.today(), 1);\n\n              return kendoDate.getDate(value).getTime() === tomorrow.getTime();\n          }\n\n          return false;\n      }\n      today(value) {\n          if (value instanceof Date) {\n              return kendoDate.isToday(value);\n          }\n\n          return false;\n      }\n      yesterday(value) {\n          if (value instanceof Date) {\n              var yesterday = kendoDate.addDays(kendoDate.today(), -1);\n\n              return kendoDate.getDate(value).getTime() === yesterday.getTime();\n          }\n\n          return false;\n      }\n      nextWeek(value) {\n          return sameWeek(kendoDate.addDays(kendoDate.today(), 7), value);\n      }\n      thisWeek(value) {\n          return sameWeek(kendoDate.today(), value);\n      }\n      lastWeek(value) {\n          return sameWeek(kendoDate.addDays(kendoDate.today(), -7), value);\n      }\n      nextMonth(value) {\n          return sameMonth(value, 1);\n      }\n      thisMonth(value) {\n          return sameMonth(value, 0);\n      }\n      lastMonth(value) {\n          return sameMonth(value, -1);\n      }\n      nextQuarter(value) {\n          if (value instanceof Date) {\n              var today = kendoDate.today();\n\n              var diff = quarter(value) - quarter(today);\n\n              return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                      (diff == -3 && today.getFullYear() + 1 === value.getFullYear());\n          }\n\n          return false;\n      }\n      thisQuarter(value) {\n          if (value instanceof Date) {\n              var today = kendoDate.today();\n\n              var diff = quarter(value) - quarter(today);\n\n              return diff === 0 && today.getFullYear() === value.getFullYear();\n          }\n\n          return false;\n      }\n      lastQuarter(value) {\n          if (value instanceof Date) {\n              var today = kendoDate.today();\n\n              var diff = quarter(today) - quarter(value);\n\n              return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                      (diff == -3 && today.getFullYear() - 1 === value.getFullYear());\n          }\n\n          return false;\n      }\n      nextYear(value) {\n          return sameYear(value, 1);\n      }\n      thisYear(value) {\n          return sameYear(value, 0);\n      }\n      lastYear(value) {\n          return sameYear(value, -1);\n      }\n      yearToDate(value) {\n          if (value instanceof Date) {\n              var today = kendoDate.today();\n\n              return value.getFullYear() === today.getFullYear() && value <= today;\n          }\n\n          return false;\n      }\n      toJSON() {\n          return {\n              filter: \"dynamic\",\n              type: this._type\n          };\n      }\n  }\n\n  filtersObj = {\n      Filter, ValueFilter, CustomFilter, TopFilter\n  };\n\n  [1, 2, 3, 4].forEach(function(target) {\n      DynamicFilter.prototype[\"quarter\" + target] = function(value) {\n          if (value instanceof Date) {\n              return quarter(value) === target;\n          }\n\n          return false;\n      };\n  });\n\n  const initDynamicFilter = () => {\n      culture().calendar.months.format.wide.forEach(function(month, index) {\n          DynamicFilter.prototype[month.toLowerCase()] = function(value) {\n              if (value instanceof Date) {\n                  return value.getMonth() === index;\n              }\n\n              return false;\n          };\n      });\n  };\n\n  function quarter(value) {\n      var month = value.getMonth() + 1;\n\n      if (month >= 1 && month <= 3) {\n          return 1;\n      } else if (month >= 4 && month <= 6) {\n          return 2;\n      } else if (month >= 7 && month <= 9) {\n          return 3;\n      } else {\n          return 4;\n      }\n  }\n\n  function sameYear(value, offset) {\n      if (value instanceof Date) {\n          var today = kendoDate.today();\n\n          today.setFullYear(today.getFullYear() + offset);\n\n          return today.getFullYear() === value.getFullYear();\n      }\n\n      return false;\n  }\n\n  function sameMonth(value, offset) {\n      if (value instanceof Date) {\n          var today = kendoDate.firstDayOfMonth(kendoDate.today());\n\n          today.setMonth(today.getMonth() + offset, 1);\n\n          return today.getTime() === kendoDate.firstDayOfMonth(value).getTime();\n      }\n\n      return false;\n  }\n\n  function sameWeek(a, b) {\n      if (b instanceof Date) {\n          var firstWeek = kendoDate.dayOfWeek(kendoDate.getDate(a), 1);\n\n          var secondWeek = kendoDate.dayOfWeek(kendoDate.getDate(b), 1);\n\n          return firstWeek.getTime() === secondWeek.getTime();\n      }\n\n      return false;\n  }\n\n  /* eslint-disable max-params */\n  /* eslint-disable no-empty */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable consistent-return */\n  /* eslint-disable block-scoped-var */\n  /* eslint-disable no-redeclare */\n  /* eslint-disable no-var */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable complexity */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable brace-style */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-else-return */\n  /* eslint-disable default-case */\n  /* eslint-disable no-param-reassign */\n\n\n  // This is a “dynamic variable” (see Greenspun's 10th rule).  It's\n  // bound to an array via sheet._saveModifiedFormulas (which see)\n  // while the callback runs.  The goal is to enable external code\n  // to get a list of formulas or validations that have been\n  // adjusted as an effect of an insert/delete row/column operation,\n  // to be able to undo it.\n  //\n  // The reason why simply saving the state via sheet.getState() or\n  // range.getState() won't suffice is that an insert or delete\n  // operation can have far-reaching effects, like adjusting\n  // formulas from another sheet.\n  var MODIFIED_FORMULAS;\n\n  const DEFAULT_SHEET_STATE = 'visible';\n\n  class Selection {\n      constructor(sheet) {\n          this._sheet = sheet;\n          this.selection = FIRSTREF.toRangeRef();\n          this.originalSelection = FIRSTREF.toRangeRef();\n          this._activeCell = FIRSTREF.toRangeRef();\n          this.originalActiveCell = FIRSTREF;\n      }\n\n      currentSelectionRange() {\n          return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n      }\n\n      currentOriginalNavigationRange() {\n          return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n      }\n\n      currentNavigationRange() {\n          if (this.singleCellSelection()) {\n              return this._sheet._sheetRef;\n          } else {\n              return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n          }\n      }\n\n      nextNavigationRange() {\n          if (!this.singleCellSelection()) {\n              this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n          }\n\n          return this.currentNavigationRange();\n      }\n\n      previousNavigationRange() {\n          if (!this.singleCellSelection()) {\n              this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n          }\n\n          return this.currentNavigationRange();\n      }\n\n      activeCell(ref) {\n          if (ref) {\n              this.originalActiveCell = ref.first();\n              this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n              this._sheet.focus(ref);\n              this._sheet.triggerChange({ activeCell: true, selection: true });\n          }\n\n          return this._activeCell;\n      }\n\n      select(ref, expanded, changeActiveCell, view) {\n          if (ref) {\n              if (ref.eq(this.originalSelection)) {\n                  return;\n              }\n\n              this._sheet.triggerSelect(new Range$1(ref, this._sheet));\n\n              this.originalSelection = ref;\n\n              this.selection = expanded;\n\n              if (changeActiveCell !== false) {\n                  if (ref.isCell()) {\n                      // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                      // is requested, mark A1 as the actually active cell.\n                      // https://github.com/telerik/kendo/issues/7698\n                      this._sheet.forEachMergedCell(ref, function(merged) {\n                          ref = merged.topLeft;\n                      });\n                      this.activeCell(ref);\n                  } else {\n                      ref = this.selection.lastRange();\n                      if (view && view._sheet === this._sheet && view.panes[0]) {\n                          // we should intersect this ref with the range that's currently on\n                          // screen, so that the view doesn't scroll (that is, keep the activeCell\n                          // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 —\n                          // XXX: fiddling with View internals here is probably bad practice, but\n                          // this whole thing is a mess already, so it can be forgiven. :-/\n                          var panes = view.panes;\n                          var i, pane, rows, cols, visible, newRef;\n\n                          for (i = 0; i < panes.length; i++) {\n                              pane = panes[i];\n                              if (!pane._currentView) {\n                                  continue;\n                              }\n                              rows = pane._currentView.rows.values;\n                              cols = pane._currentView.columns.values;\n\n                              visible = new RangeRef(\n                                  new CellRef(rows.start, cols.start),\n                                  new CellRef(rows.end, cols.end)\n                              );\n\n                              newRef = ref.intersect(visible);\n\n                              if (newRef !== NULLREF) {\n                                  break;\n                              }\n                          }\n\n                          if (newRef && newRef !== NULLREF) {\n                              ref = newRef;\n                          }\n                      }\n                      this.activeCell(ref.first());\n                  }\n\n                  this.selectionRangeIndex = this.selection.size() - 1;\n              } else {\n                  this._sheet.triggerChange({ selection: true });\n              }\n          }\n\n          return this.selection;\n      }\n\n      singleCellSelection() {\n          return this._activeCell.eq(this.selection);\n      }\n  }\n\n  let EDITORS = {};\n\n  function registerEditor(name, editor) {\n      EDITORS[name] = editor;\n  }\n\n  class Sheet extends Observable {\n      constructor() {\n          super();\n          this.events = [\n              \"changing\",\n              \"commandRequest\",\n              \"afterInsertRow\",\n              \"afterDeleteRow\",\n              \"insertRow\",\n              \"insertColumn\",\n              \"deleteRow\",\n              \"deleteColumn\",\n              \"hideRow\",\n              \"hideColumn\",\n              \"unhideRow\",\n              \"unhideColumn\",\n              \"select\",\n              \"dataBinding\",\n              \"dataBound\",\n              \"progress\"\n          ];\n\n          this.createSheetDataSource = Array.from(arguments).pop();\n\n          this._reinit.apply(this, arguments);\n      }\n\n      activeCellCustomEditor() {\n          let cell = this.activeCell().first();\n\n          if (this.range(cell).enable()) {\n              let val = this.validation(cell);\n              let key = this._properties.get(\"editor\", this._grid.cellRefIndex(cell));\n              let editor;\n\n              if (key != null) {\n                  editor = EDITORS[key];\n              }\n              else if (val && val.showButton) {\n                  key = \"_validation_\" + val.dataType;\n                  editor = EDITORS[key];\n              }\n\n              if (typeof editor == \"function\") {\n                  editor = EDITORS[key] = editor();\n              }\n\n              return editor;\n          }\n      }\n\n      _reinit(rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n          defaultCellStyle = defaultCellStyle || {};\n\n          this._defaultCellStyle = {\n              background: defaultCellStyle.background,\n              color: defaultCellStyle.color,\n              fontFamily: defaultCellStyle.fontFamily,\n              fontSize: defaultCellStyle.fontSize,\n              italic: defaultCellStyle.italic,\n              bold: defaultCellStyle.bold,\n              underline: defaultCellStyle.underline,\n              wrap: defaultCellStyle.wrap,\n              verticalAlign: defaultCellStyle.verticalAlign,\n              textAlign: defaultCellStyle.textAlign\n          };\n\n          this._rows = new Axis(rowCount, rowHeight);\n          this._columns = new Axis(columnCount, columnWidth);\n          this._filteredRows = new RangeList(0, rowCount - 1, false);\n          this._mergedCells = [];\n          this._frozenRows = 0;\n          this._frozenColumns = 0;\n          this._suspendChanges = false;\n          this._filter = null;\n          this._showGridLines = true;\n          this._gridLinesColor = null;\n          this._grid = new Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n          this._sheetRef = this._grid.normalize(SHEETREF);\n          this._properties = new PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n          this._sorter = new Sorter(this._grid, this._properties.sortable());\n\n          this._viewSelection = new Selection(this);\n\n          this._editSelection = new Selection(this);\n\n          this._formulaSelections = [];\n          this._drawings = [];\n      }\n\n      resize(newRows, newCols) {\n          newRows = Math.max(newRows, 1);\n          newCols = Math.max(newCols, 1);\n          var oldRows = this._rows._count;\n          var oldCols = this._columns._count;\n          if (newRows < oldRows) {\n              this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n          }\n          if (newCols < oldCols) {\n              this.range(0, newCols, oldRows, oldCols - newCols).clear();\n          }\n          this._rows._resize(newRows);\n          this._columns._resize(newCols);\n          this._grid._resize(newRows, newCols);\n          this._properties._resize(newRows, newCols);\n          this._sheetRef = this._grid.normalize(SHEETREF);\n          if (newRows > oldRows) {\n              this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n              this._filteredRows.value(oldRows, newRows - 1, false);\n          }\n          if (newCols > oldCols) {\n              this.range(0, oldCols, newRows, newCols - oldCols).clear();\n          }\n          this.triggerChange({ layout: true });\n      }\n\n      _resizeAddRow(count) {\n          this.resize(this._rows._count + (count || 1), this._columns._count);\n      }\n\n      _resizeAddColumn(count) {\n          this.resize(this._rows._count, this._columns._count + (count || 1));\n      }\n\n      _resizeDeleteRow(count) {\n          this._resizeAddRow(-(count || 1));\n      }\n\n      _resizeDeleteColumn(count) {\n          this._resizeAddColumn(-(count || 1));\n      }\n\n      _resizeForJSON(rows) {\n          var rowCount = rows.length, colCount = 0;\n          for (var ri = 0; ri < rows.length; ++ri) {\n              var row = rows[ri];\n              if (row.index != null) {\n                  rowCount = Math.max(rowCount, row.index + 1);\n              }\n              if (row.cells) {\n                  colCount = Math.max(colCount, row.cells.length);\n                  for (var ci = 0; ci < row.cells.length; ++ci) {\n                      var cell = row.cells[ci];\n                      if (cell.index != null) {\n                          colCount = Math.max(colCount, cell.index + 1);\n                      }\n                  }\n              }\n          }\n          this.resize(Math.max(rowCount, this._rows._count),\n                      Math.max(colCount, this._columns._count));\n      }\n\n      _selectionState() {\n          return this._inEdit ? this._editSelection : this._viewSelection;\n      }\n\n      navigator() {\n          if (!this._navigator) {\n              this._navigator = new SheetNavigator(this);\n          }\n          return this._navigator;\n      }\n\n      axisManager() {\n          if (!this._axisManager) {\n              this._axisManager = new AxisManager(this);\n          }\n\n          return this._axisManager;\n      }\n\n      _name(value) {\n          if (!value) {\n              return this._sheetName;\n          }\n\n          this._sheetName = value;\n\n          return this;\n      }\n\n      name() {\n          return this._name();\n      }\n\n      _state(value) {\n          if (!value) {\n              return this._sheetState || DEFAULT_SHEET_STATE;\n          }\n\n          this._sheetState = value;\n\n          return this;\n      }\n\n      state() {\n          return this._state();\n      }\n\n      _property(accessor, value, reason) {\n          if (value === undefined) {\n              return accessor();\n          } else {\n              accessor(value);\n\n              return this.triggerChange(reason);\n          }\n      }\n\n      _field(name, value, reason) {\n          if (value === undefined) {\n              return this[name];\n          } else {\n              this[name] = value;\n\n              return this.triggerChange(reason);\n          }\n      }\n\n      suspendChanges(value) {\n          if (value === undefined) {\n              return this._suspendChanges;\n          }\n\n          this._suspendChanges = value;\n\n          return this;\n      }\n\n      triggerChange(reason) {\n          if (!this._suspendChanges) {\n              this.trigger(\"change\", reason);\n          } else if (reason && reason.isValue) {\n              this._valueChanged = true;\n          }\n          return this;\n      }\n\n      triggerSelect(range) {\n          this.trigger(\"select\", { range: range });\n      }\n\n      setDataSource(dataSource, columns) {\n          if (this.dataSourceBinder) {\n              this.dataSourceBinder.destroy();\n          }\n\n          this.dataSourceBinder = new SheetDataSourceBinder({\n              dataSource: dataSource,\n              sheet: this,\n              columns: columns,\n              createSheetDataSource: this.createSheetDataSource\n          });\n\n          this.dataSource = this.dataSourceBinder.dataSource;\n      }\n\n      hideColumn(columnIndex) {\n          if (this.trigger(\"hideColumn\", { index: columnIndex })) {\n              return;\n          }\n\n          return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n      }\n\n      unhideColumn(columnIndex) {\n          if (this.trigger(\"unhideColumn\", { index: columnIndex })) {\n              return;\n          }\n\n          return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n      }\n\n      isHiddenColumn(columnIndex) {\n          return this._grid._columns.hidden(columnIndex);\n      }\n\n      _copyRange(sourceRangeRef, targetRef) {\n          var grid = this._grid;\n          var rowCount = grid.rowCount;\n\n          var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n          var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n\n          var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n          var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n\n          var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n          this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n      }\n\n      _saveModifiedFormulas(array, callback) {\n          var save = MODIFIED_FORMULAS;\n          MODIFIED_FORMULAS = array;\n          var ret = callback();\n          MODIFIED_FORMULAS = save;\n          return ret;\n      }\n\n      _restoreModifiedFormulas(array) {\n          var wb = this._workbook;\n          array.forEach(function(f) {\n              var sheet = wb.sheetByName(f.sheet), index;\n              if (f instanceof calc.runtime.Formula) {\n                  index = sheet._grid.cellRefIndex(f); // f has row, col\n                  sheet._properties.set(\"formula\", index, index, f);\n              }\n              if (f instanceof validationExport.Validation) {\n                  index = sheet._grid.cellRefIndex(f); // f has row, col\n                  sheet._properties.set(\"validation\", index, index, f);\n              }\n          });\n      }\n\n      _adjustReferences(operation, start, delta, mergedCells) {\n          this._mergedCells = mergedCells.reduce(function(a, ref) {\n              ref = ref.adjust(null, null, null, null, operation === \"row\", start, delta);\n              if (ref instanceof RangeRef) {\n                  a.push(ref);\n              }\n              return a;\n          }, []);\n          if (this._workbook) {\n              var affectedSheet = this._name();\n              this._workbook._sheets.forEach(function(sheet) {\n                  sheet._forFormulas(function(formula) {\n                      var prev = formula.adjust(affectedSheet, operation, start, delta);\n                      if (prev && MODIFIED_FORMULAS) {\n                          // if formula.adjust returns non-null,\n                          // that means the formula was indeed\n                          // modified and the returned value is a\n                          // copy of the previous Formula, which we\n                          // can use for undoing the operation.\n                          MODIFIED_FORMULAS.push(prev);\n                      }\n                  });\n\n                  sheet._forValidations(function(validation) {\n                      var prev = validation.adjust(affectedSheet, operation, start, delta);\n                      if (prev && MODIFIED_FORMULAS) {\n                          MODIFIED_FORMULAS.push(prev);\n                      }\n                  });\n              });\n              this._workbook.adjustNames(affectedSheet, operation === \"row\", start, delta);\n          }\n          var selection = this.select();\n          selection = selection.adjust(null, null, null, null, operation === \"row\", start, delta);\n          if (selection !== NULLREF) {\n              this.select(selection);\n          }\n          // adjust column widths or row heights and hidden attribute\n          var axis = operation === \"col\" ? this._columns : this._rows;\n          axis.adjust(start, delta);\n\n          if (operation === \"row\") {\n              if (delta < 0) {\n                  this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n              } else {\n                  this._filteredRows.copy(start, this._rows._count, start + delta);\n                  this._filteredRows.value(start, start + delta - 1, false);\n              }\n          }\n\n          // adjust drawing anchor cells\n          this._drawings.forEach(function(drawing) {\n              if (drawing.topLeftCell) {\n                  drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null,\n                                                                      operation === \"row\", start, delta);\n              }\n          });\n      }\n\n      _forFormulas(callback) {\n          var props = this._properties;\n          var formulas = props.get(\"formula\").values();\n          var n = formulas.length;\n          formulas.forEach(function(f, i) {\n              callback.call(this, f.value, i, n);\n          }, this);\n      }\n\n      _forValidations(callback) {\n          var props = this._properties;\n          props.get(\"validation\").values().forEach(function(v) {\n              callback.call(this, v.value);\n          }, this);\n      }\n\n      insertRow(rowIndex, skipDataSourceInsert) {\n          if (this.trigger(\"insertRow\", { index: rowIndex })) {\n              return;\n          }\n\n          this.batch(function() {\n              this._resizeAddRow();\n\n              var grid = this._grid;\n              var columnCount = grid.columnCount;\n              var rowCount = grid.rowCount;\n\n              if (rowIndex + 1 === rowCount) {\n                  // we just inserted after the last one, no need to shift data\n                  return;\n              }\n\n              var frozenRows = this.frozenRows();\n\n              if (rowIndex < frozenRows) {\n                  this.frozenRows(frozenRows + 1);\n              }\n\n              var mergedCells = this._mergedCells.slice();\n\n              for (var ci = 0; ci < columnCount; ci++) {\n                  var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n\n                  var nextRef = new RangeRef(\n                      new CellRef(topLeft.row, topLeft.col),\n                      new CellRef(rowCount - 2, bottomRight.col)\n                  );\n\n                  this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                  new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n              }\n\n              this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n          }, {\n              recalc: true,\n              layout: true,\n              insertRow: { index: rowIndex },\n              ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n          });\n\n          if (!skipDataSourceInsert) {\n              this.trigger(\"afterInsertRow\", { index: rowIndex });\n          }\n\n          return this;\n      }\n\n      isEnabledRow(rowIndex) {\n          var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n          return new Range$1(ref, this).enable();\n      }\n\n      deleteRow(rowIndex, skipDataSourceDelete) {\n          if (!this.isEnabledRow(rowIndex)) {\n              return this;\n          }\n\n          if (this.trigger(\"deleteRow\", { index: rowIndex })) {\n              return;\n          }\n\n          this.batch(function() {\n              var grid = this._grid;\n              var columnCount = grid.columnCount;\n\n              var frozenRows = this.frozenRows();\n              if (rowIndex < frozenRows) {\n                  this.frozenRows(frozenRows - 1);\n              }\n\n              var mergedCells = this._mergedCells.slice();\n\n              for (var ci = 0; ci < columnCount; ci++) {\n                  var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                  new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n\n                  var nextRef = new RangeRef(\n                      new CellRef(topLeft.row + 1, topLeft.col),\n                      new CellRef(Infinity, bottomRight.col)\n                  );\n\n                  this._copyRange(nextRef, topLeft);\n\n                  var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n\n                  new Range$1(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n              }\n\n              this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n              this._resizeDeleteRow();\n          }, {\n              recalc: true,\n              layout: true,\n              deleteRow: { index: rowIndex },\n              ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n          });\n\n          if (!skipDataSourceDelete) {\n              this.trigger(\"afterDeleteRow\", { index: rowIndex });\n          }\n\n          return this;\n      }\n\n      insertColumn(columnIndex) {\n          if (this.trigger(\"insertColumn\", { index: columnIndex })) {\n              return;\n          }\n\n          this.batch(function() {\n              this._resizeAddColumn();\n\n              var grid = this._grid;\n              var columnCount = grid.columnCount;\n\n              if (columnIndex + 1 === columnCount) {\n                  // we just inserted after the last one, no need to shift data\n                  return;\n              }\n\n              var frozenColumns = this.frozenColumns();\n\n              if (columnIndex < frozenColumns) {\n                  this.frozenColumns(frozenColumns + 1);\n              }\n\n              var mergedCells = this._mergedCells.slice();\n\n              for (var ci = columnCount; ci >= columnIndex; ci--) {\n                  var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                  new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                  if (ci === columnIndex) {\n                      break;\n                  }\n\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n\n                  var nextRef = new RangeRef(\n                      new CellRef(topLeft.row, topLeft.col - 1),\n                      new CellRef(bottomRight.row, bottomRight.col - 1)\n                  );\n\n                  this._copyRange(nextRef, topLeft);\n              }\n\n              this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n          }, {\n              recalc: true,\n              layout: true,\n              insertColumn: { index: columnIndex },\n              ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n          });\n\n          return this;\n      }\n\n      isEnabledColumn(columnIndex) {\n          var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n          return new Range$1(ref, this).enable();\n      }\n\n      deleteColumn(columnIndex) {\n          if (!this.isEnabledColumn(columnIndex)) {\n              return this;\n          }\n\n          if (this.trigger(\"deleteColumn\", { index: columnIndex })) {\n              return;\n          }\n\n          this.batch(function() {\n              var grid = this._grid;\n              var columnCount = grid.columnCount;\n\n              var frozenColumns = this.frozenColumns();\n\n              if (columnIndex < frozenColumns) {\n                  this.frozenColumns(frozenColumns - 1);\n              }\n\n              var mergedCells = this._mergedCells.slice();\n\n              for (var ci = columnIndex; ci < columnCount; ci++) {\n                  var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                  new Range$1(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                  if (ci === columnCount - 1) {\n                      break;\n                  }\n\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n\n                  var nextRef = new RangeRef(\n                      new CellRef(topLeft.row, topLeft.col + 1),\n                      new CellRef(bottomRight.row, bottomRight.col + 1)\n                  );\n\n                  this._copyRange(nextRef, topLeft);\n              }\n\n              this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n              this._resizeDeleteColumn();\n          }, {\n              recalc: true,\n              layout: true,\n              deleteColumn: { index: columnIndex },\n              ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n          });\n\n          return this;\n      }\n\n      _filterRow(rowIndex) {\n          this._rows.hide(rowIndex);\n          this._filteredRows.value(rowIndex, rowIndex, true);\n          this.triggerChange({ layout: true });\n      }\n\n      hideRow(rowIndex) {\n          if (this.trigger(\"hideRow\", { index: rowIndex })) {\n              return;\n          }\n          return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n      }\n\n      unhideRow(rowIndex) {\n          if (this.trigger(\"unhideRow\", { index: rowIndex })) {\n              return;\n          }\n          return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n      }\n\n      isHiddenRow(rowIndex) {\n          return this._grid._rows.hidden(rowIndex);\n      }\n\n      isFilteredRow(rowIndex) {\n          return this._filteredRows.value(rowIndex);\n      }\n\n      columnWidth(columnIndex, width) {\n          return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n      }\n\n      rowHeight(rowIndex, height) {\n          return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n      }\n\n      frozenRows(value) {\n          return this._field(\"_frozenRows\", value, { layout: true });\n      }\n\n      frozenColumns(value) {\n          return this._field(\"_frozenColumns\", value, { layout: true });\n      }\n\n      showGridLines(value) {\n          return this._field(\"_showGridLines\", value, { layout: true });\n      }\n\n      gridLinesColor(value) {\n          return this._field(\"_gridLinesColor\", value, { layout: true });\n      }\n\n      _ref(row, column, numRows, numColumns) {\n          var ref = null;\n\n          if (row instanceof Ref) {\n              return row;\n          }\n\n          if (row instanceof Range$1) {\n              return row._ref.toRangeRef();\n          }\n\n          if (typeof row === \"string\") {\n              ref = calc.parseReference(row);\n          } else {\n              if (!numRows) {\n                  numRows = 1;\n              }\n\n              if (!numColumns) {\n                  numColumns = 1;\n              }\n              ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n          }\n\n          return ref;\n      }\n\n      range(row, column, numRows, numColumns) {\n          return new Range$1(this._ref(row, column, numRows, numColumns), this);\n      }\n\n      _getMergedCells(range) {\n          var grid = this._grid;\n          var primary = {};\n          var secondary = {};\n          var hasMerged = false;\n\n          this.forEachMergedCell(range, function(ref) {\n              var topLeft = ref.topLeft;\n              grid.forEach(ref, function(cellRef) {\n                  if (topLeft.eq(cellRef)) {\n                      primary[cellRef.print()] = ref;\n                      hasMerged = true;\n                  } else if (range.contains(cellRef)) {\n                      secondary[cellRef.print()] = topLeft;\n                      hasMerged = true;\n                  }\n              });\n          });\n\n          return { primary: primary, secondary: secondary, hasMerged: hasMerged };\n      }\n\n      forEachMergedCell(ref, callback) {\n          var selectAll = false;\n\n          if (typeof callback === \"undefined\") {\n              callback = ref;\n              selectAll = true;\n          }\n\n          this._mergedCells.forEach(function(merged) {\n              if (selectAll || merged.intersects(ref)) {\n                  callback(merged);\n              }\n          });\n      }\n\n      forEachFilterHeader(ref, callback) {\n          var selectAll = false;\n\n          if (typeof callback === \"undefined\") {\n              callback = ref;\n              selectAll = true;\n          }\n\n          if (this._filter) {\n              var refs = [];\n\n              // get refs of all columns\n              this._filter.ref.forEachColumn(function(columnRef) {\n                  if (selectAll || columnRef.intersects(ref)) {\n                      refs.push(columnRef.topLeft);\n                  }\n              });\n\n              // filter out merged references\n              this._mergedCells.forEach(function(merged) {\n                  refs = refs.map(function(ref) {\n                      if (merged.intersects(ref)) {\n                          return merged;\n                      }\n\n                      return ref;\n                  });\n              });\n\n              // use only unique refs\n              refs.reduce(function unique(result, element) {\n                  if (result.indexOf(element) < 0) {\n                      result.push(element);\n                  }\n\n                  return result;\n              }, []).forEach(callback);\n          }\n      }\n\n      forEach(ref, callback) {\n          var self = this;\n          function forEachRange(ref) {\n              if (!(ref instanceof RangeRef)) {\n                  ref = ref.toRangeRef();\n              }\n              var topLeft = self._grid.normalize(ref.topLeft);\n              var bottomRight = self._grid.normalize(ref.bottomRight);\n              var ci, ri;\n\n              function doIt(value) {\n                  callback(ri++, ci, value);\n              }\n\n              for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                  ri = topLeft.row;\n                  var startCellIndex = self._grid.index(ri, ci);\n                  var endCellIndex = self._grid.index(bottomRight.row, ci);\n                  self._properties.forEach(startCellIndex, endCellIndex, doIt);\n              }\n          }\n\n          if (!(ref instanceof RangeRef)) {\n              ref = self._ref(ref);\n          }\n\n          if (ref instanceof UnionRef) {\n              // _ref() might still return a UnionRef, for instance, if\n              // `ref` happens to be one.  Probably an oversight, but it\n              // turns out to be useful.\n              ref.forEach(forEachRange);\n          } else {\n              forEachRange(ref);\n          }\n      }\n\n      startResizing(initialPosition) {\n          this._initialPosition = initialPosition;\n          this._resizeInProgress = true;\n      }\n\n      startAutoFill() {\n          this._autoFillInProgress = true;\n          var selection = this.select();\n          this._autoFillOrigin = selection;\n          this._autoFillDest = selection;\n          this.triggerChange({ selection: true });\n      }\n\n      updateAutoFill(dest, punch, hint, direction) {\n          this._autoFillDest = dest;\n          this._autoFillPunch = punch;\n          this._autoFillHint = hint;\n          this._autoFillDirection = direction;\n          this.triggerChange({ selection: true });\n      }\n\n      autoFillRef() {\n          return this._autoFillDest;\n      }\n\n      autoFillPunch() {\n          return this._autoFillPunch;\n      }\n\n      autoFillInProgress() {\n          return this._autoFillInProgress;\n      }\n\n      resizingInProgress() {\n          return this._resizeInProgress;\n      }\n\n      draggingInProgress() {\n          return this._draggingInProgress;\n      }\n\n      completeResizing() {\n          if (this._resizeInProgress) {\n              this._resizeInProgress = false;\n              var hintPosition = this.resizeHintPosition();\n\n              if (this._initialPosition && hintPosition) {\n                  var handlePosition = this.resizeHandlePosition();\n                  if (handlePosition.col !== -Infinity) {\n                      this.trigger(\"commandRequest\", {\n                          command: \"ColumnWidthCommand\",\n                          options: {\n                              target: handlePosition.col,\n                              value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                          }\n                      });\n                  } else {\n                      this.trigger(\"commandRequest\", {\n                          command: \"RowHeightCommand\",\n                          options: {\n                              target: handlePosition.row,\n                              value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                          }\n                      });\n                  }\n              } else {\n                  this.trigger(\"change\", { resize: true });\n              }\n          }\n      }\n\n      _visualRange(ref) {\n          var merged = this._mergedCells;\n          for (var i = merged.length; --i >= 0;) {\n              if (merged[i].intersects(ref)) {\n                  return this.range(merged[i]);\n              }\n          }\n          return this.range(ref);\n      }\n\n      _renderComment(ref) {\n          var comment = null;\n          if (ref) {\n              var range = this._visualRange(ref);\n              comment = range.comment();\n              ref = range._ref.toRangeRef().topLeft;\n          }\n          if (comment) {\n              if (!this._commentRef || !ref.eq(this._commentRef)) {\n                  this._commentRef = ref;\n                  this.trigger(\"change\", { comment: true });\n              }\n          } else {\n              if (this._commentRef) {\n                  this._commentRef = null;\n                  this.trigger(\"change\", { comment: true });\n              }\n          }\n      }\n\n      resizeHandlePosition() {\n          return this._resizeHandlePosition;\n      }\n\n      resizeHintPosition(location) {\n          if (location !== undefined) {\n              this._resizeHintPosition = location;\n              this.trigger(\"change\", { resize: true });\n          }\n          return this._resizeHintPosition;\n      }\n\n      removeResizeHandle() {\n          if (this._resizeHandlePosition) {\n              this._resizeHintPosition = undefined;\n              this._resizeHandlePosition = undefined;\n              this._initialPosition = undefined;\n              this.trigger(\"change\", { resize: true });\n          }\n      }\n\n      positionResizeHandle(ref) {\n          this._resizeHandlePosition = ref;\n          this.trigger(\"change\", { resize: true });\n      }\n\n      startDragging(data) {\n          this._draggingInProgress = data;\n      }\n\n      completeDragging() {\n          var drag = this._draggingInProgress;\n          if (drag) {\n              this._draggingInProgress = null;\n              var drawing = drag.drawing;\n              if (drawing.eq(drag.copy)) {\n                  return;\n              }\n              if (drawing.topLeftCell) {\n                  // adjust reference - in case the top-left corner\n                  // was moving, select the cell beneath it.\n                  var box = this.drawingBoundingBox(drawing);\n                  var row = this._rows.indexVisible(box.top);\n                  var col = this._columns.indexVisible(box.left);\n                  var ref = new CellRef(row, col);\n                  var refBox = this.refBoundingBox(ref);\n                  drawing.offsetX = box.left - refBox.left;\n                  drawing.offsetY = box.top - refBox.top;\n                  drawing.topLeftCell = ref;\n                  this.triggerChange({ dragging: true });\n              }\n              this.trigger(\"commandRequest\", {\n                  command: \"DrawingUpdateCommand\",\n                  options: {\n                      sheet    : this,\n                      drawing  : drawing,\n                      previous : drag.copy\n                  }\n              });\n          }\n      }\n\n      startSelection(view) {\n          if (this.frozenRows() || this.frozenColumns()) {\n              this._currentView = null;\n          } else if (view && view._sheet === this) {\n              this._currentView = view;\n          }\n          this._selectionInProgress = true;\n      }\n\n      completeSelection() {\n          if (this._selectionInProgress) {\n              this._selectionInProgress = false;\n              this._resizeHintPosition = undefined;\n              this.trigger(\"change\", { selection: true });\n          }\n          if (this._autoFillInProgress) {\n              this._autoFillInProgress = false;\n              var dest = this._autoFillDest;\n              var origin = this._autoFillOrigin;\n\n              if (this._autoFillPunch) { // we just clear data here\n                  this.trigger(\"commandRequest\", {\n                      command: \"ClearContentCommand\", options: { operatingRange: this.range(this._autoFillPunch) }\n                  });\n              } else {\n                  if (!dest.eq(origin)) {\n                      this.trigger(\"commandRequest\", {\n                          command: \"AutoFillCommand\", options: { operatingRange: this.range(dest), origin: this.range(origin) }\n                      });\n                  } else {\n                      this.triggerChange({ selection: true });\n                  }\n              }\n\n              this._autoFillDest = null;\n              this._autoFillPunch = null;\n              this._autoFillOrigin = null;\n\n              this.select(dest);\n          }\n      }\n\n      selectionInProgress() {\n          return this._selectionInProgress;\n      }\n\n      select(ref, changeActiveCell) {\n          var selectionState = this._selectionState();\n\n          var expandedRef;\n\n          if (ref) {\n              ref = this._ref(ref);\n              ref = this._grid.normalize(ref);\n              expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n          }\n\n          return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n      }\n\n      originalSelect() {\n          return this._selectionState().originalSelection;\n      }\n\n      currentSelectionRange() {\n          return this._selectionState().currentSelectionRange();\n      }\n\n      currentOriginalSelectionRange() {\n          return this._selectionState().currentOriginalNavigationRange();\n      }\n\n      currentNavigationRange() {\n          return this._selectionState().currentNavigationRange();\n      }\n\n      nextNavigationRange() {\n          return this._selectionState().nextNavigationRange();\n      }\n\n      previousNavigationRange() {\n          return this._selectionState().previousNavigationRange();\n      }\n\n      selectionRangeIndex() {\n          return this._selectionState().selectionRangeIndex;\n      }\n\n      activeCell(ref) {\n          return this._selectionState().activeCell(ref);\n      }\n\n      originalActiveCell() {\n          return this._selectionState().originalActiveCell;\n      }\n\n      singleCellSelection() {\n          return this._selectionState().singleCellSelection();\n      }\n\n      unionWithMerged(ref) {\n          var mergedCells = this._mergedCells;\n\n          return ref.map(function(ref) {\n              return ref.toRangeRef().union(mergedCells);\n          });\n      }\n\n      trim(ref) {\n          var trims = [];\n          var grid = this._grid;\n          this._properties.forEachProperty(function(property) {\n              trims.push(grid.trim(ref, property.list));\n          });\n          return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n      }\n\n      focus(ref) {\n          if (ref) {\n              this._focus = ref.toRangeRef();\n          } else {\n              var focus = this._focus;\n              this._focus = null;\n              return focus;\n          }\n      }\n\n      activeCellSelection() {\n          return new Range$1(this._grid.normalize(this.activeCell()), this);\n      }\n\n      selection() {\n          return new Range$1(this._grid.normalize(this._selectionState().selection), this);\n      }\n\n      selectedHeaders() {\n          var selection = this.select();\n\n          var rows = {};\n          var cols = {};\n          var allCols = false;\n          var allRows = false;\n          var maxRow = this._grid.rowCount - 1;\n          var maxCol = this._grid.columnCount - 1;\n\n          selection.forEach(function(ref) {\n              var i;\n              var rowState = \"partial\";\n              var colState = \"partial\";\n              ref = ref.toRangeRef();\n\n              var bottomRight = ref.bottomRight;\n              var topLeft = ref.topLeft;\n\n              var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n              var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n              if (colSelection) { //column selection\n                  allRows = true;\n                  colState = \"full\";\n              }\n\n              if (rowSelection) { //row selection\n                  allCols = true;\n                  rowState = \"full\";\n              }\n\n              if (!colSelection) { //column selection\n                  for (i = topLeft.row; i <= bottomRight.row; i++) {\n                      if (rows[i] !== \"full\") {\n                          rows[i] = rowState;\n                      }\n                  }\n              }\n\n              if (!rowSelection) {\n                  for (i = topLeft.col; i <= bottomRight.col; i++) {\n                      if (cols[i] !== \"full\") {\n                          cols[i] = colState;\n                      }\n                  }\n              }\n          });\n\n          return {\n              rows: rows,\n              cols: cols,\n              allRows: allRows,\n              allCols: allCols,\n              all: allRows && allCols\n          };\n      }\n\n      isInEditMode(isInEdit) {\n          if (isInEdit === undefined) {\n              return this._inEdit;\n          }\n\n          this._inEdit = isInEdit;\n\n          if (isInEdit) {\n              this._editSelection.selection = this._viewSelection.selection.clone();\n              this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n              this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n              this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n          }\n      }\n\n      _setFormulaSelections(selection) {\n          this._formulaSelections = (selection || []).slice();\n          this.triggerChange({ selection: true });\n      }\n\n      _viewActiveCell() {\n          return this._viewSelection._activeCell.toRangeRef();\n      }\n\n      toJSON() {\n          var positions = {};\n\n          var rows = this._rows.toJSON(\"height\", positions);\n          var columns = this._columns.toJSON(\"width\", {});\n          var viewSelection = this._viewSelection;\n          var hyperlinks = [];\n          var defaultCellStyle = this._defaultCellStyle || {};\n\n          function clearDefaultStyle(cell) {\n              Object.keys(defaultCellStyle).forEach(function(key) {\n                  if (cell[key] === defaultCellStyle[key]) {\n                      delete cell[key];\n                  }\n              });\n          }\n\n          this.forEach(SHEETREF, function(row, col, cell) {\n              clearDefaultStyle(cell);\n\n              if (Object.keys(cell).length === 0) {\n                  return;\n              }\n\n              if (cell.link) {\n                  hyperlinks.push({\n                      ref    : Ref.display(null, row, col),\n                      target : cell.link\n                  });\n              }\n\n              var position = positions[row];\n\n              if (position === undefined) {\n                  position = rows.length;\n                  rows.push({ index: row });\n                  positions[row] = position;\n              }\n\n              row = rows[position];\n\n              cell.index = col;\n\n              if (row.cells === undefined) {\n                  row.cells = [];\n              }\n\n              if (cell.formula) {\n                  // stringify Formula object.\n                  if (cell.formula.arrayFormulaRange) {\n                      cell.formula = {\n                          src: cell.formula.toString(),\n                          ref: cell.formula.arrayFormulaRange.toString()\n                      };\n                  } else {\n                      cell.formula = cell.formula.toString();\n                  }\n              }\n\n              if (cell.validation) {\n                  cell.validation = cell.validation.toJSON();\n              }\n\n              if (cell.color) {\n                  cell.color = kendo_drawing_cmn_chunk_js.q(cell.color).toCss();\n              }\n\n              if (cell.background) {\n                  cell.background = kendo_drawing_cmn_chunk_js.q(cell.background).toCss();\n              }\n\n              if (cell.borderTop && cell.borderTop.color) {\n                  cell.borderTop.color = kendo_drawing_cmn_chunk_js.q(cell.borderTop.color).toCss();\n              }\n\n              if (cell.borderBottom && cell.borderBottom.color) {\n                  cell.borderBottom.color = kendo_drawing_cmn_chunk_js.q(cell.borderBottom.color).toCss();\n              }\n\n              if (cell.borderRight && cell.borderRight.color) {\n                  cell.borderRight.color = kendo_drawing_cmn_chunk_js.q(cell.borderRight.color).toCss();\n              }\n\n              if (cell.borderLeft && cell.borderLeft.color) {\n                  cell.borderLeft.color = kendo_drawing_cmn_chunk_js.q(cell.borderLeft.color).toCss();\n              }\n\n              row.cells.push(cell);\n          });\n\n          var json = {\n              name: this._name(),\n              state: this._state(),\n              rows: rows,\n              columns: columns,\n              selection: viewSelection.selection.toString(),\n              activeCell: viewSelection.activeCell().toString(),\n              frozenRows: this.frozenRows(),\n              frozenColumns: this.frozenColumns(),\n              showGridLines: this.showGridLines(),\n              gridLinesColor: this.gridLinesColor(),\n              mergedCells: this._mergedCells.map(function(ref) {\n                  return ref.toString();\n              }),\n              hyperlinks: hyperlinks,\n              defaultCellStyle: defaultCellStyle,\n              drawings: this._drawings.map(function(dr) {\n                  return dr.toJSON();\n              })\n          };\n\n          if (this._sort) {\n              json.sort = {\n                  ref: this._sort.ref.toString(),\n                  columns: this._sort.columns.map(function(column) {\n                      return {\n                          index: column.index,\n                          ascending: column.ascending\n                      };\n                  })\n              };\n          }\n\n          if (this._filter) {\n              json.filter = {\n                  ref: this._filter.ref.toString(),\n                  columns: this._filter.columns.map(function(column) {\n                      var filter = column.filter.toJSON();\n                      filter.index = column.index;\n                      return filter;\n                  })\n              };\n          }\n\n          return json;\n      }\n\n      fromJSON(json) {\n          this.batch(function() {\n              if (json.name !== undefined) {\n                  this._name(json.name);\n              }\n\n              if (json.frozenColumns !== undefined) {\n                  this.frozenColumns(json.frozenColumns);\n              }\n\n              if (json.frozenRows !== undefined) {\n                  this.frozenRows(json.frozenRows);\n              }\n\n              if (json.columns !== undefined) {\n                  this._columns.fromJSON(\"width\", json.columns);\n              }\n\n              if (json.rows !== undefined) {\n                  this._resizeForJSON(json.rows);\n                  this._rows.fromJSON(\"height\", json.rows);\n\n                  for (var ri = 0; ri < json.rows.length; ri++) {\n                      var row = json.rows[ri];\n                      var rowIndex = row.index;\n\n                      if (rowIndex === undefined) {\n                          rowIndex = ri;\n                      }\n\n                      if (row.cells) {\n                          for (var ci = 0; ci < row.cells.length; ci++) {\n                              var cell = row.cells[ci];\n                              var columnIndex = cell.index;\n\n                              if (columnIndex === undefined) {\n                                  columnIndex = ci;\n                              }\n\n                              if (cell.formula) {\n                                  var isArray = typeof cell.formula != \"string\";\n                                  var src = isArray ? cell.formula.src : cell.formula;\n                                  var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                  if (isArray) {\n                                      formula.setArrayFormulaRange(\n                                          calc.parseReference(cell.formula.ref));\n                                  }\n                                  cell.formula = formula;\n                              }\n\n                              if (cell.validation) {\n                                  cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                              }\n\n                              this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                          }\n                      }\n                  }\n              }\n\n              if (json.drawings) {\n                  this._drawings = json.drawings.map(Drawing.fromJSON);\n              }\n\n              if (json.selection) {\n                  this._viewSelection.selection =\n                      this._viewSelection.originalSelection = this._ref(json.selection);\n              }\n\n              if (json.activeCell) {\n                  var activeCellRef = this._ref(json.activeCell);\n\n                  this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                  this._viewSelection.originalActiveCell = activeCellRef.first();\n              }\n\n\n              if (json.mergedCells) {\n                  json.mergedCells.forEach(function(ref) {\n                      this.range(ref).merge();\n                  }, this);\n              }\n\n              if (json.filter) {\n                  var ref = json.filter.ref;\n                  var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n\n                  if (!ref) ; else {\n                      this._filter = {\n                          ref: this._ref(ref),\n                          columns: columns.map(function(column) {\n                              return {\n                                  index: column.index,\n                                  filter: Filter.create(column)\n                              };\n                          })\n                      };\n\n                      this._refreshFilter();\n                  }\n              }\n\n              if (json.showGridLines !== undefined) {\n                  this._showGridLines = json.showGridLines;\n              }\n\n              this._gridLinesColor = json.gridLinesColor;\n\n              if (json.sort) {\n                  this._sortBy(this._ref(json.sort.ref), json.sort.columns.slice(0));\n              }\n          });\n\n          this._rows._refresh();\n          this._columns._refresh();\n      }\n\n      formula(ref) {\n          return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n      }\n\n      validation(ref) {\n          return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n      }\n\n      // NOTE: resetFormulas should be called first.  We don't do it in this\n      // function because it should be done from the Workbook object for all\n      // sheets.\n      resetFormulas() {\n          this._forFormulas(function(formula) {\n              formula.reset();\n          });\n      }\n\n      resetValidations() {\n          this._forValidations(function(validation) {\n              validation.reset();\n          });\n      }\n\n      recalc(context, callback) {\n          var formulas = this._properties.get(\"formula\").values();\n          var count = formulas.length, pending = 0, i = 0;\n          if (!count && callback) {\n              return callback();\n          }\n          function next() {\n              pending--;\n              if (i === count && !pending) {\n                  callback();\n              }\n          }\n          while (i < count) {\n              pending++;\n              formulas[i++].value.exec(context, callback ? next : null);\n          }\n      }\n\n      revalidate(context) {\n          var self = this;\n          this._forValidations(function(validation) {\n              var cellRef = new CellRef(validation.row, validation.col);\n              var ref = new RangeRef(cellRef, cellRef);\n              validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n          });\n      }\n\n      _value(row, col, value) {\n          var index = this._grid.index(row, col);\n\n          if (value !== undefined) {\n              this._properties.set(\"value\", index, index, value);\n          } else {\n              return this._properties.get(\"value\", index);\n          }\n      }\n\n      _validation(row, col) {\n          var index = this._grid.index(row, col);\n\n          return this._properties.get(\"validation\", index);\n      }\n\n      _compileValidation(row, col, curValidation) {\n          if (curValidation instanceof validationExport.Validation) {\n              // do not alter an existing object.\n              return curValidation.clone(this._name(), row, col);\n          }\n\n          if (curValidation.from != null) {\n              curValidation.from = (curValidation.from + \"\").replace(/^=/, \"\");\n          }\n\n          if (curValidation.to != null) {\n              curValidation.to = (curValidation.to + \"\").replace(/^=/, \"\");\n          }\n\n          return validationExport.compile(this._name(), row, col, curValidation);\n      }\n\n      _compileFormula(row, col, f) {\n          f = f.replace(/^=/, \"\");\n          f = calc.parseFormula(this._name(), row, col, f);\n          return calc.compile(f);\n      }\n\n      _copyValuesInRange(topLeft, bottomRight, value, property) {\n          var ci, start, end;\n\n          for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n              start = this._grid.index(topLeft.row, ci);\n              end = this._grid.index(bottomRight.row, ci);\n              for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                  // Even if it's the same formula in multiple cells, we\n                  // need to have different Formula objects, hence cloning\n                  // it.  Don't worry, clone() is fast.\n                  value = value.clone(this._name(), row, ci);\n                  this._properties.set(property, index, index, value);\n              }\n          }\n          return value;\n      }\n\n      _set(ref, name, value) {\n          var topLeft = this._grid.normalize(ref.topLeft);\n          var bottomRight = this._grid.normalize(ref.bottomRight);\n          var ci, start, end;\n\n          if (typeof value == \"number\") {\n              // Apparently, Excel (and LibreOffice and Google\n              // Sheets) will limit precision to 14 digits; type:\n              // -4.2524999999999995 and you get -4.2525.  The\n              // formula engine already does something similar for\n              // intermediate formula results, but we must do it\n              // here as well for original input values.\n              value = calc.runtime.limitPrecision(value);\n          }\n\n          if (value && name === \"formula\") {\n              if (typeof value == \"string\") {\n                  // get Formula object.  we don't care about handling errors\n                  // here since it won't be called interactively.\n                  value = this._compileFormula(topLeft.row, topLeft.col, value);\n              }\n\n              value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n\n          } else if (value && name === \"validation\") {\n              value = this._compileValidation(topLeft.row, topLeft.col, value);\n              value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n\n          } else {\n              for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                  start = this._grid.index(topLeft.row, ci);\n                  end = this._grid.index(bottomRight.row, ci);\n                  this._properties.set(name, start, end, value);\n                  if (name === \"formula\") {\n                      // removing a formula, must clear value.\n                      this._properties.set(\"value\", start, end, null);\n                  }\n              }\n          }\n      }\n\n      _get(ref, name) {\n          var topLeft = this._grid.normalize(ref.topLeft);\n\n          var index = this._grid.index(topLeft.row, topLeft.col);\n\n          return this._properties.get(name, index);\n      }\n\n      batch(callback, reason) {\n          var suspended = this.suspendChanges();\n\n          this.suspendChanges(true);\n          this._valueChanged = false;\n\n          callback.call(this);\n\n          if (!reason) {\n              reason = { recalc: true };\n          }\n          if (this._valueChanged) {\n              reason.isValue = true;\n          }\n\n          return this.suspendChanges(suspended).triggerChange(reason);\n      }\n\n      _sortBy(ref, columns) {\n          var indices = null;\n\n          columns.forEach(function(column) {\n              indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n          }, this);\n\n          this._sort = {\n              ref: ref,\n              columns: columns\n          };\n\n          this._refreshFilter();\n\n          this.forEach(ref, function(row, col, props) {\n              var formula = props.formula;\n              if (formula) {\n                  var diff = row - formula.row;\n                  if (diff !== 0) {\n                      var start = diff > 0 ? formula.row : formula.row + diff;\n                      formula.adjust(this.name(), \"row\", start, diff);\n                  }\n              }\n          }.bind(this));\n\n          this.triggerChange({ recalc: true });\n      }\n\n      _refreshFilter() {\n          if (this._filter) {\n              this._filterBy(this._filter.ref, this._filter.columns);\n          }\n      }\n\n      _filterBy(ref, columns) {\n          this.batch(function() {\n              for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                  if (this.isFilteredRow(ri)) {\n                      this._filteredRows.value(ri, ri, false);\n                      this._rows.unhide(ri);\n                  }\n              }\n\n              columns.forEach(function(column) {\n                  // do not filter header row\n                  var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n\n                  var cells = [];\n\n                  if (columnRef === NULLREF) {\n                      return;\n                  }\n\n                  this.forEach(columnRef, function(row, col, cell) {\n                      cell.row = row;\n                      cells.push(cell);\n                  });\n\n                  column.filter.prepare(cells);\n\n                  for (var ci = 0; ci < cells.length; ci++) {\n                      var cell = cells[ci];\n                      var value = column.filter.value(cell);\n\n                      if (column.filter.matches(value) === false) {\n                          this._filterRow(cell.row);\n                      }\n                  }\n              }, this);\n\n              this._filter = {\n                  ref: ref,\n                  columns: columns\n              };\n          }, { recalc: true, layout: true, filter: true });\n      }\n\n      filterColumn(ref) {\n          var filterRef = this.filter().ref;\n          return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n      }\n\n      filter() {\n          return this._filter;\n      }\n\n      clearFilter(spec) {\n          this._clearFilter(spec instanceof Array ? spec : [spec]);\n      }\n\n      _clearFilter(indices) {\n          if (this._filter) {\n              this.batch(function() {\n                  this._filter.columns = this._filter.columns.filter(function(column) {\n                      return indices.indexOf(column.index) < 0;\n                  });\n\n                  this._refreshFilter();\n              }, { recalc: true, layout: true, filter: true });\n          }\n      }\n\n      getAxisState() {\n          return {\n              rows: this._rows.getState(),\n              columns: this._columns.getState()\n          };\n      }\n\n      setAxisState(state) {\n          this._rows.setState(state.rows);\n          this._columns.setState(state.columns);\n          this.triggerChange({ layout: true });\n      }\n\n      getState() {\n          return {\n              rows: this._rows.getState(),\n              columns: this._columns.getState(),\n              mergedCells: this._mergedCells.map(function(cell) { return cell.clone(); }),\n              properties: this._properties.getState()\n          };\n      }\n\n      setState(state) {\n          this._rows.setState(state.rows);\n          this._columns.setState(state.columns);\n          this._mergedCells = state.mergedCells;\n          this._properties.setState(state.properties);\n          this.triggerChange(ALL_REASONS);\n      }\n\n      _merge(ref) {\n          var mergedCells = this._mergedCells;\n\n          var sheet = this;\n          var mergedRef;\n          this.batch(function() {\n              mergedRef = ref.map(function(ref) {\n                  if (ref instanceof CellRef) {\n                      return ref;\n                  }\n\n                  var currentRef = ref.toRangeRef().union(mergedCells, function(ref) {\n                      mergedCells.splice(mergedCells.indexOf(ref), 1);\n                  });\n\n                  var range = new Range$1(currentRef, sheet);\n                  var formula = range._get(\"formula\");\n                  var value = range.value();\n                  var format = range.format();\n                  var background = range.background();\n\n                  range.value(null);\n                  range.format(null);\n                  range.background(null);\n\n                  var topLeft = new Range$1(currentRef.collapse(), sheet);\n\n                  if (formula) {\n                      topLeft._set(\"formula\", formula);\n                  } else {\n                      topLeft.value(value);\n                  }\n                  topLeft.format(format);\n                  topLeft.background(background);\n\n                  mergedCells.push(currentRef);\n                  return currentRef;\n              });\n\n              var viewSelection = sheet._viewSelection;\n\n              viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n              viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n          }, { activeCell: true, selection: true });\n\n          return mergedRef;\n      }\n\n      _useCultureDecimals() {\n          return this._workbook && this._workbook.options.useCultureDecimals;\n      }\n\n      withCultureDecimals(f) {\n          var dot = \".\";\n          if (this._useCultureDecimals()) {\n              dot = culture().numbers.symbols.decimal;\n          }\n          return calc.withDecimalSeparator(dot, f);\n      }\n\n      drawingBoundingBox(drawing) {\n          var left = drawing.offsetX;\n          var top = drawing.offsetY;\n          if (drawing.topLeftCell) {\n              // offsets are relative to cell\n              left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n              top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n          }\n          return new Rectangle(left, top, drawing.width, drawing.height);\n      }\n\n      refBoundingBox(ref) {\n          return this._grid.rectangle(ref.toRangeRef());\n      }\n\n      addDrawing(drw, activate) {\n          if (!(drw instanceof Drawing)) {\n              drw = new Drawing(drw);\n          }\n          this._drawings.push(drw);\n          if (activate) {\n              this._activeDrawing = drw;\n          }\n          this.triggerChange({ layout: true });\n          return drw;\n      }\n\n      removeDrawing(drawing) {\n          var pos = this._drawings.indexOf(drawing);\n          if (pos >= 0) {\n              this._drawings.splice(pos, 1);\n              this.triggerChange({ layout: true });\n          }\n      }\n\n      usesImage(img) {\n          for (var i = this._drawings.length; --i >= 0;) {\n              if (this._drawings[i].image === img) {\n                  return true;\n              }\n          }\n          return false;\n      }\n\n      isMerged(ref) {\n          var merged = this._mergedCells;\n          for (var i = merged.length; --i >= 0;) {\n              if (merged[i].eq(ref)) {\n                  return true;\n              }\n          }\n          return false;\n      }\n  }\n\n  class Drawing {\n      constructor(args) {\n          this.reset(args);\n      }\n\n      toJSON() {\n          return {\n              topLeftCell: this.topLeftCell.toString(),\n              offsetX: this.offsetX,\n              offsetY: this.offsetY,\n              width: this.width,\n              height: this.height,\n              image: this.image,\n              opacity: this.opacity\n          };\n      }\n\n      clone() {\n          return new Drawing(this);\n      }\n\n      reset(dr) {\n          var anchor = dr.topLeftCell;\n          if (typeof anchor == \"string\") {\n              anchor = calc.parseReference(anchor);\n          }\n          this.topLeftCell = anchor;\n          this.offsetX = dr.offsetX || 0;\n          this.offsetY = dr.offsetY || 0;\n          this.width = dr.width;\n          this.height = dr.height;\n          this.image = dr.image;\n          this.opacity = dr.opacity != null ? dr.opacity : 1;\n      }\n\n      eq(dr) {\n          return ((!this.topLeftCell && !dr.topLeftCell)\n                  || (this.topLeftCell && dr.topLeftCell\n                      && this.topLeftCell.eq(dr.topLeftCell)))\n              && this.offsetX === dr.offsetX\n              && this.offsetY === dr.offsetY\n              && this.width === dr.width\n              && this.height === dr.height\n              && this.image === dr.image\n              && this.opacity === dr.opacity;\n      }\n  }\n\n  Drawing.fromJSON = function(args) {\n      return new Drawing(args);\n  };\n\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable key-spacing */\n  let PAPER_SIZE = {\n      a0        : [ 2383.94 , 3370.39 ],\n      a1        : [ 1683.78 , 2383.94 ],\n      a2        : [ 1190.55 , 1683.78 ],\n      a3        : [ 841.89 , 1190.55 ],\n      a4        : [ 595.28 , 841.89 ],\n      a5        : [ 419.53 , 595.28 ],\n      a6        : [ 297.64 , 419.53 ],\n      a7        : [ 209.76 , 297.64 ],\n      a8        : [ 147.40 , 209.76 ],\n      a9        : [ 104.88 , 147.40 ],\n      a10       : [ 73.70 , 104.88 ],\n      b0        : [ 2834.65 , 4008.19 ],\n      b1        : [ 2004.09 , 2834.65 ],\n      b2        : [ 1417.32 , 2004.09 ],\n      b3        : [ 1000.63 , 1417.32 ],\n      b4        : [ 708.66 , 1000.63 ],\n      b5        : [ 498.90 , 708.66 ],\n      b6        : [ 354.33 , 498.90 ],\n      b7        : [ 249.45 , 354.33 ],\n      b8        : [ 175.75 , 249.45 ],\n      b9        : [ 124.72 , 175.75 ],\n      b10       : [ 87.87 , 124.72 ],\n      c0        : [ 2599.37 , 3676.54 ],\n      c1        : [ 1836.85 , 2599.37 ],\n      c2        : [ 1298.27 , 1836.85 ],\n      c3        : [ 918.43 , 1298.27 ],\n      c4        : [ 649.13 , 918.43 ],\n      c5        : [ 459.21 , 649.13 ],\n      c6        : [ 323.15 , 459.21 ],\n      c7        : [ 229.61 , 323.15 ],\n      c8        : [ 161.57 , 229.61 ],\n      c9        : [ 113.39 , 161.57 ],\n      c10       : [ 79.37 , 113.39 ],\n      executive : [ 521.86 , 756.00 ],\n      folio     : [ 612.00 , 936.00 ],\n      legal     : [ 612.00 , 1008.00 ],\n      letter    : [ 612.00 , 792.00 ],\n      tabloid   : [ 792.00 , 1224.00 ]\n  };\n\n  function mm2pt(mm) {\n      return mm * (72 / 25.4);\n  }\n\n  function cm2pt(cm) {\n      return mm2pt(cm * 10);\n  }\n\n  function in2pt(inch) {\n      return inch * 72;\n  }\n\n  function unitsToPoints(x, def) {\n      if (typeof x == \"number\") {\n          return x;\n      }\n      if (typeof x == \"string\") {\n          let m;\n          m = /^\\s*([0-9.]+)\\s*(mm|cm|in|pt)\\s*$/.exec(x);\n          if (m) {\n              let num = parseFloat(m[1]);\n              if (!isNaN(num)) {\n                  if (m[2] === \"pt\") {\n                      return num;\n                  }\n                  return {\n                      \"mm\": mm2pt,\n                      \"cm\": cm2pt,\n                      \"in\": in2pt\n                  }[m[2]](num);\n              }\n          }\n      }\n      if (def != null) {\n          return def;\n      }\n      throw new Error(\"Can't parse unit: \" + x);\n  }\n\n  function getPaperOptions(getOption) {\n      if (typeof getOption != \"function\") {\n          let options = getOption;\n          getOption = function(key, def) {\n              return key in options ? options[key] : def;\n          };\n      }\n      let paperSize = getOption(\"paperSize\", PAPER_SIZE.a4);\n      if (!paperSize) {\n          return {};\n      }\n      if (typeof paperSize == \"string\") {\n          paperSize = PAPER_SIZE[paperSize.toLowerCase()];\n          if (paperSize == null) {\n              throw new Error(\"Unknown paper size\");\n          }\n      }\n\n      paperSize[0] = unitsToPoints(paperSize[0]);\n      paperSize[1] = unitsToPoints(paperSize[1]);\n\n      if (getOption(\"landscape\", false)) {\n          paperSize = [\n              Math.max(paperSize[0], paperSize[1]),\n              Math.min(paperSize[0], paperSize[1])\n          ];\n      }\n\n      let margin = getOption(\"margin\");\n      if (margin) {\n          if (typeof margin == \"string\" || typeof margin == \"number\") {\n              margin = unitsToPoints(margin, 0);\n              margin = { left: margin, top: margin, right: margin, bottom: margin };\n          } else {\n              margin = {\n                  left   : unitsToPoints(margin.left, 0),\n                  top    : unitsToPoints(margin.top, 0),\n                  right  : unitsToPoints(margin.right, 0),\n                  bottom : unitsToPoints(margin.bottom, 0)\n              };\n          }\n          if (getOption(\"addMargin\")) {\n              paperSize[0] += margin.left + margin.right;\n              paperSize[1] += margin.top + margin.bottom;\n          }\n      }\n      return { paperSize: paperSize, margin: margin };\n  }\n\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable default-case */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable no-else-return */\n  /* eslint-disable key-spacing */\n  /* eslint-disable eqeqeq */\n  /* eslint-disable no-param-reassign */\n\n\n  let GUIDELINE_WIDTH = 0.8;\n\n  // This takes a list of row heights and the page height, and\n  // produces a list of Y coordinates for each row, such that rows\n  // are not truncated across pages.  However, the algorithm will\n  // decide to truncate a row in the event that more than\n  // `maxEmpty` (default 0.2) of the available space would\n  // otherwise be left blank.\n  //\n  // It will be used for horizontal splitting too (will receive\n  // column widths and page width, and produce a list of X coords).\n  //\n  // If the third argument (headerRows) is not null, it specifies a\n  // number of rows to repeat on each page.  On pages other than the\n  // first, the necessary space will be skipped at the top.  Header\n  // coordinates (except for the first page) are pushed in\n  // headerCoords.\n  function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n      let curr = 0;\n      let out = [];\n      let bottom = pageHeight;\n      let header = 0;\n      if (pageHeight && maxEmpty) {\n          maxEmpty *= pageHeight;\n      }\n      heights.forEach(function(h, i) {\n          if (headerRows != null && i < headerRows) {\n              header += h;\n          }\n          if (pageHeight && curr + h > bottom) {\n              if (bottom - curr < maxEmpty) {\n                  // align to next page\n                  curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                  if (header > 0) {\n                      headerCoords.push(curr - header);\n                  }\n              }\n              // update bottom anyway; don't just add pageHeight, as\n              // we might need multiple pages for the pathological\n              // case of one row higher than the page.\n              bottom += pageHeight * Math.ceil(h / pageHeight);\n          }\n          out.push(curr);\n          curr += h;\n      });\n      out.push(curr);\n      return out;\n  }\n\n  function doLayout(sheet, range, options) {\n      // normalize reference so we don't have to deal with Infinity here.\n      let grid = sheet._grid;\n      range = grid.normalize(range);\n\n      let wholeRect = grid.rectangle(range);\n      let drawings = [];\n      sheet._drawings.forEach(function(d) {\n          let box = sheet.drawingBoundingBox(d);\n          if (box.intersects(wholeRect)) {\n              drawings.push({\n                  drawing: d,\n                  box: box.offset(-wholeRect.left, -wholeRect.top)\n              });\n          }\n      });\n\n      // 1. obtain the list of cells that need to be printed, the\n      //    row heights and column widths.  Place in each cell row,\n      //    col (relative to range, i.e. first is 0,0), rowspan,\n      //    colspan and merged.  also place a list of drawings\n      //    anchored to that cell.\n      let cells = [];\n      let rowHeights = [];\n      let colWidths = [];\n      let mergedCells = sheet._getMergedCells(range);\n\n      let maxRow = -1, maxCol = -1;\n      sheet.forEach(range, function(row, col, cell) {\n          let relrow = row - range.topLeft.row;\n          let relcol = col - range.topLeft.col;\n          let rh = sheet.rowHeight(row);\n          let cw = sheet.columnWidth(col);\n          if (!options.forScreen) {\n              // for printing we'll need the list of anchored\n              // drawings so that we can adjust them after page\n              // splitting.\n              cell.drawings = drawings.filter(function(d) {\n                  let tl = d.drawing.topLeftCell;\n                  if (tl && tl.row == row && tl.col == col) {\n                      maxRow = Math.max(maxRow, sheet._rows.index(d.box.bottom));\n                      maxCol = Math.max(maxCol, sheet._columns.index(d.box.right));\n                      return true;\n                  }\n              });\n          }\n          if (!relcol) {\n              rowHeights.push(rh);\n          }\n          if (!relrow) {\n              colWidths.push(cw);\n          }\n          let id = new CellRef(row, col).print();\n          if (mergedCells.secondary[id]) {\n              return;\n          }\n          cell.row = relrow;\n          cell.col = relcol;\n          let m = mergedCells.primary[id];\n          if (m) {\n              delete mergedCells.primary[id];\n              cell.merged = true;\n              cell.rowspan = m.height();\n              cell.colspan = m.width();\n              if (options.forScreen) {\n                  cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                  cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n              }\n          } else {\n              cell.rowspan = 1;\n              cell.colspan = 1;\n          }\n          if (!sheet._grid._columns.sum(col, col + cell.colspan - 1) ||\n              !sheet._grid._rows.sum(row, row + cell.rowspan - 1)) {\n              return;\n          }\n          let nonEmpty = options.forScreen || shouldDrawCell(cell);\n          if (!(options.emptyCells || nonEmpty)) {\n              return;\n          }\n          if (nonEmpty) {\n              maxRow = Math.max(maxRow, relrow + cell.rowspan - 1);\n              maxCol = Math.max(maxCol, relcol + cell.colspan - 1);\n          } else {\n              cell.empty = true;\n          }\n          cells.push(cell);\n      });\n\n      if (!options.forScreen) {\n          // keep only the drawable area\n          rowHeights = rowHeights.slice(0, maxRow + 1);\n          colWidths = colWidths.slice(0, maxCol + 1);\n      }\n\n      let pageWidth = options.pageWidth;\n      let pageHeight = options.pageHeight;\n      let scaleFactor = options.scale || 1;\n\n      // when fitWidth is requested, we must update the page size\n      // with the corresponding scale factor; the algorithm below\n      // (2) will continue to work, just drawing on a bigger page.\n      if (options.fitWidth) {\n          let width = colWidths.reduce(sum, 0);\n          if (width > pageWidth) {\n              scaleFactor = pageWidth / width;\n          }\n      }\n      pageWidth = Math.ceil(pageWidth / scaleFactor);\n      pageHeight = Math.ceil(pageHeight / scaleFactor);\n\n      // 2. calculate top, left, bottom, right, width and height for\n      //    printable cells.  Merged cells will be split across\n      //    pages, unless the first row/col is shifted to next page.\n      //    boxWidth and boxHeight get the complete drawing size.\n      //    Note that cell coordinates keep increasing, i.e. they\n      //    are not reset to zero for a new page.  The print\n      //    function translates the view to current page.\n      let hyCoords = []; // will receive header Y coordinates, if needed\n      let yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty,\n                                      options.headerRows, hyCoords);\n      let xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n      let boxWidth = 0;\n      let boxHeight = 0;\n      let headerCells = [];\n      cells = cells.filter(function(cell) {\n          if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n              return false;\n          }\n          if (options.headerRows && cell.row < options.headerRows) {\n              headerCells.push(cell);\n          }\n          cell.left = xCoords[cell.col];\n          cell.top = yCoords[cell.row];\n          if (cell.merged) {\n              if (!options.forScreen) {\n                  cell.right = orlast(xCoords, cell.col + cell.colspan);\n                  cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                  cell.width = cell.right - cell.left;\n                  cell.height = cell.bottom - cell.top;\n              } else {\n                  cell.right = cell.left + cell.width;\n                  cell.bottom = cell.top + cell.height;\n              }\n          } else {\n              cell.width = colWidths[cell.col];\n              cell.height = rowHeights[cell.row];\n              cell.bottom = cell.top + cell.height;\n              cell.right = cell.left + cell.width;\n          }\n          if (!options.forScreen) {\n              // page breaking will shift cell coordinates.  adjust\n              // anchored drawings.\n              cell.drawings.forEach(function(d) {\n                  let box = d.box;\n                  box.left = cell.left + d.drawing.offsetX;\n                  box.top = cell.top + d.drawing.offsetY;\n                  box.right = box.left + box.width;\n                  box.bottom = box.top + box.height;\n              });\n          }\n          boxWidth = Math.max(boxWidth, cell.right);\n          boxHeight = Math.max(boxHeight, cell.bottom);\n          return true;\n      });\n\n      // 3. if any merged cells remain in \"primary\", they start\n      //    outside the printed range and we should still display\n      //    them partially.\n      Object.keys(mergedCells.primary).forEach(function(id) {\n          let ref = mergedCells.primary[id];\n          sheet.forEach(ref.topLeft.toRangeRef(), function(row, col, cell) {\n              let relrow = row - range.topLeft.row;\n              let relcol = col - range.topLeft.col;\n              cell.merged = true;\n              cell.colspan = ref.width();\n              cell.rowspan = ref.height();\n              if (relrow < 0) {\n                  cell.top = -sheet._rows.sum(row, row - relrow - 1);\n              } else {\n                  cell.top = yCoords[relrow];\n              }\n              if (relcol < 0) {\n                  cell.left = -sheet._columns.sum(col, col - relcol - 1);\n              } else {\n                  cell.left = xCoords[relcol];\n              }\n              cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n              cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n              if (cell.height > 0 && cell.width > 0) {\n                  // zero means a fully hidden merged cell (all rows/columns are hidden)\n                  // https://github.com/telerik/kendo-ui-core/issues/1794\n                  cell.right = cell.left + cell.width;\n                  cell.bottom = cell.top + cell.height;\n                  cell.row = relrow;\n                  cell.col = relcol;\n                  cells.push(cell);\n              }\n          });\n      });\n\n      // 4. replicate header rows on all pages\n      if (options.headerRows) {\n          hyCoords.forEach(function(y) {\n              headerCells.forEach(function(cell) {\n                  cell = clone(cell);\n                  cell.top += y;\n                  cell.bottom = cell.top + cell.height;\n                  cells.push(cell);\n              });\n              yCoords.push(y);\n          });\n          yCoords.sort(orderCoords);\n      }\n\n      return {\n          width    : boxWidth,\n          height   : boxHeight,\n          cells    : cells.sort(orderCells),\n          scale    : scaleFactor,\n          xCoords  : xCoords,\n          yCoords  : yCoords,\n          drawings : drawings\n      };\n  }\n\n  function clone(hash, target) {\n      if (!target) {\n          target = {};\n      }\n      if (Object.assign) {\n          return Object.assign(target, hash);\n      }\n      return Object.keys(hash).reduce(function(copy, key) {\n          copy[key] = hash[key];\n          return copy;\n      }, target);\n  }\n\n  function sameBorder(a, b) {\n      return a.size === b.size && a.color === b.color;\n  }\n\n  function sum(a, b) {\n      return a + b;\n  }\n\n  function orlast(a, i) {\n      return i < a.length ? a[i] : a[a.length - 1];\n  }\n\n  function shouldDrawCell(cell) {\n      return cell.value != null\n          || cell.merged\n          || cell.background != null\n          || cell.borderRight != null\n          || cell.borderBottom != null\n          || cell.dBorders != null\n          || (cell.validation != null && !cell.validation.value)\n          || (cell.drawings && cell.drawings.length);\n  }\n\n  function orderCells(a, b) {\n      if (a.top < b.top) {\n          return -1;\n      } else if (a.top == b.top) {\n          if (a.left < b.left) {\n              return -1;\n          } else if (a.left == b.left) {\n              return 0;\n          } else {\n              return 1;\n          }\n      } else {\n          return 1;\n      }\n  }\n\n  function orderCoords(a, b) {\n      return a < b ? -1 : a > b ? 1 : 0;\n  }\n\n  function drawLayout(sheet, layout, group, options) {\n      // options:\n      // - pageWidth\n      // - pageHeight\n      // - fitWidth\n      // - hCenter\n      // - vCenter\n      let ncols = Math.ceil(layout.width / options.pageWidth);\n      let nrows = Math.ceil(layout.height / options.pageHeight);\n      let pageWidth = Math.ceil(options.pageWidth / layout.scale);\n      let pageHeight = Math.ceil(options.pageHeight / layout.scale);\n\n      for (let j = 0; j < nrows; ++j) {\n          for (let i = 0; i < ncols; ++i) {\n              addPage(j, i);\n          }\n      }\n\n      function addPage(row, col) {\n          let left = col * pageWidth;\n          let right = left + pageWidth;\n          let top = row * pageHeight;\n          let bottom = top + pageHeight;\n          let endbottom = 0, endright = 0;\n\n          function isInside(box) {\n              if (box.right <= left || box.left >= right ||\n                  box.bottom <= top || box.top >= bottom) {\n                  return false;\n              }\n              endbottom = Math.max(box.bottom, endbottom);\n              endright = Math.max(box.right, endright);\n              return true;\n          }\n\n          // XXX: this can be optimized - discard cells that won't\n          // be used again, and don't walk cells that stand no\n          // chance to fit.\n          let cells = layout.cells.filter(isInside);\n\n          let drawings = layout.drawings.filter(function(d) {\n              return isInside(d.box);\n          });\n\n          // merged cells might stretch beyond page; limit to that\n          endbottom = Math.min(endbottom, bottom);\n          endright = Math.min(endright, right);\n\n          if (cells.length || drawings.length) {\n              let page = new kendo_drawing_cmn_chunk_js.G();\n              group.append(page);\n              // page.clip(drawing.Path.fromRect(\n              //     new geometry.Rect([ 0, 0 ],\n              //                  [ options.pageWidth, options.pageHeight ])));\n\n              let content = new kendo_drawing_cmn_chunk_js.G();\n              page.append(content);\n\n              content.clip(kendo_drawing_cmn_chunk_js.b.fromRect(\n                  new kendo_drawing_cmn_chunk_js.R([ left - 1, top - 1 ], [ endright + 1, endbottom + 1 ])\n              ));\n\n              let matrix = kendo_drawing_cmn_chunk_js.M.scale(layout.scale, layout.scale)\n                  .multiplyCopy(kendo_drawing_cmn_chunk_js.M.translate(-left, -top));\n\n              if (options.hCenter || options.vCenter) {\n                  matrix = matrix.multiplyCopy(\n                      kendo_drawing_cmn_chunk_js.M.translate(\n                          options.hCenter ? (right - endright) / 2 : 0,\n                          options.vCenter ? (bottom - endbottom) / 2 : 0)\n                  );\n              }\n\n              content.transform(matrix);\n\n              if (options.guidelines) {\n                  let prev = null;\n                  layout.xCoords.forEach(function(x) {\n                      x = Math.min(x, endright);\n                      if (x !== prev && x >= left && x <= right) {\n                          prev = x;\n                          content.append(\n                              new kendo_drawing_cmn_chunk_js.b()\n                                  .moveTo(x, top)\n                                  .lineTo(x, endbottom)\n                                  .close()\n                                  .stroke(options.guideColor, GUIDELINE_WIDTH)\n                          );\n                      }\n                  });\n                  prev = null;\n                  layout.yCoords.forEach(function(y) {\n                      y = Math.min(y, endbottom);\n                      if (y !== prev && y >= top && y <= bottom) {\n                          prev = y;\n                          content.append(\n                              new kendo_drawing_cmn_chunk_js.b()\n                                  .moveTo(left, y)\n                                  .lineTo(endright, y)\n                                  .close()\n                                  .stroke(options.guideColor, GUIDELINE_WIDTH)\n                          );\n                      }\n                  });\n              }\n\n              let borders = Borders();\n              cells.forEach(function(cell) {\n                  drawCell$1(cell, content, options);\n                  borders.add(cell, sheet);\n              });\n\n              let bordersGroup = new kendo_drawing_cmn_chunk_js.G();\n              borders.vert.forEach(function(a) {\n                  a.forEach(function(b) {\n                      if (!b.rendered) {\n                          b.rendered = true;\n                          bordersGroup.append(\n                              new kendo_drawing_cmn_chunk_js.b()\n                                  .moveTo(b.x, b.top)\n                                  .lineTo(b.x, b.bottom)\n                                  .close()\n                                  .stroke(b.color, b.size)\n                          );\n                      }\n                  });\n              });\n              borders.horiz.forEach(function(a) {\n                  a.forEach(function(b) {\n                      if (!b.rendered) {\n                          b.rendered = true;\n                          bordersGroup.append(\n                              new kendo_drawing_cmn_chunk_js.b()\n                                  .moveTo(b.left, b.y)\n                                  .lineTo(b.right, b.y)\n                                  .close()\n                                  .stroke(b.color, b.size)\n                          );\n                      }\n                  });\n              });\n              content.append(bordersGroup);\n\n              drawings.forEach(function(d) {\n                  let drawing = d.drawing;\n                  let image = drawing.image;\n                  if (image != null) {\n                      let box = d.box;\n                      let url = sheet._workbook.imageUrl(image);\n                      content.append(\n                          new drawing.Image(url, new kendo_drawing_cmn_chunk_js.R(\n                              [ box.left, box.top ],\n                              [ box.width, box.height ]\n                          )).opacity(drawing.opacity)\n                      );\n                  }\n              });\n          }\n      }\n  }\n\n  function drawCell$1(cell, content, options) {\n      let g = new kendo_drawing_cmn_chunk_js.G();\n      content.append(g);\n      let rect = new kendo_drawing_cmn_chunk_js.R([ cell.left, cell.top ],\n                              [ cell.width, cell.height ]);\n      if (cell.background || cell.merged) {\n          let r2d2 = rect;\n          if (options.guidelines) {\n              r2d2 = rect.clone();\n              r2d2.origin.x += GUIDELINE_WIDTH / 2 + 0.1;\n              r2d2.origin.y += GUIDELINE_WIDTH / 2 + 0.1;\n              r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n              r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n          }\n          g.append(\n              new kendo_drawing_cmn_chunk_js.B(r2d2)\n                  .fill(cell.background || \"#fff\")\n                  .stroke(null)\n          );\n      }\n      if (cell.dBorders) {\n          if (cell.dBorders.type & 2) {\n              g.append(\n                  new kendo_drawing_cmn_chunk_js.b()\n                      .moveTo(cell.left, cell.bottom)\n                      .lineTo(cell.right, cell.top)\n                      .stroke(cell.dBorders.color, cell.dBorders.size)\n              );\n          }\n          if (cell.dBorders.type & 1) {\n              g.append(\n                  new kendo_drawing_cmn_chunk_js.b()\n                      .moveTo(cell.left, cell.top)\n                      .lineTo(cell.right, cell.bottom)\n                      .stroke(cell.dBorders.color, cell.dBorders.size)\n              );\n          }\n      }\n      let val = cell.value;\n      if (val != null) {\n          let type = typeof val == \"number\" ? \"number\" : null;\n          let clip = new kendo_drawing_cmn_chunk_js.G();\n          clip.clip(kendo_drawing_cmn_chunk_js.b.fromRect(rect));\n          g.append(clip);\n          let f, format = cell.format;\n          if (!format && type == \"number\" && val != Math.floor(val)) {\n              format = \"0.##############\";\n          }\n          if (format) {\n              f = formatting.textAndColor(val, format);\n              val = f.text;\n              if (f.type) {\n                  type = f.type;\n              }\n          } else {\n              val += \"\";\n          }\n          if (!cell.textAlign) {\n              switch (type) {\n              case \"number\":\n              case \"date\":\n              case \"percent\":\n              case \"currency\":\n                  cell.textAlign = \"right\";\n                  break;\n              case \"boolean\":\n                  cell.textAlign = \"center\";\n                  break;\n              }\n          }\n          drawText(val, (f && f.color) || cell.color || \"#000\", cell, clip);\n      }\n  }\n\n  function applyIndent(cell, style) {\n      if (cell.indent) {\n          // OOXML spec states the indent is \"An integer value,\n          // where an increment of 1 represents 3 spaces\".  This, of\n          // course, bears no resemblance to what Excel actually\n          // does, so we need magic numbers here.\n          let indent = 1.4 * cell.indent;\n          switch (style.textAlign) {\n          case null:\n          case \"left\":\n              style.paddingLeft = indent + \"ch\";\n              break;\n          case \"right\":\n              style.paddingRight = indent + \"ch\";\n              break;\n          case \"center\":\n              style.paddingLeft = indent / 2 + \"ch\";\n              style.paddingRight = indent / 2 + \"ch\";\n              break;\n          }\n      }\n  }\n\n  let CONT;\n  function drawText(text, color, cell, group) {\n      if (!CONT) {\n          CONT = document.createElement(\"div\");\n          CONT.style.position = \"fixed\";\n          CONT.style.left = \"0px\";\n          CONT.style.top = \"0px\";\n          CONT.style.visibility = \"hidden\";\n          CONT.style.overflow = \"hidden\";\n          CONT.style.boxSizing = \"border-box\";\n          CONT.style.lineHeight = \"normal\";\n          document.body.appendChild(CONT);\n      }\n\n      if (CONT.firstChild) {\n          CONT.removeChild(CONT.firstChild);\n      }\n\n      CONT.style.padding = \"2px 4px\";\n      CONT.style.color = color;\n      CONT.style.font = makeFontDef(cell);\n      CONT.style.width = cell.width + \"px\";\n      CONT.style.textAlign = cell.textAlign || \"left\";\n      CONT.style.textDecoration = cell.underline ? \"underline\" : \"none\";\n\n      applyIndent(cell, CONT.style);\n\n      if (cell.wrap) {\n          CONT.style.whiteSpace = \"pre-wrap\";\n          CONT.style.overflowWrap = CONT.style.wordWrap = \"break-word\";\n      } else {\n          CONT.style.whiteSpace = \"pre\";\n          CONT.style.overflowWrap = CONT.style.wordWrap = \"normal\";\n      }\n\n      CONT.appendChild(document.createTextNode(text));\n\n      let vtrans = 0;\n      switch (cell.verticalAlign) {\n      case \"center\":\n          vtrans = (cell.height - CONT.offsetHeight) >> 1;\n          break;\n\n      case undefined:\n      case null:\n      case \"bottom\":\n          vtrans = (cell.height - CONT.offsetHeight);\n          break;\n      }\n      if (vtrans < 0) { vtrans = 0; }\n\n      let textGroup = kendo_drawing_cmn_chunk_js.D(CONT);\n      textGroup.transform(kendo_drawing_cmn_chunk_js.M.translate(cell.left, cell.top + vtrans));\n      group.append(textGroup);\n  }\n\n  function makeFontDef(cell) {\n      let font = [];\n      if (cell.italic) {\n          font.push(\"italic\");\n      }\n      if (cell.bold) {\n          font.push(\"bold\");\n      }\n      font.push((cell.fontSize || 12) + \"px\");\n      font.push((cell.fontFamily || \"Arial\"));\n      return font.join(\" \");\n  }\n\n  function drawFn(sheet, range, options, callback) {\n      if (options == null && callback == null) {\n          callback = range;\n          options = {};\n          range = SHEETREF;\n      }\n      if (callback == null) {\n          callback = options;\n          if (range instanceof Range\n              || range instanceof Ref\n              || typeof range == \"string\") {\n              options = {};\n          } else {\n              options = range;\n              range = SHEETREF;\n          }\n      }\n      options = Object.assign({ }, {\n          paperSize  : \"A4\",\n          landscape  : true,\n          margin     : \"1cm\",\n          guidelines : true,\n          guideColor : \"#aaa\",\n          emptyCells : true,\n          fitWidth   : false,\n          center     : false,\n          headerRows : null,\n          maxEmpty   : 0.2,\n          scale      : 1\n      }, options);\n      let group = new kendo_drawing_cmn_chunk_js.G();\n      let paper = getPaperOptions(options);\n      group.options.set(\"pdf\", {\n          author    : options.author,\n          creator   : options.creator,\n          date      : options.date,\n          keywords  : options.keywords,\n          margin    : paper.margin,\n          multiPage : true,\n          paperSize : paper.paperSize,\n          subject   : options.subject,\n          title     : options.title,\n          autoPrint : options.autoPrint\n      });\n      let pageWidth = paper.paperSize[0];\n      let pageHeight = paper.paperSize[1];\n      if (paper.margin) {\n          pageWidth -= paper.margin.left + paper.margin.right + 1;\n          pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n      }\n      options.pageWidth = pageWidth;\n      options.pageHeight = pageHeight;\n      let layout = doLayout(sheet, sheet._ref(range), options);\n      drawLayout(sheet, layout, group, options);\n      callback(group);\n  }\n\n  Sheet.prototype.draw = function(range, options, callback) {\n      let sheet = this;\n      if (sheet._workbook) {\n          sheet.recalc(sheet._workbook._context, function() {\n              drawFn(sheet, range, options, callback);\n          });\n      } else {\n          drawFn(sheet, range, options, callback);\n      }\n  };\n\n  // Hack: since we index the border arrays by relative row/col we\n  // could end up with negative indexes, i.e. horiz[-2] = border.\n  // Array forEach will ignore these, so we provide a simple\n  // container here (outside code only needs forEach at this time).\n  function Container() {}\n  Container.prototype = {\n      forEach: function(f) {\n          Object.keys(this).forEach(function(key) {\n              f(this[key], key, this);\n          }, this);\n      }\n  };\n\n  function Borders() {\n      let horiz = new Container();\n      let vert = new Container();\n      function add(cell, sheet) {\n          if (sheet) {\n              // reset borders here; the propertybag doesn't keep track of merged cells :-/ this\n              // is ugly, but the inner details of data storage have leaked everywhere anyway.\n              let pb = sheet._properties;\n              let grid = sheet._grid;\n              cell.borderLeft = pb.get(\"vBorders\", grid.index(cell.row, cell.col));\n              cell.borderRight = pb.get(\"vBorders\", grid.index(cell.row, cell.col + cell.colspan));\n              cell.borderTop = pb.get(\"hBorders\", grid.index(cell.row, cell.col));\n              cell.borderBottom = pb.get(\"hBorders\", grid.index(cell.row + cell.rowspan, cell.col));\n          }\n          if (cell.borderLeft) {\n              addVert(cell.row, cell.col, cell.borderLeft,\n                      cell.left, cell.top, cell.bottom);\n          }\n          if (cell.borderRight) {\n              addVert(cell.row, cell.col + cell.colspan, cell.borderRight,\n                      cell.right, cell.top, cell.bottom);\n          }\n          if (cell.borderTop) {\n              addHoriz(cell.row, cell.col, cell.borderTop,\n                          cell.top, cell.left, cell.right);\n          }\n          if (cell.borderBottom) {\n              addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom,\n                          cell.bottom, cell.left, cell.right);\n          }\n      }\n      function addVert(row, col, border, x, top, bottom) {\n          let a = vert[col] || (vert[col] = new Container());\n          let prev = row > 0 && a[row - 1];\n          if (prev && sameBorder(prev, border)) {\n              a[row] = prev;\n              prev.bottom = bottom;\n          } else {\n              a[row] = {\n                  size: border.size,\n                  color: border.color || \"#000\",\n                  x: x,\n                  top: top,\n                  bottom: bottom\n              };\n          }\n      }\n      function addHoriz(row, col, border, y, left, right) {\n          let a = horiz[row] || (horiz[row] = new Container());\n          let prev = col > 0 && a[col - 1];\n          if (prev && sameBorder(prev, border)) {\n              a[col] = prev;\n              prev.right = right;\n          } else {\n              a[col] = {\n                  size: border.size,\n                  color: border.color || \"#000\",\n                  y: y,\n                  left: left,\n                  right: right\n              };\n          }\n      }\n      return { add: add, horiz: horiz, vert: vert };\n  }\n\n  // export function drawTabularData(options) {\n      // let progress = new $.Deferred();\n      // let promise = progress.promise();\n\n      // options = clone(options, {\n      //     dataSource       : null,\n      //     guidelines       : true,\n      //     guideColor       : \"#000\",\n      //     columns          : null,\n      //     headerBackground : \"#999\",\n      //     headerColor      : \"#000\",\n      //     oddBackground    : null,\n      //     evenBackground   : null,\n      //     fontFamily       : \"Arial\",\n      //     fontSize         : 12,\n      //     paperSize        : \"A4\",\n      //     margin           : \"1cm\",\n      //     landscape        : true,\n      //     fitWidth         : false,\n      //     scale            : 1,\n      //     rowHeight        : 20,\n      //     maxEmpty         : 1,\n      //     useGridFormat    : true\n      // });\n\n      // // retrieve fonts; custom fonts should be already loaded\n      // pdf.defineFont(\n      //     getFontFaces(document)\n      // );\n\n      // let charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n      // function textWidth(value) {\n      //     if (value != null) {\n      //         let width = 12;         // magic numbers :-/\n      //         for (let i = value.length; --i >= 0;) {\n      //             width += charWidth(value.charAt(i));\n      //         }\n      //         return width;\n      //     }\n      //     return 0;\n      // }\n\n      // let border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n      // function mkCell(data) {\n      //     if (!border) {\n      //         return data;\n      //     }\n      //     return clone(data, {\n      //         borderLeft: border,\n      //         borderTop: border,\n      //         borderRight: border,\n      //         borderBottom: border\n      //     });\n      // }\n\n      // options.dataSource.fetch(function() {\n      //     let data = options.dataSource.data();\n      //     if (!data.length) {\n      //         return progress.reject(\"Empty dataset\");\n      //     }\n\n      //     // this really must be present\n      //     let columns = options.columns.map(function(col) {\n      //         if (typeof col == \"string\") {\n      //             return { title: col, field: col };\n      //         } else {\n      //             return col;\n      //         }\n      //     });\n      //     let columnTitles = columns.map(function(col) {\n      //         return col.title || col.field;\n      //     });\n      //     let columnWidths = columnTitles.map(textWidth);\n\n      //     // prepare data for a Sheet object's fromJSON method\n      //     let rows = data.map(function(row, rowIndex) {\n      //         return {\n      //             cells: columns.map(function(col, colIndex) {\n      //                 let value = row[col.field];\n\n      //                 // NOTE: value might not be string.  I added option useGridFormat (default\n      //                 // true), which will use a column's format, if present, to convert the value\n      //                 // to a string, so that we can measure the width right now.\n      //                 if (options.useGridFormat) {\n      //                     if (value != null) {\n      //                         if (col.format) {\n      //                             value = intl().format(col.format, value);\n      //                         } else {\n      //                             value += \"\";\n      //                         }\n      //                     }\n      //                     // adjust the column widths while we're at it\n      //                     columnWidths[colIndex] = Math.max(\n      //                         textWidth(value),\n      //                         columnWidths[colIndex]\n      //                     );\n      //                 }\n\n      //                 // if options.useGridFormat is false and col.format is present, pass it over\n      //                 // to the spreadsheet.  In that case we should calculate the widths after\n      //                 // the spreadsheet is created (XXX to be implemented when someone needs it).\n      //                 return mkCell({\n      //                     value: value,\n      //                     format: options.useGridFormat ? null : col.format,\n      //                     background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n      //                 });\n      //             })\n      //         };\n      //     });\n\n      //     // insert header line\n      //     rows.unshift({\n      //         cells: columnTitles.map(function(label) {\n      //             return mkCell({\n      //                 value: label,\n      //                 background: options.headerBackground,\n      //                 color: options.headerColor\n      //             });\n      //         })\n      //     });\n\n      //     // init a Sheet object.  Note that we have to add one\n      //     // extra-row and column, because the very last ones can't\n      //     // have right/bottom borders (known limitation).\n      //     let sheet = new Sheet(\n      //         rows.length + 1,        // rows\n      //         columns.length + 1,     // columns\n      //         options.rowHeight,      // row height\n      //         50,                     // column width\n      //         20,                     // header height\n      //         20,                     // header width,\n      //         {                       // default cell style\n      //             fontFamily: options.fontFamily,\n      //             fontSize: options.fontSize,\n      //             verticalAlign: \"center\"\n      //         }\n      //     );\n\n      //     // load data\n      //     sheet.fromJSON({\n      //         name: \"Sheet1\",\n      //         rows: rows,\n      //         columns: columnWidths.map(function(w, i) {\n      //             return { index: i, width: w };\n      //         })\n      //     });\n\n      //     sheet.draw({\n      //         paperSize  : options.paperSize,\n      //         landscape  : options.landscape,\n      //         margin     : options.margin,\n      //         guidelines : false, // using borders instead (better contrast)\n      //         scale      : options.scale,\n      //         fitWidth   : options.fitWidth,\n      //         maxEmpty   : options.maxEmpty,\n      //         headerRows : 1\n      //     }, progress.resolve.bind(progress));\n      // });\n\n      // return promise;\n  // }\n\n  // let CACHE_CHAR_WIDTH = {};\n\n  // let charWidthFunction = function(fontFamily, fontSize) {\n  //     let id = fontSize + \":\" + fontFamily;\n  //     let func = CACHE_CHAR_WIDTH[id];\n  //     if (!func) {\n  //         let span, div = document.createElement(\"div\");\n  //         div.style.position = \"fixed\";\n  //         div.style.left = \"-10000px\";\n  //         div.style.top = \"-10000px\";\n  //         div.style.fontFamily = fontFamily;\n  //         div.style.fontSize = fontSize + \"px\";\n  //         div.style.whiteSpace = \"pre\";\n  //         for (let i = 32; i < 128; ++i) {\n  //             span = document.createElement(\"span\");\n  //             span.appendChild(document.createTextNode(String.fromCharCode(i)));\n  //             div.appendChild(span);\n  //         }\n  //         document.body.appendChild(div);\n  //         let widths = {};\n  //         for (let i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n  //             widths[i] = span.offsetWidth;\n  //         }\n  //         while ((span = div.firstChild)) {\n  //             div.removeChild(span);\n  //         }\n  //         func = CACHE_CHAR_WIDTH[id] = function(ch) {\n  //             let code = ch.charCodeAt(0);\n  //             let width = widths[code];\n  //             if (width == null) {\n  //                 // probably not an ASCII character, let's cache its width as well\n  //                 span = document.createElement(\"span\");\n  //                 span.appendChild(document.createTextNode(String.fromCharCode(code)));\n  //                 div.appendChild(span);\n  //                 width = widths[code] = span.offsetWidth;\n  //                 div.removeChild(span);\n  //             }\n  //             return width;\n  //         };\n  //     }\n  //     return func;\n  // };\n\n  // spreadsheet.draw = {\n  //     Borders         : Borders,\n  //     doLayout        : doLayout,\n  //     applyIndent     : applyIndent\n  // };\n\n  const draw = { Borders, doLayout, applyIndent };\n\n  // spreadsheet.drawTabularData = drawTabularData;\n\n  const RESIZE_HANDLE_WIDTH = 7;\n  const EDIT_BUTTON_WIDTH = 20;\n  const DOT = \".\";\n\n  const viewClassNames = {\n      view: \"k-spreadsheet-view\",\n      fixedContainer: \"k-spreadsheet-fixed-container\",\n      editContainer: \"k-spreadsheet-edit-container\",\n      scroller: \"k-spreadsheet-scroller\",\n      viewSize: \"k-spreadsheet-view-size\",\n      clipboard: \"k-spreadsheet-clipboard\",\n      cellEditor: \"k-spreadsheet-cell-editor\",\n      barEditor: \"k-spreadsheet-editor\",\n      topCorner: \"k-spreadsheet-top-corner\",\n      filterHeadersWrapper: \"k-filter-wrapper\",\n      filterRange: \"k-filter-range\",\n      filterButton: \"k-spreadsheet-filter\",\n      filterButtonSelected: \"k-selected\",\n      horizontalResize: \"k-horizontal-resize\",\n      verticalResize: \"k-vertical-resize\",\n      icon: \"k-icon\",\n      iconFilterDefault: \"k-i-caret-alt-down\",\n      sheetsBar: \"k-spreadsheet-sheets-bar\",\n      sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n      sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n      cellContextMenu: \"k-spreadsheet-cell-context-menu\",\n      rowHeaderContextMenu: \"k-spreadsheet-row-header-context-menu\",\n      colHeaderContextMenu: \"k-spreadsheet-col-header-context-menu\",\n      drawingContextMenu: \"k-spreadsheet-drawing-context-menu\"\n  };\n\n  const paneClassNames = {\n      cell: \"k-spreadsheet-cell\",\n      vaxis: \"k-spreadsheet-vaxis\",\n      haxis: \"k-spreadsheet-haxis\",\n      vborder: \"k-spreadsheet-vborder\",\n      hborder: \"k-spreadsheet-hborder\",\n      rowHeader: \"k-spreadsheet-row-header\",\n      columnHeader: \"k-spreadsheet-column-header\",\n      pane: \"k-spreadsheet-pane\",\n      data: \"k-spreadsheet-data\",\n      mergedCell: \"k-spreadsheet-merged-cell\",\n      mergedCellsWrapper: \"k-merged-cells-wrapper\",\n      activeCell: \"k-spreadsheet-active-cell\",\n      selection: \"k-spreadsheet-selection\",\n      selectionWrapper: \"k-selection-wrapper\",\n      autoFillWrapper: \"k-auto-fill-wrapper\",\n      single: \"k-single\",\n      top: \"k-top\",\n      right: \"k-right\",\n      bottom: \"k-bottom\",\n      left: \"k-left\",\n      resizeHandle: \"k-resize-handle\",\n      columnResizeHandle: \"k-column-resize-handle\",\n      rowResizeHandle: \"k-row-resize-handle\",\n      resizeHint: \"k-resize-hint\",\n      resizeHintHandle: \"k-resize-hint-handle\",\n      resizeHintMarker: \"k-resize-hint-marker\",\n      resizeHintVertical: \"k-resize-hint-vertical\",\n      selectionHighlight: \"k-spreadsheet-selection-highlight\",\n      series: [\n          \"k-series-a\",\n          \"k-series-b\",\n          \"k-series-c\",\n          \"k-series-d\",\n          \"k-series-e\",\n          \"k-series-f\"\n      ]\n  };\n\n  /* eslint-disable complexity */\n\n\n  function cellBorder(value) {\n      return (value.size || 1) + \"px solid \" + (value.color || \"#000\");\n  }\n\n  function asURL(link) {\n      if (!/:\\/\\//.test(link)) {\n          link = \"http://\" + link;\n      }\n      return link;\n  }\n\n  function drawCell(collection, cell, cls, showGrid) {\n      function maybeLink(el) {\n          let link = cell.link;\n          if (!link) {\n              if (typeof cell.value == \"object\") {\n                  link = cell.value.link;\n              }\n          }\n          if (link) {\n              let style = {\n                  textDecoration: \"none\"\n              };\n              if (cell.color) {\n                  style.color = cell.color;\n              }\n              if (cell.underline) {\n                  style.textDecoration = \"underline\";\n              }\n              return dom.element(\"a\", {\n                  href   : asURL(link),\n                  style  : style,\n                  target : \"_blank\" // XXX: customizable?\n              }, el ? [ el ] : []);\n          }\n          return el;\n      }\n\n      let shouldDraw = (cell.value != null || (cell.validation != null && !cell.validation.value) || // jshint ignore:line\n                          cell.background || cell.merged || cell.comment || cell.dBorders);\n      if (!cls && !shouldDraw) {\n          return;\n      }\n\n      let style = { background: [] };\n      let background = cell.background;\n      if (background) {\n          let defaultBorder = background;\n          if (showGrid) {\n              // darken\n              defaultBorder = kendo_drawing_cmn_chunk_js.q(defaultBorder).toHSV();\n              defaultBorder.v *= 0.9;\n              defaultBorder = defaultBorder.toCssRgba();\n          }\n          defaultBorder = cellBorder({ color: defaultBorder });\n          style.outline = defaultBorder;\n      }\n\n      if (cell.dBorders) {\n          if (cell.dBorders.type & 2) {\n              style.background.push(\"linear-gradient(to top left, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                      cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                      cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n          }\n          if (cell.dBorders.type & 1) {\n              style.background.push(\"linear-gradient(to top right, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                      cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                      cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n          }\n      }\n\n      if (background) {\n          style.background.push(background);\n      }\n\n      if (cell.color) {\n          style.color = cell.color;\n      }\n\n      if (cell.fontFamily) {\n          style.fontFamily = cell.fontFamily;\n      }\n\n      if (cell.underline) {\n          style.textDecoration = \"underline\";\n      }\n\n      if (cell.italic) {\n          style.fontStyle = \"italic\";\n      }\n\n      if (cell.textAlign) {\n          style.textAlign = cell.textAlign;\n      }\n\n      if (cell.bold) {\n          style.fontWeight = \"bold\";\n      }\n\n      if (cell.fontSize) {\n          style.fontSize = cell.fontSize + \"px\";\n      }\n\n      if (cell.wrap === true) {\n          style.whiteSpace = \"pre-wrap\";\n          style.overflowWrap = \"break-word\";\n          style.wordWrap = \"break-word\";\n      } else {\n          style.whiteSpace = \"pre\";\n          style.overflowWrap = \"normal\";\n          style.wordWrap = \"normal\";\n      }\n\n      style.left = (cell.left + 1) + \"px\";\n      style.top = (cell.top + 1) + \"px\";\n      style.width = (cell.width - 1) + \"px\";\n      style.height = (cell.height - 1) + \"px\";\n\n      let data = cell.value, type = typeof data, format = cell.format;\n      if (!format && type === \"number\" && data !== Math.floor(data)) {\n          format = \"0.##############\";\n      }\n      if (format && data != null) {\n          data = formatting.format(data, format);\n          if (data.__dataType) {\n              type = data.__dataType;\n          }\n      } else if (data != null) {\n          if (cell.html) {\n              data = dom.html(data);\n          } else {\n              data = dom.text(data);\n          }\n      }\n\n      if (!style.textAlign) {\n          switch (type) {\n          case \"number\":\n          case \"date\":\n          case \"percent\":\n          case \"currency\":\n              style.textAlign = \"right\";\n              break;\n          case \"boolean\":\n              style.textAlign = \"center\";\n              break;\n          }\n      }\n\n      // defined in print.js\n      draw.applyIndent(cell, style);\n\n      let classNames = [ paneClassNames.cell ];\n\n      if (cls) {\n          classNames.push(cls);\n      }\n      if (cell.enable === false) {\n          classNames.push(\"k-disabled\");\n      }\n      if (cell.merged) {\n          classNames.push(\"k-spreadsheet-merged-cell\");\n          if (!cell.enable) {\n              collection.push(dom.element(\"div\", {\n                  className: \"k-spreadsheet-disabled-mask\",\n                  style: {\n                      left: (cell.left + 1) + \"px\",\n                      top: (cell.top + 1) + \"px\",\n                      width: (cell.width - 1) + \"px\",\n                      height: (cell.height - 1) + \"px\"\n                  }\n              }));\n          }\n      }\n      if (cell.comment) {\n          classNames.push(\"k-spreadsheet-has-comment\");\n      }\n\n      let verticalAlign = cell.verticalAlign || \"bottom\";\n\n      if (verticalAlign && data) {\n          data = dom.element(\"div\", { className: \"k-vertical-align-\" + verticalAlign }, [ maybeLink(data) ]);\n      } else {\n          data = maybeLink(data);\n      }\n\n      if (style.background.length) {\n          style.background = style.background.join(\",\");\n      } else {\n          delete style.background;\n      }\n\n      let children = data ? [ data ] : [];\n      let properties = {\n          style: style\n      };\n      let validation = cell.validation;\n      if (validation && !validation.value) {\n          children.push(dom.element(\"span\", { className: \"k-dirty\" }));\n          classNames.push(\"k-dirty-cell\");\n\n          properties.title = validation.message;\n      }\n      properties.className = classNames.join(\" \");\n\n      let div = dom.element(\"div\", properties, children);\n      collection.push(div);\n      return div;\n  }\n\n  class Pane {\n      constructor(sheet, grid, getIconHTMLString) {\n          this._sheet = sheet;\n          this._grid = grid;\n          this.getIconHTMLString = getIconHTMLString;\n      }\n\n      refresh(width, height) {\n          this._grid.refresh(width, height);\n      }\n\n      isVisible(scrollLeft, scrollTop, ref) {\n          return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n      }\n\n      render(args) {\n          let scroller = args.scroller;\n          let scrollLeft = scroller.scrollLeft;\n          let scrollTop = scroller.scrollTop;\n\n          if (scrollTop < 0) {\n              scrollTop = 0;\n          }\n\n          if (scrollLeft < 0) {\n              scrollLeft = 0;\n          }\n\n          let classNames = Pane.classNames;\n          let sheet = this._sheet;\n          let grid = this._grid;\n          let view = grid.view(scrollLeft, scrollTop);\n          this._currentView = view;\n          this._currentRect = this._rectangle(view.ref);\n          this._selectedHeaders = sheet.selectedHeaders();\n\n          let children = [];\n\n          children.push(this.renderData(args));\n\n          if (!sheet._activeDrawing) {\n              children.push(this.renderSelection(scroller));\n          }\n\n          children.push(this.renderAutoFill());\n\n          children.push(this.renderEditorSelection());\n\n          children.push(this.renderFilterHeaders());\n\n          if (grid.hasRowHeader) {\n              let rowHeader = dom.element(\"div\", {\n                  className: classNames.rowHeader,\n                  style: {\n                      width: grid.headerWidth + \"px\",\n                      top: view.rowOffset + \"px\"\n                  }\n              });\n              children.push(rowHeader);\n              sheet.forEach(view.ref.leftColumn(), function(row) {\n                  if (!sheet.isHiddenRow(row)) {\n                      let text = row + 1, height = sheet.rowHeight(row);\n                      rowHeader.children.push(dom.element(\"div\", {\n                          className: this.headerClassName(row, \"row\"),\n                          style: {\n                              width: grid.headerWidth + \"px\",\n                              height: height + \"px\"\n                          }\n                      }, [ dom.element(\"div\", {\n                          className: \"k-vertical-align-center\"\n                      }, [ dom.text(text + \"\") ])]));\n                  }\n              }.bind(this));\n          }\n\n          if (grid.hasColumnHeader) {\n              let columnHeader = dom.element(\"div\", {\n                  className: classNames.columnHeader,\n                  style: {\n                      top: \"0px\",\n                      left: view.columnOffset + \"px\",\n                      width: this._currentRect.width + \"px\",\n                      height: grid.headerHeight + \"px\"\n                  }\n              });\n              children.push(columnHeader);\n              let left = 0;\n              sheet.forEach(view.ref.topRow(), function(row, col) {\n                  if (!sheet.isHiddenColumn(col)) {\n                      let text = Ref.display(null, Infinity, col),\n                          width = sheet.columnWidth(col);\n                      columnHeader.children.push(dom.element(\"div\", {\n                          className: this.headerClassName(col, \"col\"),\n                          style: {\n                              position: \"absolute\",\n                              left: left + \"px\",\n                              width: width + \"px\",\n                              height: grid.headerHeight + \"px\"\n                          }\n                      }, [ dom.element(\"div\", {\n                          className: \"k-vertical-align-center\"\n                      }, [ dom.text(text + \"\") ])]));\n                      left += width;\n                  }\n              }.bind(this));\n          }\n\n          if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n              if (!sheet.resizeHintPosition()) {\n                  this.renderResizeHandle(children);\n              }\n          }\n\n          let paneClasses = [classNames.pane];\n\n          if (grid.hasColumnHeader) {\n              paneClasses.push(classNames.top);\n          }\n\n          if (grid.hasRowHeader) {\n              paneClasses.push(classNames.left);\n          }\n\n          return dom.element(\"div\", {\n              style: grid.style,\n              className: paneClasses.join(\" \")\n          }, children);\n      }\n\n      headerClassName(index, type) {\n          let selectedHeaders = this._selectedHeaders;\n\n          let itemSelection;\n          let allHeaders;\n\n          if (type === \"row\") {\n              itemSelection = selectedHeaders.rows[index];\n              allHeaders = selectedHeaders.allRows;\n          } else {\n              itemSelection = selectedHeaders.cols[index];\n              allHeaders = selectedHeaders.allCols;\n          }\n\n          let className = itemSelection || (selectedHeaders.all ? \"full\" : (allHeaders ? \"partial\" : \"none\"));\n\n          if (className) {\n              className = \"k-selection-\" + className;\n          }\n\n          return className;\n      }\n\n      renderData(args) {\n          let sheet = this._sheet;\n          let view = this._currentView;\n          let cont = dom.element(\"div\", {\n              className: Pane.classNames.data,\n              style: {\n                  position: \"relative\",\n                  left: view.columnOffset + \"px\",\n                  top: view.rowOffset + \"px\"\n              }\n          });\n          let rect = this._currentRect;\n          let layout = draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n          let grid = this._grid;\n          let showGridLines = sheet._showGridLines;\n          if (showGridLines) {\n              // draw axis first\n              prev = null;\n              layout.xCoords.forEach(function(x) {\n                  if (x !== prev) {\n                      prev = x;\n                      cont.children.push(dom.element(\"div\", {\n                          className: paneClassNames.vaxis,\n                          style: {\n                              left: x + \"px\",\n                              height: rect.height + \"px\",\n                              borderColor: sheet.gridLinesColor()\n                          }\n                      }));\n                  }\n              });\n              prev = null;\n              layout.yCoords.forEach(function(y) {\n                  if (y !== prev) {\n                      prev = y;\n                      cont.children.push(dom.element(\"div\", {\n                          className: paneClassNames.haxis,\n                          style: {\n                              top: y + \"px\",\n                              width: rect.width + \"px\",\n                              borderColor: sheet.gridLinesColor()\n                          }\n                      }));\n                  }\n              });\n          }\n          let borders = draw.Borders();\n          let activeCellRange = sheet.activeCell().toRangeRef();\n          let activeCell = activeCellRange.topLeft;\n\n          layout.cells.forEach(function(cell) {\n              let cls = null;\n              let absRow = cell.row + view.ref.topLeft.row;\n              let absCol = cell.col + view.ref.topLeft.col;\n              if (sheet._activeDrawing) {\n                  let ref = sheet._activeDrawing.topLeftCell;\n                  if (ref && ref.row === absRow && ref.col === absCol) {\n                      cls = \"k-spreadsheet-drawing-anchor-cell\";\n                  }\n              } else if (absRow === activeCell.row && absCol === activeCell.col) {\n                  // active cell.  normally we enter here only once.\n                  cls = [\n                      Pane.classNames.activeCell\n                  ].concat(this._activeFormulaColor(),\n                              this._directionClasses(activeCellRange));\n                  if (sheet.singleCellSelection()) {\n                      cls.push(Pane.classNames.single);\n                  }\n                  cls = cls.join(\" \");\n              }\n              borders.add(cell);\n              drawCell(cont.children, cell, cls, showGridLines);\n              if (cell.comment && sheet._commentRef &&\n                  absRow === sheet._commentRef.row && absCol === sheet._commentRef.col) {\n                  let ttOffset = 4;\n                  let left = cell.right + grid.left + view.columnOffset + ttOffset;\n                  let style = { top: (cell.top + grid.top + view.rowOffset) + \"px\" };\n                  if (left + 200 > args.contentWidth) {\n                      style.right = (args.contentWidth - grid.left - cell.left - view.columnOffset + ttOffset) + \"px\";\n                  } else {\n                      style.left = left + \"px\";\n                  }\n                  let div = dom.element(\"div\", {\n                      className: \"k-tooltip k-spreadsheet-cell-comment\",\n                      style: style\n                  }, [ dom.text(cell.comment) ]);\n                  args.toplevelElements.push(div);\n              }\n          }, this);\n          borders.vert.forEach(function(a) {\n              a.forEach(function(b) {\n                  if (!b.rendered) {\n                      b.rendered = true;\n                      let style = {\n                          left        : b.x + \"px\",\n                          top         : b.top + \"px\",\n                          height      : (b.bottom - b.top + 1) + \"px\",\n                          borderWidth : b.size + \"px\",\n                          borderColor : b.color\n                      };\n                      if (b.size !== 1) {\n                          style.transform = \"translateX(-\" + (b.size - 1) / 2 + \"px)\";\n                      }\n                      cont.children.push(dom.element(\"div\", {\n                          className: paneClassNames.vborder,\n                          style: style\n                      }));\n                  }\n              });\n          });\n          borders.horiz.forEach(function(a) {\n              a.forEach(function(b) {\n                  if (!b.rendered) {\n                      b.rendered = true;\n                      let style = {\n                          top         : b.y + \"px\",\n                          left        : b.left + \"px\",\n                          width       : (b.right - b.left) + \"px\",\n                          borderWidth : b.size + \"px\",\n                          borderColor : b.color\n                      };\n                      if (b.size !== 1) {\n                          style.transform = \"translateY(-\" + (b.size - 1) / 2 + \"px)\";\n                      }\n                      cont.children.push(dom.element(\"div\", {\n                          className: paneClassNames.hborder,\n                          style: style\n                      }));\n                  }\n              });\n          });\n          this.renderDrawings(layout, cont.children);\n          return cont;\n      }\n\n      renderDrawings(layout, container) {\n          let sheet = this._sheet;\n          let workbook = sheet._workbook;\n          layout.drawings.forEach(function(d) {\n              let drawing = d.drawing;\n              let box = d.box;\n              let div = box.toDiv(\"k-spreadsheet-drawing\");\n              if (drawing.image) {\n                  div.children.push(dom.element(\"div\", {\n                      className: \"k-spreadsheet-drawing-image\",\n                      style: {\n                          backgroundImage: \"url('\" + workbook.imageUrl(drawing.image) + \"')\",\n                          opacity: drawing.opacity\n                      }\n                  }));\n              }\n              if (drawing === sheet._activeDrawing) {\n                  div.attr.className += \" k-spreadsheet-active-drawing\";\n                  drawingResizeHandles(div.children);\n              }\n              container.push(div);\n          });\n      }\n\n      renderResizeHandle(container) {\n          let sheet = this._sheet;\n          let ref = sheet.resizeHandlePosition();\n          let rectangle = this._rectangle(ref);\n          let classNames = [ Pane.classNames.resizeHandle ];\n\n          let style;\n          if (ref.col !== -Infinity) {\n              if (this._grid.rows._start > 0) {\n                  return;\n              }\n              style = {\n                  height: this._grid.headerHeight + \"px\",\n                  width: RESIZE_HANDLE_WIDTH + \"px\",\n                  left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + \"px\",\n                  top: \"0px\"\n              };\n              classNames.push(viewClassNames.horizontalResize);\n          } else {\n              if (this._grid.columns._start > 0) {\n                  return;\n              }\n              style = {\n                  height: RESIZE_HANDLE_WIDTH + \"px\",\n                  width: this._grid.headerWidth + \"px\",\n                  top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + \"px\",\n                  left: \"0px\"\n              };\n              classNames.push(viewClassNames.verticalResize);\n          }\n\n          container.push(dom.element(\"div\", {\n              className: classNames.join(\" \"),\n              style: style\n          }));\n      }\n\n      filterIconRect(rect) {\n          let BUTTON_SIZE = 16;\n          let BUTTON_OFFSET = 3;\n\n          return new Rectangle(\n              rect.right - BUTTON_SIZE - BUTTON_OFFSET,\n              rect.top + BUTTON_OFFSET,\n              BUTTON_SIZE,\n              BUTTON_SIZE\n          );\n      }\n\n      icon(className) {\n          if (typeof this.getIconHTMLString === \"function\") {\n              return dom.element(this.getIconHTMLString(className));\n          }\n\n          return dom.element(\"span\", {\n              className: viewClassNames.icon + \" \" + className\n          });\n      }\n\n      renderFilterHeaders() {\n          let pane = this;\n          let sheet = this._sheet;\n          let children = [];\n          let classNames = viewClassNames;\n          let filter = sheet.filter();\n\n          function filterButton(classNames, position, index) {\n              let style = {\n                  left: position.left + \"px\",\n                  top: position.top + \"px\"\n              };\n              let filtered = filter && filter.columns.some(function(c) {\n                  return c.index === index;\n              });\n              let classes = classNames.filterButton;\n\n              if (filtered) {\n                  classes += \" \" + classNames.filterButtonSelected;\n              }\n\n              let button = dom.element(\n                  \"span\",\n                  { className: classes, style: style },\n                  [ pane.icon(classNames.iconFilterDefault) ]\n              );\n\n              return button;\n          }\n\n          if (filter) {\n              this._addDiv(children, filter.ref, classNames.filterRange);\n          }\n\n          sheet.forEachFilterHeader(this._currentView.ref, function(ref) {\n              let rect = this._rectangle(ref);\n              let position = this.filterIconRect(rect);\n              let column = this._sheet.filterColumn(ref);\n              let button = filterButton(classNames, position, column);\n\n              children.push(button);\n          }.bind(this));\n\n          return dom.element(\"div\", {\n              className: classNames.filterHeadersWrapper\n          }, children);\n\n      }\n\n      renderEditorSelection() {\n          let classNames = Pane.classNames;\n          let sheet = this._sheet;\n          let selections = [];\n\n          sheet._formulaSelections.forEach(function(range) {\n              let ref = range.ref;\n\n              if (ref === NULLREF) {\n                  return;\n              }\n\n              this._addDiv(selections, ref, classNames.selectionHighlight + \" \" + range.colorClass);\n          }.bind(this));\n\n          return dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n\n      }\n\n      renderSelection(scroller) {\n          let classNames = Pane.classNames;\n          let selections = [];\n          let selectionClasses = [classNames.selection];\n          let sheet = this._sheet;\n          let activeCell = sheet.activeCell().toRangeRef();\n          let selection = sheet.select();\n\n          selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n\n          if (selection.size() === 1) {\n              selectionClasses.push(\"k-single-selection\");\n          }\n\n          if (this._sheet.autoFillPunch()) {\n              selectionClasses.push(\"k-dim-auto-fill-handle\");\n          }\n\n          selection.forEach(function(ref) {\n              if (ref !== NULLREF) {\n                  this._addDiv(selections, ref, selectionClasses.join(\" \"));\n              }\n          }.bind(this));\n\n          this._renderCustomEditorButton(selections, activeCell, scroller);\n\n          return dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n      }\n\n      renderAutoFill() {\n          let autoFillRectangle = [];\n\n          if (this._sheet.autoFillInProgress()) {\n              let autoFillRef = this._sheet.autoFillRef();\n              let punch = this._sheet.autoFillPunch();\n              let direction = this._sheet._autoFillDirection;\n\n              this._addDiv(autoFillRectangle, autoFillRef, \"k-auto-fill\");\n\n              if (punch) { // collapsing, add overlay\n                  this._addDiv(autoFillRectangle, punch, \"k-auto-fill-punch\");\n              } else if (direction !== undefined) { // expanding - add hint\n                  let ref, cssClass;\n\n                  switch (direction) {\n                  case 0:\n                      ref = autoFillRef.bottomRight;\n                      cssClass = \"k-auto-fill-br-hint\";\n                      break;\n                  case 1:\n                      ref = autoFillRef.bottomRight;\n                      cssClass = \"k-auto-fill-br-hint\";\n                      break;\n                  case 2:\n                      ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                      cssClass = \"k-auto-fill-tr-hint\";\n                      break;\n                  case 3:\n                      ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                      cssClass = \"k-auto-fill-bl-hint\";\n                      break;\n                  }\n\n                  let rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                  if (rectangle) {\n                      let hint = dom.element(\"span\", { className: \"k-tooltip\" }, [ dom.text(this._sheet._autoFillHint) ]);\n                      rectangle.children.push(hint);\n                  }\n              }\n          }\n\n          return dom.element(\"div\", { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n      }\n\n      _addDiv(collection, ref, className) {\n          let view = this._currentView, div;\n\n          if (view.ref.intersects(ref)) {\n              div = this._rectangle(ref).resize(1, 1).toDiv(className);\n              collection.push(div);\n          }\n          return div;\n      }\n\n      _renderCustomEditorButton(collection, ref, scroller) {\n          let self = this;\n          let sheet = self._sheet;\n          let view = self._currentView;\n          let columnCount = self._grid.columns._axis._count;\n          let ed = sheet.activeCellCustomEditor();\n\n          if (ed && view.ref.intersects(ref)) {\n              let rectangle = self._rectangle(ref);\n              sheet.forEach(ref.collapse(), function(row, col, cell) {\n                  cell.left = rectangle.left;\n                  cell.top = rectangle.top;\n                  cell.width = rectangle.width;\n                  cell.height = rectangle.height;\n\n                  let btnClass = \"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button\";\n                  let isLastColumn = col === columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                  if (isLastColumn) {\n                      btnClass += \" k-spreadsheet-last-column\";\n                  }\n                  self._editorInLastColumn = isLastColumn;\n                  let btn = dom.element(\"div\", {\n                      className: btnClass,\n                      style: {\n                          left   : (cell.left + (isLastColumn ? 0 : cell.width)) + \"px\",\n                          top    : cell.top + \"px\",\n                          height : cell.height + \"px\"\n                      }\n                  });\n\n                  if (ed.icon) {\n                      btn.children.push(self.icon(ed.icon));\n                  }\n\n                  collection.push(btn);\n              });\n          }\n      }\n\n      _activeFormulaColor() {\n          let activeFormulaSelection;\n          let colorClasses = [];\n\n          if (this._sheet.isInEditMode()) {\n              activeFormulaSelection = this._sheet._formulaSelections.filter(function(sel) { return sel.active && sel.type === \"ref\"; })[0];\n\n              if (activeFormulaSelection) {\n                  colorClasses.push(activeFormulaSelection.colorClass);\n              }\n          }\n\n          return colorClasses;\n      }\n\n      _directionClasses(cell) {\n          let cellClasses = [];\n          let classNames = Pane.classNames;\n          let view = this._currentView.ref;\n\n          if (!cell.move(0, -1).intersects(view)) {\n              cellClasses.push(classNames.left);\n          }\n\n          if (!cell.move(-1, 0).intersects(view)) {\n              cellClasses.push(classNames.top);\n          }\n\n          if (!cell.move(0, 1).intersects(view)) {\n              cellClasses.push(classNames.right);\n          }\n\n          if (!cell.move(1, 0).intersects(view)) {\n              cellClasses.push(classNames.bottom);\n          }\n\n          return cellClasses;\n      }\n\n      _rectangle(ref) {\n          return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n      }\n\n      _buttonOutOfVisiblePane(row, col, scroller) {\n          let self = this;\n          let theGrid = self._grid;\n          let sheet = self._sheet;\n          let ref = sheet.range(row, col)._ref;\n          let boundaries = theGrid.scrollBoundaries(ref);\n          let scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n          if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n              return true;\n          }\n      }\n  }\n\n  Pane.classNames = paneClassNames;\n\n  function drawingResizeHandles(container) {\n      [ \"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\" ].forEach(function(direction) {\n          container.push(dom.element(\"div\", {\n              \"className\": \"k-spreadsheet-drawing-handle \" + direction,\n              \"data-direction\": direction\n          }));\n      });\n  }\n\n  /* eslint-disable no-unused-vars */\n  /* eslint-disable no-param-reassign */\n  /* eslint-disable no-else-return */\n  /* eslint-disable no-multi-spaces */\n  /* eslint-disable no-nested-ternary */\n\n\n  let styles = [\n      \"font-family\",\n      \"font-size\",\n      \"font-stretch\",\n      \"font-style\",\n      \"font-weight\",\n      \"letter-spacing\",\n      \"text-transform\",\n      \"line-height\"\n  ];\n\n  //move to core\n  let KEY_NAMES = {\n      27: 'esc',\n      37: 'left',\n      39: 'right',\n      35: 'end',\n      36: 'home',\n      32: 'spacebar'\n  };\n\n  let PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n\n  class FormulaInput extends Widget {\n      constructor(element, opt) {\n          const defaultOptions = {\n              name: \"FormulaInput\",\n              autoScale: false,\n              filterOperator: \"startswith\",\n              scalePadding: 30,\n              minLength: 1,\n              formulaBarWidth: null\n          };\n\n          const options = Object.assign({}, defaultOptions, opt);\n          super(element, options);\n\n          this.events = [\n              \"keyup\",\n              \"focus\"\n          ];\n\n          this.input = opt.input;\n\n          if (!element) {\n              return;\n          }\n\n          this.bind(this.events, this.options);\n\n          element.classList.add(FormulaInput.classNames.wrapper);\n\n          if (options && options.formulaBarWidth) ;\n\n          this._highlightedRefs = [];\n\n          this._formulaSource();\n\n          this._formulaList();\n\n          this._tooltip();\n\n          this._sync = this._sync.bind(this);\n          this.scale = this.scale.bind(this);\n          this._keydown = this._keydown.bind(this);\n          this._keyup = this._keyup.bind(this);\n          this._blur = this._blur.bind(this);\n          this._input = this._input.bind(this);\n          this._focus = this._focus.bind(this);\n          this._paste = this._paste.bind(this);\n\n          if (this.options.autoScale) {\n              element.addEventListener(\"input\", this.scale);\n          }\n\n          element.addEventListener(\"keydown\", this._keydown);\n          element.addEventListener(\"keyup\", this._keyup);\n          element.addEventListener(\"blur\", this._blur);\n          element.addEventListener(\"input\", this._input);\n          element.addEventListener(\"click\", this._input);\n          element.addEventListener(\"focus\", this._focus);\n          element.addEventListener(\"paste\", this._paste);\n      }\n\n      enable(enable) {\n          if (enable === undefined) {\n              return this.element.getAttribute(\"contenteditable\") === \"true\";\n          }\n\n          if (enable) {\n              this.element.setAttribute(\"contenteditable\", enable);\n          } else {\n              this.element.removeAttribute(\"contenteditable\");\n          }\n\n          this.element.classList.toggle(\"k-disabled\", !enable);\n      }\n\n      getPos() {\n          let div = this.element;\n          let sel = window.getSelection();\n          let a = lookup(sel.focusNode, sel.focusOffset);\n          let b = lookup(sel.anchorNode, sel.anchorOffset);\n          if (a != null && b != null) {\n              if (a > b) {\n                  let tmp = a;\n                  a = b;\n                  b = tmp;\n              }\n              return { begin: a, end: b, collapsed: a === b };\n          }\n          function lookup(lookupNode, pos) {\n              try {\n                  (function loop(node) {\n                      if (node === lookupNode) {\n                          throw pos;\n                      } else if (node.nodeType === 1 /* Element */) {\n                          for (let i = node.firstChild; i; i = i.nextSibling) {\n                              loop(i);\n                          }\n                      } else if (node.nodeType === 3 /* Text */) {\n                          pos += node.nodeValue.length;\n                      }\n                  })(div);\n              } catch (index) {\n                  return index;\n              }\n          }\n      }\n\n      setPos(begin, end) {\n          let eiv = this.element;\n          begin = lookup(eiv, begin);\n          if (end != null) {\n              end = lookup(eiv, end);\n          } else {\n              end = begin;\n          }\n          if (begin && end) {\n              this._setRange(begin, end);\n          }\n\n          function lookup(node, pos) {\n              try {\n                  (function loop(node) {\n                      if (node.nodeType === 3 /* Text */) {\n                          let len = node.nodeValue.length;\n                          if (len >= pos) {\n                              throw node;\n                          }\n                          pos -= len;\n                      } else if (node.nodeType === 1 /* Element */) {\n                          for (let i = node.firstChild; i; i = i.nextSibling) {\n                              loop(i);\n                          }\n                      }\n                  })(node);\n              } catch (el) {\n                  return { node: el, pos: pos };\n              }\n          }\n      }\n\n      end() {\n          this.setPos(this.length());\n      }\n\n      home() {\n          this.setPos(0);\n      }\n\n      select() {\n          this.setPos(0, this.length());\n      }\n\n      length() {\n          return this.value().length;\n      }\n\n      _setRange(begin, end) {\n          let range = document.createRange();\n          range.setStart(begin.node, begin.pos);\n          range.setEnd(end.node, end.pos);\n          let sel = window.getSelection();\n          let currentRange = sel.getRangeAt(0);\n          if (differ(range, currentRange))  {\n              sel.removeAllRanges();\n              sel.addRange(range);\n          }\n\n          function differ(a, b) {\n              return (\n                  a.startOffset !== b.startOffset ||\n                  a.endOffset !== b.endOffset ||\n                  a.startContainer !== b.endContainer ||\n                  a.endContainer !== b.endContainer\n              );\n          }\n      }\n\n      _formulaSource() {\n          let result = [];\n          let value;\n\n          for (let key in calc.runtime.FUNCS) {\n              if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                  value = key.toUpperCase();\n                  result.push({ value: value, text: value });\n              }\n          }\n\n          this.formulaSource = result;\n      }\n\n      get list() { return  this.input.current.list; }\n      get popup() { return  this.input.current.popup; }\n\n      _formulaList() {\n          this.list.data(this.formulaSource);\n          this.list.itemClick((value) => {\n              this._formulaListChange(value);\n          });\n      }\n\n      _formulaListChange(value) {\n          let tokenCtx = this._tokenContext();\n\n          if (!tokenCtx || this._mute) {\n              return;\n          }\n\n          let activeToken = tokenCtx.token;\n          let completion = value;\n          let ctx = {\n              replace: true,\n              token: activeToken,\n              end: activeToken.end\n          };\n\n          if (!tokenCtx.nextToken || tokenCtx.nextToken.value !== \"(\") {\n              completion += \"(\";\n          }\n\n          this._replaceAt(ctx, completion);\n          this.popup.close();\n      }\n\n      _blur() {\n          this.popup.close();\n          clearTimeout(this._focusId);\n          this.trigger(\"blur\");\n      }\n\n      _isFormula() {\n          return /^=/.test(this.value());\n      }\n\n      _keydown(e) {\n          let key = e.keyCode;\n          let that = this;\n\n          if (KEY_NAMES[key]) {\n              that.popup.close();\n              that._navigated = true;\n          } else if (that._move(key)) {\n              that._navigated = true;\n              e.preventDefault();\n          }\n\n          that._keyDownTimeout = setTimeout(that._syntaxHighlight.bind(that));\n      }\n\n      _keyup() {\n          let popup = this.popup;\n          let value;\n\n          if (this._isFormula() && !this._navigated) {\n              value = ((this._tokenContext() || {}).token || {}).value;\n\n              const data = this.filter(value);\n\n              if (!value || !data.length) {\n                  popup.close();\n              } else {\n                  popup[popup.visible() ? \"position\" : \"open\"]();\n                  setTimeout(() => { this.list.focusFirst(); }, 0);\n              }\n          }\n\n          this._navigated = false;\n          this._syntaxHighlight();\n\n          this.trigger(\"keyup\");\n      }\n\n      _input() {\n          this._syntaxHighlight();\n      }\n\n      _focus() {\n          setTimeout(this._sync.bind(this));\n          this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n          this.trigger(\"focus\");\n      }\n\n      _paste(ev) {\n          ev.preventDefault();\n          let pos = this.getPos();\n          let text;\n          text = ev.clipboardData.getData(\"text/plain\");\n          let val = this.value();\n          val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n          this.value(val);\n          this.setPos(pos.begin + text.length);\n          this.scale();\n      }\n\n      _move(key) {\n          let list = this.list;\n          let popup = this.popup;\n          if (popup.visible()) {\n              if (key === keys.DOWN) {\n                  list.focusNext();\n                  return true;\n              }\n              if (key === keys.UP) {\n                  list.focusPrev();\n                  return true;\n              }\n              if (key === keys.ENTER || key === keys.TAB) {\n                  let focusIndex = typeof list.focusIndex === \"function\" ? list.focusIndex() : list.focus();\n                  if (list.data()[focusIndex]) {\n                      this._formulaListChange(list.data()[focusIndex].value);\n                  }\n\n                  popup.close();\n                  return true;\n              }\n              if (key === keys.PAGEUP) {\n                  list.focusFirst();\n                  return true;\n              }\n              if (key === keys.PAGEDOWN) {\n                  list.focusLast();\n                  return true;\n              }\n          }\n          return false; // key === keys.ENTER || key === keys.TAB;\n      }\n\n      _tokenContext() {\n          let point = this.getPos();\n          let value = this.value();\n\n          if (!value || !point || !point.collapsed) {\n              return null;\n          }\n\n          let tokens = calc.tokenize(value, this.row(), this.col());\n          let tok;\n\n          for (let i = 0; i < tokens.length; ++i) {\n              tok = tokens[i];\n              if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                  return { token: tok, nextToken: tokens[i + 1] };\n              }\n          }\n\n          return null;\n      }\n\n      _sync() {\n          if (this._editorToSync && this.isActive()) {\n              this._editorToSync.value(this.value());\n          }\n      }\n\n      _textContainer() {\n          let computedStyles = kendoGetComputedStyles(this.element, styles);\n\n          computedStyles.position = \"absolute\";\n          computedStyles.visibility = \"hidden\";\n          computedStyles.whiteSpace = \"pre\";\n          computedStyles.top = -3333;\n          computedStyles.left = -3333;\n\n          this._span = document.createElement('span');\n          this._span.style.whiteSpace = 'pre';\n          for (const style in computedStyles) {\n              if (Object.hasOwnProperty.call(computedStyles, style)) {\n                  this._span.style[style] = computedStyles[style];\n              }\n          }\n          insertAfter(this._span, this.element);\n          // this._span = $(\"<span style='white-space: pre'/>\").css(computedStyles).insertAfter(this.element);\n      }\n\n      _tooltip() {\n          this._cellTooltip = document.createElement('div');\n          this._cellTooltip.className = 'k-widget k-tooltip';\n          this._cellTooltip.style.position = 'absolute';\n          this._cellTooltip.style.display = 'none';\n          this._cellTooltip.appendChild(document.createTextNode('A1'));\n          insertAfter(this._cellTooltip, this.element);\n          // this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n      }\n\n      tooltip(value) {\n          while (this._cellTooltip.firstChild) {\n              this._cellTooltip.removeChild(this._cellTooltip.firstChild);\n          }\n          this._cellTooltip.appendChild(document.createTextNode(value));\n          // this._cellTooltip.text(value);\n      }\n\n      toggleTooltip(show) {\n          this._cellTooltip.style.display = (show ? '' : 'none');\n          // this._cellTooltip.toggle(show);\n      }\n\n      isActive() {\n          return this.element === _activeElement$1();\n      }\n\n      filter(value) {\n          if (!value || value.length < this.options.minLength) {\n              return;\n          }\n\n          const data = this.formulaSource.filter((item) => String(item.value).toLowerCase().startsWith(value.toLowerCase()));\n\n          this.list.data(data);\n\n          return data;\n      }\n\n      hide() {\n          this.enable(false);\n          this.element.style.display = 'none';\n          this._cellTooltip.style.display = 'none';\n      }\n\n      show() {\n          this.enable(true);\n          this.element.style.display = 'block';\n      }\n\n      row() {\n          if (this.activeCell) {\n              return this.activeCell.row;\n          }\n      }\n\n      col() {\n          if (this.activeCell) {\n              return this.activeCell.col;\n          }\n      }\n\n      position(rectangle) {\n          if (!rectangle) {\n              return;\n          }\n\n          this.show();\n\n          this.element.style.top = (rectangle.top + 1) + \"px\";\n          this.element.style.left = (rectangle.left + 1) + \"px\";\n\n          this._cellTooltip.style.top =  (rectangle.top - this._cellTooltip.offsetHeight - 10) + \"px\";\n          this._cellTooltip.style.left = rectangle.left + \"px\";\n      }\n\n      resize(rectangle) {\n          if (!rectangle) {\n              return;\n          }\n\n          this.element.style.width = (rectangle.width - 1) + \"px\";\n          this.element.style.height = (rectangle.height - 1) + \"px\";\n      }\n\n      canInsertRef(isKeyboardAction) {\n          return this._canInsertRef(isKeyboardAction);\n      }\n\n      _canInsertRef(isKeyboardAction) {\n          if (this.popup.visible()) {\n              return null;\n          }\n          let strictMode = isKeyboardAction;\n          let point = this.getPos();\n          let tokens, tok, i;\n\n          if (point && this._isFormula()) {\n              if (point.begin === 0) {\n                  return null;\n              }\n\n              tokens = calc.tokenize(this.value(), this.row(), this.col());\n\n              for (i = 0; i < tokens.length; ++i) {\n                  tok = tokens[i];\n                  if (touches(tok, point)) {\n                      return canReplace(tok);\n                  }\n                  if (afterPoint(tok)) {\n                      return canInsertBetween(tokens[i - 1], tok);\n                  }\n              }\n              return canInsertBetween(tok, null);\n          }\n\n          return null;\n\n          function afterPoint(tok) {\n              return tok.begin > point.begin;\n          }\n          function canReplace(tok) {\n              if (tok) {\n                  if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                      return { replace: true, token: tok, end: tok.end };\n                  }\n                  if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                      if (tok.end === point.end) {\n                          return canInsertBetween(tok, tokens[i + 1]);\n                      }\n                      return canInsertBetween(tokens[i - 1], tok);\n                  }\n              }\n          }\n          function canInsertBetween(left, right) {\n              if (left == null) {\n                  return null;\n              }\n              if (right == null) {\n                  if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                      return { token: left, end: point.end };\n                  }\n                  return null;\n              }\n              if (strictMode) {\n                  if (left.type === \"op\" && /^(?:punc|op)$/.test(right.type)) {\n                      return { token: left, end: point.end };\n                  }\n              } else {\n                  if (left.type === \"startexp\") {\n                      return { token: left, end: point.end };\n                  }\n                  if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                      return { token: left, end: point.end };\n                  }\n                  if (/^(?:ref|sym)/.test(left.type)) {\n                      return { token: left, replace: true, end: left.end };\n                  }\n                  if (/^(?:ref|sym)/.test(right.type)) {\n                      return { token: right, replace: true, end: right.end };\n                  }\n              }\n              return false;\n          }\n      }\n\n      refAtPoint(sheet) {\n          let x = this._canInsertRef();\n          if (x) {\n              let ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n              if (sheet.isMerged(ref)) {\n                  ref = ref.topLeft;\n              }\n              if (sheet !== this.activeSheet) {\n                  ref = ref.setSheet(sheet.name(), true);\n              }\n              this._replaceAt(x, ref.print(0, 0));\n          }\n      }\n\n      _replaceAt(ctx, newValue) {\n          let value = this.value();\n          let tok = ctx.token;\n          let rest = value.substr(ctx.end);\n          value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n          let point = value.length;\n          value += rest;\n          this._value(value);\n          this.setPos(point);\n          this.scale();\n          this._syntaxHighlight();\n      }\n\n      syncWith(formulaInput) {\n          this._editorToSync = formulaInput;\n          if (this.element) {\n              this.element.removeEventListener(\"input\", this._sync);\n              this.element.addEventListener(\"input\", this._sync);\n          }\n      }\n\n      scale() {\n          let element = this.element;\n          let width, height;\n\n          if (!this._span) {\n              this._textContainer();\n          }\n\n          this._span.innerHTML = element.innerHTML;\n\n          width = this._span.offsetWidth + this.options.scalePadding;\n          height = this._span.offsetHeight;\n\n          if (width > element.offsetWidth) {\n              element.style.width = width + 'px';\n          }\n\n          const activeCellOutlineWidth = 1;\n          if (height - activeCellOutlineWidth > element.offsetHeight) {\n              element.style.height = (height - activeCellOutlineWidth) + 'px';\n          }\n\n          this._sync();\n      }\n\n      _value(value) {\n          let txt = (this.element.innerText || this.element.textContent).replace(/\\n$/, \"\");\n          if (txt !== value) {\n              while (this.element.firstChild) {\n                  this.element.removeChild(this.element.firstChild);\n              }\n              this.element.appendChild(document.createTextNode(value));\n          }\n      }\n\n      value(value) {\n          let txt = (this.element.innerText || this.element.textContent).replace(/\\n$/, \"\");\n          if (value === undefined) {\n              return txt;\n          }\n\n          if (txt !== value) {\n              this._value(value);\n              this._syntaxHighlight();\n          }\n      }\n\n      highlightedRefs() {\n          return this._highlightedRefs.slice();\n      }\n\n      _syntaxHighlight() {\n          let pos = this.getPos();\n          let value = this.value();\n          let refClasses = Pane.classNames.series;\n          let highlightedRefs = [];\n          let refIndex = 0;\n          let parens = [];\n          let tokens = [];\n          // let activeToken;\n\n          if (pos && !pos.collapsed) {\n              // Backward selection (hold shift, move right to left)\n              // will not work properly if we continuously re-set\n              // the HTML.  If the selection is on, presumably the\n              // text has already been highlighted, so stop here.\n              return;\n          }\n\n          if (!(/^=/.test(value))) {\n              // if an user deleted the initial =, reset the text to\n              // discard any highlighting.  Only do that once.\n              if (this._highlightedRefs.length) {\n                  this._highlightedRefs = [];\n                  this._value(value);\n              }\n\n              // also make sure the completion popup goes away\n              // if (this.popup) {\n                  // this.popup.close();\n              // }\n\n              return; // avoid messing with the cursor position below\n          } else {\n              tokens = calc.tokenize(value, this.row(), this.col());\n              tokens.forEach(function(tok) {\n                  tok.active = false;\n                  tok.cls = [ \"k-syntax-\" + tok.type ];\n\n                  if (tok.type === \"ref\") {\n                      tok.colorClass = refClasses[(refIndex++) % refClasses.length];\n                      tok.cls.push(tok.colorClass);\n                      highlightedRefs.push(tok);\n                  }\n                  if (pos && tok.type === \"punc\") {\n                      if (isOpenParen(tok.value)) {\n                          parens.unshift(tok);\n                      } else if (isCloseParen(tok.value)) {\n                          let open = parens.shift();\n                          if (open) {\n                              if (isMatchingParen(tok.value, open.value)) {\n                                  if (touches(tok, pos) || touches(open, pos)) {\n                                      tok.cls.push(\"k-syntax-paren-match\");\n                                      open.cls.push(\"k-syntax-paren-match\");\n                                  }\n                              } else {\n                                  tok.cls.push(\"k-syntax-error\");\n                                  open.cls.push(\"k-syntax-error\");\n                              }\n                          } else {\n                              tok.cls.push(\"k-syntax-error\");\n                          }\n                      }\n                  }\n                  if (pos && touches(tok, pos)) {\n                      tok.cls.push(\"k-syntax-at-point\");\n                      tok.active = true;\n                      // activeToken = tok;\n                  }\n                  if (tok.type === \"func\" && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                      tok.cls.push(\"k-syntax-error\");\n                  }\n              });\n              tokens.reverse().forEach(function(tok) {\n                  let begin = tok.begin, end = tok.end;\n                  let text = htmlEncode(value.substring(begin, end));\n                  value = value.substr(0, begin) +\n                      \"<span class='\" + tok.cls.join(\" \") + \"'>\" + text + \"</span>\" +\n                      value.substr(end);\n              });\n              this.element.innerHTML = value;\n          }\n          if (pos) {\n              this.setPos(pos.begin, pos.end);\n          }\n\n          this._highlightedRefs = highlightedRefs;\n      }\n\n      destroy() {\n          this._editorToSync = null;\n\n          this.element.removeEventListener(\"input\", this.scale);\n          this.element.removeEventListener(\"keydown\", this._keydown);\n          this.element.removeEventListener(\"keyup\", this._keyup);\n          this.element.removeEventListener(\"blur\", this._blur);\n          this.element.removeEventListener(\"input\", this._input);\n          this.element.removeEventListener(\"click\", this._input);\n          this.element.removeEventListener(\"focus\", this._focus);\n          this.element.removeEventListener(\"paste\", this._paste);\n\n          clearTimeout(this._focusTimeout);\n          clearTimeout(this._keyDownTimeout);\n\n          this._cellTooltip = null;\n          this._span = null;\n\n          super.destroy();\n      }\n\n      insertNewline() {\n          let val = this.value();\n          let pos = this.getPos();\n          let eof = pos.end === val.length;\n          val = val.substr(0, pos.begin) + (eof ? \"\\n\\n\" : \"\\n\" + val.substr(pos.end));\n          this.value(val);\n          this.setPos(pos.begin + 1);\n      }\n  }\n\n  FormulaInput.classNames = {\n      wrapper: \"k-spreadsheet-formula-input\",\n      listWrapper: \"k-spreadsheet-formula-list\"\n  };\n\n  function isOpenParen(ch) {\n      return ch === \"(\" || ch === \"[\" || ch === \"{\";\n  }\n\n  function isCloseParen(ch) {\n      return ch === \")\" || ch === \"]\" || ch === \"}\";\n  }\n\n  function isMatchingParen(close, open) {\n      return open === \"(\" ? close === \")\"\n          :  open === \"[\" ? close === \"]\"\n          :  open === \"{\" ? close === \"}\"\n          :  false;\n  }\n\n  function touches(pos, target) {\n      return pos.begin <= target.begin && pos.end >= target.end;\n  }\n\n  function knownFunction(name) {\n      return calc.runtime.FUNCS[name.toLowerCase()];\n  }\n\n  class FormulaBar extends Widget {\n      constructor(element, options) {\n          super(element, options);\n\n          const formulaInputDiv = element && element.querySelector(\".k-spreadsheet-formula-input:not(.k-spreadsheet-cell-editor)\");\n          this.formulaInput = new FormulaInput(formulaInputDiv, this.options);\n      }\n\n      destroy() {\n          if (this.formulaInput) {\n              this.formulaInput.destroy();\n          }\n          this.formulaInput = null;\n      }\n  }\n\n  class NameEditor extends Widget {\n      readData() {\n          const data = [];\n          this._workbook.forEachName(function(def) {\n              if (!def.hidden && def.value instanceof Ref) {\n                  data.push({ name: def.name });\n              }\n          });\n          return data;\n      }\n      value(val) {\n          if (this.options.combobox.current) {\n              return this.options.combobox.current.value(val);\n          }\n      }\n  }\n\n  class SheetsBar extends Widget {\n      constructor(element, options) {\n          super(element, Object.assign({}, { name: \"SheetsBar\" }, options));\n          this.events = [\n              \"select\",\n              \"reorder\",\n              \"rename\"\n          ];\n      }\n\n      onSheetReorderEnd(e) {\n          this.trigger(\"reorder\", { oldIndex: e.oldIndex, newIndex: e.newIndex });\n      }\n      onSheetRemove(removedSheetName) {\n          this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n      }\n      onSheetSelect(selectedSheetText) {\n          this.trigger(\"select\", { name: selectedSheetText, isAddButton: false });\n      }\n      onSheetRename(newSheetName, sheetIndex) {\n          this.trigger(\"rename\", { name: newSheetName, sheetIndex: sheetIndex });\n      }\n      onAddSelect() {\n          this.trigger(\"select\", { isAddButton: true });\n      }\n      destroy() {\n          super.destroy();\n      }\n  }\n\n  /* eslint-disable complexity */\n  /* eslint-disable consistent-return */\n  /* eslint-disable default-case */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-param-reassign */\n\n\n  function selectElementContents(el) {\n      let sel = window.getSelection();\n      sel.removeAllRanges();\n\n      let range = document.createRange();\n      range.selectNodeContents(el);\n\n      sel.addRange(range);\n  }\n\n  function cellBefore(table, row) {\n      let cells = table.trs[row].children;\n      return cells[cells.length - 2];\n  }\n\n  function cellAbove(table, row) {\n      let prevRow = table.trs[row - 1];\n      let index = table.trs[row].children.length - 1;\n\n      if (prevRow && index >= 0) {\n          return prevRow.children[index];\n      }\n  }\n\n  function addCell(table, row, cell) {\n      let style = {};\n\n      if (cell.background) {\n          style.backgroundColor = cell.background;\n      }\n\n      if (cell.color) {\n          style.color = cell.color;\n      }\n\n      if (cell.fontFamily) {\n          style.fontFamily = cell.fontFamily;\n      }\n\n      if (cell.underline) {\n          style.textDecoration = \"underline\";\n      }\n\n      if (cell.italic) {\n          style.fontStyle = \"italic\";\n      }\n\n      if (cell.textAlign) {\n          style.textAlign = cell.textAlign;\n      }\n\n      if (cell.verticalAlign) {\n          style.verticalAlign = (cell.verticalAlign === \"center\") ? \"middle\" : cell.verticalAlign;\n      }\n\n      if (cell.bold) {\n          style.fontWeight = \"bold\";\n      }\n\n      if (cell.fontSize) {\n          style.fontSize = cell.fontSize + \"px\";\n      }\n\n      if (cell.wrap === true) {\n          style.whiteSpace = \"pre-wrap\";\n      }\n\n      if (cell.borderRight) {\n          style.borderRight = cellBorder(cell.borderRight);\n      } else if (cell.background) {\n          style.borderRightColor = cell.background;\n      }\n\n      if (cell.borderBottom) {\n          style.borderBottom = cellBorder(cell.borderBottom);\n      } else if (cell.background) {\n          style.borderBottomColor = cell.background;\n      }\n\n      let data = cell.value, type = typeof data, format = cell.format;\n      if (!format && type === \"number\" && data !== Math.floor(data)) {\n          format = \"0.##############\";\n      }\n      if (format && data != null) {\n          data = formatting.format(data, format);\n          if (data.__dataType) {\n              type = data.__dataType;\n          }\n      }\n\n      let attrs = { style: style };\n\n      if (!style.textAlign) {\n          switch (type) {\n              case \"number\":\n              case \"date\":\n              case \"percent\":\n              case \"currency\":\n                  style.textAlign = \"right\";\n                  break;\n              case \"boolean\":\n                  style.textAlign = \"center\";\n                  break;\n          }\n      }\n\n      if (!/^(?:string|undefined)$/.test(type)) {\n          // provide original value and number format for better\n          // interoperability with google sheets and libre office.\n          attrs.sdval = cell.value;\n          attrs[\"data-sheets-value\"] = JSON.stringify({ 1: 3, 3: cell.value });\n          if (format) {\n              attrs.sdnum = format;\n              attrs[\"data-sheets-numberformat\"] = JSON.stringify({ 1: 2, 2: format, 3: 1 });\n          }\n      }\n      if (cell.formula) {\n          attrs[\"data-sheets-formula\"] = \"=\" + cell.formula.print();\n      }\n\n      let className = null;\n\n      if (cell.enable === false) {\n          className = \"k-disabled\";\n      }\n\n      let td = table.addCell(row, data, attrs, className, cell.validation);\n\n      let border, sibling;\n\n      if (cell.borderLeft) {\n          sibling = cellBefore(table, row);\n          border = cellBorder(cell.borderLeft);\n          if (sibling && border) {\n              sibling.attr.style.borderRight = border;\n          }\n      } else if (cell.background) {\n          style.borderLeftColor = cell.background;\n      }\n\n      if (cell.borderTop) {\n          sibling = cellAbove(table, row);\n          border = cellBorder(cell.borderTop);\n          if (sibling && border) {\n              sibling.attr.style.borderBottom = border;\n          }\n      } else if (cell.background) {\n          style.borderTopColor = cell.background;\n      }\n\n      return td;\n  }\n\n  class HtmlTable {\n      constructor() {\n          this.cols = [];\n          this.trs = [];\n          this._height = 0;\n          this._width = 0;\n      }\n\n      addColumn(width) {\n          this._width += width;\n\n          let col = dom.element(\"col\", { style: { width: width + \"px\" } });\n\n          col.visible = width > 0;\n\n          this.cols.push(col);\n      }\n\n      addRow(height) {\n          let attr = null;\n\n          attr = { style: { height: height + \"px\" } };\n\n          this._height += height;\n\n          let tr = dom.element(\"tr\", attr);\n\n          tr.visible = height > 0;\n\n          this.trs.push(tr);\n      }\n\n      addCell(rowIndex, text, attrs, className, validation) {\n          if (text === null || text === undefined) {\n              text = \"\";\n          }\n          if (!(text instanceof dom.Node)) {\n              text = dom.text(text);\n          }\n\n          let children = [text];\n\n          if (validation && !validation.value) {\n              children.push(dom.element(\"span\", { className: \"k-dirty\" }));\n\n              className = (className || \"\") + (className ? \" \" : \"\") + \"k-dirty-cell\";\n              attrs.title = validation.message;\n          }\n\n          if (className) {\n              attrs.className = className;\n          }\n          let td = dom.element(\"td\", attrs, children);\n\n          this.trs[rowIndex].children.push(td);\n          return td;\n      }\n\n      toDomTree(x, y, className) {\n          this.trs = this.trs.filter(function (tr) {\n              return tr.visible;\n          });\n\n          let offset = 0;\n          this.cols = this.cols.filter(function (col, ci) {\n              if (!col.visible) {\n                  this.trs.forEach(function (tr) {\n                      tr.children.splice(ci - offset, 1);\n                  });\n                  offset++;\n              }\n\n              return col.visible;\n          }, this);\n\n          return dom.element(\"table\", {\n              style: { left: x + \"px\", top: y + \"px\", height: this._height + \"px\", width: this._width + \"px\" },\n              className: className,\n              role: \"presentation\"\n          }, [\n              dom.element(\"colgroup\", null, this.cols),\n              dom.element(\"tbody\", null, this.trs)\n          ]);\n      }\n  }\n\n  function within(value, min, max) {\n      return value >= min && value <= max;\n  }\n\n  class View extends Observable {\n      constructor(element, options) {\n          super();\n          let classNames = View.classNames;\n\n          this.element = element;\n\n          this.options = deepExtend({}, {\n              messages: messages.view\n          }, this.options, options);\n\n          this.events = ['update', 'message'];\n\n          this._chrome();\n\n          this._dialogs = [];\n\n          this._formulaInput();\n\n          this.wrapper = element.querySelector(DOT + classNames.view);\n          this.container = element.querySelector(DOT + classNames.fixedContainer);\n          this.scroller = element.querySelector(DOT + classNames.scroller);\n          this.clipboard = element.querySelector(DOT + classNames.clipboard);\n\n          this.viewSize = this.scroller ?\n              this.scroller.querySelector(\".k-spreadsheet-view-size\") || this.scroller.firstElementChild :\n              null;\n\n          if (!this.viewSize) {\n              throw new Error(\"The scroller element does not contain a view size element.\");\n          }\n\n          this.tree = new dom.Tree(this.container);\n          this.clipboardContents = new dom.Tree(this.clipboard);\n\n          this.editor = new SheetEditor(this);\n\n          this._sheetsbar();\n\n          this.options.createContextMenus?.();\n      }\n\n      enableClipboard(enable) {\n          this.isClipboardDeactivated = !enable;\n\n          if (enable) {\n              this.clipboard.setAttribute(\"contenteditable\", enable);\n          } else {\n              this.clipboard.removeAttribute(\"contenteditable\");\n          }\n      }\n\n      _resize() {\n          // let actionBar = $(this.formulaBar.element).parents(\".k-spreadsheet-action-bar\");\n          // let outerHeight = kendo._outerHeight;\n          // let tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n          // let formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n          // let sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n\n          // this.wrapper.height(\n          //     this.element.height() -\n          //         (tabstripHeight + formulaBarHeight + sheetsBarHeight)\n          // );\n\n          // if (this.tabstrip) {\n          //     this.tabstrip.quickAccessAdjust();\n          // }\n      }\n\n      _chrome() {\n          // let wrapper = document.createElement('div');\n          // wrapper.className = 'k-spreadsheet-action-bar';\n          // this.element.appendChild(wrapper);\n\n          let nameEditor = this.element.querySelector('.k-spreadsheet-name-editor');\n          this.nameEditor = new NameEditor(nameEditor, { combobox: this.options.nameBoxRef });\n\n          // let formulaBar = document.createElement('div');\n          // wrapper.appendChild(formulaBar);\n          let formulaBar = this.element.querySelector('.k-spreadsheet-formula-bar');\n          this.formulaBar = new FormulaBar(formulaBar, { input: this.options.formulaBarInputRef });\n\n          // if (this.options.toolbar) {\n          this._tabstrip();\n          // }\n      }\n\n      _formulaInput() {\n          let editor = this.element.querySelector(DOT + View.classNames.cellEditor);\n\n          this.formulaInput = new FormulaInput(editor, {\n              autoScale: true,\n              input: this.options.formulaCellInputRef\n          });\n      }\n\n      _sheetsbar() {\n          if (this.options.sheetsbar) {\n              this.sheetsbar = new SheetsBar(this.element.querySelector(DOT + View.classNames.sheetsBar), this.options.sheetsbar);\n              this.options.createSheetBar?.(this.options.openDialogCallback);\n          }\n      }\n\n      _tabstrip() {\n          this.tabstrip = this.options.createTabStrip?.();\n          // let messages = this.options.messages.tabs;\n          // let options = $.extend(true, { home: true, insert: true, data: true }, this.options.toolbar);\n          // let tabs = [];\n\n          // if (this.tabstrip) {\n          //     this.tabstrip.destroy();\n          //     this.element.children(\".k-tabstrip\").remove();\n          // }\n\n          // for (let name in options) {\n          //     if (options[name] === true || options[name] instanceof Array) {\n          //         tabs.push({ id: name, text: messages[name], content: \"\" });\n          //     }\n          // }\n\n          // this.tabstrip = new kendo.spreadsheet.TabStrip($(\"<div />\").prependTo(this.element), {\n          //     animation: false,\n          //     dataTextField: \"text\",\n          //     dataContentField: \"content\",\n          //     dataSource: tabs,\n          //     toolbarOptions: options,\n          //     view: this\n          // });\n\n          // this.tabstrip.select(0);\n      }\n\n      _executeCommand(e) {\n          this._sheet.trigger(\"commandRequest\", e);\n      }\n\n      workbook(workbook) {\n          this._workbook = workbook;\n          workbook._view = this;\n          this.nameEditor._workbook = workbook;\n      }\n\n      sheet(sheet) {\n          this._sheet = sheet;\n      }\n\n      activeCellRectangle() {\n          return this.cellRectangle(this._sheet._viewActiveCell());\n      }\n\n      _rectangle(pane, ref) {\n          return pane._grid.boundingRectangle(ref.toRangeRef());\n      }\n\n      isColumnResizer(x, pane, col) {\n          // relative to content\n          x -= this._sheet._grid._headerWidth;\n\n          // add scroll if pane is not frozen\n          if (!pane._grid.columns.frozen) {\n              x += this.scroller.scrollLeft;\n          }\n\n          col = this._sheet._grid._columns.locate(0, col, function (w) {\n              return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH / 2;\n          });\n\n          return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n      }\n\n      isRowResizer(y, pane, row) {\n          // relative to content\n          y -= this._sheet._grid._headerHeight;\n\n          // add scroll if pane is not frozen\n          if (!pane._grid.rows.frozen) {\n              y += this.scroller.scrollTop;\n          }\n\n          row = this._sheet._grid._rows.locate(0, row, function (h) {\n              return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH / 2;\n          });\n\n          return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n      }\n\n      isFilterIcon(x, y, pane, ref) {\n          let self = this;\n          let theGrid = pane._grid;\n          let scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n          let scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n\n          x -= self._sheet._grid._headerWidth - scrollLeft;\n          y -= self._sheet._grid._headerHeight - scrollTop;\n\n          return withExit(function (exit) {\n              self._sheet.forEachFilterHeader(ref, function (ref) {\n                  let rect = self._rectangle(pane, ref);\n                  if (pane.filterIconRect(rect).intersects(x, y)) {\n                      exit(true);\n                  }\n              });\n          });\n      }\n\n      isAutoFill(x, y, pane) {\n          let selection = this._sheet.select();\n\n          if (selection.size > 1) {\n              return false;\n          }\n\n          x -= this._sheet._grid._headerWidth;\n          y -= this._sheet._grid._headerHeight;\n\n          if (!pane._grid.columns.frozen) {\n              x += this.scroller.scrollLeft;\n          }\n\n          if (!pane._grid.rows.frozen) {\n              y += this.scroller.scrollTop;\n          }\n\n          let rectangle = this._rectangle(pane, selection);\n\n          return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n      }\n\n      isEditButton(x, y, pane) {\n          let ed = this._sheet.activeCellCustomEditor();\n          if (ed) {\n              let r = this.activeCellRectangle();\n              // XXX: hard-coded button width (20)\n\n              if (y >= r.top && y <= r.bottom) {\n                  return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH\n                      : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n              }\n          }\n      }\n\n      drawingAt(x, y, pane) {\n          x -= this._sheet._grid._headerWidth;\n          y -= this._sheet._grid._headerHeight;\n\n          if (!pane._grid.columns.frozen) {\n              x += this.scroller.scrollLeft;\n          }\n\n          if (!pane._grid.rows.frozen) {\n              y += this.scroller.scrollTop;\n          }\n\n          let sheet = this._sheet;\n          let drawings = this._sheet._drawings;\n          for (let i = drawings.length; --i >= 0;) {\n              let d = drawings[i];\n              let box = sheet.drawingBoundingBox(d);\n              if (box.intersects(x, y)) {\n                  return {\n                      drawing: d,\n\n                      // also include how far is the drawing's\n                      // top-left from the mouse position, as it's\n                      // not easy to compute some place else.\n                      drx: box.left - x,\n                      dry: box.top - y\n                  };\n              }\n          }\n      }\n\n      objectAt(x, y, noDrawing) {\n          let grid = this._sheet._grid;\n          let object, pane;\n\n          if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n              object = { type: \"outside\" };\n          } else if (x < grid._headerWidth && y < grid._headerHeight) {\n              object = { type: \"topcorner\" };\n          } else {\n              pane = this.paneAt(x, y);\n\n              if (!pane) {\n                  object = { type: \"outside\" };\n              } else {\n                  if (!noDrawing) {\n                      let drawing = this.drawingAt(x, y, pane);\n                      if (drawing) {\n                          return {\n                              type: \"drawing\",\n                              drawing: drawing.drawing,\n                              drx: drawing.drx,\n                              dry: drawing.dry,\n                              pane: pane,\n                              startX: x,\n                              startY: y\n                          };\n                      }\n                  }\n\n                  let row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                  let column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n\n                  let type = \"cell\";\n                  let ref = new CellRef(row, column);\n                  let selecting = this._sheet.selectionInProgress();\n\n                  if (this.isAutoFill(x, y, pane)) {\n                      type = \"autofill\";\n                  } else if (this.isFilterIcon(x, y, pane, ref)) {\n                      type = \"filtericon\";\n                  } else if (!selecting && x < grid._headerWidth) {\n                      type = \"rowheader\";\n                      if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                          ref = new CellRef(row, -Infinity);\n                          type = \"rowresizehandle\";\n                      }\n                  } else if (!selecting && y < grid._headerHeight) {\n                      type = \"columnheader\";\n                      if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                          ref = new CellRef(-Infinity, column);\n                          type = \"columnresizehandle\";\n                      }\n                  } else if (this.isEditButton(x, y, pane)) {\n                      type = \"editor\";\n                  }\n\n                  object = { type: type, ref: ref };\n              }\n          }\n\n          object.pane = pane;\n          object.x = x;\n          object.y = y;\n          return object;\n      }\n\n      paneAt(x, y) {\n          return this.panes.filter(function paneLocationWithin(pane) {\n              let grid = pane._grid;\n              return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n          })[0];\n      }\n\n      containingPane(cell) {\n          return this.panes.filter(function (pane) {\n              if (pane._grid.contains(cell)) {\n                  return true;\n              }\n              return false;\n          })[0];\n      }\n\n      cellRectangle(cell) {\n          let theGrid = this.containingPane(cell)._grid;\n          let rectangle = this._sheet._grid.rectangle(cell);\n\n          return rectangle.offset(\n              theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft),\n              theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop)\n          );\n      }\n\n      refresh(reason) {\n          let sheet = this._sheet;\n\n          // if (this.tabstrip) {\n          //     this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n          // }\n\n          this.trigger('update', { reason, range: sheet.range(sheet.activeCell()), sheet });\n\n          // if (reason.sheetSelection && this.sheetsbar) {\n          //    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n          // }\n\n          this._resize();\n\n          //TODO: refresh sheets list on sheetSelection\n          this.viewSize.style.height = sheet._grid.totalHeight() + \"px\";\n          this.viewSize.style.width = sheet._grid.totalWidth() + \"px\";\n\n          if (reason.layout) {\n              let frozenColumns = sheet.frozenColumns();\n              let frozenRows = sheet.frozenRows();\n\n              // main or bottom or right pane\n              this.panes = [this._pane(frozenRows, frozenColumns)];\n\n              // left pane\n              if (frozenColumns > 0) {\n                  this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n              }\n\n              // top pane\n              if (frozenRows > 0) {\n                  this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n              }\n\n              // left-top \"fixed\" pane\n              if (frozenRows > 0 && frozenColumns > 0) {\n                  this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n              }\n          }\n\n          if (reason.filter) {\n              this._destroyFilterMenu();\n          }\n\n          if (reason.activeCell) {\n              this._focus = sheet.activeCell().toRangeRef();\n          }\n      }\n\n      createFilterMenu(column) {\n          this._destroyFilterMenu();\n\n          let sheet = this._sheet;\n          let ref = sheet.filter().ref;\n          let range = new Range$1(ref, sheet);\n\n          let options = { column: column, range: range };\n\n          this._filterMenu = this.options.createFilterMenu(options);\n\n          return this._filterMenu;\n      }\n\n      selectClipboardContents() {\n          if (!this.isClipboardDeactivated) {\n              this.clipboard.focus({ preventScroll: true });\n              selectElementContents(this.clipboard);\n          }\n      }\n\n      scrollIntoView(cell) {\n          let willScroll = false;\n          let theGrid = this.containingPane(cell)._grid;\n\n          let boundaries = theGrid.scrollBoundaries(cell);\n\n          let scroller = this.scroller;\n          let scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n          let scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n          if (boundaries.top < scrollTop) {\n              willScroll = true;\n              scroller.scrollTop = boundaries.scrollTop;\n          }\n\n          if (boundaries.bottom > scrollTop) {\n              willScroll = true;\n              scroller.scrollTop = boundaries.scrollBottom;\n          }\n\n          if (boundaries.left < scrollLeft) {\n              willScroll = true;\n              scroller.scrollLeft = boundaries.scrollLeft;\n          }\n\n          if (boundaries.right > scrollLeft) {\n              willScroll = true;\n              scroller.scrollLeft = boundaries.scrollRight;\n          }\n\n          return willScroll;\n      }\n\n      _destroyDialog() {\n          this._dialogs.pop();\n      }\n\n      openCustomEditor() {\n          let self = this;\n          let cell = self._sheet.activeCell().first();\n          let editor = self._sheet.activeCellCustomEditor();\n          let range = self._sheet.range(cell);\n          editor.edit({\n              range: range,\n              rect: self.activeCellRectangle(),\n              view: this,\n              validation: this._sheet.validation(cell),\n              callback: function (value, parse) {\n                  self._executeCommand({\n                      command: \"EditCommand\",\n                      options: {\n                          operatingRange: range,\n                          editRange: range,\n                          property: parse ? \"input\" : \"value\",\n                          value: value\n                      }\n                  });\n              }\n          });\n      }\n\n      openDialog(name, options) {\n          let sheet = this._sheet;\n          return sheet.withCultureDecimals(function () {\n              let ref = sheet.activeCell();\n              let range = new Range$1(ref, sheet);\n              let args = { ...options, name, ref, range };\n              this.trigger('message', args);\n              return args.dialog;\n          }.bind(this));\n      }\n\n      showError(options, reopenEditor) {\n          let currentDialogs = this._dialogs;\n          let errorMessages = this.options.messages.errors;\n\n          if (currentDialogs.length > 0) {\n              return;\n          }\n\n          let onClose = function () {\n              currentDialogs.pop();\n              // let dlg = e.sender;\n              this.selectClipboardContents();\n              if (reopenEditor) { // dlg._retry &&\n                  reopenEditor();\n              }\n          }.bind(this);\n\n          const dialogOptions = {\n              title: options.title || \"Error\",\n              text: options.body ? options.body : errorMessages[options.type],\n              close: onClose\n          };\n\n          currentDialogs.push(dialogOptions);\n\n          this.openDialog(options.type || \"message\", dialogOptions);\n      }\n\n      destroy() {\n          this.unbind();\n\n          [this.tree, this.clipboardContents].forEach(el => {\n              while (el && el.root && el.root.lastChild) {\n                  el.root.removeChild(el.root.lastChild);\n              }\n          });\n          this.tree = this.clipboardContents = null;\n\n          // this._dialogs.forEach(function(dialog) {\n          //     dialog.destroy();\n          // });\n\n          // if (this.cellContextMenu) {\n          //     this.cellContextMenu.destroy();\n          // }\n\n          // this.rowHeaderContextMenu.destroy();\n          // this.colHeaderContextMenu.destroy();\n          // this.drawingContextMenu.destroy();\n\n          // this.cellContextMenu = this.rowHeaderContextMenu =\n          //                         this.colHeaderContextMenu =\n          //                         this.drawingContextMenu = null;\n\n          if (this.tabstrip) {\n              this.tabstrip.destroy();\n              this.tabstrip = null;\n          }\n\n          this._destroyFilterMenu();\n      }\n\n      _destroyFilterMenu() {\n          if (this._filterMenu) {\n              this._filterMenu.destroy();\n              this._filterMenu = undefined;\n          }\n      }\n\n      render(reason) {\n          // if (!this.element.is(\":visible\")) {\n          //     return;\n          // }\n          let sheet = this._sheet;\n          let focus = sheet.focus();\n          let scrollbarSize = scrollbar();\n          let contentWidth = this.wrapper.clientWidth - scrollbarSize;\n          let contentHeight = this.wrapper.clientHeight - scrollbarSize;\n\n          if (focus && this.scrollIntoView(focus)) {\n              return;\n          }\n\n          let resizeDirection =\n              !sheet.resizingInProgress() ? \"none\" :\n                  sheet.resizeHandlePosition().col === -Infinity ? \"column\" :\n                      \"row\";\n\n          this.wrapper.classList.toggle(viewClassNames.editContainer, this.editor.isActive());\n          this.wrapper.classList.toggle(viewClassNames.horizontalResize, resizeDirection === \"row\");\n          this.wrapper.classList.toggle(viewClassNames.verticalResize, resizeDirection === \"column\");\n\n          let grid = sheet._grid;\n          let content = [];\n          let args = {\n              scroller: this.scroller,\n              toplevelElements: content,\n              contentWidth: contentWidth,\n              contentHeight: contentHeight\n          };\n          this.panes.forEach(function (pane) {\n              content.push(pane.render(args));\n          });\n\n          let topCorner = dom.element(\"div\", {\n              style: { width: grid._headerWidth + \"px\", height: grid._headerHeight + \"px\" },\n              className: View.classNames.topCorner\n          });\n\n          content.push(topCorner);\n\n          if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n              content.push(this.renderResizeHint());\n          }\n\n          this.tree.render(content);\n\n          this.container.style.width = contentWidth + 'px';\n          this.container.style.height = contentHeight + 'px';\n          // $(this.container).css({\n          //     width: contentWidth,\n          //     height: contentHeight\n          // });\n\n          if (this.editor.isActive()) {\n              this.editor.toggleTooltip(this.activeCellRectangle());\n          } else if (!(reason.resize ||\n              reason.comment ||\n              sheet.selectionInProgress() ||\n              sheet.resizingInProgress() ||\n              sheet.draggingInProgress() ||\n              sheet.isInEditMode())) {\n              this.renderClipboardContents();\n          }\n      }\n\n      // this renders the big blue line during resizing\n      renderResizeHint() {\n          let sheet = this._sheet;\n          let ref = sheet.resizeHandlePosition();\n\n          let horizontal = ref.col !== -Infinity;\n\n          let style;\n          if (horizontal) {\n              style = {\n                  height: this.scroller.clientHeight + \"px\",\n                  width: RESIZE_HANDLE_WIDTH + \"px\",\n                  left: sheet.resizeHintPosition().x + \"px\",\n                  top: \"0px\"\n              };\n          } else {\n              style = {\n                  height: RESIZE_HANDLE_WIDTH + \"px\",\n                  width: this.scroller.clientWidth + \"px\",\n                  top: sheet.resizeHintPosition().y + \"px\",\n                  left: \"0px\"\n              };\n          }\n\n          let classNames = Pane.classNames;\n\n          return dom.element(\"div\", {\n              className: classNames.resizeHint + (!horizontal ? \" \" + classNames.resizeHintVertical : \"\"),\n              style: style\n          }, [\n              dom.element(\"div\", { className: classNames.resizeHintHandle }),\n              dom.element(\"div\", { className: classNames.resizeHintMarker })\n          ]);\n      }\n\n      renderClipboardContents() {\n          let sheet = this._sheet;\n          let grid = sheet._grid;\n\n          // if (sheet._activeDrawing && sheet._activeDrawing.image) {\n          //     let url = this._workbook.imageUrl(sheet._activeDrawing.image);\n          //     let img = dom.element(\"img\", {\n          //         src: url,\n          //         style: {\n          //             width: sheet._activeDrawing.width + \"px\",\n          //             height: sheet._activeDrawing.height + \"px\"\n          //         }\n          //     });\n          //     this.clipboardContents.render([ img ]);\n          //     this.selectClipboardContents();\n          //     return;\n          // }\n\n          let selection = grid.normalize(sheet.select().toRangeRef());\n          let status = this._workbook.clipboard().canCopy();\n          if (status.canCopy === false && status.multiSelection) {\n              this.clipboardContents.render([]);\n              this.selectClipboardContents();\n              return;\n          }\n\n          selection = sheet.trim(selection);\n\n          let table = new HtmlTable();\n\n          let selectionView = grid.rangeDimensions(selection);\n\n          selectionView.rows.forEach(function (height) {\n              table.addRow(height);\n          });\n\n          selectionView.columns.forEach(function (width) {\n              table.addColumn(width);\n          });\n\n          let tmp = sheet._getMergedCells(selection);\n          let primaryMergedCells = tmp.primary;\n          let secondaryMergedCells = tmp.secondary;\n\n          sheet.forEach(selection, function (row, col, cell) {\n              let location = new CellRef(row, col).print();\n\n              if (!secondaryMergedCells[location]) {\n                  let td = addCell(table, row - selection.topLeft.row, cell);\n\n                  let mergedCell = primaryMergedCells[location];\n\n                  if (mergedCell) {\n                      td.attr.colspan = mergedCell.width();\n                      td.attr.rowspan = mergedCell.height();\n                  }\n              }\n          });\n\n          this.clipboardContents.render([table.toDomTree(0, 0, \"kendo-clipboard-\" + this._workbook.clipboard()._uid)]);\n\n          this.selectClipboardContents();\n      }\n\n      _pane(row, column, rowCount, columnCount) {\n          let pane = new Pane(this._sheet, this._sheet._grid.pane({ row: row, column: column, rowCount: rowCount, columnCount: columnCount }), this.options.getIconHTMLString);\n          pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n          return pane;\n      }\n  }\n\n  View.classNames = viewClassNames;\n\n  const reTable = /<table[^>]+>/gmi;\n  const tables = contentStr => ((contentStr || '').match(reTable) || []);\n\n  class Clipboard {\n      constructor(workbook) {\n          this._content = {};\n          this._externalContent = {};\n          this._internalContent = {};\n          this.workbook = workbook;\n          this.origin = NULLREF;\n          this.iframe = document.createElement(\"iframe\");\n          this.iframe.className = \"k-spreadsheet-clipboard-paste\";\n          this.iframe.setAttribute(\"title\", \"Spreadsheet clipboard iframe\");\n          this.menuInvoked = false;\n          this._uid = guid();\n          document.body.appendChild(this.iframe);\n      }\n\n      destroy() {\n          if (this.iframe && this.iframe.parentNode) {\n              this.iframe.parentNode.removeChild(this.iframe);\n          }\n      }\n\n      canCopy() {\n          let status = { canCopy: true };\n          let selection = this.workbook.activeSheet().select();\n          if (selection === NULLREF) {\n              status.canCopy = false;\n          }\n          if (selection instanceof UnionRef) {\n              status.canCopy = false;\n              status.multiSelection = true;\n          }\n          if (this.menuInvoked) {\n              status.canCopy = false;\n              status.menuInvoked = true;\n          }\n          return status;\n      }\n\n      canPaste() {\n          let sheet = this.workbook.activeSheet();\n          let ref = this.pasteRef();\n          let range = sheet.range(ref);\n          let status = { canPaste: true, pasteOnMerged: false, pasteOnDisabled: false };\n\n          if (!range.enable()) {\n              status.canPaste = false;\n              status.pasteOnDisabled = true;\n          }\n          if (!ref.eq(sheet.unionWithMerged(ref))) {\n              status.canPaste = false;\n              status.pasteOnMerged = true;\n          }\n          if (this.menuInvoked) {\n              status.canPaste = false;\n              status.menuInvoked = true;\n          }\n          return status;\n      }\n\n      intersectsMerged() {\n          let sheet = this.workbook.activeSheet();\n          this.parse();\n          this.origin = this._content.origRef;\n          let ref = this.pasteRef();\n          return !ref.eq(sheet.unionWithMerged(ref));\n      }\n\n      copy() {\n          let sheet = this.workbook.activeSheet();\n          this.origin = sheet.select();\n          this._internalContent = sheet.selection().getState();\n          delete this._externalContent.html;\n          delete this._externalContent.plain;\n      }\n\n      cut() {\n          let sheet = this.workbook.activeSheet();\n          this.copy();\n          sheet.range(sheet.select()).clear();\n      }\n\n      pasteRef() {\n          let sheet = this.workbook.activeSheet();\n\n          // When pasting from an external source, origin will be\n          // NULLREF.  Just return the destination range.\n          // https://github.com/telerik/kendo-ui-core/issues/3486\n          if (this.origin === NULLREF) {\n              return sheet.select();\n          }\n\n          let destination = sheet.activeCell().first();\n          let originActiveCell = this.origin.first();\n          let rowDelta = originActiveCell.row - destination.row;\n          let colDelta = originActiveCell.col - destination.col;\n\n          return this.origin.relative(rowDelta, colDelta, 3);\n      }\n\n      paste() {\n          let sheet = this.workbook.activeSheet();\n          let pasteRef = this.pasteRef();\n          if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n              sheet.resize(\n                  Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                  Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n              );\n          }\n          sheet.range(pasteRef).setState(this._content, this);\n          sheet.triggerChange({ recalc: true, ref: pasteRef });\n      }\n\n      external(data) {\n          if (data && (data.html || data.plain)) {\n              this._externalContent = data;\n          } else {\n              return this._externalContent;\n          }\n      }\n\n      isExternal() {\n          return !this._isInternal();\n      }\n\n      parse() {\n          let state;\n\n          if (this._isInternal()) {\n              state = this._internalContent;\n          } else {\n              let data = this._externalContent;\n              state = data.plain ? parseTSV(data.plain) : newState();\n              if (data.html) {\n                  let doc = this.iframe.contentWindow.document;\n                  doc.open();\n                  doc.write(data.html);\n                  doc.close();\n                  let table = doc.querySelector(\"table\"),\n                      program = doc.head.querySelector(\"meta[name=ProgId]\")?.getAttribute(\"content\");\n                  if (table) {\n                      let richState = parseHTML(table, program);\n\n                      // fixup #### values that are sent by Excel when the column is too\n                      // narrow. It turns out that the plain text clipboard data contains the\n                      // actual values. https://github.com/telerik/kendo-ui-core/issues/5277\n                      richState.data.forEach(function(rowData, rowIndex) {\n                          rowData.forEach(function(colData, colIndex) {\n                              if (/^\\s*#+\\s*$/.test(colData.value)) {\n                                  colData.value = state.data[rowIndex][colIndex].value;\n                              }\n                          });\n                      });\n                      state = richState;\n                  }\n              }\n              this.origin = state.origRef;\n          }\n\n          this._content = state;\n      }\n\n      _isInternal() {\n          if (this._externalContent.html === undefined) {\n              return true;\n          }\n\n          const uid = \"kendo-clipboard-\" + this._uid;\n          const includeUid = tablesArr => tablesArr.some(table => table.includes(uid));\n\n          return includeUid(tables(this._externalContent.html)) || includeUid(tables(this._externalContent.plain));\n      }\n  }\n\n  function newState() {\n      let ref = new CellRef(0, 0, 0);\n      return {\n          ref: ref,\n          mergedCells: [],\n          data: [],\n          foreign: true,\n          origRef: ref.toRangeRef()\n      };\n  }\n\n  function setStateData(state, row, col, value) {\n      let data = state.data || (state.data = []);\n      if (!data[row]) {\n          data[row] = [];\n      }\n      data[row][col] = value;\n      let br = state.origRef.bottomRight;\n      br.row = Math.max(br.row, row);\n      br.col = Math.max(br.col, col);\n  }\n\n  function stripStyle(style) {\n      return style.replace(/^-(?:ms|moz|webkit)-/, \"\");\n  }\n\n  function borderObject(element, styles) {\n      // MS Office uses class name and writes borders in the <style> section, so for it we need to\n      // use the computed styles.  For Google Sheets / LibreOffice, however, the inline styles are\n      // more accurate.\n      if (!element.className) {\n          styles = element.style;\n      }\n      let obj = {};\n      [\n          \"borderBottom\",\n          \"borderRight\",\n          \"borderLeft\",\n          \"borderTop\"\n      ].forEach(function(key) {\n          let width = styles[key + \"Width\"];\n          if (width) {\n              width = parseInt(width, 10);\n          }\n          if (width) {\n              obj[key] = {\n                  size: width,\n                  color: styles[key + \"Color\"] || \"#000\"\n              };\n          }\n      });\n      return obj;\n  }\n\n  function cellState(row, col, element, hBorders, vBorders, program) {\n      let styles = window.getComputedStyle(element),\n          isExcel = typeof program === \"string\" && program.indexOf(\"Excel\") > -1;\n      let value, format, formula;\n\n      // google sheets\n      if (!isExcel && (value = element.getAttribute(\"data-sheets-value\"))) {\n          value = JSON.parse(value);\n          value = value[value[1]];\n      }\n      if (!isExcel && (format = element.getAttribute(\"data-sheets-numberformat\"))) {\n          format = JSON.parse(format);\n          format = format[format[1]];\n      }\n      formula = element.getAttribute(\"data-sheets-formula\");\n\n      // libre office\n      if (!isExcel && value == null && format == null && formula == null) {\n          value = element.getAttribute(\"sdval\");\n          format = element.getAttribute(\"sdnum\");\n          if (format) {\n              // for ungoogable reasons, libreoffice prepends format strings with\n              // \"1033;\" and sometimes with \"1033;0;\". discard it below.\n              format = format.replace(/^1033;(?:0;)?/, \"\");\n          }\n      }\n\n      // note: Chrome 70 appends a \\t to a cell's text, which is actually mandated by the standard\n      // ([1] item 6).  We remove it below.  In [2] it's suggested they might switch back to\n      // previous behavior, but removing an eventual last TAB won't hurt anyway.\n      //\n      // [1] https://www.w3.org/TR/html53/dom.html#dom-htmlelement-innertext\n      // [2] https://bugs.chromium.org/p/chromium/issues/detail?id=897373\n      if (value == null) {\n          value = (element.innerText || element.textContent).replace(/\\t$/, \"\");\n      }\n\n      let borders = borderObject(element, styles);\n      let state = {\n          value: value === \"\" ? null : value,\n          formula: formula,\n\n          borderTop: borders.borderTop || hBorders.get(row, col) || null,\n          borderBottom: borders.borderBottom || hBorders.get(row + 1, col) || null,\n          borderLeft: borders.borderLeft || vBorders.get(row, col) || null,\n          borderRight: borders.borderRight || vBorders.get(row, col + 1) || null,\n\n          fontSize: parseInt(styles[\"fontSize\"], 10)\n      };\n\n      if (format != null) {\n          state.format = format;\n      }\n\n      hBorders.set(row, col, state.borderTop);\n      hBorders.set(row + 1, col, state.borderBottom);\n      vBorders.set(row, col, state.borderLeft);\n      vBorders.set(row, col + 1, state.borderRight);\n\n      if (styles[\"backgroundColor\"] !== \"rgb(0, 0, 0)\" && styles[\"backgroundColor\"] !== \"rgba(0, 0, 0, 0)\") {\n          state.background = styles[\"backgroundColor\"];\n      }\n      if (stripStyle(styles[\"textAlign\"]) !== \"right\") {\n          state.textAlign = stripStyle(styles[\"textAlign\"]);\n      }\n      if (styles[\"verticalAlign\"] !== \"middle\") {\n          state.verticalAlign = styles[\"verticalAlign\"];\n      }\n      if (styles[\"wordWrap\"] !== \"normal\" ) {\n          state.wrap = true;\n      }\n\n      const txtElem = element.querySelector(\"font\"); // libre office\n      if (txtElem) {\n          styles = window.getComputedStyle(txtElem);\n      }\n\n      if (styles.color !== \"rgb(0, 0, 0)\" && styles.color !== \"rgba(0, 0, 0, 0)\") {\n          state.color = styles.color;\n      }\n      if (/^underline/.test(styles[\"textDecoration\"])) {\n          state.underline = true;\n      }\n      if (styles[\"fontStyle\"] == \"italic\") {\n          state.italic = true;\n      }\n      if (/^(?:bold|[67]00)$/i.test(styles[\"fontWeight\"])) {\n          state.bold = true;\n      }\n\n      return state;\n  }\n\n  function parseHTML(table, program) {\n      let state = newState();\n\n      let done = [], row = 0, col = 0;\n      for (let i = 0; i < table.rows.length; ++i) {\n          done.push([]);\n      }\n      let hBorders = new calc.runtime.Matrix();\n      let vBorders = new calc.runtime.Matrix();\n\n      for (let ri = 0; ri < table.rows.length; ++ri, ++row) {\n          let tr = table.rows[ri];\n          col = 0;\n          for (let ci = 0; ci < tr.cells.length; ++ci) {\n              let td = tr.cells[ci];\n              let rowSpan = td.rowSpan;\n              let colSpan = td.colSpan;\n              while (done[row][col]) {\n                  col++;\n              }\n\n              // A cell containing a long text overflowing the next (empty) cell will weirdly be\n              // reported as merged by Excel (has colspan=2).  Then, Excel informatively suggests\n              // us to ignore the colSpan by passing mso-ignore:colspan in the style.  Much thanks!\n              // https://github.com/telerik/kendo-ui-core/issues/3760\n              let style = td.getAttribute(\"style\");\n              let ignoreColspan = /mso-ignore:colspan/.test(style);\n\n              setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders, program));\n              if (rowSpan > 1 || (colSpan > 1 && !ignoreColspan)) {\n                  state.mergedCells.push(\n                      new RangeRef(\n                          new CellRef(row, col),\n                          new CellRef(row + rowSpan - 1, col + colSpan - 1)\n                      ).toString());\n              }\n              for (let dr = row + rowSpan; --dr >= row;) {\n                  for (let dc = col + colSpan; --dc >= col;) {\n                      if (dr < done.length) {\n                          done[dr][dc] = true;\n                          if (!(dr === row && dc === col)) {\n                              setStateData(state, dr, dc, {});\n                          }\n                      }\n                  }\n              }\n          }\n      }\n\n      return state;\n  }\n\n  function parseTSV(data) {\n      let state = newState();\n      if (data.indexOf(\"\\t\") === -1 && data.indexOf(\"\\n\") === -1) {\n          setStateData(state, 0, 0, { value: data });\n      } else {\n          let rows = data.split(\"\\n\");\n          for (let ri = 0; ri < rows.length; ri++) {\n              let cols = rows[ri].split(\"\\t\");\n              for (let ci = 0; ci < cols.length; ci++) {\n                  setStateData(state, ri, ci, { value: cols[ci] });\n              }\n          }\n      }\n      return state;\n  }\n\n  /* eslint-disable no-else-return */\n  /* eslint-disable consistent-return */\n  /* eslint-disable space-before-blocks */\n  /* eslint-disable no-implicit-coercion */\n\n\n  let COMMAND_TYPES = {\n      AUTO_FILL: \"autoFill\",\n      CLEAR: \"clear\",\n      CUT: \"cut\",\n      EDIT: \"edit\",\n      PASTE: \"paste\",\n      VALIDATION: \"validation\"\n  };\n\n  const noop = () => { /* */ };\n\n  class Command {\n      constructor(options) {\n          this.options = options;\n          this._workbook = options.workbook;\n          this._property = options && options.property;\n          this._state = {};\n      }\n      range(range) {\n          if (range !== undefined) {\n              this._setRange(range);\n          }\n\n          return this._range;\n      }\n      _setRange(range) {\n          this._range = range;\n      }\n      redo() {\n          this.range().select();\n          this.exec();\n      }\n      undo() {\n          this.setState(this._state);\n      }\n      getState() {\n          this._state = this.range().getState(this._property);\n      }\n      setState(state) {\n          this.range().setState(state);\n      }\n      rejectState(validationState) {\n          this.undo();\n          return {\n              title: validationState.title,\n              body: validationState.message,\n              reason: \"error\",\n              type: \"validationError\"\n          };\n      }\n      _forEachCell(callback) {\n          let range = this.range();\n          let ref = range._ref;\n\n          ref.forEach(function(ref) {\n              range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n          }.bind(this));\n      }\n      usesImage(/* image id from workbook._images */) {\n          return false;\n      }\n  }\n\n  class DrawingUpdateCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._sheet = options.sheet;\n          this._drawing = options.drawing;\n          this._orig = this._drawing.clone();\n          this._previous = options.previous;\n      }\n      exec() {}\n      undo() {\n          this._drawing.reset(this._previous);\n          this._sheet._activeDrawing = this._drawing;\n          this._sheet.triggerChange({ layout: true });\n      }\n      redo() {\n          this._drawing.reset(this._orig);\n          this._sheet._activeDrawing = this._drawing;\n          this._sheet.triggerChange({ layout: true });\n      }\n      usesImage(img) {\n          return this._drawing.image === img\n              || this._orig.image === img\n              || this._previous.image === img;\n      }\n  }\n\n  class DrawingCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._drawing = options.drawing;\n      }\n      usesImage(img) {\n          return this._drawing.image === img;\n      }\n  }\n\n  class InsertImageCommand extends DrawingCommand {\n      constructor(options) {\n          super(options);\n          this._blob = options.blob;\n          this._width = options.width;\n          this._height = options.height;\n      }\n      exec() {\n          let range = this.range();\n          let sheet = range.sheet();\n          let width = this._width;\n          let height = this._height;\n          let aspect = width / height;\n          if (width > height) {\n              width = Math.min(width, 300);\n              height = width / aspect;\n          } else {\n              height = Math.min(height, 300);\n              width = height * aspect;\n          }\n          this._drawing = sheet.addDrawing({\n              topLeftCell: range.topLeft(),\n              offsetX: 5,\n              offsetY: 5,\n              width: width,\n              height: height,\n              opacity: 1,\n              image: this._workbook.addImage(this._blob)\n          }, true);\n          this._blob = null;\n      }\n      undo() {\n          let sheet = this.range().sheet();\n          sheet._activeDrawing = null;\n          sheet.removeDrawing(this._drawing);\n      }\n      redo() {\n          let sheet = this.range().sheet();\n          sheet._activeDrawing = this._drawing;\n          sheet.addDrawing(this._drawing);\n      }\n  }\n\n  class DeleteDrawingCommand extends DrawingCommand {\n      exec() {\n          let sheet = this.range().sheet();\n          sheet._activeDrawing = null;\n          sheet.removeDrawing(this._drawing);\n      }\n      undo() {\n          let sheet = this.range().sheet();\n          sheet._activeDrawing = this._drawing;\n          sheet.addDrawing(this._drawing);\n      }\n      redo() {\n          this.exec();\n      }\n  }\n\n  class ReorderDrawingsCommand extends DrawingCommand {\n      exec() {\n          let sheet = this.range().sheet();\n          this._origIndex = sheet._drawings.indexOf(this._drawing);\n          sheet._drawings.splice(this._origIndex, 1);\n          this._newIndex = this._reorder();\n          sheet._drawings.splice(this._newIndex, 0, this._drawing);\n          sheet.triggerChange({ drawings: true });\n      }\n      undo() {\n          let sheet = this.range().sheet();\n          sheet._drawings.splice(this._newIndex, 1);\n          sheet._drawings.splice(this._origIndex, 0, this._drawing);\n          sheet.triggerChange({ drawings: true });\n      }\n  }\n\n  class BringToFrontCommand extends ReorderDrawingsCommand {\n      _reorder() {\n          return this.range().sheet()._drawings.length;\n      }\n  }\n\n  class SendToBackCommand extends ReorderDrawingsCommand {\n      _reorder() {\n          return 0;\n      }\n  }\n\n  class TargetValueCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._target = options.target;\n          this._value = options.value;\n      }\n      exec() {\n          this.getState();\n          this.setState(this._value);\n      }\n  }\n\n  class ColumnWidthCommand extends TargetValueCommand {\n      getState() {\n          this._state = this.range().sheet().columnWidth(this._target);\n      }\n      setState(state) {\n          this.range().sheet().columnWidth(this._target, state);\n      }\n  }\n\n  class RowHeightCommand extends TargetValueCommand {\n      getState() {\n          this._state = this.range().sheet().rowHeight(this._target);\n      }\n      setState(state) {\n          this.range().sheet().rowHeight(this._target, state);\n      }\n  }\n\n  class HyperlinkCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._link = options.link;\n      }\n      exec() {\n          let range = this.range();\n          this._prevLink = range.link();\n          this._prevUnderline = range.underline();\n          range.link(this._link);\n          range.underline(true);\n          if (range.value() == null) {\n              this._hasSetValue = true;\n              range.value(this._link);\n          }\n      }\n      undo() {\n          let range = this.range();\n          range.link(this._prevLink);\n          range.underline(this._prevUnderline);\n          if (this._hasSetValue) {\n              range.value(null);\n          }\n      }\n  }\n\n  class GridLinesChangeCommand extends TargetValueCommand {\n      getState() {\n          this._state = this._range.sheet().showGridLines();\n      }\n      setState(v) {\n          this._range.sheet().showGridLines(v);\n      }\n  }\n\n  class PropertyChangeCommand extends Command {\n      _setRange(range) {\n          Command.prototype._setRange.call(this, range.skipHiddenCells());\n      }\n      constructor(options) {\n          super(options);\n          this._value = options.value;\n      }\n      exec() {\n          let range = this.range();\n          if (range.enable()) {\n              this.getState();\n\n              if (this.options.property === \"format\") {\n                  this._workbook.trigger(\"changeFormat\", { range: range });\n              }\n\n              range[this._property](this._value);\n          }\n      }\n  }\n\n  class PropertyCleanCommand extends PropertyChangeCommand {\n      exec() {\n          let range = this.range();\n          if (range.enable()) {\n              this.getState();\n              range.clearFormat();\n          }\n      }\n  }\n\n  class ClearContentCommand extends Command {\n      exec() {\n          let values = [], range, rowValues, nullValues, validationState, currentRange;\n          if (!this.range().enable()) {\n              return { reason: \"error\", type: \"cannotModifyDisabled\" };\n          }\n          if (!this.range().canEditArrayFormula()) {\n              return { reason: \"error\", type: \"intersectsArray\" };\n          }\n          this.getState();\n          range = this.range().skipHiddenCells();\n\n          if (range._ref.refs && range._ref.refs.length > 1) {\n              range._ref.refs.forEach(function(ref) {\n                  currentRange = range.sheet().range(ref);\n                  values = values.concat(currentRange.values());\n              });\n          } else {\n              values = range.values();\n          }\n          nullValues = [];\n          values.forEach(function(row) {\n              rowValues = [];\n              row.forEach(function() {\n                  rowValues.push(null);\n              });\n              nullValues.push(rowValues);\n          });\n          if (range.sheet().trigger(\"changing\", { data: nullValues, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n              return;\n          }\n          range.clearContent();\n          validationState = range._getValidationState();\n          if (validationState) {\n              return this.rejectState(validationState);\n          }\n      }\n      undo() {\n          let range = this.range().skipHiddenCells();\n          let sheet = range.sheet();\n          let data = this._state.data;\n          let values = [];\n          let rowValues;\n          data.forEach(function(row) {\n              rowValues = [];\n              row.forEach(function(cell) {\n                  rowValues.push(cell.value);\n              });\n              values.push(rowValues);\n          });\n          if (sheet.trigger(\"changing\", { data: values, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n              return;\n          }\n          this.setState(this._state);\n      }\n  }\n\n  class EditCommand extends PropertyChangeCommand {\n      constructor(options) {\n          options.property = options.property || \"input\";\n          super(options);\n      }\n      _setRange(range) {\n          PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n          this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n      }\n      getState() {\n          this._state = this.range().getState();\n      }\n      exec() {\n          return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n      }\n      undo() {\n          let editRange = this._editRange;\n          let state = this._state;\n          if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].value, range: editRange, changeType: COMMAND_TYPES.EDIT })) {\n              return;\n          }\n          this.setState(this._state);\n      }\n      _exec() {\n          let arrayFormula = this.options.arrayFormula;\n          let editRange = this._editRange;\n\n          if (!editRange.enable()) {\n              return { reason: \"error\", type: \"rangeDisabled\" };\n          }\n\n          if (!editRange.canEditArrayFormula()) {\n              return { reason: \"error\", type: \"intersectsArray\" };\n          }\n\n          let value = this._value;\n          this.getState();\n          if (this.range().sheet().trigger(\"changing\", { data: value, range: this._editRange, changeType: COMMAND_TYPES.EDIT })) {\n              return;\n          }\n\n          if (this._property === \"value\") {\n              editRange.value(value);\n              return;\n          }\n\n          try {\n              editRange.link(null);\n              if (value === \"\") {\n                  editRange.value(null);\n              } else {\n                  editRange.input(value, { arrayFormula: arrayFormula });\n                  if (/\\n/.test(editRange.value())) {\n                      editRange.wrap(true);\n                  }\n              }\n              editRange._adjustRowHeight();\n\n              let validationState = editRange._getValidationState();\n              if (validationState) {\n                  return this.rejectState(validationState);\n              }\n          } catch (ex) {\n              if (ex instanceof calc.runtime.ParseError) {\n                  return {\n                      title: \"Error in formula\",\n                      body: ex + \"\",\n                      reason: \"error\"\n                  };\n              } else {\n                  throw ex;\n              }\n          }\n      }\n  }\n\n  class InsertCommentCommand extends PropertyChangeCommand {\n      constructor(options) {\n          options.property = \"comment\";\n          super(options);\n      }\n  }\n\n  class TextWrapCommand extends PropertyChangeCommand {\n      constructor(options) {\n          options.property = \"wrap\";\n          super(options);\n\n          this._value = options.value;\n      }\n      getState() {\n          let rowHeight = {};\n          this.range().forEachRow(function(range) {\n              let index = range.topLeft().row;\n\n              rowHeight[index] = range.sheet().rowHeight(index);\n          });\n\n          this._state = this.range().getState(this._property);\n          this._rowHeight = rowHeight;\n      }\n      undo() {\n          let sheet = this.range().sheet();\n          let rowHeight = this._rowHeight;\n\n          this.range().setState(this._state);\n\n          for (let row in rowHeight) {\n              sheet.rowHeight(row, rowHeight[row]);\n          }\n      }\n  }\n\n  class AdjustDecimalsCommand extends Command {\n      constructor(options) {\n          options.property = \"format\";\n          super(options);\n          this._delta = options.value;\n      }\n      exec() {\n          let sheet = this.range().sheet();\n          let delta = this._delta;\n\n          this.getState();\n\n          sheet.batch(function() {\n              this.range().forEachCell(function(row, col, cell) {\n                  let format = cell.format;\n\n                  if (!format) {\n                      let value = cell.value;\n                      if (typeof value == \"number\" && /\\./.test(value)) {\n                          format = \"0.\" + String(value).split(\".\")[1].replace(/\\d/g, \"0\");\n                      }\n                  }\n\n                  if (format || delta > 0) {\n                      format = formatting.adjustDecimals(format || \"0\", delta);\n                      sheet.range(row, col).format(format);\n                  }\n              });\n          }.bind(this));\n      }\n  }\n\n  class BorderChangeCommand extends Command {\n      constructor(options) {\n          options.property = \"border\";\n          super(options);\n          this._type = options.border;\n          this._style = options.style;\n      }\n      _batch(f) {\n          return this.range().sheet().batch(f, {});\n      }\n      exec() {\n          let self = this;\n\n          if (!self._type) {\n              return;\n          }\n          \n          self.getState();\n          self._batch(function(){\n              self[self._type](self._style);\n          });\n      }\n      noBorders() {\n          this.range().insideBorders(null);\n          this.outsideBorders(null);\n      }\n      allBorders(style) {\n          this.range().insideBorders(style);\n          this.outsideBorders(style);\n      }\n      leftBorder(style) {\n          this.range().leftColumn().borderLeft(style);\n      }\n      rightBorder(style) {\n          this.range().rightColumn().borderRight(style);\n      }\n      topBorder(style) {\n          this.range().topRow().borderTop(style);\n      }\n      bottomBorder(style) {\n          this.range().bottomRow().borderBottom(style);\n      }\n      outsideBorders(style) {\n          let range = this.range();\n          range.leftColumn().borderLeft(style);\n          range.topRow().borderTop(style);\n          range.rightColumn().borderRight(style);\n          range.bottomRow().borderBottom(style);\n      }\n      insideBorders(style) {\n          this.range().insideBorders(style);\n          this.outsideBorders(null);\n      }\n      insideHorizontalBorders(style) {\n          this.range().insideHorizontalBorders(style);\n      }\n      insideVerticalBorders(style) {\n          this.range().insideVerticalBorders(style);\n      }\n  }\n\n  class MergeCellCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._type = options.value;\n      }\n      exec() {\n          this.getState();\n          this[this._type]();\n          this.range().sheet().triggerChange({ recalc: true });\n      }\n      activate(ref) {\n          this.range().sheet().activeCell(ref);\n      }\n      getState() {\n          this._state = this.range().getState();\n      }\n      undo() {\n          if (this._type !== \"unmerge\") {\n              this.range().unmerge();\n              this.activate(this.range().topLeft());\n          }\n          this.range().setState(this._state);\n      }\n      cells() {\n          let range = this.range();\n          let ref = range._ref;\n\n          range.merge();\n          this.activate(ref);\n      }\n      horizontally() {\n          let ref = this.range().topRow()._ref;\n\n          this.range().forEachRow(function(range) {\n              range.merge();\n          });\n\n          this.activate(ref);\n      }\n      vertically() {\n          let ref = this.range().leftColumn()._ref;\n\n          this.range().forEachColumn(function(range) {\n              range.merge();\n          });\n\n          this.activate(ref);\n      }\n      unmerge() {\n          let range = this.range();\n          let ref = range._ref.topLeft;\n\n          range.unmerge();\n          this.activate(ref);\n      }\n  }\n\n  class FreezePanesCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._type = options.value;\n      }\n      exec() {\n          this.getState();\n          this._topLeft = this.range().topLeft();\n          this[this._type]();\n      }\n      getState() {\n          this._state = this.range().sheet().getState();\n      }\n      undo() {\n          this.range().sheet().setState(this._state);\n      }\n      panes() {\n          let topLeft = this._topLeft;\n          let sheet = this.range().sheet();\n\n          sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n      }\n      rows() {\n          let topLeft = this._topLeft;\n          let sheet = this.range().sheet();\n\n          sheet.frozenRows(topLeft.row);\n      }\n      columns() {\n          let topLeft = this._topLeft;\n          let sheet = this.range().sheet();\n\n          sheet.frozenColumns(topLeft.col);\n      }\n      unfreeze() {\n          let sheet = this.range().sheet();\n          sheet.frozenRows(0).frozenColumns(0);\n      }\n  }\n\n  class PasteCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._clipboard = options.workbook.clipboard();\n          this._clipboard.parse();\n          this._event = options.event;\n          this._clipboardContent = this._clipboard._content;\n          this._sheet = this._workbook.activeSheet();\n          this._range = this._sheet.selection ? this._sheet.selection() : this._sheet.range(this._clipboard.pasteRef());\n          this._state = this._range.getState();\n          this._targetRangeRefs = (this._range._ref instanceof UnionRef ? this._range._ref.refs : [this._range._ref]).map(function(ref){\n              return ref.toRangeRef();\n          });\n      }\n      exec() {\n          return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n      }\n      undo() {\n          let sheet = this._sheet;\n          let range = this._range;\n\n          if (sheet.trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n              return;\n          }\n\n          this.setState(this._state);\n      }\n      _exec() {\n          let status = this._clipboard.canPaste();\n\n          if (!status.canPaste) {\n              if (status.menuInvoked) {\n                  return { reason: \"error\", type: \"useKeyboard\" };\n              }\n              if (status.pasteOnMerged) {\n                  return { reason: \"error\", type: \"modifyMerged\" };\n              }\n              if (status.pasteOnDisabled) {\n                  this._event.preventDefault();\n                  return { reason: \"error\", type: \"cannotModifyDisabled\" };\n              }\n              return { reason: \"error\" };\n          }\n\n          let sheet = this._sheet;\n          let range = this._range;\n\n          if (this._workbook.trigger(\"paste\", { range: range, clipboardContent: this._clipboardContent }) ||\n              sheet.trigger(\"changing\", { data: this._clipboardContent.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n              this._event.preventDefault();\n              return;\n          } else {\n              this._processPaste();\n          }\n      }\n      _adjustPasteTarget(multipliers, sourceRows, sourceCols) {\n          let that = this;\n          let targetRangeRefs = that._targetRangeRefs;\n          let sheet = that._sheet;\n          let refs = [];\n          let compare = function(a, b) {\n              let result = 0;\n              let topLeftA = a.topLeft;\n              let topLeftB = b.topLeft;\n\n              if (topLeftA.row > topLeftB.row) {\n                  result = 1;\n              } else if (topLeftA.row < topLeftB.row) {\n                  result = -1;\n              } else if (topLeftA.col > topLeftB.col) {\n                  result = 1;\n              } else if (topLeftA.col < topLeftB.col) {\n                  result = -1;\n              }\n\n              return result;\n          };\n\n          let refToSelect, rangeToSelect, ref, topLeft, multiplier, i, bottomRight;\n\n          for (i = 0; i < targetRangeRefs.length; i += 1) {\n              ref = targetRangeRefs[i];\n              multiplier = multipliers[i];\n              topLeft = ref.topLeft;\n              bottomRight = {\n                  row: multiplier.rows * sourceRows + topLeft.row - 1,\n                  col: multiplier.cols * sourceCols + topLeft.col - 1\n              };\n\n              refToSelect = new RangeRef(topLeft, bottomRight);\n              refs.push(refToSelect);\n          }\n\n          if (refs.length === 1) {\n              rangeToSelect = sheet.range(refToSelect);\n          } else {\n              refs.sort(compare);\n              rangeToSelect = sheet.range(new UnionRef(refs));\n          }\n\n          rangeToSelect.select();\n          that._range = rangeToSelect;\n          that._state = that._range.getState();\n      }\n      _processPaste() {\n          let that = this;\n          let sheet = that._sheet;\n          let clipboardContent = that._clipboardContent;\n          let range = that._range;\n          let sourceData = clipboardContent.data;\n          let sourceRows = sourceData.length;\n          let sourceCols = sourceData[0].length;\n          let targetRangeRefs = that._targetRangeRefs;\n          let multipliers = that._targetRanges(sourceRows, sourceCols);\n          let i;\n\n          let pasteRef = this._clipboard.pasteRef();\n          if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n              sheet.resize(\n                  Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                  Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n              );\n          }\n\n          that._adjustPasteTarget(multipliers, sourceRows, sourceCols);\n\n          sheet.batch(function() {\n              for (i = 0; i < targetRangeRefs.length; i++) {\n                  that._populateTargetRange(targetRangeRefs[i], sourceRows, sourceCols, multipliers[i]);\n              }\n          }, {\n              recalc: true,\n              ref: that._range._ref\n          });\n\n          range._adjustRowHeight();\n      }\n      _populateTargetRange(ref, sourceRows, sourceCols, multipliers) {\n          let topLeft = ref.topLeft;\n          let range, i, j;\n\n          for (i = 0; i < multipliers.rows; i++) {\n              for (j = 0; j < multipliers.cols; j++) {\n                  range = this._sheet.range(topLeft.row + sourceRows * i, topLeft.col + sourceCols * j);\n                  range.setState(this._clipboardContent, this._clipboard);\n              }\n          }\n      }\n      _targetRangeDimensions(ref, sourceRows, sourceCols) {\n          let topLeft = ref.topLeft;\n          let bottomRight = ref.bottomRight;\n          let targetRangeRows = bottomRight.row - topLeft.row + 1;\n          let targetRangeCols = bottomRight.col - topLeft.col + 1;\n          let rowsMultiplier = 1;\n          let colsMultiplier = 1;\n\n          if ((targetRangeRows % sourceRows === 0 && targetRangeCols % sourceCols === 0)) {\n              rowsMultiplier = targetRangeRows / sourceRows;\n              colsMultiplier = targetRangeCols / sourceCols;\n          }\n\n          return {\n              rows: rowsMultiplier,\n              cols: colsMultiplier\n          };\n      }\n      _targetRanges(sourceRows, sourceCols) {\n          let targetRangeRefs = this._targetRangeRefs;\n          let multipliers = [];\n          let i;\n\n          for (i = 0; i < targetRangeRefs.length; i++) {\n              multipliers.push(this._targetRangeDimensions(targetRangeRefs[i], sourceRows, sourceCols));\n          }\n\n          return multipliers;\n      }\n  }\n\n  class AdjustRowHeightCommand extends Command {\n      exec() {\n          let options = this.options;\n          let sheet = this._workbook.activeSheet();\n          let range = options.range || sheet.range(options.rowIndex);\n\n          range._adjustRowHeight();\n      }\n  }\n\n  class ToolbarPasteCommand extends Command {\n      exec() {\n          if (detectClipboardAccess().paste) {\n              this._workbook._view.clipboard.focus();\n              // explore programmatic pasting further\n              document.execCommand('paste');\n          } else {\n              return { reason: \"error\", type: \"useKeyboard\" };\n          }\n      }\n  }\n\n  class CutCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._eventType = \"cut\";\n          this._clipboard = options.workbook.clipboard();\n          this._event = options.event;\n      }\n      exec() {\n          let status = this._clipboard.canCopy();\n          let data = [], rangeValues, currentRow;\n          if (!status.canCopy) {\n              if (status.menuInvoked) {\n                  return { reason: \"error\", type: \"useKeyboard\" };\n              } else if (status.multiSelection) {\n                  return { reason: \"error\", type: \"unsupportedSelection\" };\n              }\n              return;\n          }\n          let range = this._workbook.activeSheet().selection();\n          if (this._eventType === \"cut\") {\n              if (!range.enable()) {\n                  this._event.preventDefault();\n                  return { reason: \"error\", type: \"cannotModifyDisabled\" };\n              }\n              this.getState();\n          }\n          if (this._workbook.trigger(this._eventType, { range: range })) {\n              this._event.preventDefault();\n          } else if (this._eventType === \"cut\") {\n              rangeValues = range.values();\n              rangeValues.forEach(function(row){\n                  currentRow = [];\n                  row.forEach(function(){\n                      currentRow.push({});\n                  });\n                  data.push(currentRow);\n              });\n              if (range.sheet().trigger(\"changing\", { data: data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                  return;\n              }\n              this._clipboard.cut();\n          } else {\n              this._clipboard.copy();\n          }\n      }\n      undo() {\n          let range = this.range();\n          if (range.sheet().trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.CUT })) {\n              return;\n          }\n          this.setState(this._state);\n      }\n  }\n\n  class CopyCommand extends CutCommand {\n      constructor(options) {\n          super(options);\n          this._eventType = \"copy\";\n          this.undo = noop;\n      }\n  }\n\n  // function copyToClipboard(html) {\n  //     let textarea = document.createElement('textarea');\n  //     $(textarea).addClass(\"k-spreadsheet-clipboard\")\n  //         .val(html)\n  //         .appendTo(document.body)\n  //         .trigger(\"focus\")\n  //         .select();\n\n  //     document.execCommand('copy');\n\n  //     $(textarea).remove();\n  // }\n\n  function detectClipboardAccess() {\n      const commands = {\n          copy: document.queryCommandSupported ? document.queryCommandSupported(\"copy\") : false,\n          cut: document.queryCommandSupported ? document.queryCommandSupported(\"cut\") : false,\n          paste: document.queryCommandSupported ? document.queryCommandSupported(\"paste\") : false\n      };\n\n      return commands;\n  }\n\n  class ToolbarCopyCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._clipboard = options.workbook.clipboard();\n          this.cannotUndo = true;\n      }\n      exec() {\n          if (detectClipboardAccess().copy) {\n              document.execCommand('copy');\n          } else {\n              return { reason: \"error\", type: \"useKeyboard\" };\n          }\n      }\n  }\n\n  class AutoFillCommand extends Command {\n      constructor(options) {\n          super(options);\n      }\n      origin(origin) {\n          this._origin = origin;\n      }\n      exec() {\n          let range = this.range(), autoFillData;\n          if (!range.enable()) {\n              return { reason: \"error\", type: \"rangeDisabled\" };\n          }\n          if (range.intersectingArrayFormula()) {\n              return { reason: \"error\", type: \"intersectsArray\" };\n          }\n          this.getState();\n          try {\n              autoFillData = range._previewFillFrom(this._origin);\n              if (range.sheet().trigger(\"changing\", { data: autoFillData.props, range: autoFillData.dest, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                  return;\n              }\n              autoFillData.dest._properties(autoFillData.props, true);\n          } catch (ex) {\n              if (ex instanceof Range$1.FillError) {\n                  return { reason: \"error\", type: ex.code };\n              }\n              throw ex;\n          }\n      }\n      undo() {\n          let range = this.range();\n          let state = this._state;\n          if (range.sheet().trigger(\"changing\", { data: state.data, range: range, changeType: COMMAND_TYPES.AUTO_FILL })) {\n              return;\n          }\n          this.setState(this._state);\n      }\n  }\n\n  class ToolbarCutCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._clipboard = options.workbook.clipboard();\n          this.cannotUndo = true;\n      }\n      exec() {\n          if (detectClipboardAccess().copy) {\n              document.execCommand('cut');\n          } else {\n              return { reason: \"error\", type: \"useKeyboard\" };\n          }\n      }\n  }\n\n  class FilterCommand extends Command {\n      undo() {\n          this.range().filter(this._state);\n      }\n      exec() {\n          let range = this.range();\n          this._state = range.hasFilter();\n          range.filter(!this._state);\n      }\n  }\n\n  class SortCommand extends Command {\n      undo() {\n          let sheet = this.range().sheet();\n          sheet.setState(this._state);\n      }\n      exec() {\n          let range = this.range();\n          let sheet = range.sheet();\n          let activeCell = sheet.activeCell();\n          let col = this.options.sheet ? activeCell.topLeft.col : (this.options.column || 0);\n          let ascending = this.options.value === \"asc\" ? true : false;\n\n          this._state = sheet.getState();\n\n          if (this.options.sheet) {\n              range = this.expandRange();\n          }\n\n          let reason = range.cantSort();\n          if (reason) {\n              return { reason: \"error\", type: reason.code };\n          }\n\n          range.sort({ column: col, ascending: ascending });\n      }\n      expandRange() {\n          let sheet = this.range().sheet();\n          return new Range$1(sheet._sheetRef, sheet);\n      }\n  }\n\n  class ApplyFilterCommand extends Command {\n      column() {\n          return this.options.column || 0;\n      }\n      undo() {\n          let sheet = this.range().sheet();\n\n          sheet.clearFilter(this.column());\n\n          if (this._state.length) {\n              this.range().filter(this._state);\n          }\n      }\n      getState() {\n          let sheet = this.range().sheet();\n          let current = sheet.filter();\n\n          if (current) {\n              this._state = current.columns.filter(function(c) {\n                  return c.index === this.column();\n              }.bind(this));\n          }\n      }\n      exec() {\n          let range = this.range();\n          let column = this.column();\n          let current = range.sheet().filter();\n          let options;\n          let filterRule;\n          let exists = false;\n\n          if (this.options.valueFilter) {\n              filterRule = { column: column, filter: new ValueFilter(this.options.valueFilter) };\n          } else if (this.options.customFilter) {\n              filterRule = { column: column, filter: new CustomFilter(this.options.customFilter) };\n          }\n\n          this.getState();\n\n          if (current && current.ref.eq(range._ref) && current.columns.length) {\n              current.columns.forEach(function(element) {\n                  if (element.index === column) {\n                      exists = true;\n                  }\n              });\n\n              options = current.columns.map(function(element) {\n                  return element.index === column ? filterRule : { column: element.index, filter: element.filter };\n              });\n\n              if (!exists) {\n                  options.push(filterRule);\n              }\n          } else {\n              options = filterRule;\n          }\n\n          range.filter(options);\n      }\n  }\n\n  class ClearFilterCommand extends ApplyFilterCommand {\n      exec() {\n          let range = this.range();\n          let column = this.column();\n\n          this.getState();\n          range.clearFilter(column);\n      }\n  }\n\n  class HideLineCommand extends Command {\n      constructor(options) {\n          super(options);\n          this.axis = options.axis;\n      }\n\n      undo() {\n          let sheet = this.range().sheet();\n          sheet.setAxisState(this._state);\n      }\n\n      exec() {\n          let sheet = this.range().sheet();\n          this._state = sheet.getAxisState();\n\n          if (this.axis === \"row\") {\n              sheet.axisManager().hideSelectedRows();\n          } else {\n              sheet.axisManager().hideSelectedColumns();\n          }\n      }\n  }\n\n  class UnHideLineCommand extends HideLineCommand {\n      exec() {\n          let sheet = this.range().sheet();\n          this._state = sheet.getAxisState();\n\n          if (this.axis === \"row\") {\n              sheet.axisManager().unhideSelectedRows();\n          } else {\n              sheet.axisManager().unhideSelectedColumns();\n          }\n      }\n  }\n\n  class DeleteCommand extends Command {\n      exec() {\n          this._expandedRange = this._expand(this.range());\n          this._state = this._expandedRange.getState();\n          this._indexes = this._exec(this._expandedRange.sheet());\n      }\n      undo() {\n          let self = this;\n          let range = self._expandedRange;\n          let sheet = range.sheet();\n          sheet.batch(function(){\n              self._indexes.forEach(function(x){\n                  self._undoOne(sheet, x);\n                  sheet._restoreModifiedFormulas(x.formulas);\n              });\n              range.setState(self._state);\n          }, { layout: true, recalc: true, ref: range._ref, isValue: true });\n      }\n  }\n\n  class DeleteRowCommand extends DeleteCommand {\n      _expand(range) {\n          return range.resize({ left: -Infinity, right: +Infinity });\n      }\n      _exec(sheet) {\n          return sheet.axisManager().deleteSelectedRows();\n      }\n      _undoOne(sheet, x) {\n          sheet.insertRow(x.index);\n          sheet.rowHeight(x.index, x.height);\n      }\n  }\n\n  class DeleteColumnCommand extends DeleteCommand {\n      _expand(range) {\n          return range.resize({ top: -Infinity, bottom: +Infinity });\n      }\n      _exec(sheet) {\n          return sheet.axisManager().deleteSelectedColumns();\n      }\n      _undoOne(sheet, x) {\n          sheet.insertColumn(x.index);\n          sheet.columnWidth(x.index, x.width);\n      }\n  }\n\n  class AddCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._value = options.value;\n      }\n      undo() {\n          let self = this;\n          let sheet = self.range().sheet();\n          sheet.batch(function(){\n              for (let i = self._pos.count; --i >= 0;) {\n                  self._undoOne(sheet, self._pos.base);\n              }\n          }, { layout: true, recalc: true });\n      }\n  }\n\n  class AddColumnCommand extends AddCommand {\n      exec() {\n          let value = this._value;\n          let sheet = this.range().sheet();\n\n          if (value === \"left\") {\n              this._pos = sheet.axisManager().addColumnLeft();\n          } else {\n              this._pos = sheet.axisManager().addColumnRight();\n          }\n      }\n      _undoOne(sheet, index) {\n          sheet.deleteColumn(index);\n      }\n  }\n\n  class AddRowCommand extends AddCommand {\n      exec() {\n          let value = this._value;\n          let sheet = this.range().sheet();\n\n          if (value === \"above\") {\n              this._pos = sheet.axisManager().addRowAbove();\n          } else {\n              this._pos = sheet.axisManager().addRowBelow();\n          }\n      }\n      _undoOne(sheet, index) {\n          sheet.deleteRow(index);\n      }\n  }\n\n  class EditValidationCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._value = options.value;\n      }\n      exec() {\n          let self = this, sheet = self.range().sheet();\n          this.getState();\n          if (sheet.trigger(\"changing\", { data: self._value, range: self.range(), changeType: COMMAND_TYPES.VALIDATION })) {\n              return;\n          }\n          try {\n              sheet.withCultureDecimals(function(){\n                  self.range().validation(self._value);\n              });\n          } catch (ex) {\n              if (ex instanceof calc.runtime.ParseError) {\n                  return {\n                      title: \"Error in formula\",\n                      body: ex + \"\",\n                      reason: \"error\"\n                  };\n              } else {\n                  throw ex;\n              }\n          }\n      }\n      undo() {\n          let editRange = this.range();\n          let state = this._state;\n          if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].validation, range: editRange, changeType: COMMAND_TYPES.VALIDATION })) {\n              return;\n          }\n          this.setState(this._state);\n      }\n  }\n\n  class OpenCommand extends Command {\n      constructor(options) {\n          super(options);\n          this.cannotUndo = true;\n      }\n      exec() {\n          let file = this.options.file;\n          if (file.name.match(/.xlsx$/i) === null) {\n              return { reason: \"error\", type: \"openUnsupported\" };\n          }\n\n          let workbook = this.options.workbook;\n          workbook.fromFile(this.options.file);\n\n          let errors = workbook.excelImportErrors;\n          if (errors && errors.length) {\n              workbook._view.openDialog(\"importError\", {\n                  errors: errors\n              });\n          }\n      }\n  }\n\n  class SaveAsCommand extends Command {\n      constructor(options) {\n          super(options);\n          this.cannotUndo = true;\n      }\n      exec() {\n          let fileName = this.options.name + this.options.extension;\n          if (this.options.extension === \".xlsx\") {\n              return this.options.workbook.saveAsExcel({\n                  fileName: fileName\n              });\n          } else if (this.options.extension === \".pdf\") {\n              this.options.workbook.saveAsPDF(deepExtend(this.options.pdf, { workbook: this.options.workbook, fileName: fileName }));\n          }\n      }\n  }\n\n  class NameCommand extends Command {\n      constructor(options) {\n          super(options);\n          this._name = options.name;\n          this._value = options.value;\n      }\n      getState() {\n          this._state = this._workbook.nameDefinition(this._name);\n      }\n      setState() {\n          this._workbook.nameDefinition(this._name, this._state);\n          this._workbook.trigger(\"change\", { recalc: true });\n      }\n  }\n\n  class DefineNameCommand extends NameCommand {\n      exec() {\n          this.getState();\n          try {\n              this._workbook.defineName(this._name, this._value);\n              this._workbook.trigger(\"change\", { recalc: true });\n          } catch (ex) {\n              return {\n                  title: \"Error\",\n                  body: ex + \"\",\n                  reason: \"error\"\n              };\n          }\n      }\n  }\n\n  class DeleteNameCommand extends NameCommand {\n      exec() {\n          this.getState();\n          this._workbook.undefineName(this._name);\n          this._workbook.trigger(\"change\", { recalc: true });\n      }\n  }\n\n  var commands = /*#__PURE__*/Object.freeze({\n      __proto__: null,\n      AddColumnCommand: AddColumnCommand,\n      AddCommand: AddCommand,\n      AddRowCommand: AddRowCommand,\n      AdjustDecimalsCommand: AdjustDecimalsCommand,\n      AdjustRowHeightCommand: AdjustRowHeightCommand,\n      ApplyFilterCommand: ApplyFilterCommand,\n      AutoFillCommand: AutoFillCommand,\n      BorderChangeCommand: BorderChangeCommand,\n      BringToFrontCommand: BringToFrontCommand,\n      ClearContentCommand: ClearContentCommand,\n      ClearFilterCommand: ClearFilterCommand,\n      ColumnWidthCommand: ColumnWidthCommand,\n      Command: Command,\n      CopyCommand: CopyCommand,\n      CutCommand: CutCommand,\n      DefineNameCommand: DefineNameCommand,\n      DeleteColumnCommand: DeleteColumnCommand,\n      DeleteCommand: DeleteCommand,\n      DeleteDrawingCommand: DeleteDrawingCommand,\n      DeleteNameCommand: DeleteNameCommand,\n      DeleteRowCommand: DeleteRowCommand,\n      DrawingCommand: DrawingCommand,\n      DrawingUpdateCommand: DrawingUpdateCommand,\n      EditCommand: EditCommand,\n      EditValidationCommand: EditValidationCommand,\n      FilterCommand: FilterCommand,\n      FreezePanesCommand: FreezePanesCommand,\n      GridLinesChangeCommand: GridLinesChangeCommand,\n      HideLineCommand: HideLineCommand,\n      HyperlinkCommand: HyperlinkCommand,\n      InsertCommentCommand: InsertCommentCommand,\n      InsertImageCommand: InsertImageCommand,\n      MergeCellCommand: MergeCellCommand,\n      NameCommand: NameCommand,\n      OpenCommand: OpenCommand,\n      PasteCommand: PasteCommand,\n      PropertyChangeCommand: PropertyChangeCommand,\n      PropertyCleanCommand: PropertyCleanCommand,\n      ReorderDrawingsCommand: ReorderDrawingsCommand,\n      RowHeightCommand: RowHeightCommand,\n      SaveAsCommand: SaveAsCommand,\n      SendToBackCommand: SendToBackCommand,\n      SortCommand: SortCommand,\n      TargetValueCommand: TargetValueCommand,\n      TextWrapCommand: TextWrapCommand,\n      ToolbarCopyCommand: ToolbarCopyCommand,\n      ToolbarCutCommand: ToolbarCutCommand,\n      ToolbarPasteCommand: ToolbarPasteCommand,\n      UnHideLineCommand: UnHideLineCommand\n  });\n\n  class UndoRedoStack extends Observable {\n      constructor(options) {\n          super();\n          this.options = options;\n          this.events = [ \"undo\", \"redo\" ];\n          this.clear();\n      }\n\n      push(command) {\n          this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n          this.currentCommandIndex = this.stack.push(command) - 1;\n      }\n      undo() {\n          if (this.canUndo()) {\n              let command = this.stack[this.currentCommandIndex--];\n              command.undo();\n              this.trigger(\"undo\", { command: command });\n          }\n      }\n      redo() {\n          if (this.canRedo()) {\n              let command = this.stack[++this.currentCommandIndex];\n              command.redo();\n              this.trigger(\"redo\", { command: command });\n          }\n      }\n      clear() {\n          this.stack = [];\n          this.currentCommandIndex = -1;\n      }\n      canUndo() {\n          return this.currentCommandIndex >= 0;\n      }\n      canRedo() {\n          return this.currentCommandIndex !== this.stack.length - 1;\n      }\n  }\n\n  /* eslint-disable no-param-reassign */\n  // SAX-style XML parser ====================================================\n  let STRING = String.fromCharCode;\n\n  // XXX: add more here?\n  let ENTITIES = {\n      \"amp\": 38,\n      \"lt\": 60,\n      \"gt\": 62,\n      \"quot\": 34,\n      \"apos\": 39,\n      \"nbsp\": 160\n  };\n\n  function CODE(str) {\n      let out = [];\n      for (let i = 0; i < str.length; ++i) {\n          out.push(str.charCodeAt(i));\n      }\n      return out;\n  }\n\n  function UCS2(out, code) {\n      if (code > 0xFFFF) {\n          code -= 0x10000;\n          out.push(code >>> 10 & 0x3FF | 0xD800,\n                      0xDC00 | code & 0x3FF);\n      } else {\n          out.push(code);\n      }\n  }\n\n  let START_CDATA = CODE(\"<![CDATA[\");\n  let END_CDATA = CODE(\"]]>\");\n  let END_COMMENT = CODE(\"-->\");\n  let START_COMMENT = CODE(\"!--\");\n  let END_SHORT_TAG = CODE(\"/>\");\n  let END_TAG = CODE(\"</\");\n  let END_DECLARATION = CODE(\"?>\");\n  let QUESTION_MARK = CODE(\"?\");\n  let LESS_THAN = CODE(\"<\");\n  let GREATER_THAN = CODE(\">\");\n  let SEMICOLON = CODE(\";\");\n  let EQUAL = CODE(\"=\");\n  let AMPERSAND = CODE(\"&\");\n  let QUOTE = CODE('\"');\n  let APOSTROPHE = CODE(\"'\");\n  let SHARP = CODE(\"#\");\n  let LOWERCASE_X = CODE(\"x\");\n  let UPPERCASE_X = CODE(\"X\");\n\n  let EXIT = {};\n\n  function parse$1(data, callbacks) {\n      let index = 0;\n      let stack = [];\n      let object = {\n          is: function(selector) {\n              let i = stack.length, j = selector.length;\n              while (--i >= 0 && --j >= 0) {\n                  if (stack[i].$tag !== selector[j] && selector[j] !== \"*\") {\n                      return false;\n                  }\n              }\n              return j < 0 ? stack[stack.length - 1] : null;\n          },\n          exit: function() {\n              throw EXIT;\n          },\n          stack: stack\n      };\n\n      function readChar(body) {\n          let code = data[index++];\n          if (!(code & 0xF0 ^ 0xF0)) {// 4 bytes\n              UCS2(body,\n                      ((code & 0x03) << 18) |\n                      ((data[index++] & 0x3F) << 12) |\n                      ((data[index++] & 0x3F) << 6) |\n                      (data[index++] & 0x3F));\n          } else if (!(code & 0xE0 ^ 0xE0)) {// 3 bytes\n              UCS2(body,\n                      ((code & 0x0F) << 12) |\n                      ((data[index++] & 0x3F) << 6) |\n                      (data[index++] & 0x3F));\n          } else if (!(code & 0xC0 ^ 0xC0)) {// 2 bytes\n              UCS2(body,\n                      ((code & 0x1F) << 6) |\n                      (data[index++] & 0x3F));\n          } else {\n              body.push(code);\n          }\n      }\n\n      function croak(msg) {\n          throw new Error(msg + \", at \" + index);\n      }\n\n      function readWhile(pred) {\n          let a = [];\n          while (index < data.length && pred(data[index])) {\n              a.push(data[index++]);\n          }\n          return a;\n      }\n\n      function readAsciiWhile(pred) {\n          return STRING.apply(0, readWhile(pred));\n      }\n\n      function skipWhitespace() {\n          readWhile(isWhitespace);\n      }\n\n      function eat(a) {\n          let save = index;\n          for (let i = 0; i < a.length; ++i) {\n              if (data[index++] !== a[i]) {\n                  index = save;\n                  return false;\n              }\n          }\n          return a;\n      }\n\n      function skip(code) {\n          if (!eat(code)) {\n              croak(\"Expecting \" + code.join(\", \"));\n          }\n      }\n\n      function isWhitespace(code) {\n          return code === 9 || code === 10 || code === 13 || code === 32;\n      }\n\n      function isDigit(code) {\n          return code >= 48 && code <= 57;\n      }\n\n      function isHexDigit(code) {\n          return (code >= 48 && code <= 57) ||\n                  ((code |= 32) >= 97 && code <= 102); // a..f or A..F\n      }\n\n      function isNameStart(code) {\n          return code === 58 ||                      // :\n                  code === 95 ||                      // _\n                  ((code |= 32) >= 97 && code <= 122); // a..z or A..Z\n      }\n\n      function isName(code) {\n          return code === 45 ||                      // -\n                  isDigit(code) ||\n                  isNameStart(code);\n      }\n\n      function xmlComment() {\n          let body = [];\n          while (index < data.length) {\n              if (eat(END_COMMENT)) {\n                  return call(\"comment\", STRING.apply(0, body));\n              }\n              readChar(body);\n          }\n      }\n\n      function xmlTag() {\n          let name, attrs;\n          if (eat(QUESTION_MARK)) {\n              xmlDecl();\n          } else if (eat(START_COMMENT)) {\n              xmlComment();\n          } else {\n              name = xmlName();\n              attrs = xmlAttrs(name);\n              stack.push(attrs);\n              if (eat(END_SHORT_TAG)) {\n                  call(\"enter\", name, attrs, true);\n              } else {\n                  skip(GREATER_THAN);\n                  call(\"enter\", name, attrs);\n                  xmlContent(name);\n                  if (name !== xmlName()) {\n                      croak(\"Bad closing tag\");\n                  }\n                  call(\"leave\", name, attrs);\n                  skipWhitespace();\n                  skip(GREATER_THAN);\n              }\n              stack.pop();\n          }\n      }\n\n      function xmlContent(name) {\n          let body = [];\n          while (index < data.length) {\n              if (eat(END_TAG)) {\n                  return body.length && call(\"text\", STRING.apply(0, body));\n              } else if (eat(START_CDATA)) {\n                  while (index < data.length && !eat(END_CDATA)) {\n                      readChar(body);\n                  }\n              } else if (eat(LESS_THAN)) {\n                  if (body.length) {\n                      call(\"text\", STRING.apply(0, body));\n                  }\n                  xmlTag();\n                  body = [];\n              } else if (eat(AMPERSAND)) {\n                  xmlEntity(body);\n              } else {\n                  readChar(body);\n              }\n          }\n          croak(\"Unclosed tag \" + name);\n      }\n\n      function xmlName() {\n          if (!isNameStart(data[index])) {\n              croak(\"Expecting XML name\");\n          }\n          return readAsciiWhile(isName);\n      }\n\n      function xmlString() {\n          let quote = eat(QUOTE) || eat(APOSTROPHE);\n          if (!quote) {\n              croak(\"Expecting string\");\n          }\n          let body = [];\n          while (index < data.length) {\n              if (eat(quote)) {\n                  return STRING.apply(0, body);\n              } else if (eat(AMPERSAND)) {\n                  xmlEntity(body);\n              } else {\n                  readChar(body);\n              }\n          }\n          croak(\"Unfinished string\");\n      }\n\n      function xmlEntity(body) {\n          let code;\n          if (eat(SHARP)) {\n              if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                  code = parseInt(readAsciiWhile(isHexDigit), 16);\n              } else {\n                  code = parseInt(readAsciiWhile(isDigit), 10);\n              }\n              if (isNaN(code)) {\n                  croak(\"Bad numeric entity\");\n              }\n          } else {\n              let name = xmlName();\n              code = ENTITIES[name];\n              if (code === undefined) {\n                  croak(\"Unknown entity \" + name);\n              }\n          }\n          UCS2(body, code);\n          skip(SEMICOLON);\n      }\n\n      function xmlDecl() {\n          call(\"decl\", xmlName(), xmlAttrs());\n          skip(END_DECLARATION);\n      }\n\n      function xmlAttrs(name) {\n          let map = { $tag: name };\n          while (index < data.length) {\n              skipWhitespace();\n              let code = data[index];\n              if (code === 63 || code === 62 || code === 47) { // ?, > or /\n                  break;\n              }\n              map[xmlName()] = ( skip(EQUAL), xmlString() );\n          }\n          return map;\n      }\n\n      function call(what, thing, arg1, arg2) {\n          let f = callbacks && callbacks[what];\n          if (f) {\n              f.call(object, thing, arg1, arg2);\n          }\n      }\n\n      // skip BOM\n      let tmp = [];\n      readChar(tmp);\n      if (tmp[0] !== 65279) {\n          index = 0;\n      }\n\n      while (index < data.length) {\n          skipWhitespace();\n          skip(LESS_THAN);\n          xmlTag();\n          skipWhitespace();\n      }\n  }\n\n  // Exports ================================================================\n  const parseXML = function parseXML() {\n      try {\n          return parse$1.apply(this, arguments);\n      } catch (ex) {\n          if (ex !== EXIT) {\n              throw ex;\n          }\n      }\n  };\n\n  class Deferred {\r\n      constructor() {\r\n          this._progressHandlers = [];\r\n          this._resolved = false;\r\n          this._rejected = false;\r\n          this.promise = new window.Promise((resolve, reject) => {\r\n              this._resolve = (value) => {\r\n                  if (!this._resolved && !this._rejected) {\r\n                      this._resolved = true;\r\n                      resolve(value);\r\n                  }\r\n              };\r\n              this._reject = (reason) => {\r\n                  if (!this._resolved && !this._rejected) {\r\n                      this._rejected = true;\r\n                      reject(reason);\r\n                  }\r\n              };\r\n          });\r\n      }\r\n\r\n      resolve(value) {\r\n          this._resolve(value);\r\n          return this;\r\n      }\r\n\r\n      reject(reason) {\r\n          this._reject(reason);\r\n          return this;\r\n      }\r\n\r\n      notify(value) {\r\n          if (!this._resolved && !this._rejected) {\r\n              this._progressHandlers.forEach(handler => handler(value));\r\n          }\r\n      }\r\n\r\n      progress(callback) {\r\n          this._progressHandlers.push(callback);\r\n          return this;\r\n      }\r\n\r\n      then(onFulfilled, onRejected, onProgress) {\r\n          if (onProgress) {\r\n              this.progress(onProgress);\r\n          }\r\n          return this.promise.then(onFulfilled, onRejected);\r\n      }\r\n\r\n      promise() {\r\n          return this.promise;\r\n      }\r\n  }\n\n  /* eslint-disable complexity */\n  /* eslint-disable camelcase */\n  /* eslint-disable key-spacing */\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable brace-style */\n  /* eslint-disable no-implicit-coercion */\n  /* eslint-disable no-loop-func */\n  /* eslint-disable no-param-reassign */\n\n  // WARNING: removing the following jshint declaration and turning\n  // == into === to make JSHint happy will break functionality.\n\n  let MAP_EXCEL_OPERATOR = {\n      // includes only what differs; key is Excel's operator, value\n      // is our operator.\n      greaterThanOrEqual: \"greaterThanOrEqualTo\",\n      lessThanOrEqual: \"lessThanOrEqualTo\"\n  };\n\n  let ERROR_LOG = null;\n\n  function readExcel(file, workbook, deferred) {\n      let reader = new FileReader();\n      reader.onload = async function(e) {\n          kendo_jszipEsm_cmn_chunk_js.J.loadAsync(e.target.result)\n              .then(async zip => await readWorkbook(zip, workbook, deferred));\n      };\n\n      reader.readAsArrayBuffer(file);\n  }\n\n  let SEL_CELL = [\"sheetData\", \"row\", \"c\"];\n  let SEL_COL = [\"cols\", \"col\"];\n  let SEL_DEFINED_NAME = [\"definedNames\", \"definedName\"];\n  let SEL_FORMULA = [\"sheetData\", \"row\", \"c\", \"f\"];\n  let SEL_MERGE = [\"mergeCells\", \"mergeCell\"];\n  let SEL_PANE = [\"sheetViews\", \"sheetView\", \"pane\"];\n  let SEL_ROW = [\"sheetData\", \"row\"];\n  let SEL_SELECTION = [\"sheetViews\", \"sheetView\", \"selection\"];\n  let SEL_SHEET = [\"sheets\", \"sheet\"];\n  let SEL_STRING = [\"sheetData\", \"row\", \"c\", \"is\"];\n  let SEL_TEXT = [\"t\"];\n  let SEL_SHARED_STRING = [\"si\"];\n  let SEL_VALUE = [\"sheetData\", \"row\", \"c\", \"v\"];\n  let SEL_VIEW = [\"bookViews\", \"workbookView\"];\n  let SEL_SHEET_VIEW = [\"sheetViews\", \"sheetView\"];\n  let SEL_HYPERLINK = [\"hyperlinks\", \"hyperlink\"];\n  let SEL_PROTECTION = [\"sheetProtection\"];\n\n  /* A validation section looks like this:\n      *\n      * <dataValidations count=\"1\">\n      *   <dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\" sqref=\"B2\">\n      *     <formula1>$E$2:$E$5</formula1>\n      *   </dataValidation>\n      * </dataValidations>\n      */\n  let SEL_VALIDATION = [\"dataValidations\", \"dataValidation\"];\n  let SEL_VALIDATION_FORMULA1 = [\"dataValidations\", \"dataValidation\", \"formula1\"];\n  let SEL_VALIDATION_FORMULA2 = [\"dataValidations\", \"dataValidation\", \"formula2\"];\n\n  /* However, when a validation formula in one sheet references\n      * cells from another sheet, Excel produces this version instead:\n      *\n      * <extLst>\n      *   <ext xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" uri=\"{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}\">\n      *     <x14:dataValidations xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\" count=\"1\">\n      *       <x14:dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\">\n      *         <x14:formula1>\n      *           <xm:f>Sheet2!$B$3:$B$6</xm:f>\n      *         </x14:formula1>\n      *         <xm:sqref>B1</xm:sqref>\n      *       </x14:dataValidation>\n      *     </x14:dataValidations>\n      *   </ext>\n      * </extLst>\n      *\n      * I call it the \"insane version\", because that's what it is.\n      * Barring the case that the engineers who produced this horror\n      * were on LSD, the only plausible reason for it is that Microsoft\n      * does not want third party software to be compatible with Excel\n      * (sentiment I've had over and over while working on the\n      * Spreadsheet widget).\n      */\n  // XXX: technically, the aliases `x14` and `xm` below could be\n  // different, but Excel seems to be hard-coded on these; our\n  // parser does not support proper namespaces for now anyway, so\n  // hard-coded they are.\n  let SEL_VALIDATION_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\"];\n  let SEL_VALIDATION_SQREF_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"xm:sqref\"];\n  let SEL_VALIDATION_FORMULA1_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula1\", \"xm:f\"];\n  let SEL_VALIDATION_FORMULA2_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula2\", \"xm:f\"];\n\n  // comment selectors (in files like comments1.xml)\n  let SEL_COMMENT = [\"commentList\", \"comment\"];\n  let SEL_AUTHOR = [\"authors\", \"author\"];\n  let SEL_COMMENT_TEXT = [\"t\"];\n\n  function xl(file) {\n      if (!/^\\//.test(file)) {\n          if (!/^xl\\//.test(file)) {\n              file = \"xl/\" + file;\n          }\n      } else {\n          file = file.substr(1);\n      }\n      return file;\n  }\n\n  async function readWorkbook(zip, workbook, progress) {\n      ERROR_LOG = workbook.excelImportErrors = [];\n\n      let strings = await readStrings(zip);\n      let relationships = await readRelationships(zip, \"_rels/workbook.xml\");\n      let theme = await readTheme(zip, relationships.byType.theme[0]);\n      let styles = await readStyles(zip, theme);\n      let items = [];\n      let activeSheet = 0;\n\n      await parse(zip, \"xl/workbook.xml\", {\n          enter: function(tag, attrs) {\n              if (this.is(SEL_SHEET)) {\n                  let relId = attrs[\"r:id\"];\n                  let file = relationships.byId[relId];\n                  let name = attrs.name;\n                  let state = attrs.state;\n                  let dim = sheetDimensions(relationships.bytes[file]);\n\n                  workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                  workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n\n                  items.push({\n                      workbook: workbook,\n                      zip: zip,\n                      strings: strings,\n                      styles: styles,\n                      file: file,\n                      options: {\n                          state: state,\n                          name: name,\n                          rows: Math.max(workbook.options.rows || 0, dim.rows),\n                          columns: Math.max(workbook.options.columns || 0, dim.cols),\n                          columnWidth: dim.columnWidth,\n                          rowHeight: dim.rowHeight\n                      }\n                  });\n              } else if (this.is(SEL_VIEW)) {\n                  if (attrs.activeTab) {\n                      activeSheet = integer(attrs.activeTab);\n                  }\n              }\n          },\n          text: function(text) {\n              let attrs = this.is(SEL_DEFINED_NAME);\n              if (attrs && !(bool(attrs[\"function\"]) || bool(attrs.vbProcedure))) {\n                  let localSheetId = attrs.localSheetId;\n                  let sheet = null;\n                  if (localSheetId != null) {\n                      sheet = items[localSheetId].options.name;\n                  }\n                  let name = attrs.name;\n                  if (name !== \"_xlnm._FilterDatabase\") {\n                      if (sheet) {\n                          name = \"'\" + sheet.replace(/\\'/g, \"\\\\'\") + \"'!\" + name;\n                      }\n                      withErrorLog(sheet, null, function() {\n                          workbook.defineName(name, text, bool(attrs.hidden));\n                      }, \"reading user-defined name: \" + name);\n                  }\n              }\n          }\n      });\n\n      let loading = new Deferred();\n      loading.progress(function(args) {\n          if (progress) {\n              progress.notify(args);\n          }\n      })\n      .then(function() {\n          let sheets = workbook.sheets();\n          recalcSheets(sheets);\n\n          workbook.activeSheet(sheets[activeSheet]);\n\n          if (progress) {\n              progress.resolve();\n          }\n      });\n\n      loadSheets(items, workbook, loading);\n  }\n\n  function loadSheets(items, workbook, progress) {\n      let ready = window.Promise.resolve();\n      for (let i = 0; i < items.length; i++) {\n          (function(entry, i) {\n              ready = ready.then(function() {\n                  let sheet = workbook.insertSheet(entry.options);\n                  sheet.suspendChanges(true);\n\n                  let promise = queueSheet(sheet, entry);\n                  let args = {\n                      sheet: sheet,\n                      progress: i === 1 ? 1 : (i / (items.length - 1))\n                  };\n\n                  promise.then(function() {\n                      progress.notify(args);\n                  });\n\n                  return promise;\n              });\n          })(items[i], i);\n      }\n\n      ready.then(function() {\n          progress.resolve();\n      });\n  }\n\n  function queueSheet(sheet, ctx) {\n      let deferred = new Deferred();\n\n      setTimeout(async function() {\n          await readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n          deferred.resolve();\n      }, 0);\n\n      return deferred;\n  }\n\n  function recalcSheets(sheets) {\n      for (let i = 0; i < sheets.length; i++) {\n          sheets[i]\n              .suspendChanges(false)\n              .triggerChange({ recalc: true });\n      }\n  }\n\n  function sheetDimensions(bytes) {\n      let ref, dim = {\n              rows: 0,\n              cols: 0\n          };\n\n      parseXML(bytes, {\n          enter: function(tag, attrs) {\n              if (tag === \"dimension\") {\n                  ref = calc.parseReference(attrs.ref);\n                  if (ref.bottomRight) {\n                      dim.cols = ref.bottomRight.col + 1;\n                      dim.rows = ref.bottomRight.row + 1;\n                  }\n              } else if (tag === \"sheetFormatPr\") {\n                  if (attrs.defaultColWidth) {\n                      dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                  }\n\n                  if (attrs.defaultRowHeight) {\n                      dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                  }\n              } else if (this.is(SEL_ROW) && attrs.r) {\n                  dim.rows = Math.max(dim.rows, +attrs.r);\n              } else if (this.is(SEL_CELL) && attrs.r) {\n                  ref = calc.parseReference(attrs.r);\n                  dim.rows = Math.max(dim.rows, ref.row + 1);\n                  dim.cols = Math.max(dim.cols, ref.col + 1);\n              }\n          }\n      });\n\n      return dim;\n  }\n\n  function toColWidth(size) {\n      // No font to compute agains, hence the magic number\n      let maximumDigitWidth = 7;\n\n      // The formula below is taken from the OOXML spec\n      let fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n      return fraction * maximumDigitWidth;\n  }\n\n  function toRowHeight(pts) {\n      return pts * (4 / 3);\n  }\n\n  async function readSheet(zip, file, sheet, strings, styles) {\n      let sharedFormulas = {};\n      let ref, type, value, formula, formulaRange, isArrayFormula;\n      let nCols = sheet._columns._count;\n      let prevCellRef = null;\n      let relsFile = file.replace(/worksheets\\//, \"worksheets/_rels/\");\n      let relationships = await readRelationships(zip, relsFile);\n      let formula1, formula2;\n\n      let filterRef;\n      let filterColumn;\n      let customFilterLogic;\n      let customFilterCriteria;\n      let valueFilterBlanks;\n      let valueFilterValues;\n      let filters = [];\n      let deferredStyles = [];\n\n      ERROR_LOG = sheet._workbook.excelImportErrors;\n\n      file = xl(file);\n\n      await parse(zip, file, {\n          enter: function(tag, attrs, closed) {\n              let tmp;\n              if (this.is(SEL_FORMULA)) {\n                  if (closed) {\n                      if (attrs.t === \"shared\" && attrs.si != null) {\n                          formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                      }\n                  }\n              } else if (this.is(SEL_CELL)) {\n                  value = null;\n                  formula = null;\n                  ref = attrs.r;\n                  formulaRange = null;\n\n                  if (ref == null) {\n                      // apparently some tools omit the `r` for\n                      // consecutive cells in a row, so we'll figure\n                      // it out from the previous cell's reference.\n                      // XXX: this could be slightly optimized by\n                      // keeping it parsed instead of stringifying\n                      // it to parse it again later.\n                      ref = calc.parseReference(prevCellRef);\n                      ref.col++;\n                      ref = ref.toString();\n                  }\n                  prevCellRef = ref;\n\n                  // XXX: can't find no type actually, so everything is\n                  // interpreted as string.  Additionally, cells having\n                  // a formula will contain both <f> and <v> nodes,\n                  // which makes the value take precedence because it's\n                  // the second node; hence, the hack is to keep note of\n                  // them in the `text` handler, and apply the\n                  // appropriate one in the `leave` handler below.\n                  type = attrs.t;\n\n                  let styleIndex = attrs.s;\n                  if (styleIndex != null) {\n                      deferredStyles.push({ ref: ref,  sty: +styleIndex });\n                  }\n              } else if (this.is(SEL_MERGE)) {\n                  sheet.range(attrs.ref).merge();\n              } else if (this.is(SEL_COL)) {\n                  let start = integer(attrs.min) - 1;\n                  let stop = Math.min(nCols, integer(attrs.max)) - 1;\n                  let width;\n                  if (attrs.width) {\n                      width = toColWidth(parseFloat(attrs.width));\n                      if (width !== 0) {\n                          sheet._columns.values.value(start, stop, width);\n                      }\n                  }\n                  if (attrs.hidden === \"1\" || width === 0) {\n                      for (let ci = start; ci <= stop; ci++) {\n                          sheet.hideColumn(ci);\n                      }\n                  }\n                  if (attrs.style != null) {\n                      // apply style on a whole range of columns\n                      deferredStyles.unshift({\n                          ref: new RangeRef(\n                              new CellRef(-Infinity, start),\n                              new CellRef(+Infinity, stop)\n                          ),\n                          sty: +attrs.style\n                      });\n                  }\n              } else if (this.is(SEL_ROW)) {\n                  let row = integer(attrs.r) - 1;\n                  let height;\n                  if (attrs.ht) {\n                      height = toRowHeight(parseFloat(attrs.ht));\n                      if (height !== 0) {\n                          sheet._rows.values.value(row, row, height);\n                      }\n                  }\n                  if (attrs.hidden === \"1\" || height === 0) {\n                      sheet.hideRow(row);\n                  }\n              } else if (this.is(SEL_SELECTION)) {\n                  if (attrs.activeCell) {\n                      let acRef = calc.parseReference(attrs.activeCell);\n                      sheet.select(acRef, true);\n                  }\n              } else if (this.is(SEL_PANE)) {\n                  if (attrs.state && attrs.state.indexOf(\"frozen\") > -1) {\n                      if (attrs.xSplit) {\n                          sheet.frozenColumns(integer(attrs.xSplit));\n                      }\n\n                      if (attrs.ySplit) {\n                          sheet.frozenRows(integer(attrs.ySplit));\n                      }\n                  }\n              } else if (this.is(SEL_SHEET_VIEW)) {\n                  sheet.showGridLines(bool(attrs.showGridLines, true));\n              } else if (this.is(SEL_HYPERLINK)) {\n                  let relId = attrs[\"r:id\"];\n                  let target = relationships.byId[relId];\n                  if (target) {\n                      sheet.range(attrs.ref).link(target);\n                  }\n              } else if (this.is(SEL_PROTECTION)) {\n                  if (attrs.sheet) {\n                      sheet.range(SHEETREF).enable(false);\n                  }\n              } else if (this.is([\"autoFilter\"])) {\n                  filterRef = attrs.ref;\n                  if (closed) {\n                      addAutoFilter();\n                  }\n              } else if (filterRef) {\n                  if (this.is([\"filterColumn\"])) {\n                      filterColumn = parseInt(attrs.colId, 10);\n                  } else if (this.is([\"customFilters\"])) {\n                      customFilterLogic = bool(attrs.and) ? \"and\" : \"or\";\n                      customFilterCriteria = [];\n                  } else if (this.is([\"customFilter\"])) {\n                      tmp = getCustomFilter(attrs.operator, attrs.val);\n                      if (tmp) {\n                          customFilterCriteria.push({\n                              operator: tmp.operator,\n                              value: tmp.value\n                          });\n                      }\n                  } else if (this.is([\"dynamicFilter\"])) {\n                      filters.push({\n                          column: filterColumn,\n                          filter: new DynamicFilter({\n                              type: dynamicFilterType(attrs.type)\n                          })\n                      });\n                  }\n                  else if (this.is([\"top10\"])) {\n                      filters.push({\n                          column: filterColumn,\n                          filter: new TopFilter({\n                              value: getFilterVal(attrs.val),\n                              type: (function(percent, top) {\n                                  return percent && top ? \"topPercent\"\n                                      : top ? \"topNumber\"\n                                      : percent ? \"bottomPercent\"\n                                      : \"bottomNumber\";\n                              })(bool(attrs.percent), bool(attrs.top))\n                          })\n                      });\n                  }\n                  else if (this.is([\"filters\"])) {\n                      valueFilterBlanks = bool(attrs.blank);\n                      valueFilterValues = [];\n                  }\n                  else if (this.is([\"filter\"])) {\n                      valueFilterValues.push(getFilterVal(attrs.val));\n                  }\n              }\n          },\n          leave: function(tag, attrs) {\n              if (this.is(SEL_FORMULA)) {\n                  if (!formula && attrs.t === \"shared\" && attrs.si != null) {\n                      formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                  }\n              }\n              else if (this.is(SEL_CELL)) {\n                  if (formula != null) {\n                      let failed = withErrorLog(sheet, formulaRange || ref, function() {\n                          sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                      }, \"parsing formula\");\n                      if (failed) {\n                          sheet.range(formulaRange || ref).value(formula)\n                              .background(\"#ffaaaa\");\n                      }\n                  } else if (value != null) {\n                      let range = sheet.range(ref);\n\n                      if (!range._get(\"formula\")) {\n                          // Check for \"shared\" formulas before applying a value.\n                          if (!type || type === \"n\") {\n                              value = parseFloat(value);\n                          } else if (type === \"s\") {\n                              value = strings[integer(value)];\n                          } else if (type === \"b\") {\n                              value = value === \"1\";\n                          } else if (type === \"d\") {\n                              value = intl().parseDate(value);\n                          }\n\n                          if (value != null) {\n                              range.value(value);\n                          }\n                      }\n                  }\n              } else if (this.is(SEL_VALIDATION) ||\n                          this.is(SEL_VALIDATION_INSANE)) {\n                  (function() {\n                      let refs = calc.parseSqref(attrs.sqref);\n                      let type = attrs.type.toLowerCase();\n                      let operator = attrs.operator;\n                      if (/^(?:whole|decimal)$/.test(type)) {\n                          // we only support \"number\"\n                          type = \"number\";\n                      } else if (type === \"list\") {\n                          // there'll be no operator from Excel for lists\n                          operator = \"list\";\n                      }\n                      if (!operator && /^(?:number|date)$/.test(type)) {\n                          // Excel skips setting the operator for\n                          // \"between\", because why not.\n                          operator = \"between\";\n                      }\n                      refs.forEach(function(ref) {\n                          withErrorLog(sheet, ref, function() {\n                              sheet.range(ref).validation({\n                                  type             : bool(attrs.showErrorMessage, true) ? \"reject\" : \"warning\",\n                                  from             : formula1,\n                                  to               : formula2,\n                                  dataType         : type,\n                                  comparerType     : MAP_EXCEL_OPERATOR[operator] || operator,\n                                  allowNulls       : bool(attrs.allowBlank),\n                                  showButton       : bool(attrs.showDropDown) || type === \"date\" || type === \"list\",\n                                  messageTemplate  : attrs.error,\n                                  titleTemplate    : attrs.errorTitle\n                              });\n                          }, \"parsing validation\");\n                      });\n                  })();\n              } else if (tag === \"cols\") {\n                  sheet._columns._refresh();\n              } else if (tag === \"sheetData\") {\n                  sheet._rows._refresh();\n              } else if (tag === \"autoFilter\") {\n                  addAutoFilter();\n              } else if (filterRef) {\n                  if (tag === \"customFilters\") {\n                      filters.push({\n                          column: filterColumn,\n                          filter: new CustomFilter({\n                              logic: customFilterLogic,\n                              criteria: customFilterCriteria\n                          })\n                      });\n                  } else if (tag === \"filters\") {\n                      filters.push({\n                          column: filterColumn,\n                          filter: new ValueFilter({\n                              values: valueFilterValues,\n                              blanks: valueFilterBlanks\n                          })\n                      });\n                  }\n              }\n          },\n          text: function(text) {\n              let attrs;\n              if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                  value = text;\n              } else if ((attrs = this.is(SEL_FORMULA))) {\n                  formula = text;\n                  isArrayFormula = attrs.t === \"array\";\n                  if (isArrayFormula) {\n                      formulaRange = attrs.ref;\n                  } else if (attrs.t === \"shared\") {\n                      sharedFormulas[attrs.si] = ref;\n                  }\n              } else if (this.is(SEL_VALIDATION_FORMULA1) ||\n                          this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                  formula1 = text;\n              } else if (this.is(SEL_VALIDATION_FORMULA2) ||\n                          this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                  formula2 = text;\n              } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                  // put it in <dataValidation>'s attributes where it should be\n                  this.stack[this.stack.length - 2].sqref = text;\n              }\n          }\n      });\n\n      deferredStyles.forEach(({ ref, sty }) => applyStyle(sheet, ref, styles, sty));\n\n      if (relationships.byType.comments) {\n          let commentFile = relative_file(file, relationships.byType.comments[0]);\n          await readComments(zip, commentFile, sheet);\n      }\n\n      if (relationships.byType.drawing) {\n          let drawingFile = relative_file(file, relationships.byType.drawing[0]);\n          await readDrawings(zip, drawingFile, sheet);\n      }\n\n      function addAutoFilter() {\n          sheet.range(filterRef).filter(filters);\n          filterRef = null;\n      }\n  }\n\n  function getContentType(filename) {\n      let m = /\\.([^.]+)$/.exec(filename);\n      if (m && m[1]) {\n          return {\n              jpg  : \"image/jpeg\",\n              jpeg : \"image/jpeg\",\n              png  : \"image/png\",\n              gif  : \"image/gif\",\n              wmf  : \"image/wmf\"\n          }[m[1].toLowerCase()];\n      }\n  }\n\n  function getFileName(filename) {\n      let m = /[^/]+$/.exec(filename);\n      return m && m[0];\n  }\n\n  async function readDrawings(zip, file, sheet) {\n      let sel_two_cell_anchor = [ \"xdr:twoCellAnchor\" ];\n      let sel_ext = [ \"xdr:ext\" ];\n      let sel_one_cell_anchor = [ \"xdr:oneCellAnchor\" ];\n      let sel_from = [ \"xdr:from\" ];\n      let sel_to = [ \"xdr:to\" ];\n      let sel_row = [ \"xdr:row\" ];\n      let sel_col = [ \"xdr:col\" ];\n      let sel_row_offset = [ \"xdr:rowOff\" ];\n      let sel_col_offset = [ \"xdr:colOff\" ];\n      let sel_blip = [ \"xdr:blipFill\", \"a:blip\" ];\n\n      let relsFile = file.replace(/drawings\\//, \"drawings/_rels/\");\n      let relationships = await readRelationships(zip, relsFile);\n\n      if (relationships.byType.image) {\n          let relkeys = Object.keys(relationships.byId);\n          for (let i = 0; i < relkeys.length; ++i) {\n              let id = relkeys[i];\n              let img = relative_file(file, relationships.byId[id]);\n              let type = getContentType(img);\n\n              if (type) {\n                  let data = await zip.file(img).async(\"arraybuffer\");\n                  let name = getFileName(img);\n                  let blob = name && !(kendo_common_cmn_chunk_js.b.edge)\n                      ? new window.File([ data ], name, { type: type })\n                      : new window.Blob([ data ], { type: type });\n                  relationships.byId[id] = sheet._workbook.addImage(blob);\n              }\n          }\n      }\n\n      let cdr, ref, width, height;\n      await parse(zip, file, {\n          enter: function(tag, attrs) {\n              if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                  cdr = {};\n              }\n              else if (this.is(sel_from) || this.is(sel_to)) {\n                  ref = {};\n              }\n              else if (this.is(sel_blip)) {\n                  let id = attrs[\"r:embed\"];\n                  cdr.image = relationships.byId[id];\n              }\n              else if (this.is(sel_ext)) {\n                  width = excelToPixels(parseFloat(attrs.cx));\n                  height = excelToPixels(parseFloat(attrs.cy));\n              }\n          },\n          leave: function() {\n              if (this.is(sel_from)) {\n                  cdr.topLeftCell = new CellRef(ref.row, ref.col);\n                  cdr.offsetX = excelToPixels(ref.colOffset);\n                  cdr.offsetY = excelToPixels(ref.rowOffset);\n              }\n              else if (this.is(sel_to)) {\n                  cdr.brCell = new CellRef(ref.row, ref.col);\n                  cdr.brX = excelToPixels(ref.colOffset);\n                  cdr.brY = excelToPixels(ref.rowOffset);\n              }\n              // Add drawing only when it is image\n              else if (this.is(sel_two_cell_anchor) && cdr.image) {\n                  let left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                  let top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                  let right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                  let bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n\n                  sheet.addDrawing({\n                      topLeftCell : cdr.topLeftCell,\n                      offsetX     : cdr.offsetX,\n                      offsetY     : cdr.offsetY,\n                      width       : width != null ? width : right - left,\n                      height      : height != null ? height : bottom - top,\n                      image       : cdr.image,\n                      opacity     : 1\n                  });\n              }\n              // Add drawing only when it is image\n              else if (this.is(sel_one_cell_anchor) && cdr.image) {\n                  sheet.addDrawing({\n                      topLeftCell : cdr.topLeftCell,\n                      offsetX     : cdr.offsetX,\n                      offsetY     : cdr.offsetY,\n                      width       : width,\n                      height      : height,\n                      image       : cdr.image,\n                      opacity     : 1\n                  });\n              }\n          },\n          text: function(text) {\n              if (this.is(sel_row)) {\n                  ref.row = parseFloat(text);\n              }\n              else if (this.is(sel_col)) {\n                  ref.col = parseFloat(text);\n              }\n              else if (this.is(sel_row_offset)) {\n                  ref.rowOffset = parseFloat(text);\n              }\n              else if (this.is(sel_col_offset)) {\n                  ref.colOffset = parseFloat(text);\n              }\n          }\n      });\n  }\n\n  async function readComments(zip, file, sheet) {\n      let authors = [];\n      let author;\n      let comment;\n      await parse(zip, file, {\n          enter: function(tag, attrs) {\n              if (this.is(SEL_COMMENT)) {\n                  comment = {\n                      author: authors[attrs.authorId],\n                      ref: attrs.ref,\n                      text: \"\"\n                  };\n              } else if (this.is(SEL_AUTHOR)) {\n                  author = \"\";\n              }\n          },\n          leave: function() {\n              if (this.is(SEL_COMMENT)) {\n                  sheet.range(comment.ref).comment(comment.text);\n              } else if (this.is(SEL_AUTHOR)) {\n                  authors.push(author);\n              }\n          },\n          text: function(text) {\n              if (this.is(SEL_COMMENT_TEXT)) {\n                  comment.text += text;\n              } else if (this.is(SEL_AUTHOR)) {\n                  author += text;\n              }\n          }\n      });\n  }\n\n  function getCustomFilter(op, value) {\n      let ourOp = {\n          equal               : \"eq\",\n          notEqual            : \"ne\",\n          greaterThan         : \"gt\",\n          greaterThanOrEqual  : \"gte\",\n          lessThan            : \"lt\",\n          lessThanOrEqual     : \"lte\"\n      }[op];\n\n      value = getFilterVal(value);\n\n      if (ourOp && typeof value == \"number\") {\n          return { operator: ourOp, value: value };\n      }\n\n      if ((op === \"notEqual\" || !op) && typeof value == \"string\") {\n          // Excel text operators support * and ? wildcards.  Since\n          // our startswith/endswith/contains filters do not, we\n          // can't really use them here, so we'll apply the more\n          // generic \"matches\" and \"doesnotmatch\" filters.\n          return {\n              operator: op ? \"doesnotmatch\" : \"matches\",\n              value: value\n          };\n      }\n  }\n\n  function dynamicFilterType(type) {\n      return {\n          Q1  : \"quarter1\",\n          Q2  : \"quarter2\",\n          Q3  : \"quarter3\",\n          Q4  : \"quarter4\",\n          M1  : \"january\",\n          M2  : \"february\",\n          M3  : \"march\",\n          M4  : \"april\",\n          M5  : \"may\",\n          M6  : \"june\",\n          M7  : \"july\",\n          M8  : \"august\",\n          M9  : \"september\",\n          M10 : \"october\",\n          M11 : \"november\",\n          M12 : \"december\"\n      }[type.toUpperCase()] || type;\n  }\n\n  function getFilterVal(val) {\n      let tmp = parseFloat(val);\n      if (!isNaN(tmp) && tmp === val) {\n          return tmp;\n      }\n      return val;\n  }\n\n  function withErrorLog(sheet, ref, func, context) {\n      try {\n          func();\n          return false;\n      } catch (ex) {\n          let err = { context: context, error: String(ex) };\n          if (sheet && sheet.name) {\n              err.sheet = sheet.name();\n          } else if (sheet) {\n              err.sheet = sheet;\n          }\n          if (ref) {\n              err.location = String(ref);\n          }\n          ERROR_LOG.push(err);\n          return true;\n      }\n  }\n\n  let BORDER_WIDTHS = {\n      \"none\"            : 0,\n      \"thin\"            : 1,\n      \"medium\"          : 2,\n      \"dashed\"          : 1,\n      \"dotted\"          : 1,\n      \"thick\"           : 3,\n      \"double\"          : 3,\n      \"hair\"            : 1,\n      \"mediumDashed\"    : 2,\n      \"dashDot\"         : 1,\n      \"mediumDashDot\"   : 2,\n      \"dashDotDot\"      : 1,\n      \"mediumDashDotDot\": 2,\n      \"slantDashDot\"    : 1\n  };\n\n  let DEFAULT_FORMATS = {\n      0  : \"General\",\n      1  : \"0\",\n      2  : \"0.00\",\n      3  : \"#,##0\",\n      4  : \"#,##0.00\",\n      9  : \"0%\",\n      10 : \"0.00%\",\n      11 : \"0.00E+00\",\n      12 : \"# ?/?\",\n      13 : \"# ??/??\",\n      14 : \"mm-dd-yy\",\n      15 : \"d-mmm-yy\",\n      16 : \"d-mmm\",\n      17 : \"mmm-yy\",\n      18 : \"h:mm AM/PM\",\n      19 : \"h:mm:ss AM/PM\",\n      20 : \"h:mm\",\n      21 : \"h:mm:ss\",\n      22 : \"m/d/yy h:mm\",\n      37 : \"#,##0 ;(#,##0)\",\n      38 : \"#,##0 ;[Red](#,##0)\",\n      39 : \"#,##0.00;(#,##0.00)\",\n      40 : \"#,##0.00;[Red](#,##0.00)\",\n      45 : \"mm:ss\",\n      46 : \"[h]:mm:ss\",\n      47 : \"mmss.0\",\n      48 : \"##0.0E+0\",\n      49 : \"@\"\n  };\n\n  function applyStyle(sheet, ref, styles, styleIndex) {\n      let range = sheet.range(ref);\n      let xf = styles.inlineStyles[styleIndex], base, value;\n      if (xf.xfId) {\n          base = styles.namedStyles[xf.xfId];\n      }\n      if (shouldSet(\"applyBorder\", \"borderId\")) {\n          setBorder(styles.borders[value]);\n      }\n      if (shouldSet(\"applyFont\", \"fontId\")) {\n          setFont(styles.fonts[value]);\n      }\n      if (shouldSet(\"applyAlignment\", \"textAlign\")) {\n          range.textAlign(value);\n      }\n      if (shouldSet(\"applyAlignment\", \"verticalAlign\")) {\n          range.verticalAlign(value);\n      }\n      if (shouldSet(\"applyAlignment\", \"indent\")) {\n          range.indent(value);\n      }\n      if (shouldSet(\"applyAlignment\", \"wrapText\")) {\n          // don't use range.wrap to avoid recomputing row height\n          range._property(\"wrap\", value);\n      }\n      if (shouldSet(\"applyFill\", \"fillId\")) {\n          setFill(styles.fills[value]);\n      }\n      if (shouldSet(\"applyNumberFormat\", \"numFmtId\")) {\n          setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n      }\n      if (shouldSet(\"applyProtection\", \"protection\")) {\n          range.enable(!xf.protection.locked);\n      }\n\n      function setFormat(f) {\n          let format = typeof f == \"string\" ? f : f.formatCode;\n          if (format != null && !/^general$/i.test(format)) {\n              // XXX: drop locale info.\n              // http://stackoverflow.com/questions/894805/excel-number-format-what-is-409\n              // not supported by the formatting library.\n              format = format.replace(/^\\[\\$-[0-9]+\\]/, \"\");\n              range.format(format);\n          }\n      }\n\n      function setFill(f) {\n          if (f.type === \"solid\") {\n              range.background(f.color);\n          }\n      }\n\n      function setFont(f) {\n          range.fontFamily(f.name);\n          //range.fontSize(f.size); //XXX: will recalc row height.\n          // converting from points to pixels\n          if (f.size) {\n              range._property(\"fontSize\", f.size * 4 / 3);\n          }\n          if (f.bold) {\n              range.bold(true);\n          }\n          if (f.italic) {\n              range.italic(true);\n          }\n          if (f.underline) {\n              range.underline(true);\n          }\n          if (f.color) {\n              range.color(f.color);\n          }\n      }\n\n      function setBorder(b) {\n          function set(side, prop) {\n              let border = b[side];\n              if (!border) {\n                  return;\n              }\n\n              let width = BORDER_WIDTHS[border.style];\n              if (!width) {\n                  return;\n              }\n\n              let color = border.color;\n              if (color == null) {\n                  color = \"#000\";\n              }\n\n              let value = { size: width, color: color };\n              if (side === \"diagonal\") {\n                  value.type = border.up << 1 | border.down;\n              }\n\n              range._property(prop, value);\n          }\n\n          set(\"left\", \"borderLeft\");\n          set(\"top\", \"borderTop\");\n          set(\"right\", \"borderRight\");\n          set(\"bottom\", \"borderBottom\");\n          set(\"diagonal\", \"dBorders\");\n      }\n\n      function shouldSet(applyName, propName) {\n          let t = xf[applyName];\n          if (t != null && !t) {\n              return false;\n          }\n          value = xf[propName];\n          if (base && value == null) {\n              t = base[applyName];\n              if (t != null && !t) {\n                  return false;\n              }\n              value = base[propName];\n          }\n          return value != null;\n      }\n  }\n\n  function parse(zip, file, callbacks) {\n      return new window.Promise(resolve => {\n          let obj = zip.file(file);\n          if (obj) {\n              obj.async(\"uint8array\").then(bytes => {\n                  parseXML(bytes, callbacks);\n                  resolve();\n              });\n          } else {\n              resolve();\n          }\n      });\n  }\n\n  async function readStrings(zip) {\n      let strings = [];\n      let current = null;\n      await parse(zip, \"xl/sharedStrings.xml\", {\n          leave: function() {\n              if (this.is(SEL_SHARED_STRING)) {\n                  strings.push(current);\n                  current = null;\n              }\n          },\n          text: function(text) {\n              if (this.is(SEL_TEXT)) {\n                  if (current == null) {\n                      current = \"\";\n                  }\n                  current += text;\n              }\n          }\n      });\n      return strings;\n  }\n\n  async function readRelationships(zip, file) {\n      let map = { byId: {}, byType: { theme: [] }, bytes: {} };\n      await parse(zip, xl(file) + \".rels\", {\n          enter: function(tag, attrs) {\n              if (tag === \"Relationship\") {\n                  map.byId[attrs.Id] = attrs.Target;\n\n                  let type = attrs.Type.match(/\\w+$/)[0];\n                  let entries = map.byType[type] || [];\n                  entries.push(attrs.Target);\n                  map.byType[type] = entries;\n              }\n          }\n      });\n      let names = [];\n      let promises = [];\n      Object.keys(map.byId).forEach(id => {\n          let filename = map.byId[id];\n          let obj = zip.file(xl(filename));\n          if (obj) {\n              names.push(filename);\n              promises.push(obj.async(\"uint8array\"));\n          }\n      });\n      let data = await window.Promise.all(promises);\n      names.forEach((name, i) => map.bytes[name] = data[i]);\n      return map;\n  }\n\n  let SEL_BORDER = [\"borders\", \"border\"];\n  let SEL_FILL = [\"fills\", \"fill\"];\n  let SEL_FONT = [\"fonts\", \"font\"];\n  let SEL_INLINE_STYLE = [\"cellXfs\", \"xf\"];\n  let SEL_NAMED_STYLE = [\"cellStyleXfs\", \"xf\"];\n  let SEL_NUM_FMT = [\"numFmts\", \"numFmt\"];\n\n  let INDEXED_COLORS = [\n      toCSSColor(\"FF000000\"), toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"),\n      toCSSColor(\"FF00FF00\"), toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"),\n      toCSSColor(\"FFFF00FF\"), toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF000000\"),\n      toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"), toCSSColor(\"FF00FF00\"),\n      toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FFFF00FF\"),\n      toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008000\"),\n      toCSSColor(\"FF000080\"), toCSSColor(\"FF808000\"), toCSSColor(\"FF800080\"),\n      toCSSColor(\"FF008080\"), toCSSColor(\"FFC0C0C0\"), toCSSColor(\"FF808080\"),\n      toCSSColor(\"FF9999FF\"), toCSSColor(\"FF993366\"), toCSSColor(\"FFFFFFCC\"),\n      toCSSColor(\"FFCCFFFF\"), toCSSColor(\"FF660066\"), toCSSColor(\"FFFF8080\"),\n      toCSSColor(\"FF0066CC\"), toCSSColor(\"FFCCCCFF\"), toCSSColor(\"FF000080\"),\n      toCSSColor(\"FFFF00FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FF00FFFF\"),\n      toCSSColor(\"FF800080\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008080\"),\n      toCSSColor(\"FF0000FF\"), toCSSColor(\"FF00CCFF\"), toCSSColor(\"FFCCFFFF\"),\n      toCSSColor(\"FFCCFFCC\"), toCSSColor(\"FFFFFF99\"), toCSSColor(\"FF99CCFF\"),\n      toCSSColor(\"FFFF99CC\"), toCSSColor(\"FFCC99FF\"), toCSSColor(\"FFFFCC99\"),\n      toCSSColor(\"FF3366FF\"), toCSSColor(\"FF33CCCC\"), toCSSColor(\"FF99CC00\"),\n      toCSSColor(\"FFFFCC00\"), toCSSColor(\"FFFF9900\"), toCSSColor(\"FFFF6600\"),\n      toCSSColor(\"FF666699\"), toCSSColor(\"FF969696\"), toCSSColor(\"FF003366\"),\n      toCSSColor(\"FF339966\"), toCSSColor(\"FF003300\"), toCSSColor(\"FF333300\"),\n      toCSSColor(\"FF993300\"), toCSSColor(\"FF993366\"), toCSSColor(\"FF333399\"),\n      toCSSColor(\"FF333333\"),\n      toCSSColor(\"FF000000\"), // System Foreground\n      toCSSColor(\"FFFFFFFF\")  // System Background\n  ];\n\n  async function readStyles(zip, theme) {\n      let styles = {\n          fonts        : [],\n          numFmts      : {},\n          fills        : [],\n          borders      : [],\n          namedStyles  : [],\n          inlineStyles : []\n      };\n      let font = null;\n      let fill = null;\n      let border = null;\n      let xf = null;\n      await parse(zip, \"xl/styles.xml\", {\n          enter: function(tag, attrs, closed) {\n              if (this.is(SEL_NUM_FMT)) {\n                  styles.numFmts[attrs.numFmtId] = attrs;\n              }\n              else if (this.is(SEL_FONT)) {\n                  styles.fonts.push(font = {});\n                  if (closed) {\n                      // apparently, there's XLSX in the wild with\n                      // <font/>, because why not (also, <border/>).\n                      // if we don't null the variable, we always\n                      // enter below and effectively ignore the rest\n                      // of the file.\n                      font = null;\n                  }\n              } else if (font) {\n                  if (tag === \"sz\") {\n                      font.size = parseFloat(attrs.val);\n                  } else if (tag === \"name\") {\n                      font.name = attrs.val;\n                  } else if (tag === \"b\") {\n                      font.bold = bool(attrs.val, true);\n                  } else if (tag === \"i\") {\n                      font.italic = bool(attrs.val, true);\n                  } else if (tag === \"u\") {\n                      font.underline = (attrs.val == null || attrs.val === \"single\");\n                  } else if (tag === \"color\") {\n                      font.color = getColor(attrs, null);\n                  }\n              }\n              else if (this.is(SEL_FILL)) {\n                  styles.fills.push(fill = {});\n                  if (closed) {\n                      fill = null;\n                  }\n              } else if (fill) {\n                  if (tag === \"patternFill\") {\n                      fill.type = attrs.patternType;\n                  } else if (tag === \"fgColor\" && fill.type === \"solid\") {\n                      fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                  } else if (tag === \"bgColor\" && fill.type !== \"solid\") {\n                      fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                  }\n              }\n              else if (this.is(SEL_BORDER)) {\n                  styles.borders.push(border = {\n                      diagonalUp   : +bool(attrs.diagonalUp, 0),\n                      diagonalDown : +bool(attrs.diagonalDown, 0)\n                  });\n                  if (closed) {\n                      border = null;\n                  }\n              } else if (border) {\n                  if (/^(?:left|top|right|bottom|diagonal)$/.test(tag)) {\n                      border[tag] = { style: attrs.style || \"none\" };\n                      if (tag === \"diagonal\") {\n                          border.diagonal.up = border.diagonalUp;\n                          border.diagonal.down = border.diagonalDown;\n                      }\n                  }\n                  if (tag === \"color\") {\n                      let side = this.stack[this.stack.length - 2].$tag;\n                      border[side].color = getColor(attrs, INDEXED_COLORS[0]);\n                  }\n              }\n              else if (this.is(SEL_NAMED_STYLE)) {\n                  xf = getXf(attrs);\n                  styles.namedStyles.push(xf);\n                  if (closed) {\n                      xf = null;\n                  }\n              } else if (this.is(SEL_INLINE_STYLE)) {\n                  xf = getXf(attrs);\n                  styles.inlineStyles.push(xf);\n                  if (closed) {\n                      xf = null;\n                  }\n              } else if (xf) {\n                  if (tag === \"alignment\") {\n                      if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                          xf.textAlign = attrs.horizontal;\n                      }\n                      if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                          xf.verticalAlign = attrs.vertical;\n                      }\n                      if (attrs.wrapText != null) {\n                          xf.wrapText = bool(attrs.wrapText);\n                      }\n                      if (attrs.indent != null) {\n                          xf.indent = integer(attrs.indent);\n                      }\n                  } else if (tag == \"protection\") {\n                      xf.protection = {\n                          locked: bool(attrs.locked)\n                      };\n                  }\n              }\n          },\n          leave: function(tag) {\n              if (this.is(SEL_FONT)) {\n                  font = null;\n              } else if (this.is(SEL_FILL)) {\n                  fill = null;\n              } else if (this.is(SEL_BORDER)) {\n                  border = null;\n              } else if (tag === \"xf\") {\n                  xf = null;\n              }\n          }\n      });\n\n      function getXf(attrs) {\n          let xf = {\n              borderId          : integer(attrs.borderId),\n              fillId            : integer(attrs.fillId),\n              fontId            : integer(attrs.fontId),\n              numFmtId          : integer(attrs.numFmtId),\n              pivotButton       : bool(attrs.pivotButton),\n              quotePrefix       : bool(attrs.quotePrefix),\n              xfId              : integer(attrs.xfId)\n          };\n          addBool(\"applyAlignment\");\n          addBool(\"applyBorder\");\n          addBool(\"applyFill\");\n          addBool(\"applyFont\");\n          addBool(\"applyNumberFormat\");\n          if (addBool(\"applyProtection\")) {\n              xf.protection = { locked: true };\n          }\n          function addBool(name) {\n              if (attrs[name] != null) {\n                  return xf[name] = bool(attrs[name]);\n              }\n          }\n          return xf;\n      }\n\n      function getColor(attrs, defaultThemeColor) {\n          if (attrs.rgb) {\n              return toCSSColor(attrs.rgb);\n          } else if (attrs.indexed) {\n              return INDEXED_COLORS[integer(attrs.indexed)];\n          } else if (attrs.theme) {\n              let themeColor = theme.colorScheme[integer(attrs.theme)];\n              if (!themeColor) {\n                  // returning black by default for font color causes\n                  // https://github.com/telerik/kendo-ui-core/issues/5826\n                  // in default cell style, color is undefined\n                  return defaultThemeColor;\n              }\n\n              let color = kendo_drawing_cmn_chunk_js.q(themeColor);\n\n              if (attrs.tint) {\n                  color = color.toHSL();\n\n                  let tint = parseFloat(attrs.tint);\n                  if (tint < 0) {\n                      color.l = color.l * (1 + tint);\n                  } else {\n                      color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                  }\n              }\n\n              return color.toCssRgba();\n          }\n      }\n\n      return styles;\n  }\n\n  let SEL_SCHEME_RGBCLR = [\"a:clrScheme\", \"*\", \"a:srgbClr\"];\n  let SEL_SCHEME_SYSCLR = [\"a:clrScheme\", \"*\", \"a:sysClr\"];\n  async function readTheme(zip, rel) {\n      let scheme = [];\n      let theme = {\n          colorScheme: scheme\n      };\n\n      let file = xl(rel);\n      if (zip.file(file)) {\n          await parse(zip, file, {\n              enter: function(tag, attrs) {\n                  if (this.is(SEL_SCHEME_SYSCLR)) {\n                      scheme.push(toCSSColor(\n                          attrs.val === \"window\" ? \"FFFFFFFF\" : \"FF000000\"\n                      ));\n                  } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                      scheme.push(toCSSColor(\"FF\" + attrs.val));\n                  }\n              }\n          });\n\n          if (scheme.length > 3) {\n              // lt1 <-> dk1\n              swap(scheme, 0, 1);\n              // lt2 <-> dk2\n              swap(scheme, 2, 3);\n          }\n      }\n\n      function swap(arr, a, b) {\n          let tmp = arr[a];\n          arr[a] = arr[b];\n          arr[b] = tmp;\n      }\n\n      return theme;\n  }\n\n  function integer(val) {\n      return val == null ? null : parseInt(val, 10);\n  }\n\n  function bool(val, def) {\n      if (val == null) {\n          return def;\n      }\n      return val === \"true\" || val === true || val === 1 || val === '1';\n  }\n\n  function toCSSColor(rgb) {\n      let m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n      return \"rgba(\" +\n          parseInt(m[2], 16) + \", \" +\n          parseInt(m[3], 16) + \", \" +\n          parseInt(m[4], 16) + \", \" +\n          parseInt(m[1], 16) / 255 + \")\";\n  }\n\n  function relative_file(base, name) {\n      base = base.split(/\\/+/);\n      name = name.split(/\\/+/);\n      base.pop();\n      while (name.length) {\n          let part = name.shift();\n          if (part === \"\") {\n              base = [];      // absolute\n          } else if (part === \".\") {\n              continue;\n          } else if (part === \"..\") {\n              base.pop();\n          } else {\n              base.push(part);\n          }\n      }\n      return base.join(\"/\");\n  }\n\n  function excelToPixels(val) {\n      return val / 9525;\n  }\n\n  /* eslint-disable no-undef */\n  /* eslint-disable no-nested-ternary */\n  /* eslint-disable key-spacing */\n  /* eslint-disable consistent-return */\n  /* eslint-disable no-param-reassign */\n\n\n  const events$1 = [\n      \"cut\",\n      \"copy\",\n      \"paste\",\n      \"changing\",\n      \"change\",\n      \"contextmenu\",\n      \"excelImport\",\n      \"excelExport\",\n      \"insertSheet\",\n      \"removeSheet\",\n      \"selectSheet\",\n      \"renameSheet\",\n      \"insertRow\",\n      \"insertColumn\",\n      \"deleteRow\",\n      \"deleteColumn\",\n      \"hideRow\",\n      \"hideColumn\",\n      \"unhideRow\",\n      \"unhideColumn\",\n      \"select\",\n      \"changeFormat\",\n      \"dataBinding\",\n      \"dataBound\",\n      \"progress\"\n  ];\n\n  function loadBinary(url, callback) {\n      let xhr = new XMLHttpRequest();\n      xhr.onload = function() {\n          callback(xhr.response, xhr.getResponseHeader(\"Content-Type\"));\n      };\n      xhr.onerror = function() {\n          callback(null);\n      };\n      xhr.open(\"GET\", url);\n      xhr.responseType = \"arraybuffer\";\n      xhr.send();\n  }\n\n  class Workbook extends Observable {\n      constructor(options, view) {\n          super();\n          this.events = events$1;\n\n          this.options = options;\n\n          this._view = view;\n          this._sheets = [];\n          this._images = {};\n          this._imgID = 0;\n\n          this._sheetsSearchCache = {};\n\n          this._sheet = this.insertSheet({\n              rows: this.options.rows,\n              columns: this.options.columns,\n              rowHeight: this.options.rowHeight,\n              columnWidth: this.options.columnWidth,\n              headerHeight: this.options.headerHeight,\n              headerWidth: this.options.headerWidth,\n              dataSource: this.options.dataSource\n          });\n\n          this.undoRedoStack = new UndoRedoStack();\n          this.undoRedoStack.bind([\"undo\", \"redo\"], this._onUndoRedo.bind(this));\n\n          this._context = new FormulaContext(this);\n          this._validationContext = new ValidationFormulaContext(this);\n          this._names = Object.create(null);\n\n          this.fromJSON(this.options);\n      }\n\n      clipboard() {\n          if (!this._clipboard) {\n              this._clipboard = new Clipboard(this);\n          }\n          return this._clipboard;\n      }\n\n      destroy() {\n          this.unbind();\n\n          if (this._clipboard) {\n              this._clipboard.destroy();\n          }\n      }\n\n      _sheetChanging(e) {\n          if (this.trigger(\"changing\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetChange(e) {\n          this.trigger(\"change\", e);\n      }\n\n      _sheetInsertRow(e) {\n          if (this.trigger(\"insertRow\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetInsertColumn(e) {\n          if (this.trigger(\"insertColumn\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetDeleteRow(e) {\n          if (this.trigger(\"deleteRow\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetDeleteColumn(e) {\n          if (this.trigger(\"deleteColumn\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetHideRow(e) {\n          if (this.trigger(\"hideRow\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetHideColumn(e) {\n          if (this.trigger(\"hideColumn\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetUnhideRow(e) {\n          if (this.trigger(\"unhideRow\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetUnhideColumn(e) {\n          if (this.trigger(\"unhideColumn\", {\n              sheet: e.sender,\n              index: e.index\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetSelect(e) {\n          this.trigger(\"select\", e);\n      }\n\n      _sheetDataBinding(e) {\n          if (this.trigger(\"dataBinding\", {\n              sheet: e.sender\n          })) {\n              e.preventDefault();\n          }\n      }\n\n      _sheetDataBound(e) {\n          this.trigger(\"dataBound\", {\n              sheet: e.sender\n          });\n      }\n\n      _sheetProgress(e) {\n          let that = this;\n\n          setTimeout(function() {\n              that.trigger(\"progress\", {\n                  toggle: e.toggle\n              });\n          });\n      }\n\n      _sheetCommandRequest(e) {\n          this.trigger(\"commandRequest\", e);\n      }\n\n      _inputForRef(ref) {\n          let self = this;\n          return self._sheet.withCultureDecimals(function() {\n              return new Range$1(ref, self._sheet).input();\n          });\n      }\n\n      _onUndoRedo(e) {\n          e.command.range().select();\n      }\n\n      execute(options) {\n          let commandOptions = Object.assign({}, { workbook: this }, options.options);\n          let command;\n\n          if (this.options.getWorkbookCommand) {\n              command = this.options.getWorkbookCommand(options.command, commandOptions);\n          }\n\n          command = command || new commands[options.command](commandOptions);\n          let sheet = this.activeSheet();\n\n          if (commandOptions.origin) {\n              command.origin(commandOptions.origin);\n          }\n\n          if (commandOptions.operatingRange) {\n              command.range(commandOptions.operatingRange);\n          } else {\n              command.range(sheet.selection());\n          }\n\n          if (commandOptions.editRange) {\n              command._editRange = commandOptions.editRange;\n          }\n\n          let result = command.exec();\n\n          if (!result || result.reason !== \"error\") {\n              if (!command.cannotUndo) {\n                  this.undoRedoStack.push(command);\n              }\n          }\n\n          // when the undo/redo stack is truncated (by e.g. adding a\n          // non-redo command after undoing) it's possible to\n          // discard images from the dropped commands.\n          this.cleanupImages();\n\n          return result;\n      }\n\n      resetFormulas() {\n          this._sheets.forEach(function(sheet) {\n              sheet.resetFormulas();\n          });\n      }\n\n      resetValidations() {\n          this._sheets.forEach(function(sheet) {\n              sheet.resetValidations();\n          });\n      }\n\n      refresh(reason) {\n          if (reason.recalc) {\n              this.resetFormulas();\n              this.resetValidations();\n              this._sheet.recalc(this._context);\n              this._sheet.revalidate(this._validationContext);\n          }\n      }\n\n      activeSheet(sheet) {\n          if (sheet === undefined) {\n              return this._sheet;\n          }\n\n          if (!this.sheetByName(sheet.name())) {\n              return undefined;\n          }\n\n          this._sheet = sheet;\n\n          //TODO: better way to get all reasons?\n          sheet.triggerChange(ALL_REASONS);\n      }\n\n      moveSheetToIndex(sheet, toIndex) {\n          let fromIndex = this.sheetIndex(sheet);\n          let sheets = this._sheets;\n\n          if (fromIndex === -1) {\n              return;\n          }\n\n          this._sheetsSearchCache = {};\n\n          sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n\n          this.trigger(\"change\", { sheetSelection: true });\n      }\n\n      insertSheet(options) {\n          options = options || {};\n          let that = this;\n          let insertIndex = typeof options.index === \"number\" ? options.index : that._sheets.length;\n          let sheetName;\n          let sheets = that._sheets;\n          const messages = this.options.messages;\n\n          let getUniqueSheetName = function(sheetNameSuffix) {\n              sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n\n              let name = messages.workbook.defaultSheetName + sheetNameSuffix;\n\n              if (!that.sheetByName(name)) {\n                  return name;\n              }\n\n              return getUniqueSheetName(sheetNameSuffix + 1);\n          };\n\n          if (options.name && that.sheetByName(options.name)) {\n              return undefined;\n          }\n\n          this._sheetsSearchCache = {};\n\n          sheetName = options.name || getUniqueSheetName();\n\n          let sheet = new Sheet(\n              options.rows || this.options.rows,\n              options.columns || this.options.columns,\n              options.rowHeight || this.options.rowHeight,\n              options.columnWidth || this.options.columnWidth,\n              options.headerHeight || this.options.headerHeight,\n              options.headerWidth || this.options.headerWidth,\n              options.defaultCellStyle || this.options.defaultCellStyle,\n              options.createSheetDataSource || this.options.createSheetDataSource\n          );\n\n          sheet._workbook = this;\n\n          sheet._name(sheetName);\n          sheet._state(options.state);\n\n          this._bindSheetEvents(sheet);\n\n          sheets.splice(insertIndex, 0, sheet);\n\n          if (options.data) {\n              sheet.fromJSON(options.data);\n          }\n\n          if (options.dataSource) {\n              sheet.setDataSource(options.dataSource);\n          }\n\n          this.trigger(\"change\", { sheetSelection: true });\n\n          return sheet;\n      }\n\n      _bindSheetEvents(sheet) {\n          sheet.bind(\"changing\", this._sheetChanging.bind(this));\n          sheet.bind(\"change\", this._sheetChange.bind(this));\n          sheet.bind(\"insertRow\", this._sheetInsertRow.bind(this));\n          sheet.bind(\"insertColumn\", this._sheetInsertColumn.bind(this));\n          sheet.bind(\"deleteRow\", this._sheetDeleteRow.bind(this));\n          sheet.bind(\"deleteColumn\", this._sheetDeleteColumn.bind(this));\n          sheet.bind(\"hideRow\", this._sheetHideRow.bind(this));\n          sheet.bind(\"hideColumn\", this._sheetHideColumn.bind(this));\n          sheet.bind(\"unhideRow\", this._sheetUnhideRow.bind(this));\n          sheet.bind(\"unhideColumn\", this._sheetUnhideColumn.bind(this));\n          sheet.bind(\"select\", this._sheetSelect.bind(this));\n          sheet.bind(\"commandRequest\", this._sheetCommandRequest.bind(this));\n          sheet.bind(\"dataBinding\", this._sheetDataBinding.bind(this));\n          sheet.bind(\"dataBound\", this._sheetDataBound.bind(this));\n          sheet.bind(\"progress\", this._sheetProgress.bind(this));\n      }\n\n      sheets() {\n          return this._sheets.slice();\n      }\n\n      sheetByName(sheetName) {\n          return this._sheets[this.sheetIndex(sheetName)];\n      }\n\n      sheetByIndex(index) {\n          return this._sheets[index];\n      }\n\n      sheetIndex(sheet) {\n          let sheets = this._sheets;\n          let sheetName = (typeof sheet == \"string\" ? sheet : sheet.name()).toLowerCase();\n          let idx = this._sheetsSearchCache[sheetName];\n\n          if (idx >= 0) {\n              return idx;\n          }\n\n          for (idx = 0; idx < sheets.length; idx++) {\n              let name = sheets[idx].name().toLowerCase();\n              this._sheetsSearchCache[name] = idx;\n\n              if (name === sheetName) {\n                  return idx;\n              }\n          }\n\n          return -1;\n      }\n\n      renameSheet(sheet, newSheetName) {\n          let oldSheetName = sheet.name().toLowerCase();\n\n          if (!newSheetName ||\n              oldSheetName === newSheetName.toLowerCase() ||\n              this.sheetByName(newSheetName)) {\n              return;\n          }\n\n          sheet = this.sheetByName(oldSheetName);\n\n          if (!sheet) {\n              return;\n          }\n\n          this._sheetsSearchCache = {};\n\n          if (this.trigger(\"renameSheet\", {\n              sheet: sheet,\n              newSheetName: newSheetName\n          })) {\n              return;\n          }\n\n          // update references\n          this._sheets.forEach(function(sheet) {\n              sheet._forFormulas(function(formula) {\n                  formula.renameSheet(oldSheetName, newSheetName);\n              });\n          });\n\n          this.forEachName(function(def, name) {\n              // 1. redefine sheet-local names\n              if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                  this.undefineName(name);\n                  def.name = def.nameref.print();\n                  this.nameDefinition(def.name, def);\n              }\n              // 2. if the value is reference or formula, update it\n              if (def.value instanceof Ref || def.value instanceof calc.runtime.Formula) {\n                  def.value.renameSheet(oldSheetName, newSheetName);\n              }\n          }.bind(this));\n\n          sheet._name(newSheetName);\n\n          this.trigger(\"change\", { sheetSelection: true });\n\n          return sheet;\n      }\n\n      removeSheet(sheet) {\n          let that = this;\n          let sheets = that._sheets;\n          let name = sheet.name();\n          let index = that.sheetIndex(sheet);\n\n          if (sheets.length === 1) {\n              return;\n          }\n\n          if (this.trigger(\"removeSheet\", { sheet: sheet })) {\n              return;\n          }\n\n          this._sheetsSearchCache = {};\n\n          if (index > -1) {\n              sheet.unbind();\n\n              sheets.splice(index, 1);\n\n              if (that.activeSheet().name() === name) {\n                  let newSheet = sheets[index === sheets.length ? index - 1 : index];\n                  that.activeSheet(newSheet);\n              } else {\n                  this.trigger(\"change\", { recalc: true, sheetSelection: true });\n              }\n          }\n      }\n\n      _clearSheets() {\n          for (let i = 0; i < this._sheets.length; i++) {\n              this._sheets[i]._activeDrawing = [];\n              this._sheets[i]._drawings = [];\n              this._sheets[i].unbind();\n          }\n          this._sheets = [];\n          this._sheetsSearchCache = {};\n          this._names = {};\n          this._images = {};\n          this._imgID = 0;\n      }\n\n      _loadImages() {\n          let self = this;\n          let ids = Object.keys(self._images);\n          let count = ids.length;\n          if (count) {\n              ids.forEach(function(id){\n                  let img = self._images[id];\n                  if (!img.blob) {\n                      loadBinary(img.url, function(data, type) {\n                          // XXX: can we do something better in case of error?\n                          if (data != null) {\n                              img.blob = new Blob([ data ], { type: type });\n                              delete img.url;\n                          }\n                          next();\n                      });\n                  }\n              });\n          } else {\n              next();\n          }\n          function next() {\n              if (--count <= 0) {\n                  self.activeSheet().triggerChange({ layout: true });\n              }\n          }\n      }\n\n      fromJSON(json) {\n          if (json.sheets) {\n              this._clearSheets();\n\n              if (json.images) {\n                  this._imgID = 0;\n                  this._images = {};\n                  Object.keys(json.images).forEach(function(id) {\n                      if (!isNaN(id)) {\n                          let num = parseFloat(id);\n                          if (isFinite(num)) {\n                              this._imgID = Math.max(this._imgID, num);\n                          }\n                      }\n                      this._images[id] = { url: json.images[id] };\n                  }, this);\n                  this._loadImages();\n              }\n\n              for (let idx = 0; idx < json.sheets.length; idx++) {\n                  let data = json.sheets[idx];\n                  let args = sheetParamsFromJSON(data, this.options);\n                  let sheet = this.insertSheet({\n                      rows         : args.rowCount,\n                      columns      : args.columnCount,\n                      rowHeight    : args.rowHeight,\n                      columnWidth  : args.columnWidth,\n                      headerHeight : args.headerHeight,\n                      headerWidth  : args.headerWidth,\n                      data         : data\n                  });\n\n                  if (data.dataSource) {\n                      sheet.setDataSource(data.dataSource);\n                  }\n              }\n          }\n\n          if (json.activeSheet) {\n              this.activeSheet(this.sheetByName(json.activeSheet));\n          } else {\n              this.activeSheet(this._sheets[0]);\n          }\n\n          if (json.names) {\n              json.names.forEach(function(def) {\n                  this.defineName(def.name, def.value, def.hidden);\n              }, this);\n          }\n      }\n\n      toJSON() {\n          this.resetFormulas();\n          this.resetValidations();\n          let names = Object.keys(this._names).map(function(name) {\n              let def = this._names[name];\n              let val = def.value;\n              if (val instanceof Ref || val instanceof calc.runtime.Formula) {\n                  val = val.print(0, 0, true);\n              } else if (val instanceof CalcError) {\n                  val = String(val);\n              } else {\n                  val = JSON.stringify(val);\n              }\n              return {\n                  value     : val,\n                  hidden    : def.hidden,\n                  name      : def.name,\n\n                  // these two are not really useful in\n                  // deserialization, but are handy in OOXML export.\n                  sheet     : def.nameref.sheet,\n                  localName : def.nameref.name\n              };\n          }, this);\n          return {\n              activeSheet: this.activeSheet().name(),\n              sheets: this._sheets.map(function(sheet) {\n                  sheet.recalc(this._context);\n                  sheet.revalidate(this._validationContext);\n                  return sheet.toJSON();\n              }, this),\n              names: names,\n              images: {},\n              columnWidth: this.options.columnWidth,\n              rowHeight: this.options.rowHeight\n          };\n      }\n\n      saveJSON() {\n          let self = this;\n          let data = self.toJSON();\n          let ids = Object.keys(self._images).filter(function(id) {\n              return self.usesImage(id) === 1;\n          });\n          let count = ids.length;\n\n          const promises = [];\n\n          if (count) {\n              ids.forEach(function(id) {\n                  let img = self._images[id];\n                  if (img.blob) {\n                      const promise = new Promise((resolve) => {\n                          let reader = new FileReader();\n                          reader.onload = function() {\n                              data.images[id] = reader.result;\n                              resolve();\n                          };\n                          reader.readAsDataURL(img.blob);\n                      });\n                      promises.push(promise);\n                  } else {\n                      data.images[id] = img.url;\n                  }\n              });\n          }\n\n          return Promise.all(promises).then(() => data);\n      }\n\n      fromFile(file) {\n          const deferred = new Deferred();\n\n          if (file && !this.trigger(\"excelImport\", { file, deferred })) {\n              this._clearSheets();\n              this._readExcel(file, this, deferred);\n          }\n\n          return deferred.promise;\n      }\n\n      _readExcel(file, workbook, deferred) {\n          readExcel(file, workbook, deferred);\n      }\n\n      saveAsExcel(options) {\n          let self = this;\n          options = deepExtend({}, self.options.excel, options);\n          let data = self.toJSON();\n\n          if (self.trigger(\"excelExport\", { workbook: data })) {\n              return;\n          }\n\n          let ids = Object.keys(self._images).filter(function(id) {\n              return self.usesImage(id) === 1;\n          });\n          let count = ids.length;\n          let images = count ? {} : null;\n          const promises = [];\n\n          if (count) {\n              ids.forEach(function(id) {\n                  let img = self._images[id];\n\n                  if (img.blob) {\n                      const promise = new Promise((resolve) => {\n                          let reader = new FileReader();\n                          reader.onload = function() {\n                              images[id] = {\n                                  type: img.blob.type,\n                                  name: img.blob.name,\n                                  data: reader.result\n                              };\n\n                              count--;\n                              resolve();\n                          };\n                          reader.readAsArrayBuffer(img.blob);\n                      });\n\n                      promises.push(promise);\n                  } else {\n                      const promise = new Promise((resolve) => {\n                          loadBinary(img.url, function(data, type) {\n                              images[id] = { type: type, data: data };\n                              count--;\n                              resolve();\n                          });\n                      });\n                      promises.push(promise);\n                  }\n              });\n\n              return Promise.all(promises)\n                      .then(() => {\n                          return next();\n                      });\n          } else {\n              return next();\n          }\n\n          function next() {\n              if (--count <= 0) {\n                  data.images = images;\n                  let workbook = new options.Workbook(data);\n                  const promise = options.forceProxy ? workbook.toDataURL() : workbook.toBlob();\n\n                  if (!options.saveAs) {\n                      return promise;\n                  }\n\n                  return promise.then(blob => {\n                      options.saveAs(blob, data.fileName || options.fileName, {\n                          proxyURL: options.proxyURL,\n                          forceProxy: options.forceProxy\n                      });\n                  });\n              }\n\n              return Promise.resolve();\n          }\n      }\n\n      draw(options, callback) {\n          if (typeof options == \"function\" && !callback) {\n              callback = options;\n              options = {};\n          }\n          let parts = [], sheets = this._sheets;\n          (function loop(i) {\n              if (i < sheets.length) {\n                  sheets[i].draw(SHEETREF, options, function(group) {\n                      parts.push(group);\n                      loop(i + 1);\n                  });\n              } else {\n                  let group = parts[0];\n                  for (i = 1; i < parts.length; ++i) {\n                      group.children = group.children.concat(parts[i].children);\n                  }\n                  callback(group);\n              }\n          })(0);\n      }\n\n      nameForRef(ref, sheet) {\n          if (sheet === undefined) {\n              sheet = ref.sheet;\n          }\n          sheet = sheet.toLowerCase();\n          let str = String(ref);\n          for (let name in this._names) {\n              let def = this._names[name];\n              let val = def.value;\n              if (val instanceof Ref) {\n                  if (!val.sheet || (val.sheet && sheet === val.sheet.toLowerCase())) {\n                      if (String(val) === str) {\n                          return def;\n                      }\n                  }\n              }\n          }\n          return { name: str };\n      }\n\n      defineName(name, value, hidden) {\n          let x = calc.parseNameDefinition(name, value);\n          name = x.name.print();\n          this._names[name.toLowerCase()] = {\n              value   : x.value,\n              hidden  : hidden,\n              name    : name,\n              nameref : x.name\n          };\n      }\n\n      undefineName(name) {\n          delete this._names[name.toLowerCase()];\n      }\n\n      nameValue(name) {\n          name = name.toLowerCase();\n          if (name in this._names) {\n              return this._names[name].value;\n          }\n          return null;\n      }\n\n      nameDefinition(name, def) {\n          name = name.toLowerCase();\n          if (arguments.length > 1) {\n              if (def === undefined) {\n                  delete this._names[name];\n              } else {\n                  this._names[name] = def;\n              }\n          }\n          return this._names[name];\n      }\n\n      forEachName(func) {\n          Object.keys(this._names).forEach(function(name) {\n              func(this._names[name], name);\n          }, this);\n      }\n\n      adjustNames(affectedSheet, forRow, start, delta) {\n          affectedSheet = affectedSheet.toLowerCase();\n          Object.keys(this._names).forEach(function(name) {\n              let def = this._names[name];\n              let x = def.value;\n              if (x instanceof Ref &&\n                  x.sheet.toLowerCase() === affectedSheet) {\n                  def.value = x.adjust(null, null, null, null, forRow, start, delta);\n              } else if (x instanceof calc.runtime.Formula) {\n                  x.adjust(affectedSheet, forRow ? \"row\" : \"col\", start, delta);\n              }\n          }, this);\n      }\n\n      addImage(image) {\n          let id = String(++this._imgID);\n          if (typeof image == \"string\") {\n              this._images[id] = { url: image };\n          } else {\n              this._images[id] = { blob: image };\n          }\n          return id;\n      }\n\n      imageUrl(id) {\n          let img = this._images[id];\n          let url = img.url;\n          if (!url) {\n              url = img.url = window.URL.createObjectURL(img.blob);\n          }\n          return url;\n      }\n\n      cleanupImages() {\n          Object.keys(this._images).forEach(function(id) {\n              if (!this.usesImage(id)) {\n                  let url = this._images[id].url;\n                  if (url) {\n                      window.URL.revokeObjectURL(url);\n                  }\n                  delete this._images[id];\n              }\n          }, this);\n      }\n\n      usesImage(img) {\n          let i;\n          let sheets = this._sheets;\n          for (i = sheets.length; --i >= 0;) {\n              if (sheets[i].usesImage(img)) {\n                  return 1;\n              }\n          }\n          let stack = this.undoRedoStack.stack;\n          for (i = stack.length; --i >= 0;) {\n              if (stack[i].usesImage(img)) {\n                  return 2; // signal that it's only in the undo stack\n              }\n          }\n          return false;\n      }\n  }\n\n  function sheetParamsFromJSON(data, options) {\n      function or(a, b, c) {\n          return a !== undefined ? a : b !== undefined ? b : c;\n      }\n\n      let rowCount = or(data.rowCount, options.rows, 200),\n          columnCount = or(data.columnCount, options.columns, 50),\n          rowHeight = or(data.rowHeight, options.rowHeight, 20),\n          columnWidth = or(data.columnWidth, options.columnWidth, 64),\n          headerHeight = or(data.headerHeight, options.headerHeight, 20),\n          headerWidth = or(data.headerWidth, options.headerWidth, 32);\n\n      if (data.rows !== undefined) {\n          for (let i = 0; i < data.rows.length; ++i) {\n              let row = data.rows[i];\n              let ri = or(row.index, i);\n              if (ri >= rowCount) { rowCount = ri + 1; }\n              if (row.cells) {\n                  for (let j = 0; j < row.cells.length; ++j) {\n                      let cell = row.cells[j];\n                      let ci = or(cell.index, j);\n                      if (ci >= columnCount) { columnCount = ci + 1; }\n                  }\n              }\n          }\n      }\n\n      return {\n          rowCount     : rowCount,\n          columnCount  : columnCount,\n          rowHeight    : rowHeight,\n          columnWidth  : columnWidth,\n          headerHeight : headerHeight,\n          headerWidth  : headerWidth\n      };\n  }\n\n  // if (kendo.PDFMixin) {\n  //     kendo.PDFMixin.extend(Workbook.prototype);\n\n  //     Workbook.prototype.saveAsPDF = function(options) {\n  //         let progress = new $.Deferred();\n  //         let promise = progress.promise();\n  //         let args = { promise: promise };\n  //         if (this.trigger(\"pdfExport\", args)) {\n  //             return;\n  //         }\n\n  //         this._drawPDF(options, progress)\n  //         .then(function(root) {\n  //             return options.forceProxy\n  //                 ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n  //                 : kendo.pdf.exportPDFToBlob(root);\n  //         })\n  //         .done(function(dataURI) {\n  //             kendo.saveAs({\n  //                 dataURI: dataURI,\n  //                 fileName: options.fileName,\n  //                 proxyURL: options.proxyURL,\n  //                 forceProxy: options.forceProxy,\n  //                 proxyTarget: options.proxyTarget\n  //             });\n\n  //             progress.resolve();\n  //         })\n  //         .fail(function(err) {\n  //             progress.reject(err);\n  //         });\n\n  //         return promise;\n  //     };\n\n  //     Workbook.prototype._drawPDF = function(options) {\n  //         let result = new $.Deferred();\n  //         let callback = function(group) {\n  //             result.resolve(group);\n  //         };\n  //         switch (options.area) {\n  //         case \"workbook\":\n  //             options.workbook.draw(options, callback);\n  //             break;\n  //         case \"sheet\":\n  //             options.workbook.activeSheet().draw(options, callback);\n  //             break;\n  //         case \"selection\":\n  //             options.workbook.activeSheet().selection().draw(options, callback);\n  //             break;\n  //         }\n\n  //         return result.promise();\n  //     };\n  // }\n\n  /* eslint-disable no-param-reassign */\n\n  const events = [\n      \"cut\",\n      \"copy\",\n      \"paste\",\n      \"pdfExport\",\n      \"excelExport\",\n      \"excelImport\",\n      \"changing\",\n      \"change\",\n      \"render\",\n      \"removeSheet\",\n      \"selectSheet\",\n      \"renameSheet\",\n      \"insertRow\",\n      \"insertColumn\",\n      \"deleteRow\",\n      \"insertSheet\",\n      \"deleteColumn\",\n      \"hideRow\",\n      \"hideColumn\",\n      \"unhideRow\",\n      \"unhideColumn\",\n      \"select\",\n      \"changeFormat\",\n      \"dataBinding\",\n      \"dataBound\",\n      \"update\",\n      \"message\",\n      \"contextmenu\",\n  ];\n\n  class SpreadsheetWidget extends Widget {\n      constructor(element, options$1) {\n          super(element, deepExtend({}, options, options$1));\n          this.events = events;\n          this.bind(this.events, this.options);\n\n          intl({ locale: this.options.locale, ...this.options.intl });\n          initDynamicFilter();\n\n          this._view = new View(this.element, {\n              messages: this.options.messages.view,\n              toolbar: this.options.toolbar,\n              sheetsbar: this.options.sheetsbar,\n              formulaBarInputRef: this.options.formulaBarInputRef,\n              formulaCellInputRef: this.options.formulaCellInputRef,\n              nameBoxRef: this.options.nameBoxRef,\n              createTabStrip: this.options.createTabStrip,\n              createFilterMenu: this.options.createFilterMenu,\n              createContextMenus: this.options.createContextMenus,\n              createSheetBar: this.options.createSheetBar,\n              getIconHTMLString: this.options.getIconHTMLString,\n              openDialogCallback: this.openDialog.bind(this),\n          });\n\n          this._workbook = new Workbook(this.options, this._view);\n\n          this._controller = new Controller(this._view, this._workbook);\n\n          this._autoRefresh = true;\n\n          this._bindWorkbookEvents();\n          this._bindViewEvents();\n\n          this._view.workbook(this._workbook);\n\n          this._view.enableClipboard(false);\n          this.refresh();\n          this._view.enableClipboard(true);\n\n          this._resizeHandler = this.resize.bind(this);\n          window.addEventListener('resize', this._resizeHandler);\n\n          this._keyDownHandler = this._keyDown.bind(this);\n          this.element.addEventListener(\"keydown\", this._keyDownHandler);\n      }\n\n      get view() {\n          return this._view;\n      }\n\n      get workbook () {\n          return this._workbook;\n      }\n\n      _keyDown(e) {\n          let key = e.keyCode;\n          let controlKey = e.ctrlKey || e.metaKey;\n\n          this.trigger(\"keydown\", e);\n\n          if (key === keys.F11 && e.shiftKey) {\n              this._view.sheetsbar.onAddSelect();\n              e.preventDefault();\n              return;\n          } else if (e.altKey && key === keys.PAGEDOWN) {\n              let activeSheetIndex = this.sheetIndex(this.activeSheet());\n              let nextSheetName = this.sheetByIndex(activeSheetIndex + 1)?.name();\n\n              if (nextSheetName){\n                  this._view.sheetsbar.onSheetSelect(nextSheetName);\n              }\n          } else if (e.altKey && key === keys.PAGEUP) {\n              let activeSheetIndex = this.sheetIndex(this.activeSheet());\n              let prevSheetName = this.sheetByIndex(activeSheetIndex - 1)?.name();\n\n              if (prevSheetName) {\n                  this._view.sheetsbar.onSheetSelect(prevSheetName);\n              }\n          } else if (e.altKey && key === keys.DELETE) {\n              this._view.sheetsbar.onSheetRemove(this.activeSheet()._name());\n              e.preventDefault();\n              return;\n          } else if (e.altKey && key === keys.R) {\n              this.options.createSheetEditor?.();\n              e.preventDefault();\n              return;\n          } else if (controlKey && key === keys.B) {\n              this._handleTypographicalEmphasis('bold');\n          } else if (controlKey && key === keys.I) {\n              this._handleTypographicalEmphasis('italic');\n          } else if (controlKey && key === keys.U) {\n              this._handleTypographicalEmphasis('underline');\n          } else if (e.altKey && key === keys.H) {\n              this._view.tabstrip?.select(\"home\");\n              e.preventDefault();\n              return;\n          } else if (e.altKey && key === keys.N) {\n              this._view.tabstrip?.select(\"insert\");\n              e.preventDefault();\n              return;\n          } else if (e.altKey && key === keys.A) {\n              this._view.tabstrip?.select(\"data\");\n              e.preventDefault();\n              return;\n          } else if (key === keys.F10) {\n              e.preventDefault();\n              this._view.tabstrip?.focus();\n          }\n      }\n\n      _handleTypographicalEmphasis(command) {\n          const sheet = this.activeSheet();\n\n          if (sheet) {\n              this.executeCommand({\n                  command: 'PropertyChangeCommand',\n                  options: {\n                      property: command,\n                      value: !sheet.range(sheet.activeCell())[command]()\n                  }\n              });\n          }\n      }\n\n      _resize() {\n          this.refresh({ layout: true });\n      }\n\n      _workbookChanging(e) {\n          if (this.trigger(\"changing\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookChange(e) {\n          if (this._autoRefresh) {\n              this.refresh(e);\n          }\n\n          if (e.recalc && e.ref) {\n              let range = e.range || new Range$1(e.ref, this.activeSheet());\n              this.trigger(\"change\", { range: range });\n          }\n      }\n\n      _workbookCut(e) {\n          this.trigger(\"cut\", e);\n      }\n\n      _workbookCopy(e) {\n          this.trigger(\"copy\", e);\n      }\n\n      _workbookPaste(e) {\n          this.trigger(\"paste\", e);\n      }\n\n      activeSheet(sheet) {\n          return this._workbook.activeSheet(sheet);\n      }\n\n      moveSheetToIndex(sheet, index) {\n          return this._workbook.moveSheetToIndex(sheet, index);\n      }\n\n      insertSheet(options) {\n          return this._workbook.insertSheet(options);\n      }\n\n      sheets() {\n          return this._workbook.sheets();\n      }\n\n      removeSheet(sheet) {\n          return this._workbook.removeSheet(sheet);\n      }\n\n      sheetByName(sheetName) {\n          return this._workbook.sheetByName(sheetName);\n      }\n\n      sheetIndex(sheet) {\n          return this._workbook.sheetIndex(sheet);\n      }\n\n      sheetByIndex(index) {\n          return this._workbook.sheetByIndex(index);\n      }\n\n      renameSheet(sheet, newSheetName) {\n          return this._workbook.renameSheet(sheet, newSheetName);\n      }\n\n      executeCommand(options) {\n          return this._controller.executeCommand(options);\n      }\n\n      refresh(reason) {\n          if (!reason) {\n              reason = ALL_REASONS;\n          }\n\n          if (!reason.editorClose) {\n              this._view.sheet(this._workbook.activeSheet());\n              this._controller.sheet(this._workbook.activeSheet());\n\n              this._workbook.refresh(reason);\n          }\n\n          if (!reason.editorChange) {\n              this._view.refresh(reason);\n              this._controller.refresh();\n\n              this._view.render(reason);\n              this.trigger(\"render\");\n          }\n\n          return this;\n      }\n\n      openDialog(name, options) {\n          return this._view.openDialog(name, options);\n      }\n\n      autoRefresh(value) {\n          if (value !== undefined) {\n              this._autoRefresh = value;\n\n              if (value === true) {\n                  this.refresh();\n              }\n\n              return this;\n          }\n\n          return this._autoRefresh;\n      }\n\n      toJSON() {\n          return this._workbook.toJSON();\n      }\n\n      fromJSON(json) {\n          if (json.sheets) {\n              this._workbook.destroy();\n\n              this._workbook = new Workbook(deepExtend({}, this.options, json));\n\n              this._bindWorkbookEvents();\n\n              this._view.workbook(this._workbook);\n              this._controller.workbook(this._workbook);\n\n              this.activeSheet(this.activeSheet());\n          } else {\n              this.refresh();\n          }\n      }\n\n      saveJSON() {\n          return this._workbook.saveJSON();\n      }\n\n      fromFile(blob) {\n          return this._workbook.fromFile(blob);\n      }\n\n      saveAsPDF(options) {\n          this._workbook.saveAsPDF(\n              deepExtend({}, this.options.pdf, options, { workbook: this._workbook })\n          );\n      }\n\n      saveAsExcel(options) {\n          return this._workbook.saveAsExcel(options);\n      }\n\n      draw(options, callback) {\n          this._workbook.draw(options, callback);\n      }\n\n      _workbookExcelExport(e) {\n          if (this.trigger(\"excelExport\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookExcelImport(e) {\n          if (this.trigger(\"excelImport\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      // _initProgress(deferred) {\n      //     let loading =\n      //         $(\"<div class='k-loading-mask' \" +\n      //                \"style='width: 100%; height: 100%; top: 0;'>\" +\n      //             \"<div class='k-loading-color'></div>\" +\n      //         \"</div>\")\n      //         .appendTo(this.element);\n\n      //     let pb = $(\"<div class='k-loading-progress'>\")\n      //     .appendTo(loading)\n      //     .kendoProgressBar({\n      //         type: \"chunk\", chunkCount: 10,\n      //         min: 0, max: 1, value: 0\n      //     }).data(\"kendoProgressBar\");\n\n      //     deferred.progress(function(e) {\n      //         pb.value(e.progress);\n      //     })\n      //     .always(function() {\n      //         kendo.destroy(loading);\n      //         loading.remove();\n      //     });\n      // }\n\n      _workbookPdfExport(e) {\n          if (this.trigger(\"pdfExport\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookInsertSheet(e) {\n          if (this.trigger(\"insertSheet\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookRemoveSheet(e) {\n          if (this.trigger(\"removeSheet\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookSelectSheet(e) {\n          if (this.trigger(\"selectSheet\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookRenameSheet(e) {\n          if (this.trigger(\"renameSheet\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookInsertRow(e) {\n          if (this.trigger(\"insertRow\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookInsertColumn(e) {\n          if (this.trigger(\"insertColumn\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookDeleteRow(e) {\n          if (this.trigger(\"deleteRow\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookDeleteColumn(e) {\n          if (this.trigger(\"deleteColumn\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookHideRow(e) {\n          if (this.trigger(\"hideRow\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookHideColumn(e) {\n          if (this.trigger(\"hideColumn\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookUnhideRow(e) {\n          if (this.trigger(\"unhideRow\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookUnhideColumn(e) {\n          if (this.trigger(\"unhideColumn\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookSelect(e) {\n          this.trigger(\"select\", e);\n      }\n\n      _workbookChangeFormat(e) {\n          this.trigger(\"changeFormat\", e);\n      }\n\n      _workbookDataBinding(e) {\n          if (this.trigger(\"dataBinding\", e)) {\n              e.preventDefault();\n          }\n      }\n\n      _workbookDataBound(e) {\n          this.trigger(\"dataBound\", e);\n      }\n\n      _workbookProgress() {\n          // kendo.ui.progress(this.element, e.toggle);\n      }\n\n      _viewUpdate(e) {\n          this.trigger(\"update\", e);\n      }\n\n      _viewMessage(e) {\n          this.trigger(\"message\", e);\n      }\n\n      _onContextMenu(e) {\n          this.trigger(\"contextmenu\", e);\n      }\n\n      _bindWorkbookEvents() {\n          this._workbook.bind(\"cut\", this._workbookCut.bind(this));\n          this._workbook.bind(\"copy\", this._workbookCopy.bind(this));\n          this._workbook.bind(\"paste\", this._workbookPaste.bind(this));\n          this._workbook.bind(\"changing\", this._workbookChanging.bind(this));\n          this._workbook.bind(\"change\", this._workbookChange.bind(this));\n          this._workbook.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n          this._workbook.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n          this._workbook.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n          this._workbook.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n          this._workbook.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n          this._workbook.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n          this._workbook.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n          this._workbook.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n          this._workbook.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n          this._workbook.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n          this._workbook.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n          this._workbook.bind(\"hideRow\", this._workbookHideRow.bind(this));\n          this._workbook.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n          this._workbook.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n          this._workbook.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n          this._workbook.bind(\"select\", this._workbookSelect.bind(this));\n          this._workbook.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n          this._workbook.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n          this._workbook.bind(\"dataBound\", this._workbookDataBound.bind(this));\n          this._workbook.bind(\"progress\", this._workbookProgress.bind(this));\n          this._workbook.bind(\"contextmenu\", this._onContextMenu.bind(this));\n      }\n\n      _bindViewEvents() {\n          this._view.bind(\"update\", this._viewUpdate.bind(this));\n          this._view.bind(\"message\", this._viewMessage.bind(this));\n      }\n\n      destroy() {\n          window.removeEventListener('resize', this._resizeHandler);\n          this.element.removeEventListener(\"keydown\", this._keyDownHandler);\n\n          this.unbind();\n\n          this._workbook.destroy();\n          this._controller.destroy();\n          this._view.destroy();\n      }\n\n      defineName(name, value, hidden) {\n          return this._workbook.defineName(name, value, hidden);\n      }\n\n      undefineName(name) {\n          return this._workbook.undefineName(name);\n      }\n\n      nameValue(name) {\n          return this._workbook.nameValue(name);\n      }\n\n      forEachName(func) {\n          return this._workbook.forEachName(func);\n      }\n\n      cellContextMenu() {\n          return this._view.cellContextMenu;\n      }\n\n      rowHeaderContextMenu() {\n          return this._view.rowHeaderContextMenu;\n      }\n\n      colHeaderContextMenu() {\n          return this._view.colHeaderContextMenu;\n      }\n\n      addImage(image) {\n          return this._workbook.addImage(image);\n      }\n\n      cleanupImages() {\n          return this._workbook.cleanupImages();\n      }\n  }\n\n  /* -----[ Excel operators ]----- */\n\n\n  const {\n      FUNCS,\n      defineBuiltinFunction,\n      limitPrecision,\n      packDate: packDate$1,\n      unpackDate: unpackDate$1,\n      daysInMonth,\n      daysInYear,\n      isLeapYear,\n  } = calc.runtime;\n\n  defineBuiltinFunction('binary+', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return a + b;\n  });\n\n  defineBuiltinFunction('binary-', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return a - b;\n  });\n\n  defineBuiltinFunction('binary*', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return a * b;\n  });\n\n  defineBuiltinFunction('binary/', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false)) && ($b == 0 ? (err = 'DIV/0', false) : true))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return a / b;\n  });\n\n  defineBuiltinFunction('binary^', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || ($b == null ? ($b = 0, true) : false))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return Math.pow(a, b);\n  });\n\n  defineBuiltinFunction('binary&', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || (typeof $a == 'string' || typeof $a == 'boolean' || typeof $a == 'number' ? ($a += '', true) : $a === undefined ? ($a = '', true) : false) || typeof $a == 'boolean' || $a == null)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false) || (typeof $b == 'string' || typeof $b == 'boolean' || typeof $b == 'number' ? ($b += '', true) : $b === undefined ? ($b = '', true) : false) || typeof $b == 'boolean' || $b == null)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      if (a == null) {\n          a = '';\n      }\n      if (b == null) {\n          b = '';\n      }\n      return '' + a + b;\n  });\n\n  function equals(a, b) {\n      a = typeof(a) === \"string\" ? a.toLowerCase() : a;\n      b = typeof(b) === \"string\" ? b.toLowerCase() : b;\n\n      // special cases\n      if (a === false && b == null) { return true; }\n      if (b === false && a == null) { return true; }\n      if (a === 0 && b == null) { return true; }\n      if (b === 0 && a == null) { return true; }\n      if (a === \"\" && b == null) { return true; }\n      if (b === \"\" && a == null) { return true; }\n\n      return a === b;\n  }\n\n  defineBuiltinFunction('binary=', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a = this.force($a), i <= args.length)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b = this.force($b), i <= args.length)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return equals(a, b);\n  });\n\n  defineBuiltinFunction('binary<>', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a = this.force($a), i <= args.length)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b = this.force($b), i <= args.length)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return !equals(a, b);\n  });\n\n  function binaryCompare(left, right, func) {\n      if (typeof left == \"string\" && typeof right != \"string\") {\n          right = right == null ? \"\" : right + \"\";\n      }\n      if (typeof left != \"string\" && typeof right == \"string\") {\n          left = left == null ? \"\" : left + \"\";\n      }\n      if (typeof left == \"number\" && right == null) {\n          right = 0;\n      }\n      if (typeof right == \"number\" && left == null) {\n          left = 0;\n      }\n      if (typeof left == \"string\" && typeof right == \"string\") {\n          // string comparison is case insensitive\n          left = left.toLowerCase();\n          right = right.toLowerCase();\n      }\n      if (typeof right == typeof left) {\n          // for issue https://github.com/telerik/kendo-ui-core/issues/6879, limitPrecision\n          // digits got bumped to 16, but it's too much for the case 9.302 - 0.002 (issue\n          // https://github.com/telerik/kendo-ui-core/issues/7170).\n          left = maybeRoundFloatErrors(left, 15);\n          right = maybeRoundFloatErrors(right, 15);\n          return func(left, right);\n      } else {\n          return new CalcError(\"VALUE\");\n      }\n  }\n\n  defineBuiltinFunction('binary<', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a = this.force($a), i <= args.length)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b = this.force($b), i <= args.length)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return binaryCompare(a, b, (a, b) => a < b);\n  });\n\n  defineBuiltinFunction('binary<=', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a = this.force($a), i <= args.length)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b = this.force($b), i <= args.length)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return binaryCompare(a, b, (a, b) => a <= b);\n  });\n\n  defineBuiltinFunction('binary>', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a = this.force($a), i <= args.length)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b = this.force($b), i <= args.length)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return binaryCompare(a, b, (a, b) => a > b);\n  });\n\n  defineBuiltinFunction('binary>=', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a = this.force($a), i <= args.length)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b = this.force($b), i <= args.length)) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return binaryCompare(a, b, (a, b) => a >= b);\n  });\n\n  defineBuiltinFunction('unary+', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a) {\n      return a;\n  });\n\n  defineBuiltinFunction('unary-', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a) {\n      return -a;\n  });\n\n  defineBuiltinFunction('unary%', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false) || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a) {\n      return a / 100;\n  });\n\n  // range operator\n  defineBuiltinFunction('binary:', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a instanceof CellRef)) {\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b instanceof CellRef)) {\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (a, b) {\n      return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n  });\n\n  // union operator\n  defineBuiltinFunction('binary,', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a instanceof Ref)) {\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b instanceof Ref)) {\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (a, b) {\n      return new UnionRef([\n          a,\n          b\n      ]);\n  });\n\n  // intersection operator\n  defineBuiltinFunction('binary ', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!($a instanceof Ref)) {\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!($b instanceof Ref)) {\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (a, b) {\n      return a.intersect(b);\n  });\n\n  /* -----[ conditionals ]----- */\n\n  defineBuiltinFunction('not', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!(($a = this.force($a)) != null && i <= args.length || ($a == null ? ($a = 0, true) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a) {\n      return !this.bool(a);\n  });\n\n  /* -----[ the IS* functions ]----- */\n\n  defineBuiltinFunction('isblank', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!(i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      if (val instanceof CellRef) {\n          val = this.getRefData(val);\n          return val == null;\n      }\n      return false;\n  });\n\n  defineBuiltinFunction('iserror', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return val instanceof CalcError;\n  });\n\n  defineBuiltinFunction('iserr', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return val instanceof CalcError && val.code != 'N/A';\n  });\n\n  defineBuiltinFunction('isna', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return val instanceof CalcError && val.code == 'N/A';\n  });\n\n  defineBuiltinFunction('islogical', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return typeof val == 'boolean';\n  });\n\n  defineBuiltinFunction('isnontext', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return typeof val != 'string';\n  });\n\n  defineBuiltinFunction('istext', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return typeof val == 'string';\n  });\n\n  defineBuiltinFunction('isnumber', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return typeof val == 'number';\n  });\n\n  defineBuiltinFunction('isref', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!(i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      return val instanceof CellRef || val instanceof RangeRef;\n  });\n\n  defineBuiltinFunction('_matrix', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $m = args[i++];\n              if ($m instanceof CalcError)\n                  return $m;\n              if (!(((m = this.asMatrix($m)) ? $m = m : false) || (typeof $m == 'string' || typeof $m == 'boolean' || typeof $m == 'number' ? ($m += '', true) : $m === undefined ? ($m = '', true) : false))) {\n                  if ($m instanceof CalcError)\n                      return $m;\n                  return new CalcError(err);\n              }\n              xargs.push($m);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (m) {\n      if (typeof m == 'string') {\n          m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n      }\n      return m;\n  });\n\n  /* -----[ resolve NameRef-s ]----- */\n\n  FUNCS[\",getname\"] = function(callback, args) {\n      this.fetchName(args[0], callback);\n  };\n\n  // --------------------------------------------runtime-functions.js\n\n  /* -----[ Math functions ]----- */\n\n  defineBuiltinFunction('abs', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.abs);\n  defineBuiltinFunction('cos', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.cos);\n  defineBuiltinFunction('sin', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.sin);\n  defineBuiltinFunction('acos', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.acos);\n  defineBuiltinFunction('asin', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.asin);\n  defineBuiltinFunction('tan', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.tan);\n  defineBuiltinFunction('atan', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.atan);\n  defineBuiltinFunction('exp', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.exp);\n  defineBuiltinFunction('sqrt', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.sqrt);\n  defineBuiltinFunction('ln', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' ? ($n = limitPrecision($n), true) : false) || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.log);\n\n  defineBuiltinFunction('log', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num > 0 ? true : (err = 'NUM', false)))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          {\n              var $base = args[i++];\n              if ($base instanceof CalcError)\n                  return $base;\n              if (!(((typeof ($base = this.force($base)) == 'number' ? ($base = limitPrecision($base), true) : false) || (typeof $base == 'boolean' ? ($base = +$base, true) : false) || (typeof $base == 'string' && !/^(?:=|true|false)/i.test($base) ? (tmp = calc.parse(0, 0, 0, $base), /^date|number|percent$/.test(tmp.type) ? ($base = +tmp.value, true) : false) : false)) && ($base > 0 ? true : (err = 'NUM', false)) || ($base == null ? ($base = 10, true) : false))) {\n                  if ($base instanceof CalcError)\n                      return $base;\n                  return new CalcError(err);\n              }\n              xargs.push($base);\n          }\n          {\n              if (!($base != 1 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $base = this._arrayArg(args[i]);\n          if ($base) {\n              xargs.push($base);\n              width = Math.max(width, $base.width);\n              height = Math.max(height, $base.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, base) {\n      return Math.log(num) / Math.log(base);\n  });\n\n  defineBuiltinFunction('log10', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num > 0 ? true : (err = 'NUM', false)))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      return Math.log(num) / Math.log(10);\n  });\n\n  defineBuiltinFunction('pi', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return Math.PI;\n  });\n\n  defineBuiltinFunction('sqrtpi', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return Math.sqrt(n * Math.PI);\n  });\n\n  defineBuiltinFunction('degrees', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $radians = args[i++];\n              if ($radians instanceof CalcError)\n                  return $radians;\n              if (!((typeof ($radians = this.force($radians)) == 'number' ? ($radians = limitPrecision($radians), true) : false) || (typeof $radians == 'boolean' ? ($radians = +$radians, true) : false) || (typeof $radians == 'string' && !/^(?:=|true|false)/i.test($radians) ? (tmp = calc.parse(0, 0, 0, $radians), /^date|number|percent$/.test(tmp.type) ? ($radians = +tmp.value, true) : false) : false))) {\n                  if ($radians instanceof CalcError)\n                      return $radians;\n                  return new CalcError(err);\n              }\n              xargs.push($radians);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $radians = this._arrayArg(args[i]);\n          if ($radians) {\n              xargs.push($radians);\n              width = Math.max(width, $radians.width);\n              height = Math.max(height, $radians.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (rad) {\n      return 180 * rad / Math.PI % 360;\n  });\n\n  defineBuiltinFunction('radians', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $degrees = args[i++];\n              if ($degrees instanceof CalcError)\n                  return $degrees;\n              if (!((typeof ($degrees = this.force($degrees)) == 'number' ? ($degrees = limitPrecision($degrees), true) : false) || (typeof $degrees == 'boolean' ? ($degrees = +$degrees, true) : false) || (typeof $degrees == 'string' && !/^(?:=|true|false)/i.test($degrees) ? (tmp = calc.parse(0, 0, 0, $degrees), /^date|number|percent$/.test(tmp.type) ? ($degrees = +tmp.value, true) : false) : false))) {\n                  if ($degrees instanceof CalcError)\n                      return $degrees;\n                  return new CalcError(err);\n              }\n              xargs.push($degrees);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $degrees = this._arrayArg(args[i]);\n          if ($degrees) {\n              xargs.push($degrees);\n              width = Math.max(width, $degrees.width);\n              height = Math.max(height, $degrees.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (deg) {\n      return Math.PI * deg / 180;\n  });\n\n  function _cosh(n){\n      return (Math.exp(n) + Math.exp(-n)) / 2;\n  }\n\n  defineBuiltinFunction('cosh', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), _cosh);\n\n  defineBuiltinFunction('acosh', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          {\n              if (!($num >= 1 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n  });\n\n  function _sinh(n){\n      return (Math.exp(n) - Math.exp(-n)) / 2;\n  }\n\n  defineBuiltinFunction('sinh', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), _sinh);\n\n  defineBuiltinFunction('asinh', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return Math.log(n + Math.sqrt(n * n + 1));\n  });\n\n  defineBuiltinFunction('sec', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return 1 / Math.cos(n);\n  });\n\n  defineBuiltinFunction('sech', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return 1 / _cosh(n);\n  });\n\n  defineBuiltinFunction('csc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return 1 / Math.sin(n);\n  });\n\n  defineBuiltinFunction('csch', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return 1 / _sinh(n);\n  });\n\n  defineBuiltinFunction('atan2', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x == 0 ? (err = 'DIV/0', false) : true))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $y = args[i++];\n              if ($y instanceof CalcError)\n                  return $y;\n              if (!((typeof ($y = this.force($y)) == 'number' ? ($y = limitPrecision($y), true) : false) || (typeof $y == 'boolean' ? ($y = +$y, true) : false) || (typeof $y == 'string' && !/^(?:=|true|false)/i.test($y) ? (tmp = calc.parse(0, 0, 0, $y), /^date|number|percent$/.test(tmp.type) ? ($y = +tmp.value, true) : false) : false))) {\n                  if ($y instanceof CalcError)\n                      return $y;\n                  return new CalcError(err);\n              }\n              xargs.push($y);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $x = this._arrayArg(args[i]);\n          if ($x) {\n              xargs.push($x);\n              width = Math.max(width, $x.width);\n              height = Math.max(height, $x.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $y = this._arrayArg(args[i]);\n          if ($y) {\n              xargs.push($y);\n              width = Math.max(width, $y.width);\n              height = Math.max(height, $y.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (x, y) {\n      return Math.atan(y / x);\n  });\n\n  function _tanh(n) {\n      return _sinh(n) / _cosh(n);\n  }\n\n  defineBuiltinFunction('tanh', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), _tanh);\n\n  defineBuiltinFunction('atanh', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num > -1 && $num < 1 ? true : (err = 'NUM', false)))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n  });\n\n  defineBuiltinFunction('cot', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num == 0 ? (err = 'DIV/0', false) : true))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return 1 / Math.tan(n);\n  });\n\n  defineBuiltinFunction('coth', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!(((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false)) && ($num == 0 ? (err = 'DIV/0', false) : true))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return 1 / _tanh(n);\n  });\n\n  defineBuiltinFunction('acot', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return Math.PI / 2 - Math.atan(n);\n  });\n\n  defineBuiltinFunction('acoth', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $num = args[i++];\n              if ($num instanceof CalcError)\n                  return $num;\n              if (!((typeof ($num = this.force($num)) == 'number' ? ($num = limitPrecision($num), true) : false) || (typeof $num == 'boolean' ? ($num = +$num, true) : false) || (typeof $num == 'string' && !/^(?:=|true|false)/i.test($num) ? (tmp = calc.parse(0, 0, 0, $num), /^date|number|percent$/.test(tmp.type) ? ($num = +tmp.value, true) : false) : false))) {\n                  if ($num instanceof CalcError)\n                      return $num;\n                  return new CalcError(err);\n              }\n              xargs.push($num);\n          }\n          {\n              if (!(($num < -1 ? true : (err = 'N/A', false)) || ($num > 1 ? true : (err = 'N/A', false))))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $num = this._arrayArg(args[i]);\n          if ($num) {\n              xargs.push($num);\n              width = Math.max(width, $num.width);\n              height = Math.max(height, $num.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      return Math.log((n + 1) / (n - 1)) / 2;\n  });\n\n  defineBuiltinFunction('power', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return Math.pow(a, b);\n  });\n\n  defineBuiltinFunction('mod', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false)) && ($b == 0 ? (err = 'DIV/0', false) : true))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return a % b;\n  });\n\n  defineBuiltinFunction('quotient', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((typeof ($a = this.force($a)) == 'number' ? ($a = limitPrecision($a), true) : false) || (typeof $a == 'boolean' ? ($a = +$a, true) : false) || (typeof $a == 'string' && !/^(?:=|true|false)/i.test($a) ? (tmp = calc.parse(0, 0, 0, $a), /^date|number|percent$/.test(tmp.type) ? ($a = +tmp.value, true) : false) : false))) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((typeof ($b = this.force($b)) == 'number' ? ($b = limitPrecision($b), true) : false) || (typeof $b == 'boolean' ? ($b = +$b, true) : false) || (typeof $b == 'string' && !/^(?:=|true|false)/i.test($b) ? (tmp = calc.parse(0, 0, 0, $b), /^date|number|percent$/.test(tmp.type) ? ($b = +tmp.value, true) : false) : false)) && ($b == 0 ? (err = 'DIV/0', false) : true))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $a = this._arrayArg(args[i]);\n          if ($a) {\n              xargs.push($a);\n              width = Math.max(width, $a.width);\n              height = Math.max(height, $a.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $b = this._arrayArg(args[i]);\n          if ($b) {\n              xargs.push($b);\n              width = Math.max(width, $b.width);\n              height = Math.max(height, $b.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return Math.floor(a / b);\n  });\n\n  defineBuiltinFunction('ceiling', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          {\n              if (!($significance >= 0 || $number < 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $significance = this._arrayArg(args[i]);\n          if ($significance) {\n              xargs.push($significance);\n              width = Math.max(width, $significance.width);\n              height = Math.max(height, $significance.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, s) {\n      return s ? s * Math.ceil(num / s) : 0;\n  });\n\n  defineBuiltinFunction('ceiling.precise', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = 1, true) : false))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $significance = this._arrayArg(args[i]);\n          if ($significance) {\n              xargs.push($significance);\n              width = Math.max(width, $significance.width);\n              height = Math.max(height, $significance.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, s) {\n      s = Math.abs(s);\n      return s ? s * Math.ceil(num / s) : 0;\n  });\n\n  calc.runtime.defineAlias(\"iso.ceiling\", \"ceiling.precise\");\n\n  // XXX: how do we know if this function is correct?\n  //\n  // https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n  //\n  // “There are many combinations of Significance and Mode values that affect rounding of negative\n  // numbers in different ways.” — right, thanks for the info. :-\\\n  defineBuiltinFunction('ceiling.math', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = $number < 0 ? -1 : 1, true) : false))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          {\n              var $mode = args[i++];\n              if ($mode instanceof CalcError)\n                  return $mode;\n              if (!(typeof ($mode = this.force($mode)) == 'boolean' || (typeof $mode == 'number' ? ($mode = !!$mode, true) : false) || ($mode == null ? ($mode = 0, true) : false))) {\n                  if ($mode instanceof CalcError)\n                      return $mode;\n                  return new CalcError(err);\n              }\n              xargs.push($mode);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $significance = this._arrayArg(args[i]);\n          if ($significance) {\n              xargs.push($significance);\n              width = Math.max(width, $significance.width);\n              height = Math.max(height, $significance.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $mode = this._arrayArg(args[i]);\n          if ($mode) {\n              xargs.push($mode);\n              width = Math.max(width, $mode.width);\n              height = Math.max(height, $mode.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, s, mode) {\n      if (!s || !num) {\n          return 0;\n      }\n      if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n          s = -s;\n      }\n      return s ? s * Math.ceil(num / s) : 0;\n  });\n\n  defineBuiltinFunction('floor', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          {\n              if (!($significance >= 0 || $number < 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $significance = this._arrayArg(args[i]);\n          if ($significance) {\n              xargs.push($significance);\n              width = Math.max(width, $significance.width);\n              height = Math.max(height, $significance.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, s) {\n      return s ? s * Math.floor(num / s) : 0;\n  });\n\n  defineBuiltinFunction('floor.precise', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = 1, true) : false))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $significance = this._arrayArg(args[i]);\n          if ($significance) {\n              xargs.push($significance);\n              width = Math.max(width, $significance.width);\n              height = Math.max(height, $significance.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, s) {\n      s = Math.abs(s);\n      return s ? s * Math.floor(num / s) : 0;\n  });\n\n  // XXX: check this\n  defineBuiltinFunction('floor.math', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((typeof ($significance = this.force($significance)) == 'number' ? ($significance = limitPrecision($significance), true) : false) || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false) || ($significance == null ? ($significance = $number < 0 ? -1 : 1, true) : false))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          {\n              var $mode = args[i++];\n              if ($mode instanceof CalcError)\n                  return $mode;\n              if (!(typeof ($mode = this.force($mode)) == 'boolean' || (typeof $mode == 'number' ? ($mode = !!$mode, true) : false) || ($mode == null ? ($mode = 0, true) : false))) {\n                  if ($mode instanceof CalcError)\n                      return $mode;\n                  return new CalcError(err);\n              }\n              xargs.push($mode);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $significance = this._arrayArg(args[i]);\n          if ($significance) {\n              xargs.push($significance);\n              width = Math.max(width, $significance.width);\n              height = Math.max(height, $significance.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $mode = this._arrayArg(args[i]);\n          if ($mode) {\n              xargs.push($mode);\n              width = Math.max(width, $mode.width);\n              height = Math.max(height, $mode.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, s, mode) {\n      if (!s || !num) {\n          return 0;\n      }\n      if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n          s = -s;\n      }\n      return s ? s * Math.floor(num / s) : 0;\n  });\n\n  defineBuiltinFunction('int', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), Math.floor);\n\n  defineBuiltinFunction('mround', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $multiple = args[i++];\n              if ($multiple instanceof CalcError)\n                  return $multiple;\n              if (!((typeof ($multiple = this.force($multiple)) == 'number' ? ($multiple = limitPrecision($multiple), true) : false) || (typeof $multiple == 'boolean' ? ($multiple = +$multiple, true) : false) || (typeof $multiple == 'string' && !/^(?:=|true|false)/i.test($multiple) ? (tmp = calc.parse(0, 0, 0, $multiple), /^date|number|percent$/.test(tmp.type) ? ($multiple = +tmp.value, true) : false) : false))) {\n                  if ($multiple instanceof CalcError)\n                      return $multiple;\n                  return new CalcError(err);\n              }\n              xargs.push($multiple);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $multiple = this._arrayArg(args[i]);\n          if ($multiple) {\n              xargs.push($multiple);\n              width = Math.max(width, $multiple.width);\n              height = Math.max(height, $multiple.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, mult) {\n      return mult ? mult * Math.round(num / mult) : 0;\n  });\n\n  defineBuiltinFunction('round', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $digits = args[i++];\n              if ($digits instanceof CalcError)\n                  return $digits;\n              if (!((typeof ($digits = this.force($digits)) == 'number' ? ($digits = limitPrecision($digits), true) : false) || (typeof $digits == 'boolean' ? ($digits = +$digits, true) : false) || (typeof $digits == 'string' && !/^(?:=|true|false)/i.test($digits) ? (tmp = calc.parse(0, 0, 0, $digits), /^date|number|percent$/.test(tmp.type) ? ($digits = +tmp.value, true) : false) : false))) {\n                  if ($digits instanceof CalcError)\n                      return $digits;\n                  return new CalcError(err);\n              }\n              xargs.push($digits);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $digits = this._arrayArg(args[i]);\n          if ($digits) {\n              xargs.push($digits);\n              width = Math.max(width, $digits.width);\n              height = Math.max(height, $digits.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, digits) {\n      var sign = num < 0 ? -1 : 1;\n      if (sign < 0) {\n          num = -num;\n      }\n      digits = Math.pow(10, digits);\n      num = limitPrecision(num * digits);\n      num = Math.round(num);\n      return sign * num / digits;\n  });\n\n  defineBuiltinFunction('roundup', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $digits = args[i++];\n              if ($digits instanceof CalcError)\n                  return $digits;\n              if (!((typeof ($digits = this.force($digits)) == 'number' ? ($digits = limitPrecision($digits), true) : false) || (typeof $digits == 'boolean' ? ($digits = +$digits, true) : false) || (typeof $digits == 'string' && !/^(?:=|true|false)/i.test($digits) ? (tmp = calc.parse(0, 0, 0, $digits), /^date|number|percent$/.test(tmp.type) ? ($digits = +tmp.value, true) : false) : false))) {\n                  if ($digits instanceof CalcError)\n                      return $digits;\n                  return new CalcError(err);\n              }\n              xargs.push($digits);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $digits = this._arrayArg(args[i]);\n          if ($digits) {\n              xargs.push($digits);\n              width = Math.max(width, $digits.width);\n              height = Math.max(height, $digits.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, digits) {\n      digits = Math.pow(10, digits);\n      num = limitPrecision(num * digits);\n      num = num < 0 ? Math.floor(num) : Math.ceil(num);\n      return num / digits;\n  });\n\n  defineBuiltinFunction('rounddown', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $digits = args[i++];\n              if ($digits instanceof CalcError)\n                  return $digits;\n              if (!((typeof ($digits = this.force($digits)) == 'number' ? ($digits = limitPrecision($digits), true) : false) || (typeof $digits == 'boolean' ? ($digits = +$digits, true) : false) || (typeof $digits == 'string' && !/^(?:=|true|false)/i.test($digits) ? (tmp = calc.parse(0, 0, 0, $digits), /^date|number|percent$/.test(tmp.type) ? ($digits = +tmp.value, true) : false) : false))) {\n                  if ($digits instanceof CalcError)\n                      return $digits;\n                  return new CalcError(err);\n              }\n              xargs.push($digits);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $digits = this._arrayArg(args[i]);\n          if ($digits) {\n              xargs.push($digits);\n              width = Math.max(width, $digits.width);\n              height = Math.max(height, $digits.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num, digits) {\n      digits = Math.pow(10, digits);\n      num = limitPrecision(num * digits);\n      num = num < 0 ? Math.ceil(num) : Math.floor(num);\n      return num / digits;\n  });\n\n  defineBuiltinFunction('even', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n      return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n  });\n\n  defineBuiltinFunction('odd', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n      return n % 2 ? n : n + (n < 0 ? -1 : 1);\n  });\n\n  defineBuiltinFunction('sign', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      return num < 0 ? -1 : num > 0 ? 1 : 0;\n  });\n\n  function _gcd(a, b) {\n      while (b) {\n          var r = a % b;\n          a = b;\n          b = r;\n      }\n      return a;\n  }\n\n  function _lcm(a, b) {\n      return Math.abs(a * b) / _gcd(a, b);\n  }\n\n  defineBuiltinFunction('gcd', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (args) {\n      var a = args[0];\n      for (var i = 1; i < args.length; ++i) {\n          a = _gcd(a, args[i]);\n      }\n      return a;\n  });\n\n  defineBuiltinFunction('lcm', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (args) {\n      var a = args[0];\n      for (var i = 1; i < args.length; ++i) {\n          a = _lcm(a, args[i]);\n      }\n      return a;\n  });\n\n  defineBuiltinFunction('sum', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return numbers.reduce(function (sum, num) {\n          return sum + num;\n      }, 0);\n  });\n\n  defineBuiltinFunction('product', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return numbers.reduce(function (prod, num) {\n          return prod * num;\n      }, 1);\n  });\n\n  defineBuiltinFunction('sumproduct', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $a1 = args[i++];\n              if ($a1 instanceof CalcError)\n                  return $a1;\n              if (!((m = this.asMatrix($a1)) ? $a1 = m : false)) {\n                  if ($a1 instanceof CalcError)\n                      return $a1;\n                  return new CalcError(err);\n              }\n              xargs.push($a1);\n          }\n          {\n              if (i >= args.length)\n                  return new CalcError('N/A');\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              do {\n                  {\n                      var $a2 = args[i++];\n                      if ($a2 instanceof CalcError)\n                          return $a2;\n                      if (!(((m = this.asMatrix($a2)) ? $a2 = m : false) && ($a2.width == $a1.width ? true : (err = 'N/A', false)) && ($a2.height == $a1.height ? true : (err = 'N/A', false)))) {\n                          if ($a2 instanceof CalcError)\n                              return $a2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($a2);\n                  }\n              } while (i < args.length);\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          while (i < args.length) {\n              toResolve.push(args[i++]);\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (first, rest) {\n      var sum = 0;\n      first.each(function (p, row, col) {\n          if (typeof p == 'number') {\n              for (var i = 0; i < rest.length; ++i) {\n                  var v = rest[i].get(row, col);\n                  if (typeof v != 'number') {\n                      return;\n                  }\n                  p *= v;\n              }\n              sum += p;\n          }\n      });\n      return sum;\n  });\n\n  defineBuiltinFunction('sumsq', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return numbers.reduce(function (sum, num) {\n          return sum + num * num;\n      }, 0);\n  });\n\n  defineBuiltinFunction('sumx2my2', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.width == $a.width ? true : (err = 'N/A', false)) && ($b.height == $a.height ? true : (err = 'N/A', false)))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (a, b) {\n      var sum = 0;\n      a.each(function (x, row, col) {\n          var y = b.get(row, col);\n          if (typeof x == 'number' && typeof y == 'number') {\n              sum += x * x - y * y;\n          }\n      });\n      return sum;\n  });\n\n  defineBuiltinFunction('sumx2py2', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.width == $a.width ? true : (err = 'N/A', false)) && ($b.height == $a.height ? true : (err = 'N/A', false)))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (a, b) {\n      var sum = 0;\n      a.each(function (x, row, col) {\n          var y = b.get(row, col);\n          if (typeof x == 'number' && typeof y == 'number') {\n              sum += x * x + y * y;\n          }\n      });\n      return sum;\n  });\n\n  defineBuiltinFunction('sumxmy2', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.width == $a.width ? true : (err = 'N/A', false)) && ($b.height == $a.height ? true : (err = 'N/A', false)))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (a, b) {\n      var sum = 0;\n      a.each(function (x, row, col) {\n          var y = b.get(row, col);\n          if (typeof x == 'number' && typeof y == 'number') {\n              sum += (x - y) * (x - y);\n          }\n      });\n      return sum;\n  });\n\n  defineBuiltinFunction('seriessum', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $y = args[i++];\n              if ($y instanceof CalcError)\n                  return $y;\n              if (!((typeof ($y = this.force($y)) == 'number' ? ($y = limitPrecision($y), true) : false) || (typeof $y == 'boolean' ? ($y = +$y, true) : false) || (typeof $y == 'string' && !/^(?:=|true|false)/i.test($y) ? (tmp = calc.parse(0, 0, 0, $y), /^date|number|percent$/.test(tmp.type) ? ($y = +tmp.value, true) : false) : false))) {\n                  if ($y instanceof CalcError)\n                      return $y;\n                  return new CalcError(err);\n              }\n              xargs.push($y);\n          }\n          {\n              var $m = args[i++];\n              if ($m instanceof CalcError)\n                  return $m;\n              if (!((typeof ($m = this.force($m)) == 'number' ? ($m = limitPrecision($m), true) : false) || (typeof $m == 'boolean' ? ($m = +$m, true) : false) || (typeof $m == 'string' && !/^(?:=|true|false)/i.test($m) ? (tmp = calc.parse(0, 0, 0, $m), /^date|number|percent$/.test(tmp.type) ? ($m = +tmp.value, true) : false) : false))) {\n                  if ($m instanceof CalcError)\n                      return $m;\n                  return new CalcError(err);\n              }\n              xargs.push($m);\n          }\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (x, n, m, a) {\n      var sum = 0;\n      a.each(function (coef) {\n          if (typeof coef != 'number') {\n              throw new CalcError('VALUE');\n          }\n          sum += coef * Math.pow(x, n);\n          n += m;\n      });\n      return sum;\n  });\n\n  defineBuiltinFunction('min', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return numbers.length ? Math.min.apply(Math, numbers) : 0;\n  });\n\n  defineBuiltinFunction('max', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return numbers.length ? Math.max.apply(Math, numbers) : 0;\n  });\n\n  defineBuiltinFunction('counta', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                      if ($values != null && i <= args.length)\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (values) {\n      return values.length;\n  });\n\n  defineBuiltinFunction('count', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return numbers.length;\n  });\n\n  defineBuiltinFunction('countunique', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                      if ($values != null && i <= args.length)\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (values) {\n      var count = 0, seen = [];\n      values.forEach(function (val) {\n          if (seen.indexOf(val) < 0) {\n              count++;\n              seen.push(val);\n          }\n      });\n      return count;\n  });\n\n  defineBuiltinFunction('countblank', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              if (i >= args.length)\n                  return new CalcError('N/A');\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              do {\n                  {\n                      var $args = args[i++];\n                      if ($args instanceof CalcError)\n                          return $args;\n                      if (!(((m = this.asMatrix($args)) ? $args = m : false) || $args != null && i <= args.length)) {\n                          if ($args instanceof CalcError)\n                              return $args;\n                          return new CalcError(err);\n                      }\n                      xargs.push($args);\n                  }\n              } while (i < args.length);\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          while (i < args.length) {\n              toResolve.push(args[i++]);\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (a) {\n      var count = 0;\n      function add(val) {\n          if (val == null || val === '') {\n              count++;\n          }\n      }\n      function loop(args) {\n          for (var i = 0; i < args.length; ++i) {\n              var x = args[i];\n              if (x instanceof Matrix) {\n                  x.each(add, true);\n              } else {\n                  add(x);\n              }\n          }\n      }\n      loop(a);\n      return count;\n  });\n\n  defineBuiltinFunction('iseven', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      return num % 2 === 0;\n  });\n\n  defineBuiltinFunction('isodd', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      return num % 2 !== 0;\n  });\n\n  defineBuiltinFunction('n', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (val) {\n      if (typeof val == 'boolean') {\n          return val ? 1 : 0;\n      }\n      if (typeof val == 'number') {\n          return val;\n      }\n      return 0;\n  });\n\n  defineBuiltinFunction('na', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return new CalcError('N/A');\n  });\n\n  /* -----[ the \"*IFS\" functions ]----- */\n\n  // helper function: take `args` like COUNTIFS (see Excel docs) and\n  // calls `f` for each cell matching all criteria.  `f` receives\n  // `chunks` (parsed args containing matrix and predicate) and\n  // row,col of matching cells.\n  function forIFS(args, f) {\n      var chunks = [], i = 0, matrix = args[0];\n      while (i < args.length) {\n          chunks.push({\n              matrix: args[i++],\n              pred: parseCriteria(args[i++])\n          });\n      }\n      for (var row = 0; row < matrix.height; ++row) {\n          COL: for (var col = 0; col < matrix.width; ++col) {\n              for (i = 0; i < chunks.length; ++i) {\n                  var val = chunks[i].matrix.get(row, col);\n                  if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                      continue COL;\n                  }\n              }\n              f(row, col);\n          }\n      }\n  }\n\n  defineBuiltinFunction('countifs', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $m1 = args[i++];\n              if ($m1 instanceof CalcError)\n                  return $m1;\n              if (!((m = this.asMatrix($m1)) ? $m1 = m : false)) {\n                  if ($m1 instanceof CalcError)\n                      return $m1;\n                  return new CalcError(err);\n              }\n              xargs.push($m1);\n          }\n          {\n              var $c1 = args[i++];\n              if ($c1 instanceof CalcError)\n                  return $c1;\n              if (!(($c1 = this.force($c1)) != null && i <= args.length)) {\n                  if ($c1 instanceof CalcError)\n                      return $c1;\n                  return new CalcError(err);\n              }\n              xargs.push($c1);\n          }\n          {\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              while (i < args.length) {\n                  {\n                      var $m2 = args[i++];\n                      if ($m2 instanceof CalcError)\n                          return $m2;\n                      if (!((m = this.asMatrix($m2)) ? $m2 = m : false)) {\n                          if ($m2 instanceof CalcError)\n                              return $m2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($m2);\n                  }\n                  {\n                      var $c2 = args[i++];\n                      if ($c2 instanceof CalcError)\n                          return $c2;\n                      if (!(($c2 = this.force($c2)) != null && i <= args.length)) {\n                          if ($c2 instanceof CalcError)\n                              return $c2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($c2);\n                  }\n              }\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          while (i < args.length) {\n              toResolve.push(args[i++]);\n              toResolve.push(args[i++]);\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (m1, c1, rest) {\n      var count = 0;\n      rest.unshift(m1, c1);\n      forIFS(rest, function () {\n          count++;\n      });\n      return count;\n  });\n\n  defineBuiltinFunction('sumifs', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $m1 = args[i++];\n              if ($m1 instanceof CalcError)\n                  return $m1;\n              if (!((m = this.asMatrix($m1)) ? $m1 = m : false)) {\n                  if ($m1 instanceof CalcError)\n                      return $m1;\n                  return new CalcError(err);\n              }\n              xargs.push($m1);\n          }\n          {\n              var $c1 = args[i++];\n              if ($c1 instanceof CalcError)\n                  return $c1;\n              if (!(($c1 = this.force($c1)) != null && i <= args.length)) {\n                  if ($c1 instanceof CalcError)\n                      return $c1;\n                  return new CalcError(err);\n              }\n              xargs.push($c1);\n          }\n          {\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              while (i < args.length) {\n                  {\n                      var $m2 = args[i++];\n                      if ($m2 instanceof CalcError)\n                          return $m2;\n                      if (!((m = this.asMatrix($m2)) ? $m2 = m : false)) {\n                          if ($m2 instanceof CalcError)\n                              return $m2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($m2);\n                  }\n                  {\n                      var $c2 = args[i++];\n                      if ($c2 instanceof CalcError)\n                          return $c2;\n                      if (!(($c2 = this.force($c2)) != null && i <= args.length)) {\n                          if ($c2 instanceof CalcError)\n                              return $c2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($c2);\n                  }\n              }\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          while (i < args.length) {\n              toResolve.push(args[i++]);\n              toResolve.push(args[i++]);\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (range, m1, c1, args) {\n      args.unshift(range, numericPredicate, m1, c1);\n      var sum = 0;\n      forIFS(args, function (row, col) {\n          var val = range.get(row, col);\n          if (val) {\n              sum += val;\n          }\n      });\n      return sum;\n  });\n\n  // similar to sumifs, but compute average of matching cells\n  defineBuiltinFunction('averageifs', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $m1 = args[i++];\n              if ($m1 instanceof CalcError)\n                  return $m1;\n              if (!((m = this.asMatrix($m1)) ? $m1 = m : false)) {\n                  if ($m1 instanceof CalcError)\n                      return $m1;\n                  return new CalcError(err);\n              }\n              xargs.push($m1);\n          }\n          {\n              var $c1 = args[i++];\n              if ($c1 instanceof CalcError)\n                  return $c1;\n              if (!(($c1 = this.force($c1)) != null && i <= args.length)) {\n                  if ($c1 instanceof CalcError)\n                      return $c1;\n                  return new CalcError(err);\n              }\n              xargs.push($c1);\n          }\n          {\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              while (i < args.length) {\n                  {\n                      var $m2 = args[i++];\n                      if ($m2 instanceof CalcError)\n                          return $m2;\n                      if (!((m = this.asMatrix($m2)) ? $m2 = m : false)) {\n                          if ($m2 instanceof CalcError)\n                              return $m2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($m2);\n                  }\n                  {\n                      var $c2 = args[i++];\n                      if ($c2 instanceof CalcError)\n                          return $c2;\n                      if (!(($c2 = this.force($c2)) != null && i <= args.length)) {\n                          if ($c2 instanceof CalcError)\n                              return $c2;\n                          return new CalcError(err);\n                      }\n                      xargs.push($c2);\n                  }\n              }\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          while (i < args.length) {\n              toResolve.push(args[i++]);\n              toResolve.push(args[i++]);\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (range, m1, c1, args) {\n      args.unshift(range, numericPredicate, m1, c1);\n      var sum = 0, count = 0;\n      forIFS(args, function (row, col) {\n          var val = range.get(row, col);\n          if (val == null || val === '') {\n              val = 0;\n          }\n          sum += val;\n          count++;\n      });\n      return count ? sum / count : new CalcError('DIV/0');\n  });\n\n  defineBuiltinFunction('countif', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $criteria = args[i++];\n              if ($criteria instanceof CalcError)\n                  return $criteria;\n              if (!(($criteria = this.force($criteria)) != null && i <= args.length)) {\n                  if ($criteria instanceof CalcError)\n                      return $criteria;\n                  return new CalcError(err);\n              }\n              xargs.push($criteria);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          var $criteria = this._arrayArg(args[i]);\n          if ($criteria) {\n              xargs.push($criteria);\n              width = Math.max(width, $criteria.width);\n              height = Math.max(height, $criteria.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (matrix, criteria) {\n      criteria = parseCriteria(criteria);\n      var count = 0;\n      matrix.each(function (val) {\n          if (criteria(val)) {\n              count++;\n          }\n      });\n      return count;\n  });\n\n  function fetchSumRange(continuation) {\n      return function(callback, range, criteria, sumRange) {\n          var self = this;\n          if (sumRange instanceof Ref) {\n              // make sure it covers the same area as `range`, as the “spec” mentions:\n              //\n              //     The sum_range argument does not have to be the same size and shape as the\n              //     range argument. The actual cells that are added are determined by using the\n              //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n              //     including cells that correspond in size and shape to the range argument.\n              //\n              // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n              // should it be a range at all?  Oh well, Excel.\n              var r = sumRange.clone().toRangeRef();\n              if (r.width() != range.width || r.height() != range.height) {\n                  if (!isFinite(r.topLeft.row)) {\n                      r.topLeft.row = 0;\n                  }\n                  if (!isFinite(r.topLeft.col)) {\n                      r.topLeft.col = 0;\n                  }\n                  r.bottomRight.row = r.topLeft.row + range.height - 1;\n                  r.bottomRight.col = r.topLeft.col + range.width - 1;\n                  return self.resolveCells([ r ], function(){\n                      callback(continuation(range, criteria, self.asMatrix(r)));\n                  });\n              }\n          }\n          callback(continuation(range, criteria, self.asMatrix(sumRange)));\n      };\n  }\n\n  defineBuiltinFunction('sumif', true, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $criteria = args[i++];\n              if ($criteria instanceof CalcError)\n                  return $criteria;\n              if (!(($criteria = this.force($criteria)) != null && i <= args.length)) {\n                  if ($criteria instanceof CalcError)\n                      return $criteria;\n                  return new CalcError(err);\n              }\n              xargs.push($criteria);\n          }\n          {\n              var $sumRange = args[i++];\n              if ($sumRange instanceof CalcError)\n                  return $sumRange;\n              if (!($sumRange instanceof CellRef || $sumRange instanceof RangeRef || ((m = this.asMatrix($sumRange)) ? $sumRange = m : false) || (($sumRange = this.force($sumRange)) == null ? ($sumRange = $range, true) : false))) {\n                  if ($sumRange instanceof CalcError)\n                      return $sumRange;\n                  return new CalcError(err);\n              }\n              xargs.push($sumRange);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          var $criteria = this._arrayArg(args[i]);\n          if ($criteria) {\n              xargs.push($criteria);\n              width = Math.max(width, $criteria.width);\n              height = Math.max(height, $criteria.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), fetchSumRange(function (range, criteria, sumRange) {\n      var sum = 0;\n      criteria = parseCriteria(criteria);\n      range.each(function (val, row, col) {\n          if (criteria(val)) {\n              var v = sumRange.get(row, col);\n              if (numericPredicate(v)) {\n                  sum += v || 0;\n              }\n          }\n      });\n      return sum;\n  }));\n\n  defineBuiltinFunction('averageif', true, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $criteria = args[i++];\n              if ($criteria instanceof CalcError)\n                  return $criteria;\n              if (!(($criteria = this.force($criteria)) != null && i <= args.length)) {\n                  if ($criteria instanceof CalcError)\n                      return $criteria;\n                  return new CalcError(err);\n              }\n              xargs.push($criteria);\n          }\n          {\n              var $sumRange = args[i++];\n              if ($sumRange instanceof CalcError)\n                  return $sumRange;\n              if (!($sumRange instanceof CellRef || $sumRange instanceof RangeRef || ((m = this.asMatrix($sumRange)) ? $sumRange = m : false) || (($sumRange = this.force($sumRange)) == null ? ($sumRange = $range, true) : false))) {\n                  if ($sumRange instanceof CalcError)\n                      return $sumRange;\n                  return new CalcError(err);\n              }\n              xargs.push($sumRange);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          var $criteria = this._arrayArg(args[i]);\n          if ($criteria) {\n              xargs.push($criteria);\n              width = Math.max(width, $criteria.width);\n              height = Math.max(height, $criteria.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), fetchSumRange(function (range, criteria, sumRange) {\n      var sum = 0, count = 0;\n      criteria = parseCriteria(criteria);\n      range.each(function (val, row, col) {\n          if (criteria(val)) {\n              var v = sumRange.get(row, col);\n              if (numericPredicate(v)) {\n                  sum += v || 0;\n                  count++;\n              }\n          }\n      });\n      return count ? sum / count : new CalcError('DIV/0');\n  }));\n\n  function _extreme(matrix, nth, order){\n      var numbers = [];\n      var error = matrix.each(function(val){\n          if (val instanceof CalcError) {\n              return val;\n          }\n          if (typeof val == \"number\") {\n              numbers.push(val);\n          }\n      });\n      if (error) {\n          return error;\n      }\n      if (nth > numbers.length) {\n          return new CalcError(\"NUM\");\n      }\n      return numbers.sort(order)[nth - 1];\n  }\n\n  defineBuiltinFunction('large', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $array = args[i++];\n              if ($array instanceof CalcError)\n                  return $array;\n              if (!((m = this.asMatrix($array)) ? $array = m : false)) {\n                  if ($array instanceof CalcError)\n                      return $array;\n                  return new CalcError(err);\n              }\n              xargs.push($array);\n          }\n          {\n              var $nth = args[i++];\n              if ($nth instanceof CalcError)\n                  return $nth;\n              if (!(((typeof ($nth = this.force($nth)) == 'number' ? ($nth = limitPrecision($nth), true) : false) || (typeof $nth == 'boolean' ? ($nth = +$nth, true) : false) || (typeof $nth == 'string' && !/^(?:=|true|false)/i.test($nth) ? (tmp = calc.parse(0, 0, 0, $nth), /^date|number|percent$/.test(tmp.type) ? ($nth = +tmp.value, true) : false) : false)) && ($nth > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nth instanceof CalcError)\n                      return $nth;\n                  return new CalcError(err);\n              }\n              xargs.push($nth);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          var $nth = this._arrayArg(args[i]);\n          if ($nth) {\n              xargs.push($nth);\n              width = Math.max(width, $nth.width);\n              height = Math.max(height, $nth.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (matrix, nth) {\n      return _extreme(matrix, nth, descending);\n  });\n\n  defineBuiltinFunction('small', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $array = args[i++];\n              if ($array instanceof CalcError)\n                  return $array;\n              if (!((m = this.asMatrix($array)) ? $array = m : false)) {\n                  if ($array instanceof CalcError)\n                      return $array;\n                  return new CalcError(err);\n              }\n              xargs.push($array);\n          }\n          {\n              var $nth = args[i++];\n              if ($nth instanceof CalcError)\n                  return $nth;\n              if (!(((typeof ($nth = this.force($nth)) == 'number' ? ($nth = limitPrecision($nth), true) : false) || (typeof $nth == 'boolean' ? ($nth = +$nth, true) : false) || (typeof $nth == 'string' && !/^(?:=|true|false)/i.test($nth) ? (tmp = calc.parse(0, 0, 0, $nth), /^date|number|percent$/.test(tmp.type) ? ($nth = +tmp.value, true) : false) : false)) && ($nth > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nth instanceof CalcError)\n                      return $nth;\n                  return new CalcError(err);\n              }\n              xargs.push($nth);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          var $nth = this._arrayArg(args[i]);\n          if ($nth) {\n              xargs.push($nth);\n              width = Math.max(width, $nth.width);\n              height = Math.max(height, $nth.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (matrix, nth) {\n      return _extreme(matrix, nth, ascending);\n  });\n\n  function _avg(numbers) {\n      return numbers.reduce(function(sum, num){\n          return sum + num;\n      }, 0) / numbers.length;\n  }\n\n  function _var_sp(numbers, divisor, avg) {\n      if (avg == null) {\n          avg = _avg(numbers);\n      }\n      return numbers.reduce(function(sum, num){\n          return sum + Math.pow(num - avg, 2);\n      }, 0) / divisor;\n  }\n\n  function _stdev_sp(numbers, divisor) {\n      return Math.sqrt(_var_sp(numbers, divisor));\n  }\n\n  // https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\n  defineBuiltinFunction('stdev.s', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return _stdev_sp(numbers, numbers.length - 1);\n  });\n\n  // https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\n  defineBuiltinFunction('stdev.p', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length >= 1 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return _stdev_sp(numbers, numbers.length);\n  });\n\n  defineBuiltinFunction('var.s', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return _var_sp(numbers, numbers.length - 1);\n  });\n\n  defineBuiltinFunction('var.p', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      return _var_sp(numbers, numbers.length);\n  });\n\n  defineBuiltinFunction('median', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var n = numbers.length;\n      numbers.sort(ascending);\n      if (n % 2) {\n          return numbers[n >> 1];\n      }\n      return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n  });\n\n  defineBuiltinFunction('mode.sngl', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      numbers.sort(ascending);\n      var prev = null, count = 0, max = 1, mode = null;\n      for (var i = 0; i < numbers.length; ++i) {\n          var n = numbers[i];\n          if (n != prev) {\n              count = 1;\n              prev = n;\n          } else {\n              count++;\n          }\n          if (count > max) {\n              max = count;\n              mode = n;\n          }\n      }\n      return mode == null ? new CalcError('N/A') : mode;\n  });\n\n  defineBuiltinFunction('mode.mult', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var seen = Object.create(null), max = 2, res = [];\n      numbers.forEach(function (num) {\n          var s = seen[num] || 0;\n          seen[num] = ++s;\n          if (s == max) {\n              res.push(num);\n          } else if (s > max) {\n              max = s;\n              res = [num];\n          }\n      });\n      var m = new Matrix(this);\n      res.forEach(function (num, i) {\n          m.set(i, 0, num);\n      });\n      return m;\n  });\n\n  defineBuiltinFunction('geomean', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length > 0 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var n = numbers.length;\n      var p = numbers.reduce(function (p, num) {\n          if (num < 0) {\n              throw new CalcError('NUM');\n          }\n          return p * num;\n      }, 1);\n      return Math.pow(p, 1 / n);\n  });\n\n  defineBuiltinFunction('harmean', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length > 0 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var n = numbers.length;\n      var s = numbers.reduce(function (s, num) {\n          if (!num) {\n              throw new CalcError('DIV/0');\n          }\n          return s + 1 / num;\n      }, 0);\n      return n / s;\n  });\n\n  defineBuiltinFunction('trimmean', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $percent = args[i++];\n              if ($percent instanceof CalcError)\n                  return $percent;\n              if (!(((typeof ($percent = this.force($percent)) == 'number' ? ($percent = limitPrecision($percent), true) : false) || (typeof $percent == 'boolean' ? ($percent = +$percent, true) : false) || (typeof $percent == 'string' && !/^(?:=|true|false)/i.test($percent) ? (tmp = calc.parse(0, 0, 0, $percent), /^date|number|percent$/.test(tmp.type) ? ($percent = +tmp.value, true) : false) : false)) && ($percent >= 0 && $percent < 1 ? true : (err = 'NUM', false)))) {\n                  if ($percent instanceof CalcError)\n                      return $percent;\n                  return new CalcError(err);\n              }\n              xargs.push($percent);\n          }\n          {\n              if (!($numbers.length > 0 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers, p) {\n      var n = numbers.length;\n      numbers.sort(ascending);\n      var discard = Math.floor(n * p);\n      if (discard % 2) {\n          --discard;\n      }\n      discard /= 2;\n      var sum = 0;\n      for (var i = discard; i < n - discard; ++i) {\n          sum += numbers[i];\n      }\n      return sum / (n - discard * 2);\n  });\n\n  defineBuiltinFunction('frequency', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $data = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $data) {\n                      if ($data instanceof CalcError)\n                          throw $data;\n                      if ((typeof $data == 'number' ? ($data = limitPrecision($data), true) : false) || (typeof $data == 'boolean' ? ($data = +$data, true) : false) || (typeof $data == 'string' && !/^(?:=|true|false)/i.test($data) ? (tmp = calc.parse(0, 0, 0, $data), /^date|number|percent$/.test(tmp.type) ? ($data = +tmp.value, true) : false) : false))\n                          ret.push($data);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($data);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $bins = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $bins) {\n                      if ($bins instanceof CalcError)\n                          throw $bins;\n                      if ((typeof $bins == 'number' ? ($bins = limitPrecision($bins), true) : false) || (typeof $bins == 'boolean' ? ($bins = +$bins, true) : false) || (typeof $bins == 'string' && !/^(?:=|true|false)/i.test($bins) ? (tmp = calc.parse(0, 0, 0, $bins), /^date|number|percent$/.test(tmp.type) ? ($bins = +tmp.value, true) : false) : false))\n                          ret.push($bins);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($bins);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (data, bins) {\n      data.sort(ascending);\n      bins.sort(ascending);\n      var prev = -Infinity;\n      var i = 0;\n      function count(max) {\n          var n = 0;\n          while (i < data.length && data[i] > prev && data[i] <= max) {\n              ++n;\n              ++i;\n          }\n          return n;\n      }\n      var m = new Matrix(this);\n      bins.forEach(function (val, i) {\n          var n = count(val);\n          prev = val;\n          m.set(i, 0, n);\n      });\n      m.set(m.height, 0, data.length - i);\n      return m;\n  });\n\n  defineBuiltinFunction('rank.eq', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!((typeof ($value = this.force($value)) == 'number' ? ($value = limitPrecision($value), true) : false) || (typeof $value == 'boolean' ? ($value = +$value, true) : false) || (typeof $value == 'string' && !/^(?:=|true|false)/i.test($value) ? (tmp = calc.parse(0, 0, 0, $value), /^date|number|percent$/.test(tmp.type) ? ($value = +tmp.value, true) : false) : false))) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $order = args[i++];\n              if ($order instanceof CalcError)\n                  return $order;\n              if (!(typeof ($order = this.force($order)) == 'boolean' || (typeof $order == 'number' ? ($order = !!$order, true) : false) || ($order == null ? ($order = false, true) : false))) {\n                  if ($order instanceof CalcError)\n                      return $order;\n                  return new CalcError(err);\n              }\n              xargs.push($order);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (val, numbers, asc) {\n      numbers.sort(asc ? ascending : descending);\n      var pos = numbers.indexOf(val);\n      return pos < 0 ? new CalcError('N/A') : pos + 1;\n  });\n\n  calc.runtime.defineAlias(\"rank\", \"rank.eq\");\n\n  defineBuiltinFunction('rank.avg', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!((typeof ($value = this.force($value)) == 'number' ? ($value = limitPrecision($value), true) : false) || (typeof $value == 'boolean' ? ($value = +$value, true) : false) || (typeof $value == 'string' && !/^(?:=|true|false)/i.test($value) ? (tmp = calc.parse(0, 0, 0, $value), /^date|number|percent$/.test(tmp.type) ? ($value = +tmp.value, true) : false) : false))) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $order = args[i++];\n              if ($order instanceof CalcError)\n                  return $order;\n              if (!(typeof ($order = this.force($order)) == 'boolean' || (typeof $order == 'number' ? ($order = !!$order, true) : false) || ($order == null ? ($order = false, true) : false))) {\n                  if ($order instanceof CalcError)\n                      return $order;\n                  return new CalcError(err);\n              }\n              xargs.push($order);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (val, numbers, asc) {\n      numbers.sort(asc ? ascending : descending);\n      var pos = numbers.indexOf(val);\n      if (pos < 0) {\n          return new CalcError('N/A');\n      }\n      for (var i = pos; numbers[i] == val; ++i);\n      return (pos + i + 1) / 2;\n  });\n\n  // formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\n  defineBuiltinFunction('kurt', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length >= 4 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var n = numbers.length;\n      var avg = _avg(numbers);\n      var variance = _var_sp(numbers, n - 1, avg);\n      var stddev = Math.sqrt(variance);\n      var sum = numbers.reduce(function (sum, num) {\n          return sum + Math.pow((num - avg) / stddev, 4);\n      }, 0);\n      return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n  });\n\n  function _percentrank(numbers, x, exc) {\n      var nlt = 0, ngt = 0, left = null, right = null, found = false;\n      numbers.forEach(function(num){\n          if (num < x) {\n              nlt++;\n              left = left == null ? num : Math.max(left, num);\n          } else if (num > x) {\n              ngt++;\n              right = right == null ? num : Math.min(right, num);\n          } else {\n              found = true;\n          }\n      });\n      if (!nlt && !ngt) {\n          return new CalcError(\"N/A\");\n      }\n      if (found) {\n          if (exc) {\n              return (nlt + 1) / (numbers.length + 1);\n          }\n          return nlt / (nlt + ngt);\n      }\n      return ((right - x) * _percentrank(numbers, left, exc) +\n              (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n  }\n\n  defineBuiltinFunction('percentrank.inc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array) {\n                      if ($array instanceof CalcError)\n                          throw $array;\n                      if ((typeof $array == 'number' ? ($array = limitPrecision($array), true) : false) || (typeof $array == 'boolean' ? ($array = +$array, true) : false) || (typeof $array == 'string' && !/^(?:=|true|false)/i.test($array) ? (tmp = calc.parse(0, 0, 0, $array), /^date|number|percent$/.test(tmp.type) ? ($array = +tmp.value, true) : false) : false))\n                          ret.push($array);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((($significance = this.force($significance)) == null ? ($significance = 3, true) : false) || (typeof $significance == 'number' || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false)) && (($significance |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          {\n              if (!($array.length > 0 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers, x, significance) {\n      var p = _percentrank(numbers, x, 0);\n      p = p.toFixed(significance + 1);\n      return parseFloat(p.substr(0, p.length - 1));\n  });\n\n  defineBuiltinFunction('percentrank.exc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array) {\n                      if ($array instanceof CalcError)\n                          throw $array;\n                      if ((typeof $array == 'number' ? ($array = limitPrecision($array), true) : false) || (typeof $array == 'boolean' ? ($array = +$array, true) : false) || (typeof $array == 'string' && !/^(?:=|true|false)/i.test($array) ? (tmp = calc.parse(0, 0, 0, $array), /^date|number|percent$/.test(tmp.type) ? ($array = +tmp.value, true) : false) : false))\n                          ret.push($array);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $significance = args[i++];\n              if ($significance instanceof CalcError)\n                  return $significance;\n              if (!((($significance = this.force($significance)) == null ? ($significance = 3, true) : false) || (typeof $significance == 'number' || (typeof $significance == 'boolean' ? ($significance = +$significance, true) : false) || (typeof $significance == 'string' && !/^(?:=|true|false)/i.test($significance) ? (tmp = calc.parse(0, 0, 0, $significance), /^date|number|percent$/.test(tmp.type) ? ($significance = +tmp.value, true) : false) : false)) && (($significance |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($significance instanceof CalcError)\n                      return $significance;\n                  return new CalcError(err);\n              }\n              xargs.push($significance);\n          }\n          {\n              if (!($array.length > 0 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers, x, significance) {\n      var p = _percentrank(numbers, x, 1);\n      p = p.toFixed(significance + 1);\n      return parseFloat(p.substr(0, p.length - 1));\n  });\n\n  calc.runtime.defineAlias(\"percentrank\", \"percentrank.inc\");\n\n  function _covariance(x, y, divisor) {\n      var sum = 0;\n      var ax = _avg(x);\n      var ay = _avg(y);\n      var n = x.length;\n      for (var i = 0; i < n; ++i) {\n          sum += (x[i] - ax) * (y[i] - ay);\n      }\n      return sum / divisor;\n  }\n\n  defineBuiltinFunction('covariance.p', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                      if ($array1 instanceof CalcError)\n                          throw $array1;\n                      if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                          ret.push($array1);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array1);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                      if ($array2 instanceof CalcError)\n                          throw $array2;\n                      if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                          ret.push($array2);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array2);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($array1.length == $array2.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($array1.length > 0 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (x, y) {\n      return _covariance(x, y, x.length);\n  });\n\n  defineBuiltinFunction('covariance.s', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                      if ($array1 instanceof CalcError)\n                          throw $array1;\n                      if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                          ret.push($array1);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array1);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                      if ($array2 instanceof CalcError)\n                          throw $array2;\n                      if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                          ret.push($array2);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array2);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($array1.length == $array2.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($array1.length > 1 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (x, y) {\n      return _covariance(x, y, x.length - 1);\n  });\n\n  calc.runtime.defineAlias(\"covar\", \"covariance.p\");\n\n  /* -----[ Factorials ]----- */\n\n  var _fact = memoize(function(n){\n      for (var i = 2, fact = 1; i <= n; ++i) {\n          fact *= i;\n      }\n      return fact;\n  });\n\n  defineBuiltinFunction('fact', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), _fact);\n\n  defineBuiltinFunction('factdouble', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n) {\n      for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n          fact *= i;\n      }\n      return fact;\n  });\n\n  defineBuiltinFunction('multinomial', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0;\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var div = 1, sum = 0;\n      numbers.forEach(function (n) {\n          if (n < 0) {\n              throw new CalcError('NUM');\n          }\n          sum += n;\n          div *= _fact(n);\n      });\n      return _fact(sum) / div;\n  });\n\n  var _combinations = memoize(function(n, k){\n      for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n          p1 *= f1;\n          p2 *= f2;\n      }\n      return p1/p2;\n  });\n\n  defineBuiltinFunction('combin', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          {\n              var $k = args[i++];\n              if ($k instanceof CalcError)\n                  return $k;\n              if (!((typeof ($k = this.force($k)) == 'number' || (typeof $k == 'boolean' ? ($k = +$k, true) : false) || (typeof $k == 'string' && !/^(?:=|true|false)/i.test($k) ? (tmp = calc.parse(0, 0, 0, $k), /^date|number|percent$/.test(tmp.type) ? ($k = +tmp.value, true) : false) : false)) && ($k |= 0, true) && ($k >= 0 && $k <= $n ? true : (err = 'NUM', false)))) {\n                  if ($k instanceof CalcError)\n                      return $k;\n                  return new CalcError(err);\n              }\n              xargs.push($k);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $k = this._arrayArg(args[i]);\n          if ($k) {\n              xargs.push($k);\n              width = Math.max(width, $k.width);\n              height = Math.max(height, $k.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), _combinations);\n\n  defineBuiltinFunction('combina', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          {\n              var $k = args[i++];\n              if ($k instanceof CalcError)\n                  return $k;\n              if (!((typeof ($k = this.force($k)) == 'number' || (typeof $k == 'boolean' ? ($k = +$k, true) : false) || (typeof $k == 'string' && !/^(?:=|true|false)/i.test($k) ? (tmp = calc.parse(0, 0, 0, $k), /^date|number|percent$/.test(tmp.type) ? ($k = +tmp.value, true) : false) : false)) && ($k |= 0, true) && ($k >= 1 && $k <= $n ? true : (err = 'NUM', false)))) {\n                  if ($k instanceof CalcError)\n                      return $k;\n                  return new CalcError(err);\n              }\n              xargs.push($k);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $n = this._arrayArg(args[i]);\n          if ($n) {\n              xargs.push($n);\n              width = Math.max(width, $n.width);\n              height = Math.max(height, $n.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $k = this._arrayArg(args[i]);\n          if ($k) {\n              xargs.push($k);\n              width = Math.max(width, $k.width);\n              height = Math.max(height, $k.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (n, k) {\n      return _combinations(n + k - 1, n - 1);\n  });\n\n  /* -----[ Statistical functions ]----- */\n\n  defineBuiltinFunction('average', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if (typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false)\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length > 0 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var sum = numbers.reduce(function (sum, num) {\n          return sum + num;\n      }, 0);\n      return sum / numbers.length;\n  });\n\n  defineBuiltinFunction('averagea', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                      if ($values instanceof CalcError)\n                          throw $values;\n                      if ($values != null && i <= args.length)\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (values) {\n      var sum = 0, count = 0;\n      values.forEach(function (num) {\n          if (typeof num != 'string') {\n              sum += num;\n          }\n          ++count;\n      });\n      return count ? sum / count : new CalcError('DIV/0');\n  });\n\n  function _percentile(numbers, rank) {\n      numbers.sort(ascending);\n      var n = numbers.length;\n      var k = rank | 0, d = rank - k;\n      if (k === 0) {\n          return numbers[0];\n      }\n      if (k >= n) {\n          return numbers[n - 1];\n      }\n      --k;\n      return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n  }\n\n  function _percentile_inc(numbers, p){\n      // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n      var rank = p * (numbers.length - 1) + 1;\n      return _percentile(numbers, rank);\n  }\n\n  function _percentile_exc(numbers, p){\n      // https://en.wikipedia.org/wiki/Percentile#NIST_method\n      var rank = p * (numbers.length + 1);\n      return _percentile(numbers, rank);\n  }\n\n  defineBuiltinFunction('percentile.inc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), _percentile_inc);\n\n  defineBuiltinFunction('percentile.exc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p > 0 && $p < 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), _percentile_exc);\n\n  defineBuiltinFunction('quartile.inc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $quarter = args[i++];\n              if ($quarter instanceof CalcError)\n                  return $quarter;\n              if (!(($quarter = this.force($quarter)) === 0 || $quarter === 1 || $quarter === 2 || $quarter === 3 || $quarter === 4)) {\n                  if ($quarter instanceof CalcError)\n                      return $quarter;\n                  return new CalcError(err);\n              }\n              xargs.push($quarter);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers, quarter) {\n      return _percentile_inc(numbers, quarter / 4);\n  });\n\n  defineBuiltinFunction('quartile.exc', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $quarter = args[i++];\n              if ($quarter instanceof CalcError)\n                  return $quarter;\n              if (!(($quarter = this.force($quarter)) === 0 || $quarter === 1 || $quarter === 2 || $quarter === 3 || $quarter === 4)) {\n                  if ($quarter instanceof CalcError)\n                      return $quarter;\n                  return new CalcError(err);\n              }\n              xargs.push($quarter);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers, quarter) {\n      return _percentile_exc(numbers, quarter / 4);\n  });\n\n  calc.runtime.defineAlias(\"quartile\", \"quartile.inc\");\n  calc.runtime.defineAlias(\"percentile\", \"percentile.inc\");\n\n  var AGGREGATE_FUNCS = [\n      \"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\",\n      \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\",\n      \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\",\n      \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"\n  ];\n\n  function fetchValuesForAggregate(self, args, options) {\n      var values = [];\n      var opt_ignore_hidden_rows = 1;\n      var opt_ignore_errors = 2;\n      var opt_use_aggregates = 4;\n      (function fetchValues(args) {\n          if (args instanceof Ref) {\n              self.getRefCells(args, true).forEach(function(cell){\n                  var value = cell.value;\n                  if ((options & opt_ignore_hidden_rows) && cell.hidden) {\n                      return;\n                  }\n                  if (cell.formula) {\n                      // XXX: formula.print is fast, but still, can't we do any better here?\n                      //      perhaps access the input string directly somehow?\n                      var str = cell.formula.print(cell.row, cell.col);\n                      if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                          if (!(options & opt_use_aggregates)) {\n                              return;\n                          }\n                      }\n                  }\n                  if ((options & opt_ignore_errors) && value instanceof CalcError) {\n                      return;\n                  }\n                  if (typeof value == \"number\" || value instanceof CalcError) {\n                      values.push(value);\n                  }\n              });\n          } else if (Array.isArray(args)) {\n              for (var i = 0; i < args.length; ++i) {\n                  fetchValues(args[i]);\n              }\n          } else if (args instanceof Matrix) {\n              args.each(fetchValues);\n          } else if (typeof args == \"number\") {\n              values.push(args);\n          } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n              values.push(args);\n          }\n      })(args);\n      return values;\n  }\n\n  // AGGREGATE function\n  //\n  // https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n  //\n  // we can only partially type-check this function.  also, we need to use the async version in\n  // order to resolve references and delegate values to the function to aggregate.\n  defineBuiltinFunction('aggregate', true, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $funcId = args[i++];\n              if ($funcId instanceof CalcError)\n                  return $funcId;\n              if (!(($funcId = this.force($funcId)) === 1 || $funcId === 2 || $funcId === 3 || $funcId === 4 || $funcId === 5 || $funcId === 6 || $funcId === 7 || $funcId === 8 || $funcId === 9 || $funcId === 10 || $funcId === 11 || $funcId === 12 || $funcId === 13 || $funcId === 14 || $funcId === 15 || $funcId === 16 || $funcId === 17 || $funcId === 18 || $funcId === 19)) {\n                  if ($funcId instanceof CalcError)\n                      return $funcId;\n                  return new CalcError(err);\n              }\n              xargs.push($funcId);\n          }\n          {\n              var $options = args[i++];\n              if ($options instanceof CalcError)\n                  return $options;\n              if (!((($options = this.force($options)) == null ? ($options = 0, true) : false) || ($options === 0 || $options === 1 || $options === 2 || $options === 3 || $options === 4 || $options === 5 || $options === 6 || $options === 7))) {\n                  if ($options instanceof CalcError)\n                      return $options;\n                  return new CalcError(err);\n              }\n              xargs.push($options);\n          }\n          {\n              xargs.push(args.slice(i));\n              i = args.length;\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (callback, funcId, options, args) {\n      var self = this;\n      self.resolveCells(args, function () {\n          var values;\n          if (funcId > 12) {\n              values = fetchValuesForAggregate(self, args[0], options);\n              var k = args[1];\n              if (k instanceof CellRef) {\n                  k = self.getRefData(k);\n              }\n              if (typeof k != 'number') {\n                  return callback(new CalcError('VALUE'));\n              }\n          } else {\n              values = fetchValuesForAggregate(self, args, options);\n          }\n          self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n      });\n  });\n\n  defineBuiltinFunction('subtotal', true, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $funcId = args[i++];\n              if ($funcId instanceof CalcError)\n                  return $funcId;\n              if (!(($funcId = this.force($funcId)) === 1 || $funcId === 2 || $funcId === 3 || $funcId === 4 || $funcId === 5 || $funcId === 6 || $funcId === 7 || $funcId === 8 || $funcId === 9 || $funcId === 10 || $funcId === 11 || $funcId === 101 || $funcId === 102 || $funcId === 103 || $funcId === 104 || $funcId === 105 || $funcId === 106 || $funcId === 107 || $funcId === 108 || $funcId === 109 || $funcId === 110 || $funcId === 111)) {\n                  if ($funcId instanceof CalcError)\n                      return $funcId;\n                  return new CalcError(err);\n              }\n              xargs.push($funcId);\n          }\n          {\n              if (i >= args.length)\n                  return new CalcError('N/A');\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              do {\n                  {\n                      var $ref = args[i++];\n                      if ($ref instanceof CalcError)\n                          return $ref;\n                      if (!($ref instanceof Ref || ((m = this.asMatrix($ref)) ? $ref = m : false))) {\n                          return new CalcError(err);\n                      }\n                      xargs.push($ref);\n                  }\n              } while (i < args.length);\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          while (i < args.length) {\n              i++;\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (callback, funcId) {\n      var self = this;\n      var ignoreHidden = funcId > 100;\n      if (ignoreHidden) {\n          funcId -= 100;\n      }\n      var args = [];\n      for (var i = 2; i < arguments.length; ++i) {\n          args.push(arguments[i]);\n      }\n      self.resolveCells(args, function () {\n          var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n          self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n      });\n  });\n\n  // https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\n  defineBuiltinFunction('avedev', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $numbers = this.cellValues(args.slice(i)).reduce(function (ret, $numbers) {\n                      if ($numbers instanceof CalcError)\n                          throw $numbers;\n                      if ((typeof $numbers == 'number' ? ($numbers = limitPrecision($numbers), true) : false) || (typeof $numbers == 'boolean' ? ($numbers = +$numbers, true) : false) || (typeof $numbers == 'string' && !/^(?:=|true|false)/i.test($numbers) ? (tmp = calc.parse(0, 0, 0, $numbers), /^date|number|percent$/.test(tmp.type) ? ($numbers = +tmp.value, true) : false) : false))\n                          ret.push($numbers);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($numbers);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($numbers.length >= 2 ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (numbers) {\n      var avg = numbers.reduce(function (sum, num) {\n          return sum + num;\n      }, 0) / numbers.length;\n      return numbers.reduce(function (sum, num) {\n          return sum + Math.abs(num - avg);\n      }, 0) / numbers.length;\n  });\n\n  function _binom_dist(x, n, p, cumulative) {\n      if (!cumulative) {\n          return _combinations(n, x) * Math.pow(p, x) * Math.pow(1-p, n-x);\n      } else {\n          var sum = 0;\n          for (var j = 0; j <= x; ++j) {\n              sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1-p, n-j);\n          }\n          return sum;\n      }\n  }\n\n  defineBuiltinFunction('binom.dist', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $successes = args[i++];\n              if ($successes instanceof CalcError)\n                  return $successes;\n              if (!((typeof ($successes = this.force($successes)) == 'number' || (typeof $successes == 'boolean' ? ($successes = +$successes, true) : false) || (typeof $successes == 'string' && !/^(?:=|true|false)/i.test($successes) ? (tmp = calc.parse(0, 0, 0, $successes), /^date|number|percent$/.test(tmp.type) ? ($successes = +tmp.value, true) : false) : false)) && (($successes |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($successes instanceof CalcError)\n                      return $successes;\n                  return new CalcError(err);\n              }\n              xargs.push($successes);\n          }\n          {\n              var $trials = args[i++];\n              if ($trials instanceof CalcError)\n                  return $trials;\n              if (!((typeof ($trials = this.force($trials)) == 'number' || (typeof $trials == 'boolean' ? ($trials = +$trials, true) : false) || (typeof $trials == 'string' && !/^(?:=|true|false)/i.test($trials) ? (tmp = calc.parse(0, 0, 0, $trials), /^date|number|percent$/.test(tmp.type) ? ($trials = +tmp.value, true) : false) : false)) && ($trials |= 0, true) && ($trials >= $successes ? true : (err = 'N/A', false)))) {\n                  if ($trials instanceof CalcError)\n                      return $trials;\n                  return new CalcError(err);\n              }\n              xargs.push($trials);\n          }\n          {\n              var $probability = args[i++];\n              if ($probability instanceof CalcError)\n                  return $probability;\n              if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability >= 0 && $probability <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($probability instanceof CalcError)\n                      return $probability;\n                  return new CalcError(err);\n              }\n              xargs.push($probability);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), _binom_dist);\n\n  calc.runtime.defineAlias(\"binomdist\", \"binom.dist\");\n\n  defineBuiltinFunction('binom.inv', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $trials = args[i++];\n              if ($trials instanceof CalcError)\n                  return $trials;\n              if (!((typeof ($trials = this.force($trials)) == 'number' || (typeof $trials == 'boolean' ? ($trials = +$trials, true) : false) || (typeof $trials == 'string' && !/^(?:=|true|false)/i.test($trials) ? (tmp = calc.parse(0, 0, 0, $trials), /^date|number|percent$/.test(tmp.type) ? ($trials = +tmp.value, true) : false) : false)) && (($trials |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($trials instanceof CalcError)\n                      return $trials;\n                  return new CalcError(err);\n              }\n              xargs.push($trials);\n          }\n          {\n              var $probability = args[i++];\n              if ($probability instanceof CalcError)\n                  return $probability;\n              if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability >= 0 && $probability <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($probability instanceof CalcError)\n                      return $probability;\n                  return new CalcError(err);\n              }\n              xargs.push($probability);\n          }\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha >= 0 && $alpha <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (n, p, alpha) {\n      for (var x = 0; x <= n; ++x) {\n          if (_binom_dist(x, n, p, true) >= alpha) {\n              return x;\n          }\n      }\n      return new CalcError('N/A');\n  });\n\n  calc.runtime.defineAlias(\"critbinom\", \"binom.inv\");\n\n  defineBuiltinFunction('binom.dist.range', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $trials = args[i++];\n              if ($trials instanceof CalcError)\n                  return $trials;\n              if (!((typeof ($trials = this.force($trials)) == 'number' || (typeof $trials == 'boolean' ? ($trials = +$trials, true) : false) || (typeof $trials == 'string' && !/^(?:=|true|false)/i.test($trials) ? (tmp = calc.parse(0, 0, 0, $trials), /^date|number|percent$/.test(tmp.type) ? ($trials = +tmp.value, true) : false) : false)) && (($trials |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($trials instanceof CalcError)\n                      return $trials;\n                  return new CalcError(err);\n              }\n              xargs.push($trials);\n          }\n          {\n              var $probability = args[i++];\n              if ($probability instanceof CalcError)\n                  return $probability;\n              if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability >= 0 && $probability <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($probability instanceof CalcError)\n                      return $probability;\n                  return new CalcError(err);\n              }\n              xargs.push($probability);\n          }\n          {\n              var $successes_min = args[i++];\n              if ($successes_min instanceof CalcError)\n                  return $successes_min;\n              if (!((typeof ($successes_min = this.force($successes_min)) == 'number' || (typeof $successes_min == 'boolean' ? ($successes_min = +$successes_min, true) : false) || (typeof $successes_min == 'string' && !/^(?:=|true|false)/i.test($successes_min) ? (tmp = calc.parse(0, 0, 0, $successes_min), /^date|number|percent$/.test(tmp.type) ? ($successes_min = +tmp.value, true) : false) : false)) && ($successes_min |= 0, true) && ($successes_min >= 0 && $successes_min <= $trials ? true : (err = 'NUM', false)))) {\n                  if ($successes_min instanceof CalcError)\n                      return $successes_min;\n                  return new CalcError(err);\n              }\n              xargs.push($successes_min);\n          }\n          {\n              var $successes_max = args[i++];\n              if ($successes_max instanceof CalcError)\n                  return $successes_max;\n              if (!((typeof ($successes_max = this.force($successes_max)) == 'number' || (typeof $successes_max == 'boolean' ? ($successes_max = +$successes_max, true) : false) || (typeof $successes_max == 'string' && !/^(?:=|true|false)/i.test($successes_max) ? (tmp = calc.parse(0, 0, 0, $successes_max), /^date|number|percent$/.test(tmp.type) ? ($successes_max = +tmp.value, true) : false) : false)) && ($successes_max |= 0, true) && ($successes_max >= $successes_min && $successes_max <= $trials ? true : (err = 'NUM', false)) || ($successes_max == null ? ($successes_max = $successes_min, true) : false))) {\n                  if ($successes_max instanceof CalcError)\n                      return $successes_max;\n                  return new CalcError(err);\n              }\n              xargs.push($successes_max);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (n, p, s, s2) {\n      var sum = 0;\n      for (var k = s; k <= s2; ++k) {\n          sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n      }\n      return sum;\n  });\n\n  defineBuiltinFunction('negbinom.dist', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number_f = args[i++];\n              if ($number_f instanceof CalcError)\n                  return $number_f;\n              if (!((typeof ($number_f = this.force($number_f)) == 'number' || (typeof $number_f == 'boolean' ? ($number_f = +$number_f, true) : false) || (typeof $number_f == 'string' && !/^(?:=|true|false)/i.test($number_f) ? (tmp = calc.parse(0, 0, 0, $number_f), /^date|number|percent$/.test(tmp.type) ? ($number_f = +tmp.value, true) : false) : false)) && (($number_f |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($number_f instanceof CalcError)\n                      return $number_f;\n                  return new CalcError(err);\n              }\n              xargs.push($number_f);\n          }\n          {\n              var $number_s = args[i++];\n              if ($number_s instanceof CalcError)\n                  return $number_s;\n              if (!((typeof ($number_s = this.force($number_s)) == 'number' || (typeof $number_s == 'boolean' ? ($number_s = +$number_s, true) : false) || (typeof $number_s == 'string' && !/^(?:=|true|false)/i.test($number_s) ? (tmp = calc.parse(0, 0, 0, $number_s), /^date|number|percent$/.test(tmp.type) ? ($number_s = +tmp.value, true) : false) : false)) && (($number_s |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($number_s instanceof CalcError)\n                      return $number_s;\n                  return new CalcError(err);\n              }\n              xargs.push($number_s);\n          }\n          {\n              var $probability_s = args[i++];\n              if ($probability_s instanceof CalcError)\n                  return $probability_s;\n              if (!(((typeof ($probability_s = this.force($probability_s)) == 'number' ? ($probability_s = limitPrecision($probability_s), true) : false) || (typeof $probability_s == 'boolean' ? ($probability_s = +$probability_s, true) : false) || (typeof $probability_s == 'string' && !/^(?:=|true|false)/i.test($probability_s) ? (tmp = calc.parse(0, 0, 0, $probability_s), /^date|number|percent$/.test(tmp.type) ? ($probability_s = +tmp.value, true) : false) : false)) && ($probability_s >= 0 && $probability_s <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($probability_s instanceof CalcError)\n                      return $probability_s;\n                  return new CalcError(err);\n              }\n              xargs.push($probability_s);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (x, k, p, cumulative) {\n      if (cumulative) {\n          var sum = 0;\n          while (x >= 0) {\n              sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n              x--;\n          }\n          return sum;\n      }\n      return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n  });\n\n  calc.runtime.defineAlias(\"negbinomdist\", \"negbinom.dist\");\n\n  /* -----[ lookup functions ]----- */\n\n  defineBuiltinFunction('address', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $row = args[i++];\n              if ($row instanceof CalcError)\n                  return $row;\n              if (!((typeof ($row = this.force($row)) == 'number' || (typeof $row == 'boolean' ? ($row = +$row, true) : false) || (typeof $row == 'string' && !/^(?:=|true|false)/i.test($row) ? (tmp = calc.parse(0, 0, 0, $row), /^date|number|percent$/.test(tmp.type) ? ($row = +tmp.value, true) : false) : false)) && (($row |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($row instanceof CalcError)\n                      return $row;\n                  return new CalcError(err);\n              }\n              xargs.push($row);\n          }\n          {\n              var $col = args[i++];\n              if ($col instanceof CalcError)\n                  return $col;\n              if (!((typeof ($col = this.force($col)) == 'number' || (typeof $col == 'boolean' ? ($col = +$col, true) : false) || (typeof $col == 'string' && !/^(?:=|true|false)/i.test($col) ? (tmp = calc.parse(0, 0, 0, $col), /^date|number|percent$/.test(tmp.type) ? ($col = +tmp.value, true) : false) : false)) && (($col |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($col instanceof CalcError)\n                      return $col;\n                  return new CalcError(err);\n              }\n              xargs.push($col);\n          }\n          {\n              var $abs = args[i++];\n              if ($abs instanceof CalcError)\n                  return $abs;\n              if (!((($abs = this.force($abs)) == null ? ($abs = 1, true) : false) || ($abs === 1 || $abs === 2 || $abs === 3 || $abs === 4))) {\n                  if ($abs instanceof CalcError)\n                      return $abs;\n                  return new CalcError(err);\n              }\n              xargs.push($abs);\n          }\n          {\n              var $a1 = args[i++];\n              if ($a1 instanceof CalcError)\n                  return $a1;\n              if (!((($a1 = this.force($a1)) == null ? ($a1 = true, true) : false) || (typeof $a1 == 'boolean' || (typeof $a1 == 'number' ? ($a1 = !!$a1, true) : false)))) {\n                  if ($a1 instanceof CalcError)\n                      return $a1;\n                  return new CalcError(err);\n              }\n              xargs.push($a1);\n          }\n          {\n              var $sheet = args[i++];\n              if ($sheet instanceof CalcError)\n                  return $sheet;\n              if (!(($sheet = this.force($sheet)) == null || (typeof $sheet == 'string' || typeof $sheet == 'boolean' || typeof $sheet == 'number' ? ($sheet += '', true) : $sheet === undefined ? ($sheet = '', true) : false))) {\n                  if ($sheet instanceof CalcError)\n                      return $sheet;\n                  return new CalcError(err);\n              }\n              xargs.push($sheet);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (row, col, abs, a1, sheet) {\n      var cell = new CellRef(row - 1, col - 1, abs - 1);\n      if (sheet) {\n          cell.setSheet(sheet, true);\n      }\n      return a1 ? cell.print(0, 0) : cell.print();\n  });\n\n  defineBuiltinFunction('areas', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof Ref)) {\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (ref) {\n      var count = 0;\n      (function loop(x) {\n          if (x instanceof CellRef || x instanceof RangeRef) {\n              count++;\n          } else if (x instanceof UnionRef) {\n              x.refs.forEach(loop);\n          }\n      }(ref));\n      return count;\n  });\n\n  defineBuiltinFunction('choose', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $index = args[i++];\n              if ($index instanceof CalcError)\n                  return $index;\n              if (!((typeof ($index = this.force($index)) == 'number' || (typeof $index == 'boolean' ? ($index = +$index, true) : false) || (typeof $index == 'string' && !/^(?:=|true|false)/i.test($index) ? (tmp = calc.parse(0, 0, 0, $index), /^date|number|percent$/.test(tmp.type) ? ($index = +tmp.value, true) : false) : false)) && ($index |= 0, true))) {\n                  if ($index instanceof CalcError)\n                      return $index;\n                  return new CalcError(err);\n              }\n              xargs.push($index);\n          }\n          {\n              if (i >= args.length)\n                  return new CalcError('N/A');\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              do {\n                  {\n                      var $value = args[i++];\n                      if ($value instanceof CalcError)\n                          return $value;\n                      if (!(i <= args.length)) {\n                          return new CalcError(err);\n                      }\n                      xargs.push($value);\n                  }\n              } while (i < args.length);\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          while (i < args.length) {\n              i++;\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $index = this._arrayArg(args[i]);\n          if ($index) {\n              xargs.push($index);\n              width = Math.max(width, $index.width);\n              height = Math.max(height, $index.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          while (i < args.length) {\n              xargs.push(args[i++]);\n              arrays.push(false);\n          }\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (index, args) {\n      if (index > args.length) {\n          return new CalcError('N/A');\n      } else {\n          return args[index - 1];\n      }\n  });\n\n  defineBuiltinFunction('column', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof CellRef || $ref instanceof RangeRef || ($ref = this.force($ref)) == null)) {\n                  if ($ref instanceof CalcError)\n                      return $ref;\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (ref) {\n      if (!ref) {\n          return this.formula.col + 1;\n      }\n      if (ref instanceof CellRef) {\n          return ref.col + 1;\n      }\n      return this.asMatrix(ref).mapCol(function (col) {\n          return col + ref.topLeft.col + 1;\n      });\n  });\n\n  defineBuiltinFunction('columns', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof CellRef || $ref instanceof RangeRef || ((m = this.asMatrix($ref)) ? $ref = m : false))) {\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (m) {\n      return m instanceof Ref ? m.width() : m.width;\n  });\n\n  defineBuiltinFunction('formulatext', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof Ref)) {\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (ref) {\n      var cell = this.getRefCells(ref)[0];\n      if (!cell.formula) {\n          return new CalcError('N/A');\n      }\n      return cell.formula.print(cell.row, cell.col);\n  });\n\n  defineBuiltinFunction('hlookup', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $row = args[i++];\n              if ($row instanceof CalcError)\n                  return $row;\n              if (!((typeof ($row = this.force($row)) == 'number' || (typeof $row == 'boolean' ? ($row = +$row, true) : false) || (typeof $row == 'string' && !/^(?:=|true|false)/i.test($row) ? (tmp = calc.parse(0, 0, 0, $row), /^date|number|percent$/.test(tmp.type) ? ($row = +tmp.value, true) : false) : false)) && (($row |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($row instanceof CalcError)\n                      return $row;\n                  return new CalcError(err);\n              }\n              xargs.push($row);\n          }\n          {\n              var $approx = args[i++];\n              if ($approx instanceof CalcError)\n                  return $approx;\n              if (!(typeof ($approx = this.force($approx)) == 'boolean' || (typeof $approx == 'number' ? ($approx = !!$approx, true) : false) || ($approx == null ? ($approx = true, true) : false))) {\n                  if ($approx instanceof CalcError)\n                      return $approx;\n                  return new CalcError(err);\n              }\n              xargs.push($approx);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (value, m, row, approx) {\n      var resultCol = null;\n      m.eachCol(function (col) {\n          var data = m.get(0, col);\n          if (approx) {\n              if (data > value) {\n                  return true;\n              }\n              resultCol = col;\n          } else if (data === value) {\n              resultCol = col;\n              return true;\n          }\n      });\n      if (resultCol == null) {\n          return new CalcError('N/A');\n      }\n      return m.get(row - 1, resultCol);\n  });\n\n  defineBuiltinFunction('index', true, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!($range instanceof Ref || ((m = this.asMatrix($range)) ? $range = m : false))) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $row = args[i++];\n              if ($row instanceof CalcError)\n                  return $row;\n              if (!((typeof ($row = this.force($row)) == 'number' || (typeof $row == 'boolean' ? ($row = +$row, true) : false) || (typeof $row == 'string' && !/^(?:=|true|false)/i.test($row) ? (tmp = calc.parse(0, 0, 0, $row), /^date|number|percent$/.test(tmp.type) ? ($row = +tmp.value, true) : false) : false)) && (($row |= 0) >= 0 ? true : (err = 'NUM', false)) || $row == null)) {\n                  if ($row instanceof CalcError)\n                      return $row;\n                  return new CalcError(err);\n              }\n              xargs.push($row);\n          }\n          {\n              var $col = args[i++];\n              if ($col instanceof CalcError)\n                  return $col;\n              if (!((typeof ($col = this.force($col)) == 'number' || (typeof $col == 'boolean' ? ($col = +$col, true) : false) || (typeof $col == 'string' && !/^(?:=|true|false)/i.test($col) ? (tmp = calc.parse(0, 0, 0, $col), /^date|number|percent$/.test(tmp.type) ? ($col = +tmp.value, true) : false) : false)) && (($col |= 0) >= 0 ? true : (err = 'NUM', false)) || $col == null)) {\n                  if ($col instanceof CalcError)\n                      return $col;\n                  return new CalcError(err);\n              }\n              xargs.push($col);\n          }\n          {\n              var $areanum = args[i++];\n              if ($areanum instanceof CalcError)\n                  return $areanum;\n              if (!((typeof ($areanum = this.force($areanum)) == 'number' || (typeof $areanum == 'boolean' ? ($areanum = +$areanum, true) : false) || (typeof $areanum == 'string' && !/^(?:=|true|false)/i.test($areanum) ? (tmp = calc.parse(0, 0, 0, $areanum), /^date|number|percent$/.test(tmp.type) ? ($areanum = +tmp.value, true) : false) : false)) && (($areanum |= 0) > 0 ? true : (err = 'NUM', false)) || ($areanum == null ? ($areanum = 1, true) : false))) {\n                  if ($areanum instanceof CalcError)\n                      return $areanum;\n                  return new CalcError(err);\n              }\n              xargs.push($areanum);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (callback, ref, row, col, areanum) {\n      var self = this;\n      if (ref instanceof UnionRef) {\n          ref = ref.refs[areanum - 1];\n      }\n      if (!row && !col || !ref) {\n          return callback(new CalcError('N/A'));\n      }\n      if (ref instanceof CellRef) {\n          ref = ref.toRangeRef();\n      }\n      if (ref instanceof RangeRef) {\n          if (row && col) {\n              if (col > ref.width() || row > ref.height()) {\n                  return callback(new CalcError('REF'));\n              }\n              var cell = ref.toCell(row - 1, col - 1);\n              self.resolveCells([cell], function () {\n                  callback(self.getRefData(cell));\n              });\n              return;\n          }\n          if (!row) {\n              var colRange = ref.toColumn(col - 1);\n              self.resolveCells([colRange], function () {\n                  callback(self.asMatrix(colRange));\n              });\n              return;\n          }\n          if (!col) {\n              var rowRange = ref.toRow(row - 1);\n              self.resolveCells([rowRange], function () {\n                  callback(self.asMatrix(rowRange));\n              });\n              return;\n          }\n      } else if (ref instanceof Matrix) {\n          if (ref.width > 1 && ref.height > 1) {\n              if (row && col) {\n                  return callback(ref.get(row - 1, col - 1));\n              }\n              if (!row) {\n                  return callback(ref.mapRow(function (row) {\n                      return ref.get(row, col - 1);\n                  }));\n              }\n              if (!col) {\n                  return callback(ref.mapCol(function (col) {\n                      return ref.get(row - 1, col);\n                  }));\n              }\n          }\n          if (ref.width == 1) {\n              return callback(ref.get((row || 1) - 1, 0));\n          }\n          if (ref.height == 1) {\n              return callback(ref.get(0, (col || 1) - 1));\n          }\n      } else {\n          callback(new CalcError('REF'));\n      }\n  });\n\n  defineBuiltinFunction('indirect', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $thing = args[i++];\n              if ($thing instanceof CalcError)\n                  return $thing;\n              if (!(typeof ($thing = this.force($thing)) == 'string' || typeof $thing == 'boolean' || typeof $thing == 'number' ? ($thing += '', true) : $thing === undefined ? ($thing = '', true) : false)) {\n                  if ($thing instanceof CalcError)\n                      return $thing;\n                  return new CalcError(err);\n              }\n              xargs.push($thing);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (thing) {\n      try {\n          var f = this.formula;\n          var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n          var ref = exp.ast;\n          if (ref instanceof NameRef) {\n              ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n          }\n          if (!(ref instanceof Ref)) {\n              throw 1;\n          }\n          return ref.absolute(f.row, f.col);\n      } catch (ex) {\n          return new CalcError('REF');\n      }\n  });\n\n  // XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n\n  // XXX: double-check this one.\n  defineBuiltinFunction('match', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === -1 || $type === 0 || $type === 1 || ($type == null ? ($type = 1, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (val, m, type) {\n      var index = 1, cmp;\n      if (type === 0) {\n          cmp = parseCriteria(val);\n      } else if (type === -1) {\n          cmp = parseCriteria('<=' + val);\n      } else if (type === 1) {\n          cmp = parseCriteria('>=' + val);\n      }\n      if (m.each(function (el) {\n              if (el != null && cmp(el)) {\n                  if (type !== 0 && val != el) {\n                      --index;\n                  }\n                  return true;\n              }\n              index++;\n          }, true) && index > 0) {\n          return index;\n      } else {\n          return new CalcError('N/A');\n      }\n  });\n\n  defineBuiltinFunction('offset', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof CellRef || $ref instanceof RangeRef)) {\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          {\n              var $rows = args[i++];\n              if ($rows instanceof CalcError)\n                  return $rows;\n              if (!((typeof ($rows = this.force($rows)) == 'number' || (typeof $rows == 'boolean' ? ($rows = +$rows, true) : false) || (typeof $rows == 'string' && !/^(?:=|true|false)/i.test($rows) ? (tmp = calc.parse(0, 0, 0, $rows), /^date|number|percent$/.test(tmp.type) ? ($rows = +tmp.value, true) : false) : false)) && ($rows |= 0, true))) {\n                  if ($rows instanceof CalcError)\n                      return $rows;\n                  return new CalcError(err);\n              }\n              xargs.push($rows);\n          }\n          {\n              var $cols = args[i++];\n              if ($cols instanceof CalcError)\n                  return $cols;\n              if (!((typeof ($cols = this.force($cols)) == 'number' || (typeof $cols == 'boolean' ? ($cols = +$cols, true) : false) || (typeof $cols == 'string' && !/^(?:=|true|false)/i.test($cols) ? (tmp = calc.parse(0, 0, 0, $cols), /^date|number|percent$/.test(tmp.type) ? ($cols = +tmp.value, true) : false) : false)) && ($cols |= 0, true))) {\n                  if ($cols instanceof CalcError)\n                      return $cols;\n                  return new CalcError(err);\n              }\n              xargs.push($cols);\n          }\n          {\n              var $height = args[i++];\n              if ($height instanceof CalcError)\n                  return $height;\n              if (!((typeof ($height = this.force($height)) == 'number' || (typeof $height == 'boolean' ? ($height = +$height, true) : false) || (typeof $height == 'string' && !/^(?:=|true|false)/i.test($height) ? (tmp = calc.parse(0, 0, 0, $height), /^date|number|percent$/.test(tmp.type) ? ($height = +tmp.value, true) : false) : false)) && (($height |= 0) > 0 ? true : (err = 'NUM', false)) || ($height == null ? ($height = $ref.height(), true) : false))) {\n                  if ($height instanceof CalcError)\n                      return $height;\n                  return new CalcError(err);\n              }\n              xargs.push($height);\n          }\n          {\n              var $width = args[i++];\n              if ($width instanceof CalcError)\n                  return $width;\n              if (!((typeof ($width = this.force($width)) == 'number' || (typeof $width == 'boolean' ? ($width = +$width, true) : false) || (typeof $width == 'string' && !/^(?:=|true|false)/i.test($width) ? (tmp = calc.parse(0, 0, 0, $width), /^date|number|percent$/.test(tmp.type) ? ($width = +tmp.value, true) : false) : false)) && (($width |= 0) > 0 ? true : (err = 'NUM', false)) || ($width == null ? ($width = $ref.width(), true) : false))) {\n                  if ($width instanceof CalcError)\n                      return $width;\n                  return new CalcError(err);\n              }\n              xargs.push($width);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          i++;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          xargs.push(args[i++]);\n          arrays.push(false);\n          var $rows = this._arrayArg(args[i]);\n          if ($rows) {\n              xargs.push($rows);\n              width = Math.max(width, $rows.width);\n              height = Math.max(height, $rows.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $cols = this._arrayArg(args[i]);\n          if ($cols) {\n              xargs.push($cols);\n              width = Math.max(width, $cols.width);\n              height = Math.max(height, $cols.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $height = this._arrayArg(args[i]);\n          if ($height) {\n              xargs.push($height);\n              width = Math.max(width, $height.width);\n              height = Math.max(height, $height.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $width = this._arrayArg(args[i]);\n          if ($width) {\n              xargs.push($width);\n              width = Math.max(width, $width.width);\n              height = Math.max(height, $width.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (ref, rows, cols, height, width) {\n      var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n      topLeft.row += rows;\n      topLeft.col += cols;\n      if (topLeft.row < 0 || topLeft.col < 0) {\n          return new CalcError('VALUE');\n      }\n      if (height > 1 || width > 1) {\n          return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n      }\n      return topLeft;\n  });\n\n  defineBuiltinFunction('row', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof CellRef || $ref instanceof RangeRef || ($ref = this.force($ref)) == null)) {\n                  if ($ref instanceof CalcError)\n                      return $ref;\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (ref) {\n      if (!ref) {\n          return this.formula.row + 1;\n      }\n      if (ref instanceof CellRef) {\n          return ref.row + 1;\n      }\n      return this.asMatrix(ref).mapRow(function (row) {\n          return row + ref.topLeft.row + 1;\n      });\n  });\n\n  defineBuiltinFunction('rows', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $ref = args[i++];\n              if ($ref instanceof CalcError)\n                  return $ref;\n              if (!($ref instanceof CellRef || $ref instanceof RangeRef || ((m = this.asMatrix($ref)) ? $ref = m : false))) {\n                  return new CalcError(err);\n              }\n              xargs.push($ref);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function (m) {\n      return m instanceof Ref ? m.height() : m.height;\n  });\n\n  defineBuiltinFunction('vlookup', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          {\n              var $col = args[i++];\n              if ($col instanceof CalcError)\n                  return $col;\n              if (!((typeof ($col = this.force($col)) == 'number' || (typeof $col == 'boolean' ? ($col = +$col, true) : false) || (typeof $col == 'string' && !/^(?:=|true|false)/i.test($col) ? (tmp = calc.parse(0, 0, 0, $col), /^date|number|percent$/.test(tmp.type) ? ($col = +tmp.value, true) : false) : false)) && (($col |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($col instanceof CalcError)\n                      return $col;\n                  return new CalcError(err);\n              }\n              xargs.push($col);\n          }\n          {\n              var $approx = args[i++];\n              if ($approx instanceof CalcError)\n                  return $approx;\n              if (!(typeof ($approx = this.force($approx)) == 'boolean' || (typeof $approx == 'number' ? ($approx = !!$approx, true) : false) || ($approx == null ? ($approx = true, true) : false))) {\n                  if ($approx instanceof CalcError)\n                      return $approx;\n                  return new CalcError(err);\n              }\n              xargs.push($approx);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (value, m, col, approx) {\n      var resultRow = null;\n      if (typeof value != 'number') {\n          approx = false;\n      }\n      if (typeof value == 'string') {\n          value = value.toLowerCase();\n      }\n      m.eachRow(function (row) {\n          var data = m.get(row, 0);\n          if (approx) {\n              if (data > value) {\n                  return true;\n              }\n              resultRow = row;\n          } else {\n              if (typeof data == 'string') {\n                  data = data.toLowerCase();\n              }\n              if (data === value) {\n                  resultRow = row;\n                  return true;\n              }\n          }\n      });\n      if (resultRow == null) {\n          return new CalcError('N/A');\n      }\n      return m.get(resultRow, col - 1);\n  });\n\n  /* -----[ Date and time functions ]----- */\n\n  defineBuiltinFunction('date', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $year = args[i++];\n              if ($year instanceof CalcError)\n                  return $year;\n              if (!((typeof ($year = this.force($year)) == 'number' || (typeof $year == 'boolean' ? ($year = +$year, true) : false) || (typeof $year == 'string' && !/^(?:=|true|false)/i.test($year) ? (tmp = calc.parse(0, 0, 0, $year), /^date|number|percent$/.test(tmp.type) ? ($year = +tmp.value, true) : false) : false)) && ($year |= 0, true))) {\n                  if ($year instanceof CalcError)\n                      return $year;\n                  return new CalcError(err);\n              }\n              xargs.push($year);\n          }\n          {\n              var $month = args[i++];\n              if ($month instanceof CalcError)\n                  return $month;\n              if (!((typeof ($month = this.force($month)) == 'number' || (typeof $month == 'boolean' ? ($month = +$month, true) : false) || (typeof $month == 'string' && !/^(?:=|true|false)/i.test($month) ? (tmp = calc.parse(0, 0, 0, $month), /^date|number|percent$/.test(tmp.type) ? ($month = +tmp.value, true) : false) : false)) && ($month |= 0, true))) {\n                  if ($month instanceof CalcError)\n                      return $month;\n                  return new CalcError(err);\n              }\n              xargs.push($month);\n          }\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $year = this._arrayArg(args[i]);\n          if ($year) {\n              xargs.push($year);\n              width = Math.max(width, $year.width);\n              height = Math.max(height, $year.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $month = this._arrayArg(args[i]);\n          if ($month) {\n              xargs.push($month);\n              width = Math.max(width, $month.width);\n              height = Math.max(height, $month.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (year, month, date) {\n      return packDate$1(year, month - 1, date);\n  });\n\n  defineBuiltinFunction('day', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (date) {\n      return unpackDate$1(date).date;\n  });\n\n  defineBuiltinFunction('month', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (date) {\n      return unpackDate$1(date).month + 1;\n  });\n\n  defineBuiltinFunction('year', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (date) {\n      return unpackDate$1(date).year;\n  });\n\n  defineBuiltinFunction('weekday', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (date) {\n      return unpackDate$1(date).day + 1;\n  });\n\n  // https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n  // XXX: this is a mess.\n  defineBuiltinFunction('weeknum', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!((($type = this.force($type)) == null ? ($type = 1, true) : false) || ($type === 1 || $type === 2 || $type === 11 || $type === 12 || $type === 13 || $type === 14 || $type === 15 || $type === 16 || $type === 17 || $type === 21))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $type = this._arrayArg(args[i]);\n          if ($type) {\n              xargs.push($type);\n              width = Math.max(width, $type.width);\n              height = Math.max(height, $type.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (date, type) {\n      var fw = packDate$1(unpackDate$1(date).year, 0, 1);\n      var sy = unpackDate$1(fw);\n      var diff;\n      if (type == 21) {\n          diff = 3 - (sy.day + 6) % 7;\n          if (diff < 0) {\n              diff += 7;\n          }\n          fw += diff;\n          sy.date += diff;\n          sy.day = 4;\n          type = 1;\n      } else {\n          if (type == 1) {\n              type = 0;\n          } else if (type == 2) {\n              type = 1;\n          } else {\n              type = (type - 10) % 7;\n          }\n      }\n      diff = sy.day - type;\n      if (diff < 0) {\n          diff += 7;\n      }\n      fw -= diff;\n      return Math.ceil((date + 1 - fw) / 7);\n  });\n\n  function weeksInYear(year) {\n      var d = unpackDate$1(packDate$1(year, 0, 1));\n      if ((d.day == 4) || (d.day == 3 && calc.runtime.isLeapYear(year))) {\n          // long year\n          return 53;\n      }\n      return 52;\n  }\n\n  defineBuiltinFunction('isoweeknum', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $date = args[i++];\n              if ($date instanceof CalcError)\n                  return $date;\n              if (!((typeof ($date = this.force($date)) == 'number' || (typeof $date == 'boolean' ? ($date = +$date, true) : false) || (typeof $date == 'string' && !/^(?:=|true|false)/i.test($date) ? (tmp = calc.parse(0, 0, 0, $date), /^date|number|percent$/.test(tmp.type) ? ($date = +tmp.value, true) : false) : false)) && ($date |= 0, true))) {\n                  if ($date instanceof CalcError)\n                      return $date;\n                  return new CalcError(err);\n              }\n              xargs.push($date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $date = this._arrayArg(args[i]);\n          if ($date) {\n              xargs.push($date);\n              width = Math.max(width, $date.width);\n              height = Math.max(height, $date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function isoweeknum(date) {\n      var d = unpackDate$1(date);\n      var dow = d.day || 7;\n      var wk = Math.floor((d.ord - dow + 10) / 7);\n      if (wk < 1) {\n          return weeksInYear(d.year - 1);\n      } else if (wk == 53 && wk > weeksInYear(d.year)) {\n          return 1;\n      }\n      return wk;\n  });\n\n  defineBuiltinFunction('now', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return calc.runtime.dateToSerial(new Date());\n  });\n\n  defineBuiltinFunction('today', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return calc.runtime.dateToSerial(new Date()) | 0;\n  });\n\n  defineBuiltinFunction('time', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $hours = args[i++];\n              if ($hours instanceof CalcError)\n                  return $hours;\n              if (!((typeof ($hours = this.force($hours)) == 'number' || (typeof $hours == 'boolean' ? ($hours = +$hours, true) : false) || (typeof $hours == 'string' && !/^(?:=|true|false)/i.test($hours) ? (tmp = calc.parse(0, 0, 0, $hours), /^date|number|percent$/.test(tmp.type) ? ($hours = +tmp.value, true) : false) : false)) && ($hours |= 0, true))) {\n                  if ($hours instanceof CalcError)\n                      return $hours;\n                  return new CalcError(err);\n              }\n              xargs.push($hours);\n          }\n          {\n              var $minutes = args[i++];\n              if ($minutes instanceof CalcError)\n                  return $minutes;\n              if (!((typeof ($minutes = this.force($minutes)) == 'number' || (typeof $minutes == 'boolean' ? ($minutes = +$minutes, true) : false) || (typeof $minutes == 'string' && !/^(?:=|true|false)/i.test($minutes) ? (tmp = calc.parse(0, 0, 0, $minutes), /^date|number|percent$/.test(tmp.type) ? ($minutes = +tmp.value, true) : false) : false)) && ($minutes |= 0, true))) {\n                  if ($minutes instanceof CalcError)\n                      return $minutes;\n                  return new CalcError(err);\n              }\n              xargs.push($minutes);\n          }\n          {\n              var $seconds = args[i++];\n              if ($seconds instanceof CalcError)\n                  return $seconds;\n              if (!((typeof ($seconds = this.force($seconds)) == 'number' || (typeof $seconds == 'boolean' ? ($seconds = +$seconds, true) : false) || (typeof $seconds == 'string' && !/^(?:=|true|false)/i.test($seconds) ? (tmp = calc.parse(0, 0, 0, $seconds), /^date|number|percent$/.test(tmp.type) ? ($seconds = +tmp.value, true) : false) : false)) && ($seconds |= 0, true))) {\n                  if ($seconds instanceof CalcError)\n                      return $seconds;\n                  return new CalcError(err);\n              }\n              xargs.push($seconds);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $hours = this._arrayArg(args[i]);\n          if ($hours) {\n              xargs.push($hours);\n              width = Math.max(width, $hours.width);\n              height = Math.max(height, $hours.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $minutes = this._arrayArg(args[i]);\n          if ($minutes) {\n              xargs.push($minutes);\n              width = Math.max(width, $minutes.width);\n              height = Math.max(height, $minutes.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $seconds = this._arrayArg(args[i]);\n          if ($seconds) {\n              xargs.push($seconds);\n              width = Math.max(width, $seconds.width);\n              height = Math.max(height, $seconds.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (hh, mm, ss) {\n      return calc.runtime.packTime(hh, mm, ss, 0);\n  });\n\n  defineBuiltinFunction('hour', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $time = args[i++];\n              if ($time instanceof CalcError)\n                  return $time;\n              if (!((typeof ($time = this.force($time)) == 'number' ? ($time = limitPrecision($time), true) : false) || (typeof $time == 'boolean' ? ($time = +$time, true) : false) || (typeof $time == 'string' && !/^(?:=|true|false)/i.test($time) ? (tmp = calc.parse(0, 0, 0, $time), /^date|number|percent$/.test(tmp.type) ? ($time = +tmp.value, true) : false) : false))) {\n                  if ($time instanceof CalcError)\n                      return $time;\n                  return new CalcError(err);\n              }\n              xargs.push($time);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $time = this._arrayArg(args[i]);\n          if ($time) {\n              xargs.push($time);\n              width = Math.max(width, $time.width);\n              height = Math.max(height, $time.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (time) {\n      return calc.runtime.unpackTime(time).hours;\n  });\n\n  defineBuiltinFunction('minute', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $time = args[i++];\n              if ($time instanceof CalcError)\n                  return $time;\n              if (!((typeof ($time = this.force($time)) == 'number' ? ($time = limitPrecision($time), true) : false) || (typeof $time == 'boolean' ? ($time = +$time, true) : false) || (typeof $time == 'string' && !/^(?:=|true|false)/i.test($time) ? (tmp = calc.parse(0, 0, 0, $time), /^date|number|percent$/.test(tmp.type) ? ($time = +tmp.value, true) : false) : false))) {\n                  if ($time instanceof CalcError)\n                      return $time;\n                  return new CalcError(err);\n              }\n              xargs.push($time);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $time = this._arrayArg(args[i]);\n          if ($time) {\n              xargs.push($time);\n              width = Math.max(width, $time.width);\n              height = Math.max(height, $time.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (time) {\n      return calc.runtime.unpackTime(time).minutes;\n  });\n\n  defineBuiltinFunction('second', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $time = args[i++];\n              if ($time instanceof CalcError)\n                  return $time;\n              if (!((typeof ($time = this.force($time)) == 'number' ? ($time = limitPrecision($time), true) : false) || (typeof $time == 'boolean' ? ($time = +$time, true) : false) || (typeof $time == 'string' && !/^(?:=|true|false)/i.test($time) ? (tmp = calc.parse(0, 0, 0, $time), /^date|number|percent$/.test(tmp.type) ? ($time = +tmp.value, true) : false) : false))) {\n                  if ($time instanceof CalcError)\n                      return $time;\n                  return new CalcError(err);\n              }\n              xargs.push($time);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $time = this._arrayArg(args[i]);\n          if ($time) {\n              xargs.push($time);\n              width = Math.max(width, $time.width);\n              height = Math.max(height, $time.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (time) {\n      return calc.runtime.unpackTime(time).seconds;\n  });\n\n  defineBuiltinFunction('edate', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $months = args[i++];\n              if ($months instanceof CalcError)\n                  return $months;\n              if (!((typeof ($months = this.force($months)) == 'number' || (typeof $months == 'boolean' ? ($months = +$months, true) : false) || (typeof $months == 'string' && !/^(?:=|true|false)/i.test($months) ? (tmp = calc.parse(0, 0, 0, $months), /^date|number|percent$/.test(tmp.type) ? ($months = +tmp.value, true) : false) : false)) && ($months |= 0, true))) {\n                  if ($months instanceof CalcError)\n                      return $months;\n                  return new CalcError(err);\n              }\n              xargs.push($months);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $start_date = this._arrayArg(args[i]);\n          if ($start_date) {\n              xargs.push($start_date);\n              width = Math.max(width, $start_date.width);\n              height = Math.max(height, $start_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $months = this._arrayArg(args[i]);\n          if ($months) {\n              xargs.push($months);\n              width = Math.max(width, $months.width);\n              height = Math.max(height, $months.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (base, months) {\n      var d = unpackDate$1(base);\n      var m = d.month + months;\n      var y = d.year + Math.floor(m / 12);\n      m %= 12;\n      if (m < 0) {\n          m += 12;\n      }\n      d = Math.min(d.date, daysInMonth(y, m));\n      return packDate$1(y, m, d);\n  });\n\n  defineBuiltinFunction('eomonth', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $months = args[i++];\n              if ($months instanceof CalcError)\n                  return $months;\n              if (!((typeof ($months = this.force($months)) == 'number' || (typeof $months == 'boolean' ? ($months = +$months, true) : false) || (typeof $months == 'string' && !/^(?:=|true|false)/i.test($months) ? (tmp = calc.parse(0, 0, 0, $months), /^date|number|percent$/.test(tmp.type) ? ($months = +tmp.value, true) : false) : false)) && ($months |= 0, true))) {\n                  if ($months instanceof CalcError)\n                      return $months;\n                  return new CalcError(err);\n              }\n              xargs.push($months);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $start_date = this._arrayArg(args[i]);\n          if ($start_date) {\n              xargs.push($start_date);\n              width = Math.max(width, $start_date.width);\n              height = Math.max(height, $start_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $months = this._arrayArg(args[i]);\n          if ($months) {\n              xargs.push($months);\n              width = Math.max(width, $months.width);\n              height = Math.max(height, $months.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (base, months) {\n      var d = unpackDate$1(base);\n      var m = d.month + months;\n      var y = d.year + Math.floor(m / 12);\n      m %= 12;\n      if (m < 0) {\n          m += 12;\n      }\n      d = daysInMonth(y, m);\n      return packDate$1(y, m, d);\n  });\n\n  defineBuiltinFunction('workday', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $days = args[i++];\n              if ($days instanceof CalcError)\n                  return $days;\n              if (!((typeof ($days = this.force($days)) == 'number' || (typeof $days == 'boolean' ? ($days = +$days, true) : false) || (typeof $days == 'string' && !/^(?:=|true|false)/i.test($days) ? (tmp = calc.parse(0, 0, 0, $days), /^date|number|percent$/.test(tmp.type) ? ($days = +tmp.value, true) : false) : false)) && ($days |= 0, true))) {\n                  if ($days instanceof CalcError)\n                      return $days;\n                  return new CalcError(err);\n              }\n              xargs.push($days);\n          }\n          {\n              try {\n                  var $holidays = this.cellValues(args.slice(i)).reduce(function (ret, $holidays) {\n                      if ($holidays instanceof CalcError)\n                          throw $holidays;\n                      if ((typeof $holidays == 'number' || (typeof $holidays == 'boolean' ? ($holidays = +$holidays, true) : false) || (typeof $holidays == 'string' && !/^(?:=|true|false)/i.test($holidays) ? (tmp = calc.parse(0, 0, 0, $holidays), /^date|number|percent$/.test(tmp.type) ? ($holidays = +tmp.value, true) : false) : false)) && ($holidays |= 0, true))\n                          ret.push($holidays);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($holidays);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (date, n, holidays) {\n      var inc = n > 0 ? 1 : -1;\n      n = Math.abs(n);\n      var dow = unpackDate$1(date).day;\n      while (n > 0) {\n          date += inc;\n          dow = (dow + inc) % 7;\n          if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n              --n;\n          }\n      }\n      return date;\n  });\n\n  defineBuiltinFunction('networkdays', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $end_date = args[i++];\n              if ($end_date instanceof CalcError)\n                  return $end_date;\n              if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                  if ($end_date instanceof CalcError)\n                      return $end_date;\n                  return new CalcError(err);\n              }\n              xargs.push($end_date);\n          }\n          {\n              try {\n                  var $holidays = this.cellValues(args.slice(i)).reduce(function (ret, $holidays) {\n                      if ($holidays instanceof CalcError)\n                          throw $holidays;\n                      if ((typeof $holidays == 'number' || (typeof $holidays == 'boolean' ? ($holidays = +$holidays, true) : false) || (typeof $holidays == 'string' && !/^(?:=|true|false)/i.test($holidays) ? (tmp = calc.parse(0, 0, 0, $holidays), /^date|number|percent$/.test(tmp.type) ? ($holidays = +tmp.value, true) : false) : false)) && ($holidays |= 0, true))\n                          ret.push($holidays);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($holidays);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (date, end, holidays) {\n      if (date > end) {\n          var tmp = date;\n          date = end;\n          end = tmp;\n      }\n      var count = 0;\n      var dow = unpackDate$1(date).day;\n      while (date <= end) {\n          if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n              count++;\n          }\n          date++;\n          dow = (dow + 1) % 7;\n      }\n      return count;\n  });\n\n  defineBuiltinFunction('days', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $end_date = args[i++];\n              if ($end_date instanceof CalcError)\n                  return $end_date;\n              if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                  if ($end_date instanceof CalcError)\n                      return $end_date;\n                  return new CalcError(err);\n              }\n              xargs.push($end_date);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $start_date = this._arrayArg(args[i]);\n          if ($start_date) {\n              xargs.push($start_date);\n              width = Math.max(width, $start_date.width);\n              height = Math.max(height, $start_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $end_date = this._arrayArg(args[i]);\n          if ($end_date) {\n              xargs.push($end_date);\n              width = Math.max(width, $end_date.width);\n              height = Math.max(height, $end_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (end, start) {\n      return end - start;\n  });\n\n  function _days_360(start, end, method) {\n      var d1 = unpackDate$1(start);\n      var d2 = unpackDate$1(end);\n\n      // https://en.wikipedia.org/wiki/360-day_calendar\n      // humanity is a mess.\n      if (method) {\n          // EU method\n          if (d1.date == 31) {\n              d1.date = 30;\n          }\n          if (d2.date == 31) {\n              d2.date = 30;\n          }\n      } else {\n          // US method\n          if (d1.month == 1 && d2.month == 1\n              && d1.date == daysInMonth(d1.year, 1)\n              && d2.date == daysInMonth(d2.year, 1)) {\n              d2.date = 30;\n          }\n          if (d1.date == daysInMonth(d1.year, d1.month)) {\n              d1.date = 30;\n              if (d2.date == 31) {\n                  d2.date = 30;\n              }\n          } else {\n              if (d1.date == 30 && d2.date == 31) {\n                  d2.date = 30;\n              }\n          }\n      }\n\n      return (360 * (d2.year - d1.year)\n              + 30 * (d2.month - d1.month)\n              + (d2.date - d1.date));\n  }\n\n  calc.runtime._days_360 = _days_360;\n\n  defineBuiltinFunction('days360', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $end_date = args[i++];\n              if ($end_date instanceof CalcError)\n                  return $end_date;\n              if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                  if ($end_date instanceof CalcError)\n                      return $end_date;\n                  return new CalcError(err);\n              }\n              xargs.push($end_date);\n          }\n          {\n              var $method = args[i++];\n              if ($method instanceof CalcError)\n                  return $method;\n              if (!(typeof ($method = this.force($method)) == 'boolean' || (typeof $method == 'number' ? ($method = !!$method, true) : false) || ($method == null ? ($method = false, true) : false))) {\n                  if ($method instanceof CalcError)\n                      return $method;\n                  return new CalcError(err);\n              }\n              xargs.push($method);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $start_date = this._arrayArg(args[i]);\n          if ($start_date) {\n              xargs.push($start_date);\n              width = Math.max(width, $start_date.width);\n              height = Math.max(height, $start_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $end_date = this._arrayArg(args[i]);\n          if ($end_date) {\n              xargs.push($end_date);\n              width = Math.max(width, $end_date.width);\n              height = Math.max(height, $end_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $method = this._arrayArg(args[i]);\n          if ($method) {\n              xargs.push($method);\n              width = Math.max(width, $method.width);\n              height = Math.max(height, $method.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), _days_360);\n\n  defineBuiltinFunction('yearfrac', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $start_date = args[i++];\n              if ($start_date instanceof CalcError)\n                  return $start_date;\n              if (!((typeof ($start_date = this.force($start_date)) == 'number' || (typeof $start_date == 'boolean' ? ($start_date = +$start_date, true) : false) || (typeof $start_date == 'string' && !/^(?:=|true|false)/i.test($start_date) ? (tmp = calc.parse(0, 0, 0, $start_date), /^date|number|percent$/.test(tmp.type) ? ($start_date = +tmp.value, true) : false) : false)) && ($start_date |= 0, true))) {\n                  if ($start_date instanceof CalcError)\n                      return $start_date;\n                  return new CalcError(err);\n              }\n              xargs.push($start_date);\n          }\n          {\n              var $end_date = args[i++];\n              if ($end_date instanceof CalcError)\n                  return $end_date;\n              if (!((typeof ($end_date = this.force($end_date)) == 'number' || (typeof $end_date == 'boolean' ? ($end_date = +$end_date, true) : false) || (typeof $end_date == 'string' && !/^(?:=|true|false)/i.test($end_date) ? (tmp = calc.parse(0, 0, 0, $end_date), /^date|number|percent$/.test(tmp.type) ? ($end_date = +tmp.value, true) : false) : false)) && ($end_date |= 0, true))) {\n                  if ($end_date instanceof CalcError)\n                      return $end_date;\n                  return new CalcError(err);\n              }\n              xargs.push($end_date);\n          }\n          {\n              var $method = args[i++];\n              if ($method instanceof CalcError)\n                  return $method;\n              if (!((($method = this.force($method)) == null ? ($method = 0, true) : false) || ($method === 0 || $method === 1 || $method === 2 || $method === 3 || $method === 4))) {\n                  if ($method instanceof CalcError)\n                      return $method;\n                  return new CalcError(err);\n              }\n              xargs.push($method);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $start_date = this._arrayArg(args[i]);\n          if ($start_date) {\n              xargs.push($start_date);\n              width = Math.max(width, $start_date.width);\n              height = Math.max(height, $start_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $end_date = this._arrayArg(args[i]);\n          if ($end_date) {\n              xargs.push($end_date);\n              width = Math.max(width, $end_date.width);\n              height = Math.max(height, $end_date.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $method = this._arrayArg(args[i]);\n          if ($method) {\n              xargs.push($method);\n              width = Math.max(width, $method.width);\n              height = Math.max(height, $method.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (start, end, method) {\n      switch (method) {\n      case 0:\n          return _days_360(start, end, false) / 360;\n      case 1:\n          return (end - start) / daysInYear(unpackDate$1(start).year);\n      case 2:\n          return (end - start) / 360;\n      case 3:\n          return (end - start) / 365;\n      case 4:\n          return _days_360(start, end, true) / 360;\n      }\n  });\n\n  defineBuiltinFunction('datevalue', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      var date = calc.runtime.parseDate(text);\n      if (date) {\n          return calc.runtime.dateToSerial(date);\n      }\n      return new CalcError('VALUE');\n  });\n\n  defineBuiltinFunction('timevalue', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n      if (m) {\n          var hh = parseFloat(m[1]);\n          var mm = parseFloat(m[2]);\n          var ss = m[3] ? parseFloat(m[4]) : 0;\n          var ampm = m[7];\n          if (ampm && (hh > 12 || hh < 1)) {\n              return new CalcError('VALUE');\n          }\n          if (/^p/.test(ampm)) {\n              hh += 12;\n          }\n          return calc.runtime.packTime(hh, mm, ss, 0);\n      }\n      return new CalcError('VALUE');\n  });\n\n  /* -----[ Matrix functions ]----- */\n\n  defineBuiltinFunction('mdeterm', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $m = args[i++];\n              if ($m instanceof CalcError)\n                  return $m;\n              if (!(((m = this.asMatrix($m)) ? $m = m : false) && ($m.width == $m.height ? true : (err = 'N/A', false)))) {\n                  if ($m instanceof CalcError)\n                      return $m;\n                  return new CalcError(err);\n              }\n              xargs.push($m);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (m) {\n      var error = m.each(function (val) {\n          if (typeof val != 'number') {\n              return new CalcError('VALUE');\n          }\n      }, true);\n      return error || m.determinant();\n  });\n\n  defineBuiltinFunction('transpose', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $range = args[i++];\n              if ($range instanceof CalcError)\n                  return $range;\n              if (!((m = this.asMatrix($range)) ? $range = m : false)) {\n                  if ($range instanceof CalcError)\n                      return $range;\n                  return new CalcError(err);\n              }\n              xargs.push($range);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (m) {\n      return m.transpose();\n  });\n\n  defineBuiltinFunction('mmult', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $a = args[i++];\n              if ($a instanceof CalcError)\n                  return $a;\n              if (!((m = this.asMatrix($a)) ? $a = m : false)) {\n                  if ($a instanceof CalcError)\n                      return $a;\n                  return new CalcError(err);\n              }\n              xargs.push($a);\n          }\n          {\n              var $b = args[i++];\n              if ($b instanceof CalcError)\n                  return $b;\n              if (!(((m = this.asMatrix($b)) ? $b = m : false) && ($b.height == $a.width ? true : (err = 'N/A', false)))) {\n                  if ($b instanceof CalcError)\n                      return $b;\n                  return new CalcError(err);\n              }\n              xargs.push($b);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (a, b) {\n      return a.multiply(b);\n  });\n\n  defineBuiltinFunction('munit', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $n = args[i++];\n              if ($n instanceof CalcError)\n                  return $n;\n              if (!((typeof ($n = this.force($n)) == 'number' || (typeof $n == 'boolean' ? ($n = +$n, true) : false) || (typeof $n == 'string' && !/^(?:=|true|false)/i.test($n) ? (tmp = calc.parse(0, 0, 0, $n), /^date|number|percent$/.test(tmp.type) ? ($n = +tmp.value, true) : false) : false)) && (($n |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($n instanceof CalcError)\n                      return $n;\n                  return new CalcError(err);\n              }\n              xargs.push($n);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (n) {\n      return new Matrix(this).unit(n);\n  });\n\n  defineBuiltinFunction('minverse', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $m = args[i++];\n              if ($m instanceof CalcError)\n                  return $m;\n              if (!(((m = this.asMatrix($m)) ? $m = m : false) && ($m.width == $m.height ? true : (err = 'N/A', false)))) {\n                  if ($m instanceof CalcError)\n                      return $m;\n                  return new CalcError(err);\n              }\n              xargs.push($m);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (m) {\n      var error = m.each(function (val) {\n          if (typeof val != 'number') {\n              return new CalcError('VALUE');\n          }\n      }, true);\n      return error || m.inverse() || new CalcError('VALUE');\n  });\n\n  /* -----[ Other ]----- */\n\n  defineBuiltinFunction('rand', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return Math.random();\n  });\n\n  defineBuiltinFunction('randbetween', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $min = args[i++];\n              if ($min instanceof CalcError)\n                  return $min;\n              if (!((typeof ($min = this.force($min)) == 'number' || (typeof $min == 'boolean' ? ($min = +$min, true) : false) || (typeof $min == 'string' && !/^(?:=|true|false)/i.test($min) ? (tmp = calc.parse(0, 0, 0, $min), /^date|number|percent$/.test(tmp.type) ? ($min = +tmp.value, true) : false) : false)) && ($min |= 0, true))) {\n                  if ($min instanceof CalcError)\n                      return $min;\n                  return new CalcError(err);\n              }\n              xargs.push($min);\n          }\n          {\n              var $max = args[i++];\n              if ($max instanceof CalcError)\n                  return $max;\n              if (!((typeof ($max = this.force($max)) == 'number' || (typeof $max == 'boolean' ? ($max = +$max, true) : false) || (typeof $max == 'string' && !/^(?:=|true|false)/i.test($max) ? (tmp = calc.parse(0, 0, 0, $max), /^date|number|percent$/.test(tmp.type) ? ($max = +tmp.value, true) : false) : false)) && ($max |= 0, true) && ($max >= $min ? true : (err = 'N/A', false)))) {\n                  if ($max instanceof CalcError)\n                      return $max;\n                  return new CalcError(err);\n              }\n              xargs.push($max);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (min, max) {\n      return min + Math.floor((max - min + 1) * Math.random());\n  });\n\n  defineBuiltinFunction('true', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return true;\n  });\n\n  defineBuiltinFunction('false', false, function () {\n      function check(args) {\n          var xargs = [], i = 0;\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      return { check: check };\n  }(), function () {\n      return true;\n  });\n\n  defineBuiltinFunction('roman', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false)) && ($number |= 0, true))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (num) {\n      return arabicToRoman(num).toUpperCase();\n  });\n\n  defineBuiltinFunction('arabic', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $roman = args[i++];\n              if ($roman instanceof CalcError)\n                  return $roman;\n              if (!(typeof ($roman = this.force($roman)) == 'string' || typeof $roman == 'boolean' || typeof $roman == 'number' ? ($roman += '', true) : $roman === undefined ? ($roman = '', true) : false)) {\n                  if ($roman instanceof CalcError)\n                      return $roman;\n                  return new CalcError(err);\n              }\n              xargs.push($roman);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $roman = this._arrayArg(args[i]);\n          if ($roman) {\n              xargs.push($roman);\n              width = Math.max(width, $roman.width);\n              height = Math.max(height, $roman.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (rom) {\n      var num = romanToArabic(rom);\n      return num == null ? new CalcError('VALUE') : num;\n  });\n\n  defineBuiltinFunction('base', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false)) && ($number |= 0, true))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $radix = args[i++];\n              if ($radix instanceof CalcError)\n                  return $radix;\n              if (!((typeof ($radix = this.force($radix)) == 'number' || (typeof $radix == 'boolean' ? ($radix = +$radix, true) : false) || (typeof $radix == 'string' && !/^(?:=|true|false)/i.test($radix) ? (tmp = calc.parse(0, 0, 0, $radix), /^date|number|percent$/.test(tmp.type) ? ($radix = +tmp.value, true) : false) : false)) && ($radix |= 0, true) && ($radix >= 2 && $radix <= 36 ? true : (err = 'NUM', false)))) {\n                  if ($radix instanceof CalcError)\n                      return $radix;\n                  return new CalcError(err);\n              }\n              xargs.push($radix);\n          }\n          {\n              var $minLen = args[i++];\n              if ($minLen instanceof CalcError)\n                  return $minLen;\n              if (!((typeof ($minLen = this.force($minLen)) == 'number' || (typeof $minLen == 'boolean' ? ($minLen = +$minLen, true) : false) || (typeof $minLen == 'string' && !/^(?:=|true|false)/i.test($minLen) ? (tmp = calc.parse(0, 0, 0, $minLen), /^date|number|percent$/.test(tmp.type) ? ($minLen = +tmp.value, true) : false) : false)) && (($minLen |= 0) >= 0 ? true : (err = 'NUM', false)) || ($minLen == null ? ($minLen = 0, true) : false))) {\n                  if ($minLen instanceof CalcError)\n                      return $minLen;\n                  return new CalcError(err);\n              }\n              xargs.push($minLen);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $radix = this._arrayArg(args[i]);\n          if ($radix) {\n              xargs.push($radix);\n              width = Math.max(width, $radix.width);\n              height = Math.max(height, $radix.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $minLen = this._arrayArg(args[i]);\n          if ($minLen) {\n              xargs.push($minLen);\n              width = Math.max(width, $minLen.width);\n              height = Math.max(height, $minLen.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (number, radix, minLen) {\n      var str = number.toString(radix).toUpperCase();\n      while (str.length < minLen) {\n          str = '0' + str;\n      }\n      return str;\n  });\n\n  defineBuiltinFunction('decimal', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $radix = args[i++];\n              if ($radix instanceof CalcError)\n                  return $radix;\n              if (!((typeof ($radix = this.force($radix)) == 'number' || (typeof $radix == 'boolean' ? ($radix = +$radix, true) : false) || (typeof $radix == 'string' && !/^(?:=|true|false)/i.test($radix) ? (tmp = calc.parse(0, 0, 0, $radix), /^date|number|percent$/.test(tmp.type) ? ($radix = +tmp.value, true) : false) : false)) && ($radix |= 0, true) && ($radix >= 2 && $radix <= 36 ? true : (err = 'NUM', false)))) {\n                  if ($radix instanceof CalcError)\n                      return $radix;\n                  return new CalcError(err);\n              }\n              xargs.push($radix);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $radix = this._arrayArg(args[i]);\n          if ($radix) {\n              xargs.push($radix);\n              width = Math.max(width, $radix.width);\n              height = Math.max(height, $radix.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, radix) {\n      text = text.toUpperCase();\n      var val = 0;\n      for (var i = 0; i < text.length; ++i) {\n          var d = text.charCodeAt(i);\n          if (d >= 48 && d <= 57) {\n              d -= 48;\n          } else if (d >= 65 && d < 55 + radix) {\n              d -= 55;\n          } else {\n              return new CalcError('VALUE');\n          }\n          val = val * radix + d;\n      }\n      return val;\n  });\n\n  /* -----[ String functions ]----- */\n\n  defineBuiltinFunction('char', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $code = args[i++];\n              if ($code instanceof CalcError)\n                  return $code;\n              if (!((typeof ($code = this.force($code)) == 'number' || (typeof $code == 'boolean' ? ($code = +$code, true) : false) || (typeof $code == 'string' && !/^(?:=|true|false)/i.test($code) ? (tmp = calc.parse(0, 0, 0, $code), /^date|number|percent$/.test(tmp.type) ? ($code = +tmp.value, true) : false) : false)) && (($code |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($code instanceof CalcError)\n                      return $code;\n                  return new CalcError(err);\n              }\n              xargs.push($code);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $code = this._arrayArg(args[i]);\n          if ($code) {\n              xargs.push($code);\n              width = Math.max(width, $code.width);\n              height = Math.max(height, $code.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (code) {\n      return String.fromCharCode(code);\n  });\n\n  // From XRegExp\n  var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\n  defineBuiltinFunction('clean', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.replace(RX_NON_PRINTABLE, '');\n  });\n\n  defineBuiltinFunction('code', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.charAt(0);\n  });\n\n  calc.runtime.defineAlias(\"unichar\", \"char\");\n  calc.runtime.defineAlias(\"unicode\", \"code\");\n\n  defineBuiltinFunction('concatenate', false, function () {\n      function check(args) {\n          var stack = [], tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              if (i >= args.length)\n                  return new CalcError('N/A');\n              xargs.push(tmp = []);\n              stack.push(xargs);\n              xargs = tmp;\n              do {\n                  {\n                      var $text = args[i++];\n                      if ($text instanceof CalcError)\n                          return $text;\n                      if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                          if ($text instanceof CalcError)\n                              return $text;\n                          return new CalcError(err);\n                      }\n                      xargs.push($text);\n                  }\n              } while (i < args.length);\n              xargs = stack.pop();\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          while (i < args.length) {\n              toResolve.push(args[i++]);\n          }\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          while (i < args.length) {\n              var $text = this._arrayArg(args[i]);\n              if ($text) {\n                  xargs.push($text);\n                  width = Math.max(width, $text.width);\n                  height = Math.max(height, $text.height);\n                  arrays.push(true);\n              } else {\n                  xargs.push(args[i]);\n                  arrays.push(false);\n              }\n              i++;\n          }\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (args) {\n      var out = '';\n      for (var i = 0; i < args.length; ++i) {\n          out += args[i];\n      }\n      return out;\n  });\n\n  defineBuiltinFunction('dollar', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $decimals = args[i++];\n              if ($decimals instanceof CalcError)\n                  return $decimals;\n              if (!((typeof ($decimals = this.force($decimals)) == 'number' || (typeof $decimals == 'boolean' ? ($decimals = +$decimals, true) : false) || (typeof $decimals == 'string' && !/^(?:=|true|false)/i.test($decimals) ? (tmp = calc.parse(0, 0, 0, $decimals), /^date|number|percent$/.test(tmp.type) ? ($decimals = +tmp.value, true) : false) : false)) && ($decimals |= 0, true) || ($decimals == null ? ($decimals = 2, true) : false))) {\n                  if ($decimals instanceof CalcError)\n                      return $decimals;\n                  return new CalcError(err);\n              }\n              xargs.push($decimals);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $decimals = this._arrayArg(args[i]);\n          if ($decimals) {\n              xargs.push($decimals);\n              width = Math.max(width, $decimals.width);\n              height = Math.max(height, $decimals.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (number, decimals) {\n      var format = '$#,##0DECIMALS;($#,##0DECIMALS)';\n      var dec = '';\n      var denomitator = 1;\n      while (decimals-- > 0) {\n          dec += '0';\n      }\n      while (++decimals < 0) {\n          denomitator *= 10;\n      }\n      if (dec !== '') {\n          dec = '.' + dec;\n      } else if (denomitator !== 1) {\n          number = Math.round(number / denomitator) * denomitator;\n      }\n      format = format.replace(/DECIMALS/g, dec);\n      return formatting.text(number, format);\n  });\n\n  defineBuiltinFunction('exact', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text1 = args[i++];\n              if ($text1 instanceof CalcError)\n                  return $text1;\n              if (!(typeof ($text1 = this.force($text1)) == 'string' || typeof $text1 == 'boolean' || typeof $text1 == 'number' ? ($text1 += '', true) : $text1 === undefined ? ($text1 = '', true) : false)) {\n                  if ($text1 instanceof CalcError)\n                      return $text1;\n                  return new CalcError(err);\n              }\n              xargs.push($text1);\n          }\n          {\n              var $text2 = args[i++];\n              if ($text2 instanceof CalcError)\n                  return $text2;\n              if (!(typeof ($text2 = this.force($text2)) == 'string' || typeof $text2 == 'boolean' || typeof $text2 == 'number' ? ($text2 += '', true) : $text2 === undefined ? ($text2 = '', true) : false)) {\n                  if ($text2 instanceof CalcError)\n                      return $text2;\n                  return new CalcError(err);\n              }\n              xargs.push($text2);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text1 = this._arrayArg(args[i]);\n          if ($text1) {\n              xargs.push($text1);\n              width = Math.max(width, $text1.width);\n              height = Math.max(height, $text1.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $text2 = this._arrayArg(args[i]);\n          if ($text2) {\n              xargs.push($text2);\n              width = Math.max(width, $text2.width);\n              height = Math.max(height, $text2.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (a, b) {\n      return a === b;\n  });\n\n  defineBuiltinFunction('find', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $substring = args[i++];\n              if ($substring instanceof CalcError)\n                  return $substring;\n              if (!(typeof ($substring = this.force($substring)) == 'string' || typeof $substring == 'boolean' || typeof $substring == 'number' ? ($substring += '', true) : $substring === undefined ? ($substring = '', true) : false)) {\n                  if ($substring instanceof CalcError)\n                      return $substring;\n                  return new CalcError(err);\n              }\n              xargs.push($substring);\n          }\n          {\n              var $string = args[i++];\n              if ($string instanceof CalcError)\n                  return $string;\n              if (!(typeof ($string = this.force($string)) == 'string' || typeof $string == 'boolean' || typeof $string == 'number' ? ($string += '', true) : $string === undefined ? ($string = '', true) : false)) {\n                  if ($string instanceof CalcError)\n                      return $string;\n                  return new CalcError(err);\n              }\n              xargs.push($string);\n          }\n          {\n              var $start = args[i++];\n              if ($start instanceof CalcError)\n                  return $start;\n              if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)) || ($start == null ? ($start = 1, true) : false))) {\n                  if ($start instanceof CalcError)\n                      return $start;\n                  return new CalcError(err);\n              }\n              xargs.push($start);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $substring = this._arrayArg(args[i]);\n          if ($substring) {\n              xargs.push($substring);\n              width = Math.max(width, $substring.width);\n              height = Math.max(height, $substring.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $string = this._arrayArg(args[i]);\n          if ($string) {\n              xargs.push($string);\n              width = Math.max(width, $string.width);\n              height = Math.max(height, $string.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $start = this._arrayArg(args[i]);\n          if ($start) {\n              xargs.push($start);\n              width = Math.max(width, $start.width);\n              height = Math.max(height, $start.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (substring, string, start) {\n      var pos = string.indexOf(substring, start - 1);\n      return pos < 0 ? new CalcError('VALUE') : pos + 1;\n  });\n\n  defineBuiltinFunction('fixed', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' ? ($number = limitPrecision($number), true) : false) || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          {\n              var $decimals = args[i++];\n              if ($decimals instanceof CalcError)\n                  return $decimals;\n              if (!((typeof ($decimals = this.force($decimals)) == 'number' || (typeof $decimals == 'boolean' ? ($decimals = +$decimals, true) : false) || (typeof $decimals == 'string' && !/^(?:=|true|false)/i.test($decimals) ? (tmp = calc.parse(0, 0, 0, $decimals), /^date|number|percent$/.test(tmp.type) ? ($decimals = +tmp.value, true) : false) : false)) && ($decimals |= 0, true) || ($decimals == null ? ($decimals = 2, true) : false))) {\n                  if ($decimals instanceof CalcError)\n                      return $decimals;\n                  return new CalcError(err);\n              }\n              xargs.push($decimals);\n          }\n          {\n              var $noCommas = args[i++];\n              if ($noCommas instanceof CalcError)\n                  return $noCommas;\n              if (!(typeof ($noCommas = this.force($noCommas)) == 'boolean' || ($noCommas == null ? ($noCommas = false, true) : false))) {\n                  if ($noCommas instanceof CalcError)\n                      return $noCommas;\n                  return new CalcError(err);\n              }\n              xargs.push($noCommas);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $decimals = this._arrayArg(args[i]);\n          if ($decimals) {\n              xargs.push($decimals);\n              width = Math.max(width, $decimals.width);\n              height = Math.max(height, $decimals.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $noCommas = this._arrayArg(args[i]);\n          if ($noCommas) {\n              xargs.push($noCommas);\n              width = Math.max(width, $noCommas.width);\n              height = Math.max(height, $noCommas.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (number, decimals, noCommas) {\n      var scale = Math.pow(10, decimals);\n      number = Math.round(number * scale) / scale;\n      var format = noCommas ? '0' : '#,##0';\n      if (decimals > 0) {\n          format += '.';\n          while (decimals-- > 0) {\n              format += '0';\n          }\n      }\n      return formatting.text(number, format);\n  });\n\n  defineBuiltinFunction('left', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $length = args[i++];\n              if ($length instanceof CalcError)\n                  return $length;\n              if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)) || ($length == null ? ($length = 1, true) : false))) {\n                  if ($length instanceof CalcError)\n                      return $length;\n                  return new CalcError(err);\n              }\n              xargs.push($length);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $length = this._arrayArg(args[i]);\n          if ($length) {\n              xargs.push($length);\n              width = Math.max(width, $length.width);\n              height = Math.max(height, $length.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, length) {\n      return text.substr(0, length);\n  });\n\n  defineBuiltinFunction('right', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $length = args[i++];\n              if ($length instanceof CalcError)\n                  return $length;\n              if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)) || ($length == null ? ($length = 1, true) : false))) {\n                  if ($length instanceof CalcError)\n                      return $length;\n                  return new CalcError(err);\n              }\n              xargs.push($length);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $length = this._arrayArg(args[i]);\n          if ($length) {\n              xargs.push($length);\n              width = Math.max(width, $length.width);\n              height = Math.max(height, $length.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, length) {\n      return text.substr(-length);\n  });\n\n  defineBuiltinFunction('len', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.length;\n  });\n\n  defineBuiltinFunction('lower', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.toLowerCase();\n  });\n\n  defineBuiltinFunction('upper', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.toUpperCase();\n  });\n\n  defineBuiltinFunction('ltrim', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.replace(/^\\s+/, '');\n  });\n\n  defineBuiltinFunction('rtrim', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.replace(/\\s+$/, '');\n  });\n\n  defineBuiltinFunction('trim', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.replace(/^\\s+|\\s+$/, '');\n  });\n\n  defineBuiltinFunction('mid', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $start = args[i++];\n              if ($start instanceof CalcError)\n                  return $start;\n              if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($start instanceof CalcError)\n                      return $start;\n                  return new CalcError(err);\n              }\n              xargs.push($start);\n          }\n          {\n              var $length = args[i++];\n              if ($length instanceof CalcError)\n                  return $length;\n              if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($length instanceof CalcError)\n                      return $length;\n                  return new CalcError(err);\n              }\n              xargs.push($length);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $start = this._arrayArg(args[i]);\n          if ($start) {\n              xargs.push($start);\n              width = Math.max(width, $start.width);\n              height = Math.max(height, $start.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $length = this._arrayArg(args[i]);\n          if ($length) {\n              xargs.push($length);\n              width = Math.max(width, $length.width);\n              height = Math.max(height, $length.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, start, length) {\n      return text.substr(start - 1, length);\n  });\n\n  defineBuiltinFunction('proper', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text) {\n      return text.toLowerCase().replace(/\\b./g, function (s) {\n          return s.toUpperCase();\n      });\n  });\n\n  defineBuiltinFunction('replace', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $start = args[i++];\n              if ($start instanceof CalcError)\n                  return $start;\n              if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($start instanceof CalcError)\n                      return $start;\n                  return new CalcError(err);\n              }\n              xargs.push($start);\n          }\n          {\n              var $length = args[i++];\n              if ($length instanceof CalcError)\n                  return $length;\n              if (!((typeof ($length = this.force($length)) == 'number' || (typeof $length == 'boolean' ? ($length = +$length, true) : false) || (typeof $length == 'string' && !/^(?:=|true|false)/i.test($length) ? (tmp = calc.parse(0, 0, 0, $length), /^date|number|percent$/.test(tmp.type) ? ($length = +tmp.value, true) : false) : false)) && (($length |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($length instanceof CalcError)\n                      return $length;\n                  return new CalcError(err);\n              }\n              xargs.push($length);\n          }\n          {\n              var $newText = args[i++];\n              if ($newText instanceof CalcError)\n                  return $newText;\n              if (!(typeof ($newText = this.force($newText)) == 'string' || typeof $newText == 'boolean' || typeof $newText == 'number' ? ($newText += '', true) : $newText === undefined ? ($newText = '', true) : false)) {\n                  if ($newText instanceof CalcError)\n                      return $newText;\n                  return new CalcError(err);\n              }\n              xargs.push($newText);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $start = this._arrayArg(args[i]);\n          if ($start) {\n              xargs.push($start);\n              width = Math.max(width, $start.width);\n              height = Math.max(height, $start.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $length = this._arrayArg(args[i]);\n          if ($length) {\n              xargs.push($length);\n              width = Math.max(width, $length.width);\n              height = Math.max(height, $length.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $newText = this._arrayArg(args[i]);\n          if ($newText) {\n              xargs.push($newText);\n              width = Math.max(width, $newText.width);\n              height = Math.max(height, $newText.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, start, length, newText) {\n      return text.substr(0, --start) + newText + text.substr(start + length);\n  });\n\n  defineBuiltinFunction('rept', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $number = args[i++];\n              if ($number instanceof CalcError)\n                  return $number;\n              if (!((typeof ($number = this.force($number)) == 'number' || (typeof $number == 'boolean' ? ($number = +$number, true) : false) || (typeof $number == 'string' && !/^(?:=|true|false)/i.test($number) ? (tmp = calc.parse(0, 0, 0, $number), /^date|number|percent$/.test(tmp.type) ? ($number = +tmp.value, true) : false) : false)) && (($number |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($number instanceof CalcError)\n                      return $number;\n                  return new CalcError(err);\n              }\n              xargs.push($number);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $number = this._arrayArg(args[i]);\n          if ($number) {\n              xargs.push($number);\n              width = Math.max(width, $number.width);\n              height = Math.max(height, $number.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, number) {\n      var out = '';\n      while (number-- > 0) {\n          out += text;\n      }\n      return out;\n  });\n\n  defineBuiltinFunction('search', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $substring = args[i++];\n              if ($substring instanceof CalcError)\n                  return $substring;\n              if (!(typeof ($substring = this.force($substring)) == 'string' || typeof $substring == 'boolean' || typeof $substring == 'number' ? ($substring += '', true) : $substring === undefined ? ($substring = '', true) : false)) {\n                  if ($substring instanceof CalcError)\n                      return $substring;\n                  return new CalcError(err);\n              }\n              xargs.push($substring);\n          }\n          {\n              var $string = args[i++];\n              if ($string instanceof CalcError)\n                  return $string;\n              if (!(typeof ($string = this.force($string)) == 'string' || typeof $string == 'boolean' || typeof $string == 'number' ? ($string += '', true) : $string === undefined ? ($string = '', true) : false)) {\n                  if ($string instanceof CalcError)\n                      return $string;\n                  return new CalcError(err);\n              }\n              xargs.push($string);\n          }\n          {\n              var $start = args[i++];\n              if ($start instanceof CalcError)\n                  return $start;\n              if (!((typeof ($start = this.force($start)) == 'number' || (typeof $start == 'boolean' ? ($start = +$start, true) : false) || (typeof $start == 'string' && !/^(?:=|true|false)/i.test($start) ? (tmp = calc.parse(0, 0, 0, $start), /^date|number|percent$/.test(tmp.type) ? ($start = +tmp.value, true) : false) : false)) && (($start |= 0) > 0 ? true : (err = 'NUM', false)) || ($start == null ? ($start = 1, true) : false))) {\n                  if ($start instanceof CalcError)\n                      return $start;\n                  return new CalcError(err);\n              }\n              xargs.push($start);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $substring = this._arrayArg(args[i]);\n          if ($substring) {\n              xargs.push($substring);\n              width = Math.max(width, $substring.width);\n              height = Math.max(height, $substring.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $string = this._arrayArg(args[i]);\n          if ($string) {\n              xargs.push($string);\n              width = Math.max(width, $string.width);\n              height = Math.max(height, $string.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $start = this._arrayArg(args[i]);\n          if ($start) {\n              xargs.push($start);\n              width = Math.max(width, $start.width);\n              height = Math.max(height, $start.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (substring, string, start) {\n      var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n      return pos < 0 ? new CalcError('VALUE') : pos + 1;\n  });\n\n  defineBuiltinFunction('substitute', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!(typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false)) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          {\n              var $oldText = args[i++];\n              if ($oldText instanceof CalcError)\n                  return $oldText;\n              if (!(typeof ($oldText = this.force($oldText)) == 'string' || typeof $oldText == 'boolean' || typeof $oldText == 'number' ? ($oldText += '', true) : $oldText === undefined ? ($oldText = '', true) : false)) {\n                  if ($oldText instanceof CalcError)\n                      return $oldText;\n                  return new CalcError(err);\n              }\n              xargs.push($oldText);\n          }\n          {\n              var $newText = args[i++];\n              if ($newText instanceof CalcError)\n                  return $newText;\n              if (!(typeof ($newText = this.force($newText)) == 'string' || typeof $newText == 'boolean' || typeof $newText == 'number' ? ($newText += '', true) : $newText === undefined ? ($newText = '', true) : false)) {\n                  if ($newText instanceof CalcError)\n                      return $newText;\n                  return new CalcError(err);\n              }\n              xargs.push($newText);\n          }\n          {\n              var $nth = args[i++];\n              if ($nth instanceof CalcError)\n                  return $nth;\n              if (!((typeof ($nth = this.force($nth)) == 'number' || (typeof $nth == 'boolean' ? ($nth = +$nth, true) : false) || (typeof $nth == 'string' && !/^(?:=|true|false)/i.test($nth) ? (tmp = calc.parse(0, 0, 0, $nth), /^date|number|percent$/.test(tmp.type) ? ($nth = +tmp.value, true) : false) : false)) && (($nth |= 0) > 0 ? true : (err = 'NUM', false)) || $nth == null)) {\n                  if ($nth instanceof CalcError)\n                      return $nth;\n                  return new CalcError(err);\n              }\n              xargs.push($nth);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $oldText = this._arrayArg(args[i]);\n          if ($oldText) {\n              xargs.push($oldText);\n              width = Math.max(width, $oldText.width);\n              height = Math.max(height, $oldText.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $newText = this._arrayArg(args[i]);\n          if ($newText) {\n              xargs.push($newText);\n              width = Math.max(width, $newText.width);\n              height = Math.max(height, $newText.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $nth = this._arrayArg(args[i]);\n          if ($nth) {\n              xargs.push($nth);\n              width = Math.max(width, $nth.width);\n              height = Math.max(height, $nth.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (text, oldText, newText, nth) {\n      if (oldText === newText) {\n          return text;\n      }\n      var a = text.split(oldText);\n      if (nth == null) {\n          return a.join(newText);\n      }\n      text = '';\n      nth--;\n      for (var i = 0; i < a.length; ++i) {\n          text += a[i];\n          if (i < a.length - 1) {\n              if (i === nth) {\n                  text += newText;\n              } else {\n                  text += oldText;\n              }\n          }\n      }\n      return text;\n  });\n\n  defineBuiltinFunction('t', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (value) {\n      return typeof value == 'string' ? value : '';\n  });\n\n  defineBuiltinFunction('text', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              var $format = args[i++];\n              if ($format instanceof CalcError)\n                  return $format;\n              if (!(typeof ($format = this.force($format)) == 'string' || typeof $format == 'boolean' || typeof $format == 'number' ? ($format += '', true) : $format === undefined ? ($format = '', true) : false)) {\n                  if ($format instanceof CalcError)\n                      return $format;\n                  return new CalcError(err);\n              }\n              xargs.push($format);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $format = this._arrayArg(args[i]);\n          if ($format) {\n              xargs.push($format);\n              width = Math.max(width, $format.width);\n              height = Math.max(height, $format.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (value, format) {\n      return formatting.text(value, format);\n  });\n\n  defineBuiltinFunction('value', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if ($value instanceof CalcError)\n                  return $value;\n              if (!(($value = this.force($value)) != null && i <= args.length)) {\n                  if ($value instanceof CalcError)\n                      return $value;\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (value) {\n      if (typeof value == 'number') {\n          return value;\n      }\n      if (typeof value == 'boolean') {\n          return +value;\n      }\n      value = (value + '').replace(/[$€,]/g, '');\n      value = parseFloat(value);\n      return isNaN(value) ? new CalcError('VALUE') : value;\n  });\n\n  function Hyperlink(link, text) {\n      this.link = link;\n      this.text = text;\n  }\n  Hyperlink.prototype.toString = function() {\n      return this.text;\n  };\n\n  defineBuiltinFunction('hyperlink', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $link = args[i++];\n              if ($link instanceof CalcError)\n                  return $link;\n              if (!(typeof ($link = this.force($link)) == 'string' || typeof $link == 'boolean' || typeof $link == 'number' ? ($link += '', true) : $link === undefined ? ($link = '', true) : false)) {\n                  if ($link instanceof CalcError)\n                      return $link;\n                  return new CalcError(err);\n              }\n              xargs.push($link);\n          }\n          {\n              var $text = args[i++];\n              if ($text instanceof CalcError)\n                  return $text;\n              if (!((typeof ($text = this.force($text)) == 'string' || typeof $text == 'boolean' || typeof $text == 'number' ? ($text += '', true) : $text === undefined ? ($text = '', true) : false) || ($text == null ? ($text = $link, true) : false))) {\n                  if ($text instanceof CalcError)\n                      return $text;\n                  return new CalcError(err);\n              }\n              xargs.push($text);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $link = this._arrayArg(args[i]);\n          if ($link) {\n              xargs.push($link);\n              width = Math.max(width, $link.width);\n              height = Math.max(height, $link.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $text = this._arrayArg(args[i]);\n          if ($text) {\n              xargs.push($text);\n              width = Math.max(width, $text.width);\n              height = Math.max(height, $text.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (link, text) {\n      return new Hyperlink(link, text);\n  });\n\n  //// other misc functions\n\n  defineBuiltinFunction('iferror', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              var $value = args[i++];\n              if (!($value = this.force($value), i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value);\n          }\n          {\n              var $value_if_error = args[i++];\n              if (!(($value_if_error = this.force($value_if_error)) != null && i <= args.length)) {\n                  return new CalcError(err);\n              }\n              xargs.push($value_if_error);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      function arrayArgs(args) {\n          var xargs = [], width = 0, height = 0, arrays = [], i = 0;\n          var $value = this._arrayArg(args[i]);\n          if ($value) {\n              xargs.push($value);\n              width = Math.max(width, $value.width);\n              height = Math.max(height, $value.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          var $value_if_error = this._arrayArg(args[i]);\n          if ($value_if_error) {\n              xargs.push($value_if_error);\n              width = Math.max(width, $value_if_error.width);\n              height = Math.max(height, $value_if_error.height);\n              arrays.push(true);\n          } else {\n              xargs.push(args[i]);\n              arrays.push(false);\n          }\n          i++;\n          return {\n              args: xargs,\n              width: width,\n              height: height,\n              arrays: arrays\n          };\n      }\n      return {\n          check: check,\n          resolve: resolve,\n          arrayArgs: arrayArgs\n      };\n  }(), function (value, valueIfError) {\n      return value instanceof CalcError ? valueIfError : value;\n  });\n\n  //// utils\n\n  var parseCriteria = (function(){\n      var RXCACHE = Object.create(null);\n\n      function makeComparator(cmp, x) {\n          if (typeof x == \"string\") {\n              var num = parseFloat(x);\n              if (!isNaN(num) && num == x) {\n                  x = num;\n              }\n          }\n          return function(a) {\n              var b = x;\n              if (typeof a == \"string\" && typeof b == \"string\") {\n                  a = a.toLowerCase();\n                  b = b.toLowerCase();\n              }\n              return cmp(a, b);\n          };\n      }\n\n      function lc(a) {\n          var num, str;\n          if (typeof a == \"string\") {\n              a = a.toLowerCase();\n          }\n          if (/^[0-9.]+%$/.test(a)) {\n              str = a.substr(0, a.length - 1);\n              num = parseFloat(str);\n              if (!isNaN(num) && num == str) {\n                  a = num / 100;\n              }\n          } else if (/^[0-9.]+$/.test(a)) {\n              num = parseFloat(a);\n              if (!isNaN(num) && num == a) {\n                  a = num;\n              }\n          }\n          return a;\n      }\n\n      function compLT(a, b) { return lc(a) < lc(b); }\n      function compLTE(a, b) { return lc(a) <= lc(b); }\n      function compGT(a, b) { return lc(a) > lc(b); }\n      function compGTE(a, b) { return lc(a) >= lc(b); }\n      function compNE(a, b) { return !compEQ(a, b); }\n      function compEQ(a, b) {\n          if (b instanceof RegExp) {\n              return b.test(a);\n          }\n          if (typeof a == \"string\" || typeof b == \"string\") {\n              // if either one is string, make sure both are strings\n              a = String(a);\n              b = String(b);\n          }\n          return lc(a) == lc(b);\n      }\n\n      return function(cmp) {\n          if (typeof cmp == \"function\") {\n              return cmp;\n          }\n          var m;\n          if ((m = /^=(.*)$/.exec(cmp))) {\n              return makeComparator(compEQ, m[1]);\n          }\n          if ((m = /^<>(.*)$/.exec(cmp))) {\n              return makeComparator(compNE, m[1]);\n          }\n          if ((m = /^<=(.*)$/.exec(cmp))) {\n              return makeComparator(compLTE, m[1]);\n          }\n          if ((m = /^<(.*)$/.exec(cmp))) {\n              return makeComparator(compLT, m[1]);\n          }\n          if ((m = /^>=(.*)$/.exec(cmp))) {\n              return makeComparator(compGTE, m[1]);\n          }\n          if ((m = /^>(.*)$/.exec(cmp))) {\n              return makeComparator(compGT, m[1]);\n          }\n          if (/[?*]/.exec(cmp)) {\n              // has wildchars\n              var rx = RXCACHE[cmp];\n              if (!rx) {\n                  rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function(s){\n                      switch (s) {\n                      case \"~?\" : return \"\\\\?\";\n                      case \"~*\" : return \"\\\\*\";\n                      case \"?\" : return \".\";\n                      case \"*\" : return \".*\";\n                      default : return \"\\\\\" + s;\n                      }\n                  });\n                  rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n              }\n              return makeComparator(compEQ, rx);\n          }\n          return makeComparator(compEQ, cmp);\n      };\n  })();\n\n  function numericPredicate(val) {\n      return typeof val == \"number\"\n          || typeof val == \"boolean\"\n          || val == null\n          || val === \"\";\n  }\n\n  function ascending(a, b) {\n      return a === b ? 0 : a < b ? -1 : 1;\n  }\n\n  function descending(a, b) {\n      return a === b ? 0 : a < b ? 1 : -1;\n  }\n\n  defineBuiltinFunction('ERF', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $lower_limit = args[i++];\n              if ($lower_limit instanceof CalcError)\n                  return $lower_limit;\n              if (!((typeof ($lower_limit = this.force($lower_limit)) == 'number' ? ($lower_limit = limitPrecision($lower_limit), true) : false) || (typeof $lower_limit == 'boolean' ? ($lower_limit = +$lower_limit, true) : false) || (typeof $lower_limit == 'string' && !/^(?:=|true|false)/i.test($lower_limit) ? (tmp = calc.parse(0, 0, 0, $lower_limit), /^date|number|percent$/.test(tmp.type) ? ($lower_limit = +tmp.value, true) : false) : false))) {\n                  if ($lower_limit instanceof CalcError)\n                      return $lower_limit;\n                  return new CalcError(err);\n              }\n              xargs.push($lower_limit);\n          }\n          {\n              var $upper_limit = args[i++];\n              if ($upper_limit instanceof CalcError)\n                  return $upper_limit;\n              if (!((typeof ($upper_limit = this.force($upper_limit)) == 'number' ? ($upper_limit = limitPrecision($upper_limit), true) : false) || (typeof $upper_limit == 'boolean' ? ($upper_limit = +$upper_limit, true) : false) || (typeof $upper_limit == 'string' && !/^(?:=|true|false)/i.test($upper_limit) ? (tmp = calc.parse(0, 0, 0, $upper_limit), /^date|number|percent$/.test(tmp.type) ? ($upper_limit = +tmp.value, true) : false) : false) || $upper_limit == null)) {\n                  if ($upper_limit instanceof CalcError)\n                      return $upper_limit;\n                  return new CalcError(err);\n              }\n              xargs.push($upper_limit);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (ll, ul) {\n      if (ul == null) {\n          return ERF(ll);\n      }\n      return ERF(ul) - ERF(ll);\n  });\n\n  defineBuiltinFunction('ERFC', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), ERFC);\n\n  defineBuiltinFunction('GAMMALN', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x > 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), GAMMALN);\n\n  defineBuiltinFunction('GAMMA', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), GAMMA);\n\n  defineBuiltinFunction('GAMMA.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $beta = args[i++];\n              if ($beta instanceof CalcError)\n                  return $beta;\n              if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                  if ($beta instanceof CalcError)\n                      return $beta;\n                  return new CalcError(err);\n              }\n              xargs.push($beta);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), GAMMA_DIST);\n\n  defineBuiltinFunction('GAMMA.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $beta = args[i++];\n              if ($beta instanceof CalcError)\n                  return $beta;\n              if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                  if ($beta instanceof CalcError)\n                      return $beta;\n                  return new CalcError(err);\n              }\n              xargs.push($beta);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), GAMMA_INV);\n\n  defineBuiltinFunction('NORM.S.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $z = args[i++];\n              if ($z instanceof CalcError)\n                  return $z;\n              if (!((typeof ($z = this.force($z)) == 'number' ? ($z = limitPrecision($z), true) : false) || (typeof $z == 'boolean' ? ($z = +$z, true) : false) || (typeof $z == 'string' && !/^(?:=|true|false)/i.test($z) ? (tmp = calc.parse(0, 0, 0, $z), /^date|number|percent$/.test(tmp.type) ? ($z = +tmp.value, true) : false) : false))) {\n                  if ($z instanceof CalcError)\n                      return $z;\n                  return new CalcError(err);\n              }\n              xargs.push($z);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NORM_S_DIST);\n\n  defineBuiltinFunction('NORM.S.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NORM_S_INV);\n\n  defineBuiltinFunction('NORM.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $mean = args[i++];\n              if ($mean instanceof CalcError)\n                  return $mean;\n              if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                  if ($mean instanceof CalcError)\n                      return $mean;\n                  return new CalcError(err);\n              }\n              xargs.push($mean);\n          }\n          {\n              var $stddev = args[i++];\n              if ($stddev instanceof CalcError)\n                  return $stddev;\n              if (!(((typeof ($stddev = this.force($stddev)) == 'number' ? ($stddev = limitPrecision($stddev), true) : false) || (typeof $stddev == 'boolean' ? ($stddev = +$stddev, true) : false) || (typeof $stddev == 'string' && !/^(?:=|true|false)/i.test($stddev) ? (tmp = calc.parse(0, 0, 0, $stddev), /^date|number|percent$/.test(tmp.type) ? ($stddev = +tmp.value, true) : false) : false)) && ($stddev > 0 ? true : (err = 'NUM', false)))) {\n                  if ($stddev instanceof CalcError)\n                      return $stddev;\n                  return new CalcError(err);\n              }\n              xargs.push($stddev);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NORM_DIST);\n\n  defineBuiltinFunction('NORM.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $mean = args[i++];\n              if ($mean instanceof CalcError)\n                  return $mean;\n              if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                  if ($mean instanceof CalcError)\n                      return $mean;\n                  return new CalcError(err);\n              }\n              xargs.push($mean);\n          }\n          {\n              var $stddev = args[i++];\n              if ($stddev instanceof CalcError)\n                  return $stddev;\n              if (!(((typeof ($stddev = this.force($stddev)) == 'number' ? ($stddev = limitPrecision($stddev), true) : false) || (typeof $stddev == 'boolean' ? ($stddev = +$stddev, true) : false) || (typeof $stddev == 'string' && !/^(?:=|true|false)/i.test($stddev) ? (tmp = calc.parse(0, 0, 0, $stddev), /^date|number|percent$/.test(tmp.type) ? ($stddev = +tmp.value, true) : false) : false)) && ($stddev > 0 ? true : (err = 'NUM', false)))) {\n                  if ($stddev instanceof CalcError)\n                      return $stddev;\n                  return new CalcError(err);\n              }\n              xargs.push($stddev);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NORM_INV);\n\n  defineBuiltinFunction('BETADIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $beta = args[i++];\n              if ($beta instanceof CalcError)\n                  return $beta;\n              if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                  if ($beta instanceof CalcError)\n                      return $beta;\n                  return new CalcError(err);\n              }\n              xargs.push($beta);\n          }\n          {\n              var $A = args[i++];\n              if ($A instanceof CalcError)\n                  return $A;\n              if (!((typeof ($A = this.force($A)) == 'number' ? ($A = limitPrecision($A), true) : false) || (typeof $A == 'boolean' ? ($A = +$A, true) : false) || (typeof $A == 'string' && !/^(?:=|true|false)/i.test($A) ? (tmp = calc.parse(0, 0, 0, $A), /^date|number|percent$/.test(tmp.type) ? ($A = +tmp.value, true) : false) : false) || ($A == null ? ($A = 0, true) : false))) {\n                  if ($A instanceof CalcError)\n                      return $A;\n                  return new CalcError(err);\n              }\n              xargs.push($A);\n          }\n          {\n              var $B = args[i++];\n              if ($B instanceof CalcError)\n                  return $B;\n              if (!((typeof ($B = this.force($B)) == 'number' ? ($B = limitPrecision($B), true) : false) || (typeof $B == 'boolean' ? ($B = +$B, true) : false) || (typeof $B == 'string' && !/^(?:=|true|false)/i.test($B) ? (tmp = calc.parse(0, 0, 0, $B), /^date|number|percent$/.test(tmp.type) ? ($B = +tmp.value, true) : false) : false) || ($B == null ? ($B = 1, true) : false))) {\n                  if ($B instanceof CalcError)\n                      return $B;\n                  return new CalcError(err);\n              }\n              xargs.push($B);\n          }\n          {\n              if (!($x >= $A ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($x <= $B ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($A < $B ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), BETADIST);\n\n  defineBuiltinFunction('BETA.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $beta = args[i++];\n              if ($beta instanceof CalcError)\n                  return $beta;\n              if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                  if ($beta instanceof CalcError)\n                      return $beta;\n                  return new CalcError(err);\n              }\n              xargs.push($beta);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          {\n              var $A = args[i++];\n              if ($A instanceof CalcError)\n                  return $A;\n              if (!((typeof ($A = this.force($A)) == 'number' ? ($A = limitPrecision($A), true) : false) || (typeof $A == 'boolean' ? ($A = +$A, true) : false) || (typeof $A == 'string' && !/^(?:=|true|false)/i.test($A) ? (tmp = calc.parse(0, 0, 0, $A), /^date|number|percent$/.test(tmp.type) ? ($A = +tmp.value, true) : false) : false) || ($A == null ? ($A = 0, true) : false))) {\n                  if ($A instanceof CalcError)\n                      return $A;\n                  return new CalcError(err);\n              }\n              xargs.push($A);\n          }\n          {\n              var $B = args[i++];\n              if ($B instanceof CalcError)\n                  return $B;\n              if (!((typeof ($B = this.force($B)) == 'number' ? ($B = limitPrecision($B), true) : false) || (typeof $B == 'boolean' ? ($B = +$B, true) : false) || (typeof $B == 'string' && !/^(?:=|true|false)/i.test($B) ? (tmp = calc.parse(0, 0, 0, $B), /^date|number|percent$/.test(tmp.type) ? ($B = +tmp.value, true) : false) : false) || ($B == null ? ($B = 1, true) : false))) {\n                  if ($B instanceof CalcError)\n                      return $B;\n                  return new CalcError(err);\n              }\n              xargs.push($B);\n          }\n          {\n              if (!($x >= $A ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($x <= $B ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($A < $B ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), BETA_DIST);\n\n  defineBuiltinFunction('BETA.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $beta = args[i++];\n              if ($beta instanceof CalcError)\n                  return $beta;\n              if (!(((typeof ($beta = this.force($beta)) == 'number' ? ($beta = limitPrecision($beta), true) : false) || (typeof $beta == 'boolean' ? ($beta = +$beta, true) : false) || (typeof $beta == 'string' && !/^(?:=|true|false)/i.test($beta) ? (tmp = calc.parse(0, 0, 0, $beta), /^date|number|percent$/.test(tmp.type) ? ($beta = +tmp.value, true) : false) : false)) && ($beta > 0 ? true : (err = 'NUM', false)))) {\n                  if ($beta instanceof CalcError)\n                      return $beta;\n                  return new CalcError(err);\n              }\n              xargs.push($beta);\n          }\n          {\n              var $A = args[i++];\n              if ($A instanceof CalcError)\n                  return $A;\n              if (!((typeof ($A = this.force($A)) == 'number' ? ($A = limitPrecision($A), true) : false) || (typeof $A == 'boolean' ? ($A = +$A, true) : false) || (typeof $A == 'string' && !/^(?:=|true|false)/i.test($A) ? (tmp = calc.parse(0, 0, 0, $A), /^date|number|percent$/.test(tmp.type) ? ($A = +tmp.value, true) : false) : false) || ($A == null ? ($A = 0, true) : false))) {\n                  if ($A instanceof CalcError)\n                      return $A;\n                  return new CalcError(err);\n              }\n              xargs.push($A);\n          }\n          {\n              var $B = args[i++];\n              if ($B instanceof CalcError)\n                  return $B;\n              if (!((typeof ($B = this.force($B)) == 'number' ? ($B = limitPrecision($B), true) : false) || (typeof $B == 'boolean' ? ($B = +$B, true) : false) || (typeof $B == 'string' && !/^(?:=|true|false)/i.test($B) ? (tmp = calc.parse(0, 0, 0, $B), /^date|number|percent$/.test(tmp.type) ? ($B = +tmp.value, true) : false) : false) || ($B == null ? ($B = 1, true) : false))) {\n                  if ($B instanceof CalcError)\n                      return $B;\n                  return new CalcError(err);\n              }\n              xargs.push($B);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), BETA_INV);\n\n  defineBuiltinFunction('CHISQ.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), chisq_left);\n\n  defineBuiltinFunction('CHISQ.DIST.RT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), chisq_right);\n\n  defineBuiltinFunction('CHISQ.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), chisq_left_inv);\n\n  defineBuiltinFunction('CHISQ.INV.RT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), chisq_right_inv);\n\n  defineBuiltinFunction('CHISQ.TEST', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $actual_range = args[i++];\n              if ($actual_range instanceof CalcError)\n                  return $actual_range;\n              if (!((m = this.asMatrix($actual_range)) ? $actual_range = m : false)) {\n                  if ($actual_range instanceof CalcError)\n                      return $actual_range;\n                  return new CalcError(err);\n              }\n              xargs.push($actual_range);\n          }\n          {\n              var $expected_range = args[i++];\n              if ($expected_range instanceof CalcError)\n                  return $expected_range;\n              if (!((m = this.asMatrix($expected_range)) ? $expected_range = m : false)) {\n                  if ($expected_range instanceof CalcError)\n                      return $expected_range;\n                  return new CalcError(err);\n              }\n              xargs.push($expected_range);\n          }\n          {\n              if (!($actual_range.width == $expected_range.width ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($actual_range.height == $expected_range.height ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), function (ac, ex) {\n      return chisq_test(ac.data, ex.data);\n  });\n\n  defineBuiltinFunction('EXPON.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $lambda = args[i++];\n              if ($lambda instanceof CalcError)\n                  return $lambda;\n              if (!(((typeof ($lambda = this.force($lambda)) == 'number' ? ($lambda = limitPrecision($lambda), true) : false) || (typeof $lambda == 'boolean' ? ($lambda = +$lambda, true) : false) || (typeof $lambda == 'string' && !/^(?:=|true|false)/i.test($lambda) ? (tmp = calc.parse(0, 0, 0, $lambda), /^date|number|percent$/.test(tmp.type) ? ($lambda = +tmp.value, true) : false) : false)) && ($lambda > 0 ? true : (err = 'NUM', false)))) {\n                  if ($lambda instanceof CalcError)\n                      return $lambda;\n                  return new CalcError(err);\n              }\n              xargs.push($lambda);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), expon);\n\n  defineBuiltinFunction('POISSON.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && (($x |= 0) >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $mean = args[i++];\n              if ($mean instanceof CalcError)\n                  return $mean;\n              if (!(((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false)) && ($mean >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($mean instanceof CalcError)\n                      return $mean;\n                  return new CalcError(err);\n              }\n              xargs.push($mean);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), poisson);\n\n  defineBuiltinFunction('F.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom1 = args[i++];\n              if ($deg_freedom1 instanceof CalcError)\n                  return $deg_freedom1;\n              if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom1 instanceof CalcError)\n                      return $deg_freedom1;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom1);\n          }\n          {\n              var $deg_freedom2 = args[i++];\n              if ($deg_freedom2 instanceof CalcError)\n                  return $deg_freedom2;\n              if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom2 instanceof CalcError)\n                      return $deg_freedom2;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom2);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Fdist);\n\n  defineBuiltinFunction('F.DIST.RT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom1 = args[i++];\n              if ($deg_freedom1 instanceof CalcError)\n                  return $deg_freedom1;\n              if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom1 instanceof CalcError)\n                      return $deg_freedom1;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom1);\n          }\n          {\n              var $deg_freedom2 = args[i++];\n              if ($deg_freedom2 instanceof CalcError)\n                  return $deg_freedom2;\n              if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom2 instanceof CalcError)\n                      return $deg_freedom2;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom2);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Fdist_right);\n\n  defineBuiltinFunction('F.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $deg_freedom1 = args[i++];\n              if ($deg_freedom1 instanceof CalcError)\n                  return $deg_freedom1;\n              if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom1 instanceof CalcError)\n                      return $deg_freedom1;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom1);\n          }\n          {\n              var $deg_freedom2 = args[i++];\n              if ($deg_freedom2 instanceof CalcError)\n                  return $deg_freedom2;\n              if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom2 instanceof CalcError)\n                      return $deg_freedom2;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom2);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Finv);\n\n  defineBuiltinFunction('F.INV.RT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p >= 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $deg_freedom1 = args[i++];\n              if ($deg_freedom1 instanceof CalcError)\n                  return $deg_freedom1;\n              if (!((typeof ($deg_freedom1 = this.force($deg_freedom1)) == 'number' || (typeof $deg_freedom1 == 'boolean' ? ($deg_freedom1 = +$deg_freedom1, true) : false) || (typeof $deg_freedom1 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom1) ? (tmp = calc.parse(0, 0, 0, $deg_freedom1), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom1 = +tmp.value, true) : false) : false)) && (($deg_freedom1 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom1 instanceof CalcError)\n                      return $deg_freedom1;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom1);\n          }\n          {\n              var $deg_freedom2 = args[i++];\n              if ($deg_freedom2 instanceof CalcError)\n                  return $deg_freedom2;\n              if (!((typeof ($deg_freedom2 = this.force($deg_freedom2)) == 'number' || (typeof $deg_freedom2 == 'boolean' ? ($deg_freedom2 = +$deg_freedom2, true) : false) || (typeof $deg_freedom2 == 'string' && !/^(?:=|true|false)/i.test($deg_freedom2) ? (tmp = calc.parse(0, 0, 0, $deg_freedom2), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom2 = +tmp.value, true) : false) : false)) && (($deg_freedom2 |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom2 instanceof CalcError)\n                      return $deg_freedom2;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom2);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Finv_right);\n\n  defineBuiltinFunction('F.TEST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                      if ($array1 instanceof CalcError)\n                          throw $array1;\n                      if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                          ret.push($array1);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array1);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                      if ($array2 instanceof CalcError)\n                          throw $array2;\n                      if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                          ret.push($array2);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array2);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($array1.length >= 2 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($array2.length >= 2 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Ftest);\n\n  defineBuiltinFunction('FISHER', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x > -1 && $x < 1 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), fisher);\n\n  defineBuiltinFunction('FISHERINV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $y = args[i++];\n              if ($y instanceof CalcError)\n                  return $y;\n              if (!((typeof ($y = this.force($y)) == 'number' ? ($y = limitPrecision($y), true) : false) || (typeof $y == 'boolean' ? ($y = +$y, true) : false) || (typeof $y == 'string' && !/^(?:=|true|false)/i.test($y) ? (tmp = calc.parse(0, 0, 0, $y), /^date|number|percent$/.test(tmp.type) ? ($y = +tmp.value, true) : false) : false))) {\n                  if ($y instanceof CalcError)\n                      return $y;\n                  return new CalcError(err);\n              }\n              xargs.push($y);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), fisherinv);\n\n  defineBuiltinFunction('T.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Tdist);\n\n  defineBuiltinFunction('T.DIST.RT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Tdist_right);\n\n  defineBuiltinFunction('T.DIST.2T', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Tdist_2tail);\n\n  defineBuiltinFunction('T.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p > 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Tdist_inv);\n\n  defineBuiltinFunction('T.INV.2T', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $p = args[i++];\n              if ($p instanceof CalcError)\n                  return $p;\n              if (!(((typeof ($p = this.force($p)) == 'number' ? ($p = limitPrecision($p), true) : false) || (typeof $p == 'boolean' ? ($p = +$p, true) : false) || (typeof $p == 'string' && !/^(?:=|true|false)/i.test($p) ? (tmp = calc.parse(0, 0, 0, $p), /^date|number|percent$/.test(tmp.type) ? ($p = +tmp.value, true) : false) : false)) && ($p > 0 && $p <= 1 ? true : (err = 'NUM', false)))) {\n                  if ($p instanceof CalcError)\n                      return $p;\n                  return new CalcError(err);\n              }\n              xargs.push($p);\n          }\n          {\n              var $deg_freedom = args[i++];\n              if ($deg_freedom instanceof CalcError)\n                  return $deg_freedom;\n              if (!((typeof ($deg_freedom = this.force($deg_freedom)) == 'number' || (typeof $deg_freedom == 'boolean' ? ($deg_freedom = +$deg_freedom, true) : false) || (typeof $deg_freedom == 'string' && !/^(?:=|true|false)/i.test($deg_freedom) ? (tmp = calc.parse(0, 0, 0, $deg_freedom), /^date|number|percent$/.test(tmp.type) ? ($deg_freedom = +tmp.value, true) : false) : false)) && (($deg_freedom |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($deg_freedom instanceof CalcError)\n                      return $deg_freedom;\n                  return new CalcError(err);\n              }\n              xargs.push($deg_freedom);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Tdist_2tail_inv);\n\n  defineBuiltinFunction('T.TEST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array1 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array1) {\n                      if ($array1 instanceof CalcError)\n                          throw $array1;\n                      if ((typeof $array1 == 'number' ? ($array1 = limitPrecision($array1), true) : false) || (typeof $array1 == 'boolean' ? ($array1 = +$array1, true) : false) || (typeof $array1 == 'string' && !/^(?:=|true|false)/i.test($array1) ? (tmp = calc.parse(0, 0, 0, $array1), /^date|number|percent$/.test(tmp.type) ? ($array1 = +tmp.value, true) : false) : false))\n                          ret.push($array1);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array1);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $array2 = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $array2) {\n                      if ($array2 instanceof CalcError)\n                          throw $array2;\n                      if ((typeof $array2 == 'number' ? ($array2 = limitPrecision($array2), true) : false) || (typeof $array2 == 'boolean' ? ($array2 = +$array2, true) : false) || (typeof $array2 == 'string' && !/^(?:=|true|false)/i.test($array2) ? (tmp = calc.parse(0, 0, 0, $array2), /^date|number|percent$/.test(tmp.type) ? ($array2 = +tmp.value, true) : false) : false))\n                          ret.push($array2);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array2);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $tails = args[i++];\n              if ($tails instanceof CalcError)\n                  return $tails;\n              if (!((typeof ($tails = this.force($tails)) == 'number' || (typeof $tails == 'boolean' ? ($tails = +$tails, true) : false) || (typeof $tails == 'string' && !/^(?:=|true|false)/i.test($tails) ? (tmp = calc.parse(0, 0, 0, $tails), /^date|number|percent$/.test(tmp.type) ? ($tails = +tmp.value, true) : false) : false)) && ($tails |= 0, true) && ($tails === 1 || $tails === 2))) {\n                  if ($tails instanceof CalcError)\n                      return $tails;\n                  return new CalcError(err);\n              }\n              xargs.push($tails);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!((typeof ($type = this.force($type)) == 'number' || (typeof $type == 'boolean' ? ($type = +$type, true) : false) || (typeof $type == 'string' && !/^(?:=|true|false)/i.test($type) ? (tmp = calc.parse(0, 0, 0, $type), /^date|number|percent$/.test(tmp.type) ? ($type = +tmp.value, true) : false) : false)) && ($type |= 0, true) && ($type === 1 || $type === 2 || $type === 3))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              if (!($type != 1 || $array1.length == $array2.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($array1.length >= 2 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($array2.length >= 2 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), Tdist_test);\n\n  defineBuiltinFunction('CONFIDENCE.T', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 && $alpha < 1 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $standard_dev = args[i++];\n              if ($standard_dev instanceof CalcError)\n                  return $standard_dev;\n              if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                  if ($standard_dev instanceof CalcError)\n                      return $standard_dev;\n                  return new CalcError(err);\n              }\n              xargs.push($standard_dev);\n          }\n          {\n              var $size = args[i++];\n              if ($size instanceof CalcError)\n                  return $size;\n              if (!((typeof ($size = this.force($size)) == 'number' || (typeof $size == 'boolean' ? ($size = +$size, true) : false) || (typeof $size == 'string' && !/^(?:=|true|false)/i.test($size) ? (tmp = calc.parse(0, 0, 0, $size), /^date|number|percent$/.test(tmp.type) ? ($size = +tmp.value, true) : false) : false)) && (($size |= 0) > 0 ? true : (err = 'NUM', false)) && ($size != 1 ? true : (err = 'DIV/0', false)))) {\n                  if ($size instanceof CalcError)\n                      return $size;\n                  return new CalcError(err);\n              }\n              xargs.push($size);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), confidence_t);\n\n  defineBuiltinFunction('CONFIDENCE.NORM', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $alpha = args[i++];\n              if ($alpha instanceof CalcError)\n                  return $alpha;\n              if (!(((typeof ($alpha = this.force($alpha)) == 'number' ? ($alpha = limitPrecision($alpha), true) : false) || (typeof $alpha == 'boolean' ? ($alpha = +$alpha, true) : false) || (typeof $alpha == 'string' && !/^(?:=|true|false)/i.test($alpha) ? (tmp = calc.parse(0, 0, 0, $alpha), /^date|number|percent$/.test(tmp.type) ? ($alpha = +tmp.value, true) : false) : false)) && ($alpha > 0 && $alpha < 1 ? true : (err = 'NUM', false)))) {\n                  if ($alpha instanceof CalcError)\n                      return $alpha;\n                  return new CalcError(err);\n              }\n              xargs.push($alpha);\n          }\n          {\n              var $standard_dev = args[i++];\n              if ($standard_dev instanceof CalcError)\n                  return $standard_dev;\n              if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                  if ($standard_dev instanceof CalcError)\n                      return $standard_dev;\n                  return new CalcError(err);\n              }\n              xargs.push($standard_dev);\n          }\n          {\n              var $size = args[i++];\n              if ($size instanceof CalcError)\n                  return $size;\n              if (!((typeof ($size = this.force($size)) == 'number' || (typeof $size == 'boolean' ? ($size = +$size, true) : false) || (typeof $size == 'string' && !/^(?:=|true|false)/i.test($size) ? (tmp = calc.parse(0, 0, 0, $size), /^date|number|percent$/.test(tmp.type) ? ($size = +tmp.value, true) : false) : false)) && (($size |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($size instanceof CalcError)\n                      return $size;\n                  return new CalcError(err);\n              }\n              xargs.push($size);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), confidence_norm);\n\n  defineBuiltinFunction('GAUSS', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $z = args[i++];\n              if ($z instanceof CalcError)\n                  return $z;\n              if (!((typeof ($z = this.force($z)) == 'number' ? ($z = limitPrecision($z), true) : false) || (typeof $z == 'boolean' ? ($z = +$z, true) : false) || (typeof $z == 'string' && !/^(?:=|true|false)/i.test($z) ? (tmp = calc.parse(0, 0, 0, $z), /^date|number|percent$/.test(tmp.type) ? ($z = +tmp.value, true) : false) : false))) {\n                  if ($z instanceof CalcError)\n                      return $z;\n                  return new CalcError(err);\n              }\n              xargs.push($z);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), gauss);\n\n  defineBuiltinFunction('PHI', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), phi);\n\n  defineBuiltinFunction('LOGNORM.DIST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!(((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false)) && ($x > 0 ? true : (err = 'NUM', false)))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              var $mean = args[i++];\n              if ($mean instanceof CalcError)\n                  return $mean;\n              if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                  if ($mean instanceof CalcError)\n                      return $mean;\n                  return new CalcError(err);\n              }\n              xargs.push($mean);\n          }\n          {\n              var $standard_dev = args[i++];\n              if ($standard_dev instanceof CalcError)\n                  return $standard_dev;\n              if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                  if ($standard_dev instanceof CalcError)\n                      return $standard_dev;\n                  return new CalcError(err);\n              }\n              xargs.push($standard_dev);\n          }\n          {\n              var $cumulative = args[i++];\n              if ($cumulative instanceof CalcError)\n                  return $cumulative;\n              if (!(typeof ($cumulative = this.force($cumulative)) == 'boolean' || (typeof $cumulative == 'number' ? ($cumulative = !!$cumulative, true) : false))) {\n                  if ($cumulative instanceof CalcError)\n                      return $cumulative;\n                  return new CalcError(err);\n              }\n              xargs.push($cumulative);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), lognorm_dist);\n\n  defineBuiltinFunction('LOGNORM.INV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $probability = args[i++];\n              if ($probability instanceof CalcError)\n                  return $probability;\n              if (!(((typeof ($probability = this.force($probability)) == 'number' ? ($probability = limitPrecision($probability), true) : false) || (typeof $probability == 'boolean' ? ($probability = +$probability, true) : false) || (typeof $probability == 'string' && !/^(?:=|true|false)/i.test($probability) ? (tmp = calc.parse(0, 0, 0, $probability), /^date|number|percent$/.test(tmp.type) ? ($probability = +tmp.value, true) : false) : false)) && ($probability > 0 && $probability < 1 ? true : (err = 'NUM', false)))) {\n                  if ($probability instanceof CalcError)\n                      return $probability;\n                  return new CalcError(err);\n              }\n              xargs.push($probability);\n          }\n          {\n              var $mean = args[i++];\n              if ($mean instanceof CalcError)\n                  return $mean;\n              if (!((typeof ($mean = this.force($mean)) == 'number' ? ($mean = limitPrecision($mean), true) : false) || (typeof $mean == 'boolean' ? ($mean = +$mean, true) : false) || (typeof $mean == 'string' && !/^(?:=|true|false)/i.test($mean) ? (tmp = calc.parse(0, 0, 0, $mean), /^date|number|percent$/.test(tmp.type) ? ($mean = +tmp.value, true) : false) : false))) {\n                  if ($mean instanceof CalcError)\n                      return $mean;\n                  return new CalcError(err);\n              }\n              xargs.push($mean);\n          }\n          {\n              var $standard_dev = args[i++];\n              if ($standard_dev instanceof CalcError)\n                  return $standard_dev;\n              if (!(((typeof ($standard_dev = this.force($standard_dev)) == 'number' ? ($standard_dev = limitPrecision($standard_dev), true) : false) || (typeof $standard_dev == 'boolean' ? ($standard_dev = +$standard_dev, true) : false) || (typeof $standard_dev == 'string' && !/^(?:=|true|false)/i.test($standard_dev) ? (tmp = calc.parse(0, 0, 0, $standard_dev), /^date|number|percent$/.test(tmp.type) ? ($standard_dev = +tmp.value, true) : false) : false)) && ($standard_dev > 0 ? true : (err = 'NUM', false)))) {\n                  if ($standard_dev instanceof CalcError)\n                      return $standard_dev;\n                  return new CalcError(err);\n              }\n              xargs.push($standard_dev);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), lognorm_inv);\n\n  defineBuiltinFunction('PROB', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $x_range = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $x_range) {\n                      if ($x_range instanceof CalcError)\n                          throw $x_range;\n                      if ((typeof $x_range == 'number' ? ($x_range = limitPrecision($x_range), true) : false) || (typeof $x_range == 'boolean' ? ($x_range = +$x_range, true) : false) || (typeof $x_range == 'string' && !/^(?:=|true|false)/i.test($x_range) ? (tmp = calc.parse(0, 0, 0, $x_range), /^date|number|percent$/.test(tmp.type) ? ($x_range = +tmp.value, true) : false) : false))\n                          ret.push($x_range);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($x_range);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $prob_range = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $prob_range) {\n                      if ($prob_range instanceof CalcError)\n                          throw $prob_range;\n                      if ((typeof $prob_range == 'number' ? ($prob_range = limitPrecision($prob_range), true) : false) || (typeof $prob_range == 'boolean' ? ($prob_range = +$prob_range, true) : false) || (typeof $prob_range == 'string' && !/^(?:=|true|false)/i.test($prob_range) ? (tmp = calc.parse(0, 0, 0, $prob_range), /^date|number|percent$/.test(tmp.type) ? ($prob_range = +tmp.value, true) : false) : false))\n                          ret.push($prob_range);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($prob_range);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $lower_limit = args[i++];\n              if ($lower_limit instanceof CalcError)\n                  return $lower_limit;\n              if (!((typeof ($lower_limit = this.force($lower_limit)) == 'number' ? ($lower_limit = limitPrecision($lower_limit), true) : false) || (typeof $lower_limit == 'boolean' ? ($lower_limit = +$lower_limit, true) : false) || (typeof $lower_limit == 'string' && !/^(?:=|true|false)/i.test($lower_limit) ? (tmp = calc.parse(0, 0, 0, $lower_limit), /^date|number|percent$/.test(tmp.type) ? ($lower_limit = +tmp.value, true) : false) : false))) {\n                  if ($lower_limit instanceof CalcError)\n                      return $lower_limit;\n                  return new CalcError(err);\n              }\n              xargs.push($lower_limit);\n          }\n          {\n              var $upper_limit = args[i++];\n              if ($upper_limit instanceof CalcError)\n                  return $upper_limit;\n              if (!((typeof ($upper_limit = this.force($upper_limit)) == 'number' ? ($upper_limit = limitPrecision($upper_limit), true) : false) || (typeof $upper_limit == 'boolean' ? ($upper_limit = +$upper_limit, true) : false) || (typeof $upper_limit == 'string' && !/^(?:=|true|false)/i.test($upper_limit) ? (tmp = calc.parse(0, 0, 0, $upper_limit), /^date|number|percent$/.test(tmp.type) ? ($upper_limit = +tmp.value, true) : false) : false) || ($upper_limit == null ? ($upper_limit = $lower_limit, true) : false))) {\n                  if ($upper_limit instanceof CalcError)\n                      return $upper_limit;\n                  return new CalcError(err);\n              }\n              xargs.push($upper_limit);\n          }\n          {\n              if (!($prob_range.length == $x_range.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), prob);\n\n  defineBuiltinFunction('SLOPE', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                      if ($known_y instanceof CalcError)\n                          throw $known_y;\n                      if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                          ret.push($known_y);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_y);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                      if ($known_x instanceof CalcError)\n                          throw $known_x;\n                      if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                          ret.push($known_x);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_x);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), slope);\n\n  defineBuiltinFunction('INTERCEPT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                      if ($known_y instanceof CalcError)\n                          throw $known_y;\n                      if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                          ret.push($known_y);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_y);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                      if ($known_x instanceof CalcError)\n                          throw $known_x;\n                      if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                          ret.push($known_x);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_x);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), intercept);\n\n  defineBuiltinFunction('PEARSON', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $array1 = this.cellValues(args.slice(i, i + 1), true).reduce(function (ret, $array1) {\n                      if ($array1 instanceof CalcError)\n                          throw $array1;\n                      if (i <= args.length)\n                          ret.push($array1);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array1);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $array2 = this.cellValues(args.slice(i, i + 1), true).reduce(function (ret, $array2) {\n                      if ($array2 instanceof CalcError)\n                          throw $array2;\n                      if (i <= args.length)\n                          ret.push($array2);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($array2);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($array2.length == $array1.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($array2.length > 0 && $array1.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), pearson);\n\n  defineBuiltinFunction('RSQ', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                      if ($known_y instanceof CalcError)\n                          throw $known_y;\n                      if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                          ret.push($known_y);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_y);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                      if ($known_x instanceof CalcError)\n                          throw $known_x;\n                      if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                          ret.push($known_x);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_x);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($known_x.length != 1 && $known_y.length != 1 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), rsq);\n\n  defineBuiltinFunction('STEYX', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                      if ($known_y instanceof CalcError)\n                          throw $known_y;\n                      if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                          ret.push($known_y);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_y);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                      if ($known_x instanceof CalcError)\n                          throw $known_x;\n                      if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                          ret.push($known_x);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_x);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($known_x.length >= 3 && $known_y.length >= 3 ? true : (err = 'DIV/0', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), steyx);\n\n  defineBuiltinFunction('FORECAST', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $x = args[i++];\n              if ($x instanceof CalcError)\n                  return $x;\n              if (!((typeof ($x = this.force($x)) == 'number' ? ($x = limitPrecision($x), true) : false) || (typeof $x == 'boolean' ? ($x = +$x, true) : false) || (typeof $x == 'string' && !/^(?:=|true|false)/i.test($x) ? (tmp = calc.parse(0, 0, 0, $x), /^date|number|percent$/.test(tmp.type) ? ($x = +tmp.value, true) : false) : false))) {\n                  if ($x instanceof CalcError)\n                      return $x;\n                  return new CalcError(err);\n              }\n              xargs.push($x);\n          }\n          {\n              try {\n                  var $known_y = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_y) {\n                      if ($known_y instanceof CalcError)\n                          throw $known_y;\n                      if ((typeof $known_y == 'number' ? ($known_y = limitPrecision($known_y), true) : false) || (typeof $known_y == 'boolean' ? ($known_y = +$known_y, true) : false) || (typeof $known_y == 'string' && !/^(?:=|true|false)/i.test($known_y) ? (tmp = calc.parse(0, 0, 0, $known_y), /^date|number|percent$/.test(tmp.type) ? ($known_y = +tmp.value, true) : false) : false))\n                          ret.push($known_y);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_y);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $known_x = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $known_x) {\n                      if ($known_x instanceof CalcError)\n                          throw $known_x;\n                      if ((typeof $known_x == 'number' ? ($known_x = limitPrecision($known_x), true) : false) || (typeof $known_x == 'boolean' ? ($known_x = +$known_x, true) : false) || (typeof $known_x == 'string' && !/^(?:=|true|false)/i.test($known_x) ? (tmp = calc.parse(0, 0, 0, $known_x), /^date|number|percent$/.test(tmp.type) ? ($known_x = +tmp.value, true) : false) : false))\n                          ret.push($known_x);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($known_x);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($known_x.length == $known_y.length ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          {\n              if (!($known_x.length > 0 && $known_y.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), forecast);\n\n  defineBuiltinFunction('LINEST', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $known_y = args[i++];\n              if ($known_y instanceof CalcError)\n                  return $known_y;\n              if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                  if ($known_y instanceof CalcError)\n                      return $known_y;\n                  return new CalcError(err);\n              }\n              xargs.push($known_y);\n          }\n          {\n              var $known_x = args[i++];\n              if ($known_x instanceof CalcError)\n                  return $known_x;\n              if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                  if ($known_x instanceof CalcError)\n                      return $known_x;\n                  return new CalcError(err);\n              }\n              xargs.push($known_x);\n          }\n          {\n              var $const = args[i++];\n              if ($const instanceof CalcError)\n                  return $const;\n              if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                  if ($const instanceof CalcError)\n                      return $const;\n                  return new CalcError(err);\n              }\n              xargs.push($const);\n          }\n          {\n              var $stats = args[i++];\n              if ($stats instanceof CalcError)\n                  return $stats;\n              if (!(typeof ($stats = this.force($stats)) == 'boolean' || (typeof $stats == 'number' ? ($stats = !!$stats, true) : false) || ($stats == null ? ($stats = false, true) : false))) {\n                  if ($stats instanceof CalcError)\n                      return $stats;\n                  return new CalcError(err);\n              }\n              xargs.push($stats);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), linest);\n\n  defineBuiltinFunction('LOGEST', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $known_y = args[i++];\n              if ($known_y instanceof CalcError)\n                  return $known_y;\n              if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                  if ($known_y instanceof CalcError)\n                      return $known_y;\n                  return new CalcError(err);\n              }\n              xargs.push($known_y);\n          }\n          {\n              var $known_x = args[i++];\n              if ($known_x instanceof CalcError)\n                  return $known_x;\n              if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                  if ($known_x instanceof CalcError)\n                      return $known_x;\n                  return new CalcError(err);\n              }\n              xargs.push($known_x);\n          }\n          {\n              var $const = args[i++];\n              if ($const instanceof CalcError)\n                  return $const;\n              if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                  if ($const instanceof CalcError)\n                      return $const;\n                  return new CalcError(err);\n              }\n              xargs.push($const);\n          }\n          {\n              var $stats = args[i++];\n              if ($stats instanceof CalcError)\n                  return $stats;\n              if (!(typeof ($stats = this.force($stats)) == 'boolean' || (typeof $stats == 'number' ? ($stats = !!$stats, true) : false) || ($stats == null ? ($stats = false, true) : false))) {\n                  if ($stats instanceof CalcError)\n                      return $stats;\n                  return new CalcError(err);\n              }\n              xargs.push($stats);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), logest);\n\n  defineBuiltinFunction('TREND', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $known_y = args[i++];\n              if ($known_y instanceof CalcError)\n                  return $known_y;\n              if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                  if ($known_y instanceof CalcError)\n                      return $known_y;\n                  return new CalcError(err);\n              }\n              xargs.push($known_y);\n          }\n          {\n              var $known_x = args[i++];\n              if ($known_x instanceof CalcError)\n                  return $known_x;\n              if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                  if ($known_x instanceof CalcError)\n                      return $known_x;\n                  return new CalcError(err);\n              }\n              xargs.push($known_x);\n          }\n          {\n              var $new_x = args[i++];\n              if ($new_x instanceof CalcError)\n                  return $new_x;\n              if (!(((m = this.asMatrix($new_x)) ? $new_x = m : false) || $new_x == null)) {\n                  if ($new_x instanceof CalcError)\n                      return $new_x;\n                  return new CalcError(err);\n              }\n              xargs.push($new_x);\n          }\n          {\n              var $const = args[i++];\n              if ($const instanceof CalcError)\n                  return $const;\n              if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                  if ($const instanceof CalcError)\n                      return $const;\n                  return new CalcError(err);\n              }\n              xargs.push($const);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), trend);\n\n  defineBuiltinFunction('GROWTH', false, function () {\n      function check(args) {\n          var xargs = [], i = 0, m, err = 'VALUE';\n          {\n              var $known_y = args[i++];\n              if ($known_y instanceof CalcError)\n                  return $known_y;\n              if (!((m = this.asMatrix($known_y)) ? $known_y = m : false)) {\n                  if ($known_y instanceof CalcError)\n                      return $known_y;\n                  return new CalcError(err);\n              }\n              xargs.push($known_y);\n          }\n          {\n              var $known_x = args[i++];\n              if ($known_x instanceof CalcError)\n                  return $known_x;\n              if (!(((m = this.asMatrix($known_x)) ? $known_x = m : false) || $known_x == null)) {\n                  if ($known_x instanceof CalcError)\n                      return $known_x;\n                  return new CalcError(err);\n              }\n              xargs.push($known_x);\n          }\n          {\n              var $new_x = args[i++];\n              if ($new_x instanceof CalcError)\n                  return $new_x;\n              if (!(((m = this.asMatrix($new_x)) ? $new_x = m : false) || $new_x == null)) {\n                  if ($new_x instanceof CalcError)\n                      return $new_x;\n                  return new CalcError(err);\n              }\n              xargs.push($new_x);\n          }\n          {\n              var $const = args[i++];\n              if ($const instanceof CalcError)\n                  return $const;\n              if (!(typeof ($const = this.force($const)) == 'boolean' || (typeof $const == 'number' ? ($const = !!$const, true) : false) || ($const == null ? ($const = true, true) : false))) {\n                  if ($const instanceof CalcError)\n                      return $const;\n                  return new CalcError(err);\n              }\n              xargs.push($const);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), growth);\n\n  defineBuiltinFunction('FV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pmt = args[i++];\n              if ($pmt instanceof CalcError)\n                  return $pmt;\n              if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false) || ($pmt == null ? ($pmt = 0, true) : false))) {\n                  if ($pmt instanceof CalcError)\n                      return $pmt;\n                  return new CalcError(err);\n              }\n              xargs.push($pmt);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false) || ($pv == null ? ($pv = 0, true) : false))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              if (!($pmt || $pv ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), FV);\n\n  defineBuiltinFunction('PV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pmt = args[i++];\n              if ($pmt instanceof CalcError)\n                  return $pmt;\n              if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false) || ($pmt == null ? ($pmt = 0, true) : false))) {\n                  if ($pmt instanceof CalcError)\n                      return $pmt;\n                  return new CalcError(err);\n              }\n              xargs.push($pmt);\n          }\n          {\n              var $fv = args[i++];\n              if ($fv instanceof CalcError)\n                  return $fv;\n              if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                  if ($fv instanceof CalcError)\n                      return $fv;\n                  return new CalcError(err);\n              }\n              xargs.push($fv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), PV);\n\n  defineBuiltinFunction('PMT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pmt = args[i++];\n              if ($pmt instanceof CalcError)\n                  return $pmt;\n              if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false))) {\n                  if ($pmt instanceof CalcError)\n                      return $pmt;\n                  return new CalcError(err);\n              }\n              xargs.push($pmt);\n          }\n          {\n              var $fv = args[i++];\n              if ($fv instanceof CalcError)\n                  return $fv;\n              if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                  if ($fv instanceof CalcError)\n                      return $fv;\n                  return new CalcError(err);\n              }\n              xargs.push($fv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), PMT);\n\n  defineBuiltinFunction('NPER', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $pmt = args[i++];\n              if ($pmt instanceof CalcError)\n                  return $pmt;\n              if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false))) {\n                  if ($pmt instanceof CalcError)\n                      return $pmt;\n                  return new CalcError(err);\n              }\n              xargs.push($pmt);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $fv = args[i++];\n              if ($fv instanceof CalcError)\n                  return $fv;\n              if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                  if ($fv instanceof CalcError)\n                      return $fv;\n                  return new CalcError(err);\n              }\n              xargs.push($fv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NPER);\n\n  defineBuiltinFunction('RATE', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pmt = args[i++];\n              if ($pmt instanceof CalcError)\n                  return $pmt;\n              if (!((typeof ($pmt = this.force($pmt)) == 'number' ? ($pmt = limitPrecision($pmt), true) : false) || (typeof $pmt == 'boolean' ? ($pmt = +$pmt, true) : false) || (typeof $pmt == 'string' && !/^(?:=|true|false)/i.test($pmt) ? (tmp = calc.parse(0, 0, 0, $pmt), /^date|number|percent$/.test(tmp.type) ? ($pmt = +tmp.value, true) : false) : false) || ($pmt == null ? ($pmt = 0, true) : false))) {\n                  if ($pmt instanceof CalcError)\n                      return $pmt;\n                  return new CalcError(err);\n              }\n              xargs.push($pmt);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $fv = args[i++];\n              if ($fv instanceof CalcError)\n                  return $fv;\n              if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                  if ($fv instanceof CalcError)\n                      return $fv;\n                  return new CalcError(err);\n              }\n              xargs.push($fv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              var $guess = args[i++];\n              if ($guess instanceof CalcError)\n                  return $guess;\n              if (!(((typeof ($guess = this.force($guess)) == 'number' ? ($guess = limitPrecision($guess), true) : false) || (typeof $guess == 'boolean' ? ($guess = +$guess, true) : false) || (typeof $guess == 'string' && !/^(?:=|true|false)/i.test($guess) ? (tmp = calc.parse(0, 0, 0, $guess), /^date|number|percent$/.test(tmp.type) ? ($guess = +tmp.value, true) : false) : false)) && ($guess > 0 ? true : (err = 'NUM', false)) || ($guess == null ? ($guess = 0.01, true) : false))) {\n                  if ($guess instanceof CalcError)\n                      return $guess;\n                  return new CalcError(err);\n              }\n              xargs.push($guess);\n          }\n          {\n              if (!($pmt || $fv ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), RATE);\n\n  defineBuiltinFunction('IPMT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $per = args[i++];\n              if ($per instanceof CalcError)\n                  return $per;\n              if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                  if ($per instanceof CalcError)\n                      return $per;\n                  return new CalcError(err);\n              }\n              xargs.push($per);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $fv = args[i++];\n              if ($fv instanceof CalcError)\n                  return $fv;\n              if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                  if ($fv instanceof CalcError)\n                      return $fv;\n                  return new CalcError(err);\n              }\n              xargs.push($fv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              if (!($per >= 1 && $per <= $nper ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), IPMT);\n\n  defineBuiltinFunction('PPMT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $per = args[i++];\n              if ($per instanceof CalcError)\n                  return $per;\n              if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                  if ($per instanceof CalcError)\n                      return $per;\n                  return new CalcError(err);\n              }\n              xargs.push($per);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $fv = args[i++];\n              if ($fv instanceof CalcError)\n                  return $fv;\n              if (!((typeof ($fv = this.force($fv)) == 'number' ? ($fv = limitPrecision($fv), true) : false) || (typeof $fv == 'boolean' ? ($fv = +$fv, true) : false) || (typeof $fv == 'string' && !/^(?:=|true|false)/i.test($fv) ? (tmp = calc.parse(0, 0, 0, $fv), /^date|number|percent$/.test(tmp.type) ? ($fv = +tmp.value, true) : false) : false) || ($fv == null ? ($fv = 0, true) : false))) {\n                  if ($fv instanceof CalcError)\n                      return $fv;\n                  return new CalcError(err);\n              }\n              xargs.push($fv);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              if (!($per >= 1 && $per <= $nper ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), PPMT);\n\n  defineBuiltinFunction('CUMPRINC', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!(((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false)) && ($pv > 0 ? true : (err = 'NUM', false)))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $start_period = args[i++];\n              if ($start_period instanceof CalcError)\n                  return $start_period;\n              if (!(((typeof ($start_period = this.force($start_period)) == 'number' ? ($start_period = limitPrecision($start_period), true) : false) || (typeof $start_period == 'boolean' ? ($start_period = +$start_period, true) : false) || (typeof $start_period == 'string' && !/^(?:=|true|false)/i.test($start_period) ? (tmp = calc.parse(0, 0, 0, $start_period), /^date|number|percent$/.test(tmp.type) ? ($start_period = +tmp.value, true) : false) : false)) && ($start_period > 0 ? true : (err = 'NUM', false)))) {\n                  if ($start_period instanceof CalcError)\n                      return $start_period;\n                  return new CalcError(err);\n              }\n              xargs.push($start_period);\n          }\n          {\n              var $end_period = args[i++];\n              if ($end_period instanceof CalcError)\n                  return $end_period;\n              if (!(((typeof ($end_period = this.force($end_period)) == 'number' ? ($end_period = limitPrecision($end_period), true) : false) || (typeof $end_period == 'boolean' ? ($end_period = +$end_period, true) : false) || (typeof $end_period == 'string' && !/^(?:=|true|false)/i.test($end_period) ? (tmp = calc.parse(0, 0, 0, $end_period), /^date|number|percent$/.test(tmp.type) ? ($end_period = +tmp.value, true) : false) : false)) && ($end_period > 0 ? true : (err = 'NUM', false)))) {\n                  if ($end_period instanceof CalcError)\n                      return $end_period;\n                  return new CalcError(err);\n              }\n              xargs.push($end_period);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              if (!($end_period >= $start_period ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), CUMPRINC);\n\n  defineBuiltinFunction('CUMIPMT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!(((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false)) && ($pv > 0 ? true : (err = 'NUM', false)))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              var $start_period = args[i++];\n              if ($start_period instanceof CalcError)\n                  return $start_period;\n              if (!(((typeof ($start_period = this.force($start_period)) == 'number' ? ($start_period = limitPrecision($start_period), true) : false) || (typeof $start_period == 'boolean' ? ($start_period = +$start_period, true) : false) || (typeof $start_period == 'string' && !/^(?:=|true|false)/i.test($start_period) ? (tmp = calc.parse(0, 0, 0, $start_period), /^date|number|percent$/.test(tmp.type) ? ($start_period = +tmp.value, true) : false) : false)) && ($start_period > 0 ? true : (err = 'NUM', false)))) {\n                  if ($start_period instanceof CalcError)\n                      return $start_period;\n                  return new CalcError(err);\n              }\n              xargs.push($start_period);\n          }\n          {\n              var $end_period = args[i++];\n              if ($end_period instanceof CalcError)\n                  return $end_period;\n              if (!(((typeof ($end_period = this.force($end_period)) == 'number' ? ($end_period = limitPrecision($end_period), true) : false) || (typeof $end_period == 'boolean' ? ($end_period = +$end_period, true) : false) || (typeof $end_period == 'string' && !/^(?:=|true|false)/i.test($end_period) ? (tmp = calc.parse(0, 0, 0, $end_period), /^date|number|percent$/.test(tmp.type) ? ($end_period = +tmp.value, true) : false) : false)) && ($end_period > 0 ? true : (err = 'NUM', false)))) {\n                  if ($end_period instanceof CalcError)\n                      return $end_period;\n                  return new CalcError(err);\n              }\n              xargs.push($end_period);\n          }\n          {\n              var $type = args[i++];\n              if ($type instanceof CalcError)\n                  return $type;\n              if (!(($type = this.force($type)) === 0 || $type === 1 || ($type == null ? ($type = 0, true) : false))) {\n                  if ($type instanceof CalcError)\n                      return $type;\n                  return new CalcError(err);\n              }\n              xargs.push($type);\n          }\n          {\n              if (!($end_period >= $start_period ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), CUMIPMT);\n\n  defineBuiltinFunction('NPV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i)).reduce(function (ret, $values) {\n                      if ($values instanceof CalcError)\n                          throw $values;\n                      if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i = args.length;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($values.length > 0 ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NPV);\n\n  defineBuiltinFunction('IRR', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $values) {\n                      if ($values instanceof CalcError)\n                          throw $values;\n                      if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $guess = args[i++];\n              if ($guess instanceof CalcError)\n                  return $guess;\n              if (!((typeof ($guess = this.force($guess)) == 'number' ? ($guess = limitPrecision($guess), true) : false) || (typeof $guess == 'boolean' ? ($guess = +$guess, true) : false) || (typeof $guess == 'string' && !/^(?:=|true|false)/i.test($guess) ? (tmp = calc.parse(0, 0, 0, $guess), /^date|number|percent$/.test(tmp.type) ? ($guess = +tmp.value, true) : false) : false) || ($guess == null ? ($guess = 0.1, true) : false))) {\n                  if ($guess instanceof CalcError)\n                      return $guess;\n                  return new CalcError(err);\n              }\n              xargs.push($guess);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), IRR);\n\n  defineBuiltinFunction('EFFECT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $nominal_rate = args[i++];\n              if ($nominal_rate instanceof CalcError)\n                  return $nominal_rate;\n              if (!(((typeof ($nominal_rate = this.force($nominal_rate)) == 'number' ? ($nominal_rate = limitPrecision($nominal_rate), true) : false) || (typeof $nominal_rate == 'boolean' ? ($nominal_rate = +$nominal_rate, true) : false) || (typeof $nominal_rate == 'string' && !/^(?:=|true|false)/i.test($nominal_rate) ? (tmp = calc.parse(0, 0, 0, $nominal_rate), /^date|number|percent$/.test(tmp.type) ? ($nominal_rate = +tmp.value, true) : false) : false)) && ($nominal_rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nominal_rate instanceof CalcError)\n                      return $nominal_rate;\n                  return new CalcError(err);\n              }\n              xargs.push($nominal_rate);\n          }\n          {\n              var $npery = args[i++];\n              if ($npery instanceof CalcError)\n                  return $npery;\n              if (!((typeof ($npery = this.force($npery)) == 'number' || (typeof $npery == 'boolean' ? ($npery = +$npery, true) : false) || (typeof $npery == 'string' && !/^(?:=|true|false)/i.test($npery) ? (tmp = calc.parse(0, 0, 0, $npery), /^date|number|percent$/.test(tmp.type) ? ($npery = +tmp.value, true) : false) : false)) && (($npery |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($npery instanceof CalcError)\n                      return $npery;\n                  return new CalcError(err);\n              }\n              xargs.push($npery);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), EFFECT);\n\n  defineBuiltinFunction('NOMINAL', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $effect_rate = args[i++];\n              if ($effect_rate instanceof CalcError)\n                  return $effect_rate;\n              if (!(((typeof ($effect_rate = this.force($effect_rate)) == 'number' ? ($effect_rate = limitPrecision($effect_rate), true) : false) || (typeof $effect_rate == 'boolean' ? ($effect_rate = +$effect_rate, true) : false) || (typeof $effect_rate == 'string' && !/^(?:=|true|false)/i.test($effect_rate) ? (tmp = calc.parse(0, 0, 0, $effect_rate), /^date|number|percent$/.test(tmp.type) ? ($effect_rate = +tmp.value, true) : false) : false)) && ($effect_rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($effect_rate instanceof CalcError)\n                      return $effect_rate;\n                  return new CalcError(err);\n              }\n              xargs.push($effect_rate);\n          }\n          {\n              var $npery = args[i++];\n              if ($npery instanceof CalcError)\n                  return $npery;\n              if (!((typeof ($npery = this.force($npery)) == 'number' || (typeof $npery == 'boolean' ? ($npery = +$npery, true) : false) || (typeof $npery == 'string' && !/^(?:=|true|false)/i.test($npery) ? (tmp = calc.parse(0, 0, 0, $npery), /^date|number|percent$/.test(tmp.type) ? ($npery = +tmp.value, true) : false) : false)) && (($npery |= 0) > 0 ? true : (err = 'NUM', false)))) {\n                  if ($npery instanceof CalcError)\n                      return $npery;\n                  return new CalcError(err);\n              }\n              xargs.push($npery);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), NOMINAL);\n\n  defineBuiltinFunction('XNPV', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $values) {\n                      if ($values instanceof CalcError)\n                          throw $values;\n                      if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $dates = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $dates) {\n                      if ($dates instanceof CalcError)\n                          throw $dates;\n                      if ((typeof $dates == 'number' || (typeof $dates == 'boolean' ? ($dates = +$dates, true) : false) || (typeof $dates == 'string' && !/^(?:=|true|false)/i.test($dates) ? (tmp = calc.parse(0, 0, 0, $dates), /^date|number|percent$/.test(tmp.type) ? ($dates = +tmp.value, true) : false) : false)) && ($dates |= 0, true))\n                          ret.push($dates);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($dates);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              if (!($values.length == $dates.length ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), XNPV);\n\n  defineBuiltinFunction('XIRR', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              try {\n                  var $values = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $values) {\n                      if ($values instanceof CalcError)\n                          throw $values;\n                      if ((typeof $values == 'number' ? ($values = limitPrecision($values), true) : false) || (typeof $values == 'boolean' ? ($values = +$values, true) : false) || (typeof $values == 'string' && !/^(?:=|true|false)/i.test($values) ? (tmp = calc.parse(0, 0, 0, $values), /^date|number|percent$/.test(tmp.type) ? ($values = +tmp.value, true) : false) : false))\n                          ret.push($values);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($values);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              try {\n                  var $dates = this.cellValues(args.slice(i, i + 1)).reduce(function (ret, $dates) {\n                      if ($dates instanceof CalcError)\n                          throw $dates;\n                      if ((typeof $dates == 'number' || (typeof $dates == 'boolean' ? ($dates = +$dates, true) : false) || (typeof $dates == 'string' && !/^(?:=|true|false)/i.test($dates) ? (tmp = calc.parse(0, 0, 0, $dates), /^date|number|percent$/.test(tmp.type) ? ($dates = +tmp.value, true) : false) : false)) && ($dates |= 0, true))\n                          ret.push($dates);\n                      return ret;\n                  }.bind(this), []);\n                  i += 1;\n                  xargs.push($dates);\n              } catch (ex) {\n                  if (ex instanceof CalcError)\n                      return ex;\n                  throw ex;\n              }\n          }\n          {\n              var $guess = args[i++];\n              if ($guess instanceof CalcError)\n                  return $guess;\n              if (!((typeof ($guess = this.force($guess)) == 'number' ? ($guess = limitPrecision($guess), true) : false) || (typeof $guess == 'boolean' ? ($guess = +$guess, true) : false) || (typeof $guess == 'string' && !/^(?:=|true|false)/i.test($guess) ? (tmp = calc.parse(0, 0, 0, $guess), /^date|number|percent$/.test(tmp.type) ? ($guess = +tmp.value, true) : false) : false) || ($guess == null ? ($guess = 0.1, true) : false))) {\n                  if ($guess instanceof CalcError)\n                      return $guess;\n                  return new CalcError(err);\n              }\n              xargs.push($guess);\n          }\n          {\n              if (!($values.length == $dates.length ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args.slice(i));\n          toResolve.push(args.slice(i));\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), XIRR);\n\n  defineBuiltinFunction('ISPMT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $per = args[i++];\n              if ($per instanceof CalcError)\n                  return $per;\n              if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                  if ($per instanceof CalcError)\n                      return $per;\n                  return new CalcError(err);\n              }\n              xargs.push($per);\n          }\n          {\n              var $nper = args[i++];\n              if ($nper instanceof CalcError)\n                  return $nper;\n              if (!(((typeof ($nper = this.force($nper)) == 'number' ? ($nper = limitPrecision($nper), true) : false) || (typeof $nper == 'boolean' ? ($nper = +$nper, true) : false) || (typeof $nper == 'string' && !/^(?:=|true|false)/i.test($nper) ? (tmp = calc.parse(0, 0, 0, $nper), /^date|number|percent$/.test(tmp.type) ? ($nper = +tmp.value, true) : false) : false)) && ($nper > 0 ? true : (err = 'NUM', false)))) {\n                  if ($nper instanceof CalcError)\n                      return $nper;\n                  return new CalcError(err);\n              }\n              xargs.push($nper);\n          }\n          {\n              var $pv = args[i++];\n              if ($pv instanceof CalcError)\n                  return $pv;\n              if (!((typeof ($pv = this.force($pv)) == 'number' ? ($pv = limitPrecision($pv), true) : false) || (typeof $pv == 'boolean' ? ($pv = +$pv, true) : false) || (typeof $pv == 'string' && !/^(?:=|true|false)/i.test($pv) ? (tmp = calc.parse(0, 0, 0, $pv), /^date|number|percent$/.test(tmp.type) ? ($pv = +tmp.value, true) : false) : false))) {\n                  if ($pv instanceof CalcError)\n                      return $pv;\n                  return new CalcError(err);\n              }\n              xargs.push($pv);\n          }\n          {\n              if (!($per >= 1 && $per <= $nper ? true : (err = 'N/A', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), ISPMT);\n\n  defineBuiltinFunction('DB', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $cost = args[i++];\n              if ($cost instanceof CalcError)\n                  return $cost;\n              if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                  if ($cost instanceof CalcError)\n                      return $cost;\n                  return new CalcError(err);\n              }\n              xargs.push($cost);\n          }\n          {\n              var $salvage = args[i++];\n              if ($salvage instanceof CalcError)\n                  return $salvage;\n              if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                  if ($salvage instanceof CalcError)\n                      return $salvage;\n                  return new CalcError(err);\n              }\n              xargs.push($salvage);\n          }\n          {\n              var $life = args[i++];\n              if ($life instanceof CalcError)\n                  return $life;\n              if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                  if ($life instanceof CalcError)\n                      return $life;\n                  return new CalcError(err);\n              }\n              xargs.push($life);\n          }\n          {\n              var $period = args[i++];\n              if ($period instanceof CalcError)\n                  return $period;\n              if (!(((typeof ($period = this.force($period)) == 'number' ? ($period = limitPrecision($period), true) : false) || (typeof $period == 'boolean' ? ($period = +$period, true) : false) || (typeof $period == 'string' && !/^(?:=|true|false)/i.test($period) ? (tmp = calc.parse(0, 0, 0, $period), /^date|number|percent$/.test(tmp.type) ? ($period = +tmp.value, true) : false) : false)) && ($period > 0 ? true : (err = 'NUM', false)))) {\n                  if ($period instanceof CalcError)\n                      return $period;\n                  return new CalcError(err);\n              }\n              xargs.push($period);\n          }\n          {\n              var $month = args[i++];\n              if ($month instanceof CalcError)\n                  return $month;\n              if (!((typeof ($month = this.force($month)) == 'number' ? ($month = limitPrecision($month), true) : false) || (typeof $month == 'boolean' ? ($month = +$month, true) : false) || (typeof $month == 'string' && !/^(?:=|true|false)/i.test($month) ? (tmp = calc.parse(0, 0, 0, $month), /^date|number|percent$/.test(tmp.type) ? ($month = +tmp.value, true) : false) : false) || ($month == null ? ($month = 12, true) : false))) {\n                  if ($month instanceof CalcError)\n                      return $month;\n                  return new CalcError(err);\n              }\n              xargs.push($month);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), DB);\n\n  defineBuiltinFunction('DDB', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $cost = args[i++];\n              if ($cost instanceof CalcError)\n                  return $cost;\n              if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                  if ($cost instanceof CalcError)\n                      return $cost;\n                  return new CalcError(err);\n              }\n              xargs.push($cost);\n          }\n          {\n              var $salvage = args[i++];\n              if ($salvage instanceof CalcError)\n                  return $salvage;\n              if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                  if ($salvage instanceof CalcError)\n                      return $salvage;\n                  return new CalcError(err);\n              }\n              xargs.push($salvage);\n          }\n          {\n              var $life = args[i++];\n              if ($life instanceof CalcError)\n                  return $life;\n              if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                  if ($life instanceof CalcError)\n                      return $life;\n                  return new CalcError(err);\n              }\n              xargs.push($life);\n          }\n          {\n              var $period = args[i++];\n              if ($period instanceof CalcError)\n                  return $period;\n              if (!(((typeof ($period = this.force($period)) == 'number' ? ($period = limitPrecision($period), true) : false) || (typeof $period == 'boolean' ? ($period = +$period, true) : false) || (typeof $period == 'string' && !/^(?:=|true|false)/i.test($period) ? (tmp = calc.parse(0, 0, 0, $period), /^date|number|percent$/.test(tmp.type) ? ($period = +tmp.value, true) : false) : false)) && ($period > 0 ? true : (err = 'NUM', false)))) {\n                  if ($period instanceof CalcError)\n                      return $period;\n                  return new CalcError(err);\n              }\n              xargs.push($period);\n          }\n          {\n              var $factor = args[i++];\n              if ($factor instanceof CalcError)\n                  return $factor;\n              if (!((typeof ($factor = this.force($factor)) == 'number' ? ($factor = limitPrecision($factor), true) : false) || (typeof $factor == 'boolean' ? ($factor = +$factor, true) : false) || (typeof $factor == 'string' && !/^(?:=|true|false)/i.test($factor) ? (tmp = calc.parse(0, 0, 0, $factor), /^date|number|percent$/.test(tmp.type) ? ($factor = +tmp.value, true) : false) : false) || ($factor == null ? ($factor = 2, true) : false))) {\n                  if ($factor instanceof CalcError)\n                      return $factor;\n                  return new CalcError(err);\n              }\n              xargs.push($factor);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), DDB);\n\n  defineBuiltinFunction('SLN', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $cost = args[i++];\n              if ($cost instanceof CalcError)\n                  return $cost;\n              if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                  if ($cost instanceof CalcError)\n                      return $cost;\n                  return new CalcError(err);\n              }\n              xargs.push($cost);\n          }\n          {\n              var $salvage = args[i++];\n              if ($salvage instanceof CalcError)\n                  return $salvage;\n              if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                  if ($salvage instanceof CalcError)\n                      return $salvage;\n                  return new CalcError(err);\n              }\n              xargs.push($salvage);\n          }\n          {\n              var $life = args[i++];\n              if ($life instanceof CalcError)\n                  return $life;\n              if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                  if ($life instanceof CalcError)\n                      return $life;\n                  return new CalcError(err);\n              }\n              xargs.push($life);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), SLN);\n\n  defineBuiltinFunction('SYD', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $cost = args[i++];\n              if ($cost instanceof CalcError)\n                  return $cost;\n              if (!((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false))) {\n                  if ($cost instanceof CalcError)\n                      return $cost;\n                  return new CalcError(err);\n              }\n              xargs.push($cost);\n          }\n          {\n              var $salvage = args[i++];\n              if ($salvage instanceof CalcError)\n                  return $salvage;\n              if (!((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false))) {\n                  if ($salvage instanceof CalcError)\n                      return $salvage;\n                  return new CalcError(err);\n              }\n              xargs.push($salvage);\n          }\n          {\n              var $life = args[i++];\n              if ($life instanceof CalcError)\n                  return $life;\n              if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                  if ($life instanceof CalcError)\n                      return $life;\n                  return new CalcError(err);\n              }\n              xargs.push($life);\n          }\n          {\n              var $per = args[i++];\n              if ($per instanceof CalcError)\n                  return $per;\n              if (!(((typeof ($per = this.force($per)) == 'number' ? ($per = limitPrecision($per), true) : false) || (typeof $per == 'boolean' ? ($per = +$per, true) : false) || (typeof $per == 'string' && !/^(?:=|true|false)/i.test($per) ? (tmp = calc.parse(0, 0, 0, $per), /^date|number|percent$/.test(tmp.type) ? ($per = +tmp.value, true) : false) : false)) && ($per > 0 ? true : (err = 'NUM', false)))) {\n                  if ($per instanceof CalcError)\n                      return $per;\n                  return new CalcError(err);\n              }\n              xargs.push($per);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), SYD);\n\n  defineBuiltinFunction('VDB', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $cost = args[i++];\n              if ($cost instanceof CalcError)\n                  return $cost;\n              if (!(((typeof ($cost = this.force($cost)) == 'number' ? ($cost = limitPrecision($cost), true) : false) || (typeof $cost == 'boolean' ? ($cost = +$cost, true) : false) || (typeof $cost == 'string' && !/^(?:=|true|false)/i.test($cost) ? (tmp = calc.parse(0, 0, 0, $cost), /^date|number|percent$/.test(tmp.type) ? ($cost = +tmp.value, true) : false) : false)) && ($cost >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($cost instanceof CalcError)\n                      return $cost;\n                  return new CalcError(err);\n              }\n              xargs.push($cost);\n          }\n          {\n              var $salvage = args[i++];\n              if ($salvage instanceof CalcError)\n                  return $salvage;\n              if (!(((typeof ($salvage = this.force($salvage)) == 'number' ? ($salvage = limitPrecision($salvage), true) : false) || (typeof $salvage == 'boolean' ? ($salvage = +$salvage, true) : false) || (typeof $salvage == 'string' && !/^(?:=|true|false)/i.test($salvage) ? (tmp = calc.parse(0, 0, 0, $salvage), /^date|number|percent$/.test(tmp.type) ? ($salvage = +tmp.value, true) : false) : false)) && ($salvage >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($salvage instanceof CalcError)\n                      return $salvage;\n                  return new CalcError(err);\n              }\n              xargs.push($salvage);\n          }\n          {\n              var $life = args[i++];\n              if ($life instanceof CalcError)\n                  return $life;\n              if (!(((typeof ($life = this.force($life)) == 'number' ? ($life = limitPrecision($life), true) : false) || (typeof $life == 'boolean' ? ($life = +$life, true) : false) || (typeof $life == 'string' && !/^(?:=|true|false)/i.test($life) ? (tmp = calc.parse(0, 0, 0, $life), /^date|number|percent$/.test(tmp.type) ? ($life = +tmp.value, true) : false) : false)) && ($life > 0 ? true : (err = 'NUM', false)))) {\n                  if ($life instanceof CalcError)\n                      return $life;\n                  return new CalcError(err);\n              }\n              xargs.push($life);\n          }\n          {\n              var $start_period = args[i++];\n              if ($start_period instanceof CalcError)\n                  return $start_period;\n              if (!(((typeof ($start_period = this.force($start_period)) == 'number' ? ($start_period = limitPrecision($start_period), true) : false) || (typeof $start_period == 'boolean' ? ($start_period = +$start_period, true) : false) || (typeof $start_period == 'string' && !/^(?:=|true|false)/i.test($start_period) ? (tmp = calc.parse(0, 0, 0, $start_period), /^date|number|percent$/.test(tmp.type) ? ($start_period = +tmp.value, true) : false) : false)) && ($start_period >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($start_period instanceof CalcError)\n                      return $start_period;\n                  return new CalcError(err);\n              }\n              xargs.push($start_period);\n          }\n          {\n              var $end_period = args[i++];\n              if ($end_period instanceof CalcError)\n                  return $end_period;\n              if (!(((typeof ($end_period = this.force($end_period)) == 'number' ? ($end_period = limitPrecision($end_period), true) : false) || (typeof $end_period == 'boolean' ? ($end_period = +$end_period, true) : false) || (typeof $end_period == 'string' && !/^(?:=|true|false)/i.test($end_period) ? (tmp = calc.parse(0, 0, 0, $end_period), /^date|number|percent$/.test(tmp.type) ? ($end_period = +tmp.value, true) : false) : false)) && ($end_period >= 0 ? true : (err = 'NUM', false)))) {\n                  if ($end_period instanceof CalcError)\n                      return $end_period;\n                  return new CalcError(err);\n              }\n              xargs.push($end_period);\n          }\n          {\n              var $factor = args[i++];\n              if ($factor instanceof CalcError)\n                  return $factor;\n              if (!(((typeof ($factor = this.force($factor)) == 'number' ? ($factor = limitPrecision($factor), true) : false) || (typeof $factor == 'boolean' ? ($factor = +$factor, true) : false) || (typeof $factor == 'string' && !/^(?:=|true|false)/i.test($factor) ? (tmp = calc.parse(0, 0, 0, $factor), /^date|number|percent$/.test(tmp.type) ? ($factor = +tmp.value, true) : false) : false)) && ($factor >= 0 ? true : (err = 'NUM', false)) || ($factor == null ? ($factor = 2, true) : false))) {\n                  if ($factor instanceof CalcError)\n                      return $factor;\n                  return new CalcError(err);\n              }\n              xargs.push($factor);\n          }\n          {\n              var $no_switch = args[i++];\n              if ($no_switch instanceof CalcError)\n                  return $no_switch;\n              if (!(typeof ($no_switch = this.force($no_switch)) == 'boolean' || (typeof $no_switch == 'number' ? ($no_switch = !!$no_switch, true) : false) || ($no_switch == null ? ($no_switch = false, true) : false))) {\n                  if ($no_switch instanceof CalcError)\n                      return $no_switch;\n                  return new CalcError(err);\n              }\n              xargs.push($no_switch);\n          }\n          {\n              if (!($end_period >= $start_period ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), VDB);\n\n  defineBuiltinFunction('COUPDAYBS', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), COUPDAYBS);\n\n  defineBuiltinFunction('COUPDAYS', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), COUPDAYS);\n\n  defineBuiltinFunction('COUPDAYSNC', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), COUPDAYSNC);\n\n  defineBuiltinFunction('COUPPCD', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), COUPPCD);\n\n  defineBuiltinFunction('COUPNCD', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), COUPNCD);\n\n  defineBuiltinFunction('COUPNUM', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), COUPNUM);\n\n  defineBuiltinFunction('ACCRINTM', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $issue = args[i++];\n              if ($issue instanceof CalcError)\n                  return $issue;\n              if (!((typeof ($issue = this.force($issue)) == 'number' || (typeof $issue == 'boolean' ? ($issue = +$issue, true) : false) || (typeof $issue == 'string' && !/^(?:=|true|false)/i.test($issue) ? (tmp = calc.parse(0, 0, 0, $issue), /^date|number|percent$/.test(tmp.type) ? ($issue = +tmp.value, true) : false) : false)) && ($issue |= 0, true))) {\n                  if ($issue instanceof CalcError)\n                      return $issue;\n                  return new CalcError(err);\n              }\n              xargs.push($issue);\n          }\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $par = args[i++];\n              if ($par instanceof CalcError)\n                  return $par;\n              if (!((($par = this.force($par)) == null ? ($par = 1000, true) : false) || ((typeof $par == 'number' ? ($par = limitPrecision($par), true) : false) || (typeof $par == 'boolean' ? ($par = +$par, true) : false) || (typeof $par == 'string' && !/^(?:=|true|false)/i.test($par) ? (tmp = calc.parse(0, 0, 0, $par), /^date|number|percent$/.test(tmp.type) ? ($par = +tmp.value, true) : false) : false)) && ($par > 0 ? true : (err = 'NUM', false)))) {\n                  if ($par instanceof CalcError)\n                      return $par;\n                  return new CalcError(err);\n              }\n              xargs.push($par);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($issue < $settlement ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), ACCRINTM);\n\n  defineBuiltinFunction('ACCRINT', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $issue = args[i++];\n              if ($issue instanceof CalcError)\n                  return $issue;\n              if (!((typeof ($issue = this.force($issue)) == 'number' || (typeof $issue == 'boolean' ? ($issue = +$issue, true) : false) || (typeof $issue == 'string' && !/^(?:=|true|false)/i.test($issue) ? (tmp = calc.parse(0, 0, 0, $issue), /^date|number|percent$/.test(tmp.type) ? ($issue = +tmp.value, true) : false) : false)) && ($issue |= 0, true))) {\n                  if ($issue instanceof CalcError)\n                      return $issue;\n                  return new CalcError(err);\n              }\n              xargs.push($issue);\n          }\n          {\n              var $first_interest = args[i++];\n              if ($first_interest instanceof CalcError)\n                  return $first_interest;\n              if (!((typeof ($first_interest = this.force($first_interest)) == 'number' || (typeof $first_interest == 'boolean' ? ($first_interest = +$first_interest, true) : false) || (typeof $first_interest == 'string' && !/^(?:=|true|false)/i.test($first_interest) ? (tmp = calc.parse(0, 0, 0, $first_interest), /^date|number|percent$/.test(tmp.type) ? ($first_interest = +tmp.value, true) : false) : false)) && ($first_interest |= 0, true))) {\n                  if ($first_interest instanceof CalcError)\n                      return $first_interest;\n                  return new CalcError(err);\n              }\n              xargs.push($first_interest);\n          }\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $par = args[i++];\n              if ($par instanceof CalcError)\n                  return $par;\n              if (!((($par = this.force($par)) == null ? ($par = 1000, true) : false) || ((typeof $par == 'number' ? ($par = limitPrecision($par), true) : false) || (typeof $par == 'boolean' ? ($par = +$par, true) : false) || (typeof $par == 'string' && !/^(?:=|true|false)/i.test($par) ? (tmp = calc.parse(0, 0, 0, $par), /^date|number|percent$/.test(tmp.type) ? ($par = +tmp.value, true) : false) : false)) && ($par > 0 ? true : (err = 'NUM', false)))) {\n                  if ($par instanceof CalcError)\n                      return $par;\n                  return new CalcError(err);\n              }\n              xargs.push($par);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              var $calc_method = args[i++];\n              if ($calc_method instanceof CalcError)\n                  return $calc_method;\n              if (!(typeof ($calc_method = this.force($calc_method)) == 'boolean' || (typeof $calc_method == 'number' ? ($calc_method = !!$calc_method, true) : false) || ($calc_method == null ? ($calc_method = true, true) : false))) {\n                  if ($calc_method instanceof CalcError)\n                      return $calc_method;\n                  return new CalcError(err);\n              }\n              xargs.push($calc_method);\n          }\n          {\n              if (!($issue < $settlement ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), ACCRINT);\n\n  defineBuiltinFunction('DISC', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $pr = args[i++];\n              if ($pr instanceof CalcError)\n                  return $pr;\n              if (!(((typeof ($pr = this.force($pr)) == 'number' ? ($pr = limitPrecision($pr), true) : false) || (typeof $pr == 'boolean' ? ($pr = +$pr, true) : false) || (typeof $pr == 'string' && !/^(?:=|true|false)/i.test($pr) ? (tmp = calc.parse(0, 0, 0, $pr), /^date|number|percent$/.test(tmp.type) ? ($pr = +tmp.value, true) : false) : false)) && ($pr > 0 ? true : (err = 'NUM', false)))) {\n                  if ($pr instanceof CalcError)\n                      return $pr;\n                  return new CalcError(err);\n              }\n              xargs.push($pr);\n          }\n          {\n              var $redemption = args[i++];\n              if ($redemption instanceof CalcError)\n                  return $redemption;\n              if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                  if ($redemption instanceof CalcError)\n                      return $redemption;\n                  return new CalcError(err);\n              }\n              xargs.push($redemption);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), DISC);\n\n  defineBuiltinFunction('INTRATE', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $investment = args[i++];\n              if ($investment instanceof CalcError)\n                  return $investment;\n              if (!(((typeof ($investment = this.force($investment)) == 'number' ? ($investment = limitPrecision($investment), true) : false) || (typeof $investment == 'boolean' ? ($investment = +$investment, true) : false) || (typeof $investment == 'string' && !/^(?:=|true|false)/i.test($investment) ? (tmp = calc.parse(0, 0, 0, $investment), /^date|number|percent$/.test(tmp.type) ? ($investment = +tmp.value, true) : false) : false)) && ($investment > 0 ? true : (err = 'NUM', false)))) {\n                  if ($investment instanceof CalcError)\n                      return $investment;\n                  return new CalcError(err);\n              }\n              xargs.push($investment);\n          }\n          {\n              var $redemption = args[i++];\n              if ($redemption instanceof CalcError)\n                  return $redemption;\n              if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                  if ($redemption instanceof CalcError)\n                      return $redemption;\n                  return new CalcError(err);\n              }\n              xargs.push($redemption);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), INTRATE);\n\n  defineBuiltinFunction('RECEIVED', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $investment = args[i++];\n              if ($investment instanceof CalcError)\n                  return $investment;\n              if (!(((typeof ($investment = this.force($investment)) == 'number' ? ($investment = limitPrecision($investment), true) : false) || (typeof $investment == 'boolean' ? ($investment = +$investment, true) : false) || (typeof $investment == 'string' && !/^(?:=|true|false)/i.test($investment) ? (tmp = calc.parse(0, 0, 0, $investment), /^date|number|percent$/.test(tmp.type) ? ($investment = +tmp.value, true) : false) : false)) && ($investment > 0 ? true : (err = 'NUM', false)))) {\n                  if ($investment instanceof CalcError)\n                      return $investment;\n                  return new CalcError(err);\n              }\n              xargs.push($investment);\n          }\n          {\n              var $discount = args[i++];\n              if ($discount instanceof CalcError)\n                  return $discount;\n              if (!(((typeof ($discount = this.force($discount)) == 'number' ? ($discount = limitPrecision($discount), true) : false) || (typeof $discount == 'boolean' ? ($discount = +$discount, true) : false) || (typeof $discount == 'string' && !/^(?:=|true|false)/i.test($discount) ? (tmp = calc.parse(0, 0, 0, $discount), /^date|number|percent$/.test(tmp.type) ? ($discount = +tmp.value, true) : false) : false)) && ($discount > 0 ? true : (err = 'NUM', false)))) {\n                  if ($discount instanceof CalcError)\n                      return $discount;\n                  return new CalcError(err);\n              }\n              xargs.push($discount);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), RECEIVED);\n\n  defineBuiltinFunction('PRICE', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $rate = args[i++];\n              if ($rate instanceof CalcError)\n                  return $rate;\n              if (!(((typeof ($rate = this.force($rate)) == 'number' ? ($rate = limitPrecision($rate), true) : false) || (typeof $rate == 'boolean' ? ($rate = +$rate, true) : false) || (typeof $rate == 'string' && !/^(?:=|true|false)/i.test($rate) ? (tmp = calc.parse(0, 0, 0, $rate), /^date|number|percent$/.test(tmp.type) ? ($rate = +tmp.value, true) : false) : false)) && ($rate > 0 ? true : (err = 'NUM', false)))) {\n                  if ($rate instanceof CalcError)\n                      return $rate;\n                  return new CalcError(err);\n              }\n              xargs.push($rate);\n          }\n          {\n              var $yld = args[i++];\n              if ($yld instanceof CalcError)\n                  return $yld;\n              if (!(((typeof ($yld = this.force($yld)) == 'number' ? ($yld = limitPrecision($yld), true) : false) || (typeof $yld == 'boolean' ? ($yld = +$yld, true) : false) || (typeof $yld == 'string' && !/^(?:=|true|false)/i.test($yld) ? (tmp = calc.parse(0, 0, 0, $yld), /^date|number|percent$/.test(tmp.type) ? ($yld = +tmp.value, true) : false) : false)) && ($yld > 0 ? true : (err = 'NUM', false)))) {\n                  if ($yld instanceof CalcError)\n                      return $yld;\n                  return new CalcError(err);\n              }\n              xargs.push($yld);\n          }\n          {\n              var $redemption = args[i++];\n              if ($redemption instanceof CalcError)\n                  return $redemption;\n              if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                  if ($redemption instanceof CalcError)\n                      return $redemption;\n                  return new CalcError(err);\n              }\n              xargs.push($redemption);\n          }\n          {\n              var $frequency = args[i++];\n              if ($frequency instanceof CalcError)\n                  return $frequency;\n              if (!((typeof ($frequency = this.force($frequency)) == 'number' || (typeof $frequency == 'boolean' ? ($frequency = +$frequency, true) : false) || (typeof $frequency == 'string' && !/^(?:=|true|false)/i.test($frequency) ? (tmp = calc.parse(0, 0, 0, $frequency), /^date|number|percent$/.test(tmp.type) ? ($frequency = +tmp.value, true) : false) : false)) && ($frequency |= 0, true) && ($frequency === 1 || $frequency === 2 || $frequency === 4))) {\n                  if ($frequency instanceof CalcError)\n                      return $frequency;\n                  return new CalcError(err);\n              }\n              xargs.push($frequency);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), PRICE);\n\n  defineBuiltinFunction('PRICEDISC', false, function () {\n      function check(args) {\n          var tmp, xargs = [], i = 0, err = 'VALUE';\n          {\n              var $settlement = args[i++];\n              if ($settlement instanceof CalcError)\n                  return $settlement;\n              if (!((typeof ($settlement = this.force($settlement)) == 'number' || (typeof $settlement == 'boolean' ? ($settlement = +$settlement, true) : false) || (typeof $settlement == 'string' && !/^(?:=|true|false)/i.test($settlement) ? (tmp = calc.parse(0, 0, 0, $settlement), /^date|number|percent$/.test(tmp.type) ? ($settlement = +tmp.value, true) : false) : false)) && ($settlement |= 0, true))) {\n                  if ($settlement instanceof CalcError)\n                      return $settlement;\n                  return new CalcError(err);\n              }\n              xargs.push($settlement);\n          }\n          {\n              var $maturity = args[i++];\n              if ($maturity instanceof CalcError)\n                  return $maturity;\n              if (!((typeof ($maturity = this.force($maturity)) == 'number' || (typeof $maturity == 'boolean' ? ($maturity = +$maturity, true) : false) || (typeof $maturity == 'string' && !/^(?:=|true|false)/i.test($maturity) ? (tmp = calc.parse(0, 0, 0, $maturity), /^date|number|percent$/.test(tmp.type) ? ($maturity = +tmp.value, true) : false) : false)) && ($maturity |= 0, true))) {\n                  if ($maturity instanceof CalcError)\n                      return $maturity;\n                  return new CalcError(err);\n              }\n              xargs.push($maturity);\n          }\n          {\n              var $discount = args[i++];\n              if ($discount instanceof CalcError)\n                  return $discount;\n              if (!(((typeof ($discount = this.force($discount)) == 'number' ? ($discount = limitPrecision($discount), true) : false) || (typeof $discount == 'boolean' ? ($discount = +$discount, true) : false) || (typeof $discount == 'string' && !/^(?:=|true|false)/i.test($discount) ? (tmp = calc.parse(0, 0, 0, $discount), /^date|number|percent$/.test(tmp.type) ? ($discount = +tmp.value, true) : false) : false)) && ($discount > 0 ? true : (err = 'NUM', false)))) {\n                  if ($discount instanceof CalcError)\n                      return $discount;\n                  return new CalcError(err);\n              }\n              xargs.push($discount);\n          }\n          {\n              var $redemption = args[i++];\n              if ($redemption instanceof CalcError)\n                  return $redemption;\n              if (!(((typeof ($redemption = this.force($redemption)) == 'number' ? ($redemption = limitPrecision($redemption), true) : false) || (typeof $redemption == 'boolean' ? ($redemption = +$redemption, true) : false) || (typeof $redemption == 'string' && !/^(?:=|true|false)/i.test($redemption) ? (tmp = calc.parse(0, 0, 0, $redemption), /^date|number|percent$/.test(tmp.type) ? ($redemption = +tmp.value, true) : false) : false)) && ($redemption > 0 ? true : (err = 'NUM', false)))) {\n                  if ($redemption instanceof CalcError)\n                      return $redemption;\n                  return new CalcError(err);\n              }\n              xargs.push($redemption);\n          }\n          {\n              var $basis = args[i++];\n              if ($basis instanceof CalcError)\n                  return $basis;\n              if (!((($basis = this.force($basis)) == null ? ($basis = 0, true) : false) || (typeof $basis == 'number' || (typeof $basis == 'boolean' ? ($basis = +$basis, true) : false) || (typeof $basis == 'string' && !/^(?:=|true|false)/i.test($basis) ? (tmp = calc.parse(0, 0, 0, $basis), /^date|number|percent$/.test(tmp.type) ? ($basis = +tmp.value, true) : false) : false)) && ($basis |= 0, true) && ($basis === 0 || $basis === 1 || $basis === 2 || $basis === 3 || $basis === 4))) {\n                  if ($basis instanceof CalcError)\n                      return $basis;\n                  return new CalcError(err);\n              }\n              xargs.push($basis);\n          }\n          {\n              if (!($settlement < $maturity ? true : (err = 'NUM', false)))\n                  return new CalcError(err);\n          }\n          if (i < args.length)\n              return new CalcError('N/A');\n          return xargs;\n      }\n      function resolve(args, callback) {\n          var toResolve = [], i = 0;\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          toResolve.push(args[i++]);\n          this.resolveCells(toResolve, callback);\n      }\n      return {\n          check: check,\n          resolve: resolve\n      };\n  }(), PRICEDISC);\n\n  /* -----[ utils ]----- */\n\n  // function resultAsMatrix(f) {\n  //     return function() {\n  //         var a = f.apply(this, arguments);\n  //         return this.asMatrix(a);\n  //     };\n  // }\n\n  /* -----[ definitions: statistical functions ]----- */\n\n  var MAX_IT = 300,     // Maximum allowed number of iterations\n      EPS = 2.2204e-16, // Relative accuracy; 1-3*(4/3-1) = 2.220446049250313e-16\n      FP_MIN = 1.0e-30, // Near the smallest representable as floating-point, number.\n      f_abs = Math.abs;\n\n  function ERF(x) {\n      if (f_abs(x) >= 3.3) {\n          return 1 - ERFC(x);\n      }\n      var S = x > 0 ? 1 : -1;\n      if (S == -1) {\n          x = -x;\n      }\n      var m = 0, an = 1;\n      for (var n = 1; n < 100; n++) {\n          m += an;\n          an *= 2*x*x/(2*n+1);\n      }\n      return S*2/Math.sqrt(Math.PI)*x*Math.exp(-x*x)*m;\n  }\n\n  function ERFC(x) {\n      if (f_abs(x) < 3.3) {\n          return 1 - ERF(x);\n      }\n      var s = 1;\n      if (x < 0) {\n          s = -1;\n          x = -x;\n      }\n      var frac = x;\n      for (var n = 8; n >= 1; n -= 0.5) {\n          frac = x + n/frac;\n      }\n      frac = 1 / (x + frac);\n      return s == 1\n          ? Math.exp(-x*x)/Math.sqrt(Math.PI)*frac\n          : 2 - Math.exp(-x*x)/Math.sqrt(Math.PI)*frac;\n  }\n\n  function GAMMALN(x) { // Returns the value ln[Γ(x)] for x > 0.\n      var cof = [\n          1.000000000190015, 76.18009172947146, -86.50532032941677,\n          24.01409824083091, -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5\n      ];\n      var y = x, tmp = x + 5.5, ser = cof[0];\n      tmp -= (x + 0.5) * Math.log(tmp);\n      for (var j = 1; j <= 6; j++) {\n          y += 1;\n          ser += cof[j] / y;\n      }\n      return -tmp + Math.log(Math.sqrt(2*Math.PI) * ser / x); // log(Γ(x)) = log(Γ(x+1)) - log(x)\n  }\n\n  function GAMMA(x) { // returns Infinity for 0 or negative _integer argument.\n      if (x > 0) {\n          return Math.exp(GAMMALN(x));\n      }\n      var pi = Math.PI, y = -x; // For x<0 we use the reflection formula: Γ(x)Γ(1-x) = PI / sin(PI*x)\n      return -pi / (y*GAMMA(y)*Math.sin(pi*y));\n  }\n\n  function BETALN(a, b) {\n      return GAMMALN(a) + GAMMALN(b) - GAMMALN(a+b);\n  }\n\n  function BETA(a, b) {\n      return Math.exp(BETALN(a, b));\n  }\n\n  function gamma_inc(a, x) { // returns the normalized incomplete gamma function P(a, x); x > 0.\n      return x < a+1.0 ? g_series(a, x) : 1 - g_contfrac(a, x);\n  }\n\n  function g_series(a, x) { // evaluate P(a, x) by its series representation (converges quickly for x < a+1).\n      var sum = 1/a,\n          frac = sum,\n          ap = a;\n      var gln = GAMMALN(a), n;\n      for (n = 1; n <= MAX_IT; n++) {\n          ap++;\n          frac *= x/ap;\n          sum += frac;\n          if (f_abs(frac) < f_abs(sum)*EPS) {\n              break; // already the last frac is too small versus the current sum value\n          }\n      }\n      return sum * Math.exp(-x + a*Math.log(x) - gln); // e^{-x} * x^a * Γ(a) * sum\n  }\n\n  function g_contfrac(a, x) { // Q(a, x) by its continued fraction representation (converges quickly for x > a + 1); modified Lentz’s method (Numerical Recipes (The Art of Scientific Computing), 2rd Edition $5.2)\n      var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n      var gln = GAMMALN(a);\n      for (var i = 1; i <= MAX_IT; i++) {\n          d = bj + aj * d;\n          if (f_abs(d) < FP_MIN) {\n              d = FP_MIN;\n          }\n          c = bj + aj / c;\n          if (f_abs(c) < FP_MIN) {\n              c = FP_MIN;\n          }\n          d = 1 / d;\n          var delta = c * d;\n          f *= delta;\n          if (f_abs(delta - 1) < EPS) {\n              break;\n          }\n          bj += 2;\n          aj = -i * (i - a);\n      }\n      return f * Math.exp(-x - gln + a * Math.log(x));\n  }\n\n  function GAMMA_DIST(x, a, b, cumulative) { // a > 0, b > 0; x >= 0\n      if (!cumulative) {\n          return Math.pow(x/b, a-1)*Math.exp(-x/b)/(b*GAMMA(a)); // the PDF of the Gamma distribution\n      }\n      return gamma_inc(a, x/b); // (else) compute the CDF (using the incomplete Gamma function)\n  }\n\n  function GAMMA_INV(p, a, b) { // the quantile function of the Gamma distribution\n      if (p === 0) {\n          return 0;\n      }\n      if (p == 1) {\n          return Infinity;\n      }\n      var m = 0, M = 10, x = 0, ab = a*b;\n      if (ab > 1) {\n          M *= ab;\n      }\n      for (var i = 0; i < MAX_IT; i++) {\n          x = 0.5*(m + M); // console.log(x);\n          var q = GAMMA_DIST(x, a, b, true);\n          if (f_abs(p - q) < 1e-16) {\n              break;\n          }\n          if (q > p) {\n              M = x;\n          } else {\n              m = x;\n          }\n      }\n      return x;\n  }\n\n  function NORM_S_DIST(x, cumulative) {\n      if (!cumulative) {\n          return Math.exp(-x*x/2)/Math.sqrt(2*Math.PI);\n      }\n      return 0.5 + 0.5*ERF(x/Math.sqrt(2));\n  }\n\n  function NORM_S_INV(p) { // see [1] $26.2.3 and http://home.online.no/~pjacklam/notes/invnorm/#References\n      // Coefficients in rational approximations.\n      var a = [-3.969683028665376e+01, 2.209460984245205e+02,\n               -2.759285104469687e+02, 1.383577518672690e+02,\n               -3.066479806614716e+01, 2.506628277459239e+00],\n          b = [-5.447609879822406e+01, 1.615858368580409e+02,\n               -1.556989798598866e+02, 6.680131188771972e+01,\n               -1.328068155288572e+01],\n          c = [-7.784894002430293e-03, -3.223964580411365e-01,\n               -2.400758277161838e+00, -2.549732539343734e+00,\n               4.374664141464968e+00, 2.938163982698783e+00],\n          d = [ 7.784695709041462e-03, 3.224671290700398e-01,\n                2.445134137142996e+00, 3.754408661907416e+00];\n      // Define break-points.\n      var plow = 0.02425,\n          phigh = 1 - plow;\n      var q, r;\n      // Rational approximation for lower region:\n      if (p < plow) {\n          q = Math.sqrt(-2*Math.log(p));\n          return (((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n      }\n      // Rational approximation for upper region:\n      if (phigh < p) {\n          q = Math.sqrt(-2*Math.log(1-p));\n          return -(((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n      }\n      // Rational approximation for central region:\n      q = p - 0.5;\n      r = q*q;\n      return (((((a[0]*r+a[1])*r+a[2])*r+a[3])*r+a[4])*r+a[5])*q / (((((b[0]*r+b[1])*r+b[2])*r+b[3])*r+b[4])*r+1);\n  }\n\n  function NORM_DIST(x, m, s, cumulative) {\n      if (!cumulative) {\n          return Math.exp(-(x-m)*(x-m)/(2*s*s))/(s*Math.sqrt(2*Math.PI)); // NORM_S_DIST((x-m)/s)/s;\n      }\n      return NORM_S_DIST((x-m)/s, true);\n  }\n\n  function NORM_INV(p, m, s) {\n      return m + s*NORM_S_INV(p);\n  }\n\n  function betastd_pdf(x, a, b) {\n      return Math.exp((a-1)*Math.log(x) + (b-1)*Math.log(1-x) - BETALN(a, b));\n  }\n\n  function betastd_cdf(x, a, b) {\n      var k = Math.exp(a*Math.log(x) + b*Math.log(1-x) - BETALN(a, b));\n      return x < (a+1)/(a+b+2) ? k*beta_lentz(a, b, x)/a : 1 - k*beta_lentz(b, a, 1-x)/b;\n  }\n\n  function beta_lentz(a, b, x) { // estimates continued fraction by modified Lentz’s method ([2] $8.17.22)\n      var m, m2;\n      var aa, c, d, del, h, qab, qam, qap;\n      qab = a + b; // These q’s will be used in factors that occur in the coefficients d_n\n      qap = a + 1;\n      qam = a - 1;\n      c = 1; // First step of Lentz’s method.\n      d = 1 - qab * x / qap;\n      if (f_abs(d) < FP_MIN) {\n          d = FP_MIN;\n      }\n      d = 1/d;\n      h = d;\n      for (m = 1; m <= MAX_IT; m++) {\n          m2 = 2*m;\n          aa = m*(b - m)*x / ((qam + m2)*(a + m2));\n          d = 1 + aa*d; // One step (the even one) of the recurrence.\n          if (f_abs(d) < FP_MIN) {\n              d = FP_MIN;\n          }\n          c = 1 + aa/c;\n          if (f_abs(c) < FP_MIN) {\n              c = FP_MIN;\n          }\n          d = 1/d;\n          h *= d*c;\n          aa = -(a + m)*(qab + m)*x / ((a + m2)*(qap + m2));\n          d = 1 + aa*d; // Next step of the recurrence (the odd one).\n          if (f_abs(d) < FP_MIN) {\n              d = FP_MIN;\n          }\n          c = 1 + aa/c;\n          if (f_abs(c) < FP_MIN) {\n              c = FP_MIN;\n          }\n          d = 1/d;\n          del = d*c;\n          h *= del;\n          if (f_abs(del - 1) < EPS) {\n              break;\n          }\n      }\n      return h; // if(m > MAX_IT) throw new Error(\"a or b too big, or MAX_IT too small\");\n  }\n\n  function betastd_inv(p, a, b) { // the quantile function of the standard Beta distribution\n      var m = 0, M = 1, x = 0;\n      for (var i = 0; i < MAX_IT; i++) {\n          x = 0.5*(m + M);\n          var q = betastd_cdf(x, a, b);\n          if (f_abs(p - q) < EPS) {\n              break;\n          }\n          if (q > p) {\n              M = x;\n          } else {\n              m = x;\n          }\n      }\n      return x;\n  }\n\n  function BETADIST(x, a, b, m, M) {\n      return betastd_cdf((x-m)/(M-m), a, b);\n  }\n\n  function BETA_DIST(x, a, b, cdf, m, M) {\n      if (cdf) {\n          return betastd_cdf((x-m)/(M-m), a, b);\n      }\n      return betastd_pdf((x-m)/(M-m), a, b) / (M-m);\n  }\n\n  function BETA_INV(p, a, b, m, M) {\n      return m + (M-m)*betastd_inv(p, a, b);\n  }\n\n  function chisq_left(x, n, cds) {  // CHISQ.DIST(x,deg_freedom,cumulative)\n      return GAMMA_DIST(x, n/2, 2, cds);\n  }\n\n  function chisq_right(x, n) { // CHISQ.DIST.RT(x,deg_freedom)\n      return 1 - chisq_left(x, n, true);\n  }\n\n  function chisq_left_inv(p, n) { // CHISQ.INV( probability, degrees_freedom )\n      return GAMMA_INV(p, n/2, 2);\n  }\n\n  function chisq_right_inv(p, n) { // CHISQ.INV.RT(probability,deg_freedom)\n      return chisq_left_inv(1-p, n);\n  }\n\n  function chisq_test(obsv, expect) {\n      var rows = obsv.length, cols = obsv[0].length;\n      var x = 0, i, j;\n      for (i = 0; i < rows; i++) {\n          for (j = 0; j < cols; j++) {\n              var eij = expect[i][j];\n              var delta = obsv[i][j] - eij;\n              delta *= delta;\n              x += delta/eij;\n          }\n      }\n      var n = (rows - 1)*(cols - 1);\n      return chisq_right(x, n);\n  }\n\n  function expon(x, r, cdf) { // EXPON.DIST(x, lambda, cumulative)\n      if (cdf) {\n          return 1 - Math.exp(-r*x);\n      }\n      return r * Math.exp(-r*x);\n  }\n\n  function poisson(k, m, cdf) { // POISSON.DIST(x, mean, cumulative)\n      if (cdf) {\n          return 1 - chisq_left(2*m, 2*(k+1), true);\n      }\n      //return chisq_left(2*m, 2*k, true) - chisq_left(2*m, 2*(k+1), true);\n      var lnf = 0;\n      for (var i = 2; i <= k; i++) {\n          lnf += Math.log(i); // compute log(k!)\n      }\n      return Math.exp(k*Math.log(m) - m - lnf);\n  }\n\n  function Fdist(x, n, d, cdf) { //F.DIST(x,deg_freedom1,deg_freedom2,cumulative)\n      if (cdf) {\n          return betastd_cdf(n*x/(d+n*x), n/2, d/2);\n      }\n      var u = n/d;\n      n /= 2; d /= 2;\n      return u/BETA(n, d) * Math.pow(u*x, n-1) / Math.pow(1+u*x, n+d);\n  }\n\n  function Fdist_right(x, n, d) { // F.DIST.RT(x,deg_freedom1,deg_freedom2)\n      return 1 - Fdist(x, n, d, true);\n  }\n\n  function Finv_right(p, n, d) { // F.INV.RT(probability,deg_freedom1,deg_freedom2\n      return d/n*(1/BETA_INV(p, d/2, n/2, 0, 1) - 1);\n  }\n\n  function Finv(p, n, d) { // F.INV(probability,deg_freedom1,deg_freedom2\n      return d/n*(1/BETA_INV(1-p, d/2, n/2, 0, 1) - 1);\n  }\n\n  function _mean(arr) {\n      var me = 0, n = arr.length;\n      for (var i = 0; i < n; i++) {\n          me += arr[i];\n      }\n      return me / n;\n  }\n\n  function _var_sq(arr, m) { // returns the (n-1)-part of the sum of the squares of deviations from m (= VAR)\n      var v = 0, n = arr.length;\n      for (var i = 0; i < n; i++) {\n          var delta = arr[i] - m;\n          v += delta*delta;\n      }\n      return v / (n-1);\n  }\n\n  function Ftest(arr1, arr2) { // F.TEST(array1,array2)\n      var n1 = arr1.length - 1, n2 = arr2.length - 1;\n      var va1 = _var_sq(arr1, _mean(arr1)),\n          va2 = _var_sq(arr2, _mean(arr2));\n      if (!va1 || !va2) {\n          throw new CalcError(\"DIV/0\");\n      }\n      return 2*Fdist(va1 / va2, n1, n2, true);\n  }\n\n  function fisher(x) { // FISHER(x)\n      return 0.5*Math.log((1+x)/(1-x));\n  }\n\n  function fisherinv(x) { // FISHERINV(x)\n      var e2 = Math.exp(2*x);\n      return (e2 - 1)/(e2 + 1);\n  }\n\n  function Tdist(x, n, cdf) { // T.DIST(x,deg_freedom, cumulative)\n      if (cdf) {\n          return 1 - 0.5*betastd_cdf(n/(x*x+n), n/2, 0.5);\n      }\n      return 1/(Math.sqrt(n)*BETA(0.5, n/2)) * Math.pow(1 + x*x/n, -(n+1)/2);\n  }\n\n  function Tdist_right(x, n) { // T.DIST.RT(x,deg_freedom)\n      return 1 - Tdist(x, n, true);\n  }\n\n  function Tdist_2tail(x, n) { // T.DIST.2T(x,deg_freedom)\n      if (x < 0) {\n          x = -x;\n      }\n      return 2*Tdist_right(x, n);\n  }\n\n  function Tdist_inv(p, n) { // T.INV(probability,deg_freedom)\n      var x = betastd_inv(2*Math.min(p, 1-p), n/2, 0.5); // ibetainv();\n      x = Math.sqrt(n * (1 - x) / x);\n      return (p > 0.5) ? x : -x;\n  }\n\n  function Tdist_2tail_inv(p, n) { // T.INV.2T(probability,deg_freedom)\n      // T2 = 2T_r = p => T_r(x,n) = p/2 => 1 - T(x,n,true) = p/2 => x = T^-1(1-p/2, n)\n      return Tdist_inv(1-p/2, n);\n  }\n\n  function Tdist_test(gr1, gr2, tail, type) { // T.TEST(array1,array2,tails,type)\n      var n1 = gr1.length, n2 = gr2.length;\n      var t_st, df; // the t-statistic and the \"degree of freedom\"\n      if (type == 1) { // paired (dependent) samples\n          var d = 0, d2 = 0;\n          for (var i = 0; i < n1; i++) {\n              var delta = gr1[i] - gr2[i];\n              d += delta;\n              d2 += delta*delta;\n          }\n          var md = d/n1; //, md2 = d2 / n1;\n          t_st = md / Math.sqrt((d2 - d*md)/(n1*(n1-1))); // has a \"Student T\" distribution\n          return tail == 1 ? Tdist_right(t_st, n1-1) : Tdist_2tail(t_st, n1-1);\n      }\n      // unpaired (independent) samples\n      var m1 = _mean(gr1), m2 = _mean(gr2),\n          v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n      if (type == 3) { // unpaired, unequal variances\n          var u1 = v1/n1, u2 = v2/n2, u = u1 + u2;\n          var q1 = u1/u, q2 = u2/u; // u==0 must be invalidated\n          df = 1/(q1*q1/(n1-1) + q2*q2/(n2-1));\n          t_st = f_abs(m1-m2)/Math.sqrt(u);\n          return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n      }\n      else { // (type == 2) unpaired, equal variances (\"equal\" in the sense that there is no significant difference in variance in both groups - a prealable F-test could revealed that)\n          df = n1 + n2 - 2;\n          t_st = f_abs(m1-m2)*Math.sqrt(df*n1*n2/((n1+n2)*((n1-1)*v1+(n2-1)*v2)));\n          return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n      }\n  }\n\n  function confidence_t(alpha, stddev, size) { // CONFIDENCE.T(alpha,standard_dev,size)\n      return -Tdist_inv(alpha/2, size-1)*stddev/Math.sqrt(size);\n  }\n\n  function confidence_norm(alpha, stddev, size) { // CONFIDENCE.NORM(alpha,standard_dev,size)\n      return -NORM_S_INV(alpha/2)*stddev/Math.sqrt(size);\n  }\n\n  function gauss(z) { // GAUSS(z)\n      return NORM_S_DIST(z, true) - 0.5;\n  }\n\n  function phi(x) { // PHI(x)\n      return NORM_S_DIST(x);\n  }\n\n  function lognorm_dist(x, m, s, cumulative) { // LOGNORM.DIST(x,mean,standard_dev,cumulative)\n      if (cumulative) {\n          return 0.5 + 0.5*ERF((Math.log(x)-m)/(s*Math.sqrt(2)));\n      }\n      var t = Math.log(x)-m;\n      return Math.exp(-t*t/(2*s*s))/(x*s*Math.sqrt(2*Math.PI));\n  }\n\n  function lognorm_inv(p, m, s) { //LOGNORM.INV(probability, mean, standard_dev)\n      return Math.exp(NORM_INV(p, m, s));\n  }\n\n  function prob(x_, p_, lw, up) { //PROB(x_range, prob_range, [lower_limit], [upper_limit])\n      var n = x_.length;\n      var s = 0, i;\n      for (i = 0; i < n; i++) {\n          if (p_[i] <= 0 || p_[i] > 1) {\n              throw new CalcError(\"NUM\");\n          }\n          s += p_[i];\n      }\n      if (s != 1) {\n          throw new CalcError(\"NUM\");\n      }\n      var res = 0;\n      for (i = 0; i < n; i++) {\n          var x = x_[i];\n          if (x >= lw && x <= up) {\n              res += p_[i];\n          }\n      }\n      return res;\n  }\n\n  function slope(y_, x_) { // SLOPE(known_y's, known_x's)\n      var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n      for (var i = 0, n = y_.length; i < n; i++) {\n          var t = x_[i] - mx;\n          b1 += t*(y_[i] - my);\n          b2 += t*t;\n      }\n      return b1/b2;\n  }\n\n  function intercept(y_, x_) { // INTERCEPT(known_y's, known_x's)\n      var mx = _mean(x_), my = _mean(y_);\n      // return my - mx*slope(y_, x_);  //but repeating the calls for _mean()\n      var b1 = 0, b2 = 0;\n      for (var i = 0, n = y_.length; i < n; i++) {\n          var t = x_[i] - mx;\n          b1 += t*(y_[i] - my);\n          b2 += t*t;\n      }\n      return my - b1*mx/b2;\n  }\n\n  function pearson(x_, y_) { // PEARSON(array1, array2)\n      whipNumberArrays(x_, y_);\n      var mx = _mean(x_), my = _mean(y_);\n      var s1 = 0, s2 = 0, s3 = 0;\n      for (var i = 0, n = x_.length; i < n; i++) {\n          var t1 = x_[i] - mx, t2 = y_[i] - my;\n          s1 += t1*t2;\n          s2 += t1*t1;\n          s3 += t2*t2;\n      }\n      return s1/Math.sqrt(s2*s3);\n  }\n\n  function rsq(x_, y_) { // RSQ(known_y's,known_x's)\n      var r = pearson(x_, y_);\n      return r*r;\n  }\n\n  function steyx(y_, x_) { //STEYX(known_y's, known_x's)\n      var n = x_.length;\n      var mx = _mean(x_), my = _mean(y_);\n      var s1 = 0, s2 = 0, s3 = 0;\n      for (var i = 0; i < n; i++) {\n          var t1 = x_[i] - mx, t2 = y_[i] - my;\n          s1 += t2*t2;\n          s2 += t1*t2;\n          s3 += t1*t1;\n      }\n      return Math.sqrt((s1 - s2*s2/s3)/(n-2));\n  }\n\n  function forecast(x, y_, x_) { //FORECAST(x, known_y's, known_x's)\n      var mx = _mean(x_), my = _mean(y_);\n      var s1 = 0, s2 = 0;\n      for (var i = 0, n = x_.length; i < n; i++) {\n          var t1 = x_[i] - mx, t2 = y_[i] - my;\n          s1 += t1*t2;\n          s2 += t1*t1;\n      }\n      if (s2 === 0) {\n          throw new CalcError(\"N/A\");\n      }\n      var b = s1/s2, a = my - b*mx;\n      return a + b*x;\n  }\n\n  function _mat_mean(Mat) { // returns the mean value of a Matrix(n, 1)\n      var n = Mat.height, sum = 0;\n      for (var i=0; i < n; i++) {\n          sum += Mat.data[i][0];\n      }\n      return sum/n;\n  }\n\n  function _mat_devsq(Mat, mean) { // returns the sum of squares of deviations for a Matrix(n, 1)\n      var n = Mat.height, sq = 0;\n      for (var i=0; i < n; i++) {\n          var x = Mat.data[i][0] - mean;\n          sq += x*x;\n      }\n      return sq;\n  }\n\n  function linest(Y, X, konst, stats) { // LINEST(known_y's, [known_x's], [const], [stats])\n      var i = 0;\n\n      if (!X) {\n          // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n          X = Y.map(function(){ return ++i; });\n      }\n\n      if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n          X = X.clone();\n          X.eachRow(function(row){\n              X.data[row].unshift(1);\n          });\n          ++X.width;\n      }\n\n      var Xt = X.transpose();\n      var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n      var line_1 = [];\n      for (i = B.height-1; i >= 0; i--) {\n          line_1.push(B.data[i][0]); // regression coefficients ('slopes') and the y_intercept\n      }\n      if (!konst) {\n          line_1.push(0); // display 0 for y_intercept, when const==false\n      }\n      if (!stats) {\n          return this.asMatrix([ line_1 ]); // don't display statistics about the regression, when stats==false\n      }\n\n      var Y1 = X.multiply(B); // the predicted Y values\n      var y_y1 = Y.adds(Y1, true); // the errors of the predictions (= Y - Y1)\n      var mp = !konst? 0 : _mat_mean(Y1);\n      var SSreg = _mat_devsq(Y1, mp); // The regression sum of squares\n      var me = !konst? 0 : _mat_mean(y_y1);\n      var SSresid = _mat_devsq(y_y1, me); // The residual sum of squares\n      var line_5 = [];\n      line_5.push(SSreg, SSresid);\n      var R2 = SSreg / (SSreg + SSresid); // The coefficient of determination\n      var degfre = Y.height - X.width; // The degrees of freedom\n      var err_est = Math.sqrt(SSresid / degfre); // The standard error for the y estimate\n      var line_3 = [];\n      line_3.push(R2, err_est);\n      var F_sta = !konst ? (R2/X.width)/((1-R2)/(degfre)) : (SSreg/(X.width-1))/(SSresid/degfre); // The F statistic\n      var line_4 = [];\n      line_4.push(F_sta, degfre);\n      var SCP = Xt.multiply(X).inverse();\n      var line_2 = [];\n      for (i=SCP.height-1; i >= 0; i--) { // The standard errors (of coefficients an y-intercept)\n          line_2.push(Math.sqrt(SCP.data[i][i]*SSresid/degfre));\n      }\n      return this.asMatrix([line_1, line_2, line_3, line_4, line_5]);\n  }\n\n  function logest(Y, X, konst, stats) { // LOGEST(known_y's, [known_x's], [const], [stats])\n      return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n  }\n\n  function trend(Y, X, W, konst) { // TREND(known_y's, [known_x's], [new_x's], [const])\n      var i = 0;\n\n      if (!X) {\n          // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n          X = Y.map(function(){ return ++i; });\n      }\n\n      if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n          X = X.clone();\n          X.eachRow(function(row){\n              X.data[row].unshift(1);\n          });\n          ++X.width;\n      }\n\n      var Xt = X.transpose();\n      var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n\n      if (!W) {\n          W = X;\n      } else {\n          if (konst) { // for non-zero y_intercept\n              W = W.clone();\n              W.eachRow(function(row){\n                  W.data[row].unshift(1);\n              });\n              ++W.width;\n          }\n      }\n      return W.multiply(B); // the predicted Y values for the W values\n  }\n\n  function growth(Y, X, new_X, konst) { // GROWTH(known_y's, [known_x's], [new_x's], [const])\n      // = EXP(TREND(LN(Y_), X_, new_X, const))\n      return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n  }\n\n  /*\n    [1] Handbook of Mathematical Functions (NIST, 1964-2010):\n    https://en.wikipedia.org/wiki/Abramowitz_and_Stegun\n    http://dlmf.nist.gov/\n    http://www.aip.de/groups/soe/local/numres/\n\n    [2] https://en.wikibooks.org/wiki/Statistics/Numerical_Methods/Numerics_in_Excel\n  */\n\n  /* -----[ financial functions ]----- */\n\n  //// find the root of a function known an initial guess (Newton's method) ////\n  function root_newton(func, guess, max_it, eps) { // func(x) must return [value_F(x), value_F'(x)]\n      var MAX_IT = max_it || 20, // maximum number of iterations\n          EPS = eps || 1E-7; // accuracy\n      var root = guess;\n      for (var j = 1; j <= MAX_IT; j++) {\n          var f_d = func(root),\n              f = f_d[0], // the value of the function\n              df = f_d[1]; // the value of the derivative\n          var dx = f / df;\n          root -= dx;\n          if (Math.abs(dx) < EPS) {\n              return root;\n          }\n      }\n      return new CalcError(\"NUM\");\n  }\n\n\n  /* https://support.office.com/en-us/article/PV-function-23879d31-0e02-4321-be01-da16e8168cbd\n     if(rate==0):\n     PMT * nper + PV + FV = 0\n     else: //the basic equation (with six variables) implied in financial problems\n     PV * (1+rate)^nper + PMT * (1+rate*type) * ((1+rate)^nper-1) / rate + FV = 0         [1]\n  */\n\n\n  //// FV (final or future value) ////\n  /* I initially invest £1000 in a saving scheme and then at the end of each month I invest an\n     extra £50. If the interest rate is 0.5% per month and I continue this process for two year,\n     how much will my saving be worth: =FV(0.005, 24, -50, -1000, 0) */\n  function FV(rate, nper, pmt, pv, type) { // FV(rate,nper,pmt,[pv],[type])\n      var h1 = Math.pow(1+rate, nper);\n      var h2 = rate ? (h1 - 1)/rate : nper;\n      return -(pv * h1 + pmt * h2 * (1 + rate*type));\n  }\n\n  //// PV (present value of investment) ////\n  /* If I wish to accumulate £5000 in four years time by depositing £75 per month in a fixed\n     rate account with interest rate of 0.4% per month, what initial investment must I also\n     make: =PV(0.004, 4*12, -75, 5000, 0) */\n  function PV(rate, nper, pmt, fv, type) { // PV(rate, nper, pmt, [fv], [type])\n      if (!rate) {\n          return -fv - pmt*nper;\n      }\n      var h1 = Math.pow(1+rate, nper);\n      return -(fv + pmt * (h1 - 1)/rate * (1 + rate*type)) / h1;\n  }\n\n  //// PMT monthly payments (= principal part PPMT + interest part IPMT) ////\n  /* How much will the monthly repayments be if I borrow £100,000 over 20 years with an\n     effective monthly interest rate is 0.5%: =PMT(0.005, 12*20, 100000, 0, 0) */\n  function PMT(rate, nper, pv, fv, type) { // PMT(rate, nper, pv, [fv], [type])\n      if (!rate) {\n          return -(fv + pv)/nper;\n      }\n      var h1 = Math.pow(1+rate, nper);\n      return -rate*(fv + pv*h1)/((1 + rate*type)*(h1 - 1));\n  }\n\n  //// NPER (number of periods for an investment) ////\n  /* How long would it take me to pay off a loan of £10,000 at a rate of 0.5% per month if I\n     can afford to pay £100 per month: =NPER(0.5%, -100, 10000, 0, 0) */\n  function NPER(rate, pmt, pv, fv, type) { // NPER(rate,pmt,pv,[fv],[type])\n      if (!rate) {\n          return -(fv + pv) / pmt;\n      }\n      var h1 = pmt*(1 + rate*type);\n      return Math.log((h1 - fv*rate)/(h1 + pv*rate)) / Math.log(1 + rate);\n  }\n\n  //// RATE (the interest rate per period) ////\n  /* I borrow £1000 over 1 year making payments of £100 per month at the end of each\n     month. What is the monthly interest rate: =RATE(12, −100, 1000, 0, 0, 0) */\n\n  function RATE(nper, pmt, pv, fv, type, guess) { // RATE(nper, pmt, pv, [fv], [type], [guess])\n      function xfd(x) { // returns F(x) and F'(x), where F is given by the equation [1]\n          var h2 = Math.pow(1+x, nper-1), h1 = h2*(1+x);\n          return [ pv*h1 + pmt*(1/x + type)*(h1 - 1) + fv,\n                   nper*pv*h2 + pmt*(-(h1 - 1)/(x*x) + (1/x + type)*nper*h2) ];\n      }\n      return root_newton(xfd, guess); // a root of the equation F(x)=0\n  }\n\n  //// IPMT (interest part of a loan or investment) ////\n  //// PPMT (principal part of a loan) ////\n\n  function IPMT(rate, per, nper, pv, fv, type) { // IPMT(rate, per, nper, pv, [fv], [type])\n      if (type==1 && per==1) { // interest before beginnig of the payments... = ZERO\n          return 0;\n      }\n      var pmt = PMT(rate, nper, pv, fv, type);\n      var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n      return type ? ipmt/(1 + rate) : ipmt;\n  }\n\n  function PPMT(rate, per, nper, pv, fv, type) { // PPMT(rate, per, nper, pv, [fv], [type])\n      var pmt = PMT(rate, nper, pv, fv, type);\n      return pmt - IPMT(rate, per, nper, pv, fv, type);\n  }\n\n  //// CUMPRINC (cumulative principal paid) ////\n  /* The amount financed is $200,000 at an interest rate of 7.25% for 30 years. How much is the amount of principal\n     and the amount of interest paid in the first year: CUMPRINC(0.0725/12, 12*30, 200000, 1, 12, 0)\n     and CUMIPMT(0.0725/12, 12*30, 200000, 1, 12, 0) */\n  function CUMPRINC(rate, nper, pv, start, end, type) { // CUMPRINC(rate, nper, pv, start_period, end_period, type)\n      if (type == 1) { // start >= 1 (as in Excel), but if pay at beginning of the period (type==1),\n          start --;    // then periods must be counted from Zero (decreasing given start and end parameters)\n          end --;\n      }\n      var tn = Math.pow(1 + rate, nper),\n          ts = Math.pow(1 + rate, start-1),\n          te = Math.pow(1 + rate, end);\n      var monthlyPayment = rate * pv * tn / (tn - 1);\n      var remainingBalanceAtStart = ts * pv - ((ts - 1) / rate) * monthlyPayment;\n      var remainingBalanceAtEnd = te * pv - ((te - 1) / rate) * monthlyPayment;\n      return remainingBalanceAtEnd - remainingBalanceAtStart;\n  }\n\n  //// CUMIPMT (cumulative  interest paid) ////\n  function CUMIPMT(rate, nper, pv, start, end, type) { // CUMIPMT(rate, nper, pv, start_period, end_period, type)\n      var cip = 0;\n      for (var i=start; i<=end; i++) {\n          cip += IPMT(rate, i, nper, pv, 0, type);\n      }\n      return cip;\n  }\n\n  //// NPV (Net Present Value of an investment based on a series of periodic cash flows and a discount rate) ////\n  function NPV(rate, flows) { // NPV(rate,value1,[value2],...)\n      var npv = 0;\n      for (var i=0, n=flows.length; i < n; i++) {\n          npv += flows[i]*Math.pow(1 + rate, -i-1);\n      }\n      return npv;\n  }\n\n  //// IRR (Internal Rate of Return on an investment based on a series of periodic cash flows) ////\n  function IRR(flows, guess) { // IRR(values, [guess])\n      function xfd(x) {\n          var npv = 0, npv1 = 0;\n          for (var j=0, n=flows.length; j < n; j++) {\n              npv += flows[j]*Math.pow(1 + x, -j-1); // construct the NPV(x) value,\n              npv1 += -j*flows[j]*Math.pow(1+x, -j-2); // the value in x of the NPV()-derivative\n          }\n          return [npv, npv1];\n      }\n      return root_newton(xfd, guess);\n  }\n\n  //// EFFECT (effective annual interest rate) ////\n  /* which investment option is better - one that pays 5 percent after one year, or a\n     savings account that pays a monthly interest of 4.75 percent:\n     = (5% - EFFECT(4.75%, 12)) * 10000 */\n  function EFFECT(nominal_rate, npery) { // EFFECT(nominal_rate, npery)\n      return Math.pow(1 + nominal_rate/npery, npery) - 1;\n  }\n\n  //// NOMINAL (nominal annual interest rate) ////\n  function NOMINAL(effect_rate, npery) { // NOMINAL(effect_rate, npery)\n      return npery*(Math.pow(effect_rate + 1, 1/npery) - 1);\n  }\n\n  //// XNPV (Net Present Value of a series of cashflows at irregular intervals) ////\n  function XNPV(rate, values, dates) { // XNPV(rate, values, dates)\n      var npv = 0;\n      for (var i=0, n=values.length; i < n; i++) {\n          npv += values[i]*Math.pow(1 + rate, (dates[0]-dates[i])/365);\n      }\n      return npv;\n  }\n\n  //// XIRR (Internal Rate of Return of a series of cashflows at irregular intervals) ////\n  function XIRR(values, dates, guess) { // XIRR(values, dates, [guess])\n      function xfd(x) {\n          var npv = values[0], npv1 = 0;\n          for (var j=1, n=values.length; j < n; j++) {\n              var delta = (dates[0] - dates[j]) / 365;\n              npv += values[j]*Math.pow(1 + x, delta); // construct the XNPV(x) value,\n              npv1 += delta*values[j]*Math.pow(1+x, delta - 1); // the value in x of the XNPV()-derivative\n          }\n          return [npv, npv1];\n      }\n      return root_newton(xfd, guess); // , 100, 0.1);\n  }\n\n  //// ISPMT (Interest paid during a Specific Period of an investment) ////\n  function ISPMT(rate, per, nper, pv) { // ISPMT(rate, per, nper, pv)\n      var tmp = -pv*rate;\n      return tmp*(1 - per/nper);\n  }\n\n  //// DB (Declining Balance depreciation) ////\n  function DB(cost, salvage, life, period, month) { // DB(cost, salvage, life, period, [month])\n      var rate = 1 - Math.pow(salvage/cost, 1/life);\n      rate = Math.floor(rate*1000 + 0.5) / 1000; // rounded to three decimals\n      var db = cost * rate * month / 12;\n      if (period == 1) {\n          return db;\n      }\n      for (var i=1; i < life; i++) {\n          if (i == period - 1) {\n              return (cost - db) * rate;\n          }\n          db += (cost - db) * rate;\n      }\n      return (cost - db) * rate * (12 - month) / 12;\n  }\n\n  //// DDB (Double Declining Balance depreciation) ////\n  function DDB(cost, salvage, life, period, factor) { // DDB(cost, salvage, life, period, [factor])\n      var f = factor / life;\n      var prior = -cost * (Math.pow(1-f, period-1) - 1);\n      var dep = (cost - prior) * f;\n      /* Depreciation cannot exceed book value.  */\n      dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n      return dep;\n  }\n\n  //// SLN (straight-line depreciation) ////\n  function SLN(cost, salvage, life) { // SLN(cost, salvage, life)\n      return (cost - salvage) / life;\n  }\n\n  //// SYD (Sum-of-Years' digits Depreciation) ////\n  function SYD(cost, salvage, life, per) { // SYD(cost, salvage, life, per)\n      return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n  }\n\n  //// VDB (Variable Declining Balance) ////\n  //\n  // Code adapted from Gnumeric, which in turn took it from OpenOffice.  The original code is\n  // available under GNU Lesser General Public License (LGPL).\n  // https://github.com/GNOME/gnumeric/blob/master/plugins/fn-financial/sc-fin.c\n  function VDB(cost, salvage, life, start, end, factor, no_switch) {\n      var interest = factor >= life ? 1 : factor / life;\n\n      function _getGDA(value, period) {\n          var gda, oldValue, newValue;\n          if (interest == 1) {\n              oldValue = period == 1 ? value : 0;\n          } else {\n              oldValue = value * Math.pow(1 - interest, period - 1);\n          }\n          newValue = value * Math.pow(1 - interest, period);\n          gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n          return gda < 0 ? 0 : gda;\n      }\n\n      function _interVDB(cost, life1, period) {\n          var remValue = cost - salvage;\n          var intEnd = Math.ceil(period);\n          var term, lia = 0, vdb = 0, nowLia = false;\n          for (var i = 1; i <= intEnd; i++) {\n              if (!nowLia) {\n                  var gda = _getGDA(cost, i);\n                  lia = remValue / (life1 - i + 1);\n                  if (lia > gda) {\n                      term = lia;\n                      nowLia = true;\n                  } else {\n                      term = gda;\n                      remValue -= gda;\n                  }\n              } else {\n                  term = lia;\n              }\n              if (i == intEnd) {\n                  term *= period + 1 - intEnd;\n              }\n              vdb += term;\n          }\n          return vdb;\n      }\n\n      var intStart = Math.floor(start), intEnd = Math.ceil(end);\n      var vdb = 0;\n      if (no_switch) {\n          for (var i = intStart + 1; i <= intEnd; i++) {\n              var term = _getGDA(cost, i);\n              if (i == intStart + 1) {\n                  term *= Math.min(end, intStart + 1) - start;\n              } else {\n                  if (i == intEnd) {\n                      term *= end + 1 - intEnd;\n                  }\n              }\n              vdb += term;\n          }\n      } else {\n          var life1 = life;\n          if (start != Math.floor(start)) {\n              if (factor > 1) {\n                  if (start >= life / 2) {\n                      var part = start - life / 2;\n                      start = life / 2;\n                      end -= part;\n                      life1 += 1;\n                  }\n              }\n          }\n          cost -= _interVDB(cost, life1, start);\n          vdb = _interVDB(cost, life - start, end - start);\n      }\n      return vdb;\n  }\n\n  /*************************************************************************************/\n\n  /*   (from  http://beginnersinvest.about.com)\n       an investor agrees to loan money to a company or government in exchange for a predetermined interest rate for a pre-determined length of time.\n\n       If an investor wanted to buy a $25,000 Coca-Cola bond with a 30 year maturity and an 10% coupon, it would work like this: He would send in the $25,000 from his savings account and get a $25,000 engraved bond certificate in exchange. After 30 years, he would be able to get his whole $25,000 back from the Coca-Cola company (of course, he can always sell it before then if he needs the money).\n\n       Every year, he’s entitled to receive 10% interest on the money he lent, or $2,500. Since most companies in the United States pay interest semi-annually, he would likely have 60 coupons attached to his bond for $1,250 each.\n       Every June 30th and December 31st, the investor would go down, clip the proper coupon, send it in, and get their money.\n\n       Although the practice is now defunct, the terminology stuck and interest payments on bonds will forever be known as coupons.\n  */\n\n\n  // \"Use EDATE to calculate maturity dates or due dates that fall on the same day of the month as the date of issue.\"\n  // See also: DATEDIF, DAY, DAYS, DAY360, EOMONTH (wich can be useful to determine limits of coupon periods)\n  function _edate(base, months) { // EDATE(start_date, months)\n      var d = unpackDate$1(base);\n      var m = d.month + months;\n      var y = d.year + Math.floor(m/12);\n      m %= 12;\n      if (m < 0) {\n          m += 12;\n      }\n      d = Math.min(d.date, daysInMonth(y, m));\n      return packDate$1(y, m, d);\n  }\n\n  function _daysBetween(from, to, basis) {\n      if (basis == 1 || basis == 2 || basis == 3) { // Actual/Actual || Actual/360 || Actual/365\n          return to - from;\n      }\n      return _days_360(from, to, basis);\n  }\n\n  // Find coupon dates that enclose the settlement date, counting backward from the maturity date.\n  /* independent of the 'basis' convention to count days - here we have no need to count days */\n  function _borderCoupons(settlement, maturity, freq) {\n      var sett = unpackDate$1(settlement), base = unpackDate$1(maturity);\n      var periods = base.year - sett.year;\n      if (periods > 0) {\n          periods = (periods - 1) * freq;\n      }\n      var prev, next, months = 12/freq;\n      do {\n          periods++;\n          prev = _edate(maturity, - periods*months);\n      } while (settlement < prev);\n      periods--;\n      next = _edate(maturity, - periods*months);\n      return [ prev, next ];\n  }\n\n  // Find coupon dates that enclose the settlement date, counting forward from the first-coupon payment.\n  /* independent of the 'basis' convention to count days - here we have no need to count days */\n  function _borderCoupons_fw(first, settlement, freq) {\n      var sett = unpackDate$1(settlement), base = unpackDate$1(first);\n      var periods = sett.year - base.year;\n      if (periods > 0) {\n          periods = (periods - 1) * freq;\n      }\n      var prev = first, next, months = 12/freq;\n      while (settlement > prev) {\n          next = prev;\n          periods++;\n          prev = _edate(first, periods*months);\n      }\n      return [ next, prev ];\n  }\n\n  //// COUPDAYBS (COUPon DAYs Beginning to Settlement) ////\n  /* returns the number of days from the beginning of the coupon period to the settlement date */\n  function COUPDAYBS(settlement, maturity, frequency, basis) { // COUPDAYBS(settlement, maturity, frequency, [basis])\n      var prev = _borderCoupons(settlement, maturity, frequency)[0];\n      return _daysBetween(prev, settlement, basis);\n  }\n\n  //// COUPDAYS (COUPon DAYs containing Settlement) ////\n  /* Returns the number of days in the coupon period that contains the settlement date */\n  function COUPDAYS(settl, matur, freq, basis) { // COUPDAYS(settlement, maturity, frequency, [basis])\n      if (basis == 1) {\n          var borders = _borderCoupons(settl, matur, freq);\n          return _daysBetween(borders[0], borders[1], 1);\n      }\n      if (basis == 3) {\n          return 365/freq;\n      }\n      return 360/freq;\n  }\n\n  //// COUPDAYSNC (COUPon DAYs Settlement to Next Coupon) ////\n  /* Returns the number of days from the settlement date to the next coupon date */\n  function COUPDAYSNC(settl, matur, freq, basis) { // COUPDAYSNC(settlement, maturity, frequency, [basis])\n      var next = _borderCoupons(settl, matur, freq)[1];\n      return _daysBetween(settl, next, basis);\n  }\n\n  //// COUPPCD (COUPon, Previous Coupon Date) ////\n  /* Returns the previous coupon date before the settlement date */\n  function COUPPCD(settl, matur, freq/*, basis*/) { // COUPPCD(settlement, maturity, frequency, [basis])\n      // It is no need to count days, so 'basis' becomes a inutil parameter.\n      return _borderCoupons(settl, matur, freq)[0];\n  }\n\n  //// COUPNCD (COUPon, Next Coupon Date) ////\n  /* Returns the next coupon date after the settlement date */\n  function COUPNCD(settl, matur, freq/*, basis*/) { // COUPNCD(settlement, maturity, frequency, [basis])\n      // It is no need to count days, so 'basis' becomes a inutil parameter.\n      return _borderCoupons(settl, matur, freq)[1];\n  }\n\n  function COUPNUM(settl, matur, freq/*, basis*/) { // COUPNUM(settlement, maturity, frequency, [basis])\n      var sett = unpackDate$1(settl),\n          mat = unpackDate$1(matur);\n      var months = 12*(mat.year - sett.year) + mat.month - sett.month;\n      //// Discount the last month if there are not enough days? Finally - we decide to not discount.\n      //// (if this \"last month\" have 2 days, Excel.COUPNUM returns 6 but GoogleSpreads give only 5)\n      //    var res = _edate(matur, -months);\n      //    if (sett.date >= unpackDate(res).date) {\n      //        months--; // an incomplete last month correspond to a qvasi-coupon period\n      //    }\n      return 1 + (months * freq / 12 | 0);\n  }\n\n  function daysInYear2(yr, basis) {\n      if (basis == 3) { return 365; }\n      if (basis == 1) { return isLeapYear(yr) ? 366 : 365; }\n      return 360;\n  }\n\n  //// ACCRINTM  the accrued interest for a security that pays interest at maturity ////\n  function ACCRINTM(issue, maturity, rate, par, basis) { // ACCRINTM(issue, settlement, rate, par, [basis])\n      var year_days = daysInYear2(unpackDate$1(maturity).year, basis); // 360;\n      return rate*par * _daysBetween(issue, maturity, basis) / year_days;\n  }\n\n  function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n      var accr = 0, cost = par * rate / freq;\n      var brace, prev, next, prev1, next1, nrc;\n\n      var annual = basis % 2 === 0 ? 360 : 365; // only if to >> from, we eventually need to count leap years\n      function _numCoupons(from, to) { // better than COUPNUM(from, to, freq, basis)-1\n          return (to - from)*freq/annual | 0;\n      }\n\n      if (settl <= first) {\n          brace = _borderCoupons(settl, first, freq);\n          prev = brace[0];\n          next = brace[1];\n          if (prev <= issue) {\n              return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n          }\n          brace = _borderCoupons(issue, prev, freq);\n          prev1 = brace[0];\n          next1 = brace[1];\n          nrc = _numCoupons(next1, settl); // when settl==next, days are counted implicitly by nrc\n          return cost *\n              (nrc +\n               _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) +\n               (settl < next? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n      } else {\n          brace = _borderCoupons_fw(first, settl, freq);\n          prev = brace[0];\n          next = brace[1];\n          nrc = _numCoupons(first, settl); // COUPNUM(first, settl, freq, basis) - 1;\n          if (next == settl) {\n              accr = cost * nrc;\n          } else {\n              accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n          }\n          if (!calc) { return accr; } // Only the accrued interest between first and settlement dates.\n          brace = _borderCoupons(issue, first, freq); // Add the accrued interest between issue and first dates.\n          prev = brace[0];\n          next = brace[1];\n          nrc = _numCoupons(issue, first);\n          accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n          return accr; // accrued interest between issue and settlement dates\n      }\n  }\n\n  //// DISC  the discount rate for a security (given price and redemption values per 100$ face value) ////\n  function DISC(settl, matur, pr, redemption, basis) { // DISC(settlement, maturity, pr, redemption, [basis])\n      var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate$1(settl).year) ? 366 : 365);\n      return (redemption - pr)/redemption*annual/_daysBetween(settl, matur, basis);\n  }\n\n  //// INTRATE  the interest rate for a fully invested security ////\n  function INTRATE(settl, matur, investment, redemption, basis) { // INTRATE(settlement, maturity, investment, redemption, [basis])\n      var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate$1(settl).year) ? 366 : 365);\n      return (redemption - investment)/investment*annual/_daysBetween(settl, matur, basis);\n  }\n\n  //// RECEIVED  the amount received at maturity for a fully invested security ////\n  function RECEIVED(settl, matur, investment, discount, basis) { // RECEIVED(settlement, maturity, investment, discount, [basis])\n      var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate$1(settl).year) ? 366 : 365);\n      return investment/(1 - discount*_daysBetween(settl, matur, basis)/annual);\n  }\n\n  //// PRICE  the price per $100 face value of a security that pays periodic interest ////\n  function PRICE(settl, matur, rate, yld, redemption, freq, basis) { // PRICE(settlement, maturity, rate, yld, redemption, frequency, [basis])\n      var N = 1 + ((matur - settl)*freq/(basis % 2 === 0 ? 360 : 365) | 0); // coupons playable between settlement and maturity dates\n      var brace = _borderCoupons(settl, matur, freq),\n          prev = brace[0], next = brace[1];\n      var beg_settl = _daysBetween(prev, settl, basis),\n          settl_end = _daysBetween(settl, next, basis),\n          beg_end = _daysBetween(prev, next, basis);\n      var den = 100*rate/freq,\n          yf = yld/freq,\n          frac = settl_end / beg_end;\n      if (N == 1) {\n          return (redemption + den)/(1 + frac*yf) - beg_settl / beg_end * den;\n      }\n      return redemption / Math.pow(1 + yf, N-1+frac)\n          + den * Math.pow(1 + yf, 1-N-frac) * (Math.pow(1+yf, N) - 1) / yf\n          - beg_settl / beg_end * den;\n  }\n\n  //// PRICEDISC  the price per $100 face value of a discounted security ////\n  function PRICEDISC(settl, matur, discount, redemption, basis) { // PRICEDISC(settlement, maturity, discount, redemption, [basis])\n      var dsm = _daysBetween(settl, matur, basis),\n          dy = daysInYear2(unpackDate$1(matur).year, basis);\n      return redemption - discount*redemption*dsm/dy;\n  }\n\n  // Used in PEARSON, more could follow.  In some situations Excel appears to silently ignore\n  // missing or non-numeric values, for example if some value in a is missing a corresponding\n  // value in b, then the one in a is going to be ignored as if not present.  Arrays must have the\n  // same number of elements.  I couldn't come up with a good name for this function.\n  function whipNumberArrays(a, b) {\n      for (var i = a.length; --i >= 0;) {\n          if (typeof a[i] != \"number\" || typeof b[i] != \"number\") {\n              a.splice(i, 1);\n              b.splice(i, 1);\n          }\n      }\n  }\n\n  const {\n      packDate, unpackDate,\n      packTime, unpackTime,\n      serialToDate, dateToSerial,\n      defineAlias\n  } = calc.runtime;\n\n  var commonEngine = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    ALL_PROPERTIES: ALL_PROPERTIES,\n    ALL_REASONS: ALL_REASONS,\n    AddColumnCommand: AddColumnCommand,\n    AddCommand: AddCommand,\n    AddRowCommand: AddRowCommand,\n    AdjustDecimalsCommand: AdjustDecimalsCommand,\n    AdjustRowHeightCommand: AdjustRowHeightCommand,\n    ApplyFilterCommand: ApplyFilterCommand,\n    AutoFillCalculator: AutoFillCalculator,\n    AutoFillCommand: AutoFillCommand,\n    Axis: Axis,\n    AxisManager: AxisManager,\n    BorderChangeCommand: BorderChangeCommand,\n    BringToFrontCommand: BringToFrontCommand,\n    CalcError: CalcError,\n    CellRef: CellRef,\n    ClearContentCommand: ClearContentCommand,\n    ClearFilterCommand: ClearFilterCommand,\n    Clipboard: Clipboard,\n    ColumnWidthCommand: ColumnWidthCommand,\n    Command: Command,\n    Context: Context,\n    Controller: Controller,\n    CopyCommand: CopyCommand,\n    CustomFilter: CustomFilter,\n    CutCommand: CutCommand,\n    Deferred: Deferred,\n    DefineNameCommand: DefineNameCommand,\n    DeleteColumnCommand: DeleteColumnCommand,\n    DeleteCommand: DeleteCommand,\n    DeleteDrawingCommand: DeleteDrawingCommand,\n    DeleteNameCommand: DeleteNameCommand,\n    DeleteRowCommand: DeleteRowCommand,\n    Drawing: Drawing,\n    DrawingCommand: DrawingCommand,\n    DrawingUpdateCommand: DrawingUpdateCommand,\n    DynamicFilter: DynamicFilter,\n    EditCommand: EditCommand,\n    EditValidationCommand: EditValidationCommand,\n    EventListener: EventListener,\n    FIRSTREF: FIRSTREF,\n    Filter: Filter,\n    FilterCommand: FilterCommand,\n    FormulaBar: FormulaBar,\n    FormulaContext: FormulaContext,\n    FormulaInput: FormulaInput,\n    FreezePanesCommand: FreezePanesCommand,\n    Grid: Grid,\n    GridLinesChangeCommand: GridLinesChangeCommand,\n    HideLineCommand: HideLineCommand,\n    HyperlinkCommand: HyperlinkCommand,\n    InsertCommentCommand: InsertCommentCommand,\n    InsertImageCommand: InsertImageCommand,\n    Matrix: Matrix,\n    MergeCellCommand: MergeCellCommand,\n    NULLREF: NULLREF,\n    NameCommand: NameCommand,\n    NameEditor: NameEditor,\n    NameRef: NameRef,\n    OpenCommand: OpenCommand,\n    Pane: Pane,\n    PaneAxis: PaneAxis,\n    PaneGrid: PaneGrid,\n    PasteCommand: PasteCommand,\n    PropertyBag: PropertyBag,\n    PropertyChangeCommand: PropertyChangeCommand,\n    PropertyCleanCommand: PropertyCleanCommand,\n    Range: Range$1,\n    RangeList: RangeList,\n    RangeRef: RangeRef,\n    RangeTree: RangeTree,\n    Ref: Ref,\n    ReorderDrawingsCommand: ReorderDrawingsCommand,\n    RowHeightCommand: RowHeightCommand,\n    SHEETREF: SHEETREF,\n    SaveAsCommand: SaveAsCommand,\n    SendToBackCommand: SendToBackCommand,\n    Sheet: Sheet,\n    SheetDataSourceBinder: SheetDataSourceBinder,\n    SheetEditor: SheetEditor,\n    SheetNavigator: SheetNavigator,\n    SortCommand: SortCommand,\n    Sorter: Sorter,\n    SpreadsheetWidget: SpreadsheetWidget,\n    TargetValueCommand: TargetValueCommand,\n    TextWrapCommand: TextWrapCommand,\n    ToolbarCopyCommand: ToolbarCopyCommand,\n    ToolbarCutCommand: ToolbarCutCommand,\n    ToolbarPasteCommand: ToolbarPasteCommand,\n    TopFilter: TopFilter,\n    UnHideLineCommand: UnHideLineCommand,\n    UnionRef: UnionRef,\n    ValidationFormulaContext: ValidationFormulaContext,\n    ValueFilter: ValueFilter,\n    View: View,\n    Workbook: Workbook,\n    calc: calc,\n    dateToNumber: dateToNumber,\n    dateToSerial: dateToSerial,\n    defineAlias: defineAlias,\n    defineFunction: defineFunction,\n    draw: draw,\n    drawCell: drawCell,\n    formatting: formatting,\n    initDynamicFilter: initDynamicFilter,\n    intl: intl,\n    numberToDate: numberToDate,\n    packDate: packDate,\n    packTime: packTime,\n    registerEditor: registerEditor,\n    serialToDate: serialToDate,\n    unpackDate: unpackDate,\n    unpackTime: unpackTime,\n    validation: validationExport\n  });\n\n  exports.__meta__ = __meta__;\n  exports.c = commonEngine;\n\n}));\n"]}