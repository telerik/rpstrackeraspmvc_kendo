{"version":3,"file":"kendo.ooxml.cmn.chunk.min.js","names":["global","factory","exports","module","require","define","amd","globalThis","self","kendo","_globals","OoxmlCmnChunk","JszipEsmCmnChunk","this","kendo_jszipEsm_cmn_chunk_js","current$1","compile","template","TemplateService","register","userImplementation","FIELD_REGEX","getterCache","UNDEFINED","getter","field","fields","replace","match","index","indexAccessor","push","obj","result","idx","length","map","array","func","reduce","el","i","val","defaultGroupHeaderTemplate","data","createArray","callback","defaultItemId","item","id","ExcelExporter","options","columns","_trimColumns","allColumns","_leafColumns","_prepareColumn","_visibleColumns","aggregates","groups","concat","hasGroups","hierarchy","hasGroupHeaderColumn","some","column","groupHeaderColumnTemplate","collapsible","prototype","workbook","sheets","_columns","rows","_hierarchyRows","_rows","freezePane","_freezePane","filter","_filter","this$1$1","Boolean","value","dataItem","values","forEach","text","Object","assign","groupHeaderTemplate","groupFooterTemplate","footerTemplate","filterable","depth","_depth","from","to","_createPaddingCells","background","color","paddingCellOptions","_dataRow","level","cells","items","_groupHeaderCells","_dataRows","unshift","type","_footer","dataCells","cellIdx","_cell","colSpan","title","group","groupHeaderCellOptions","undefined","dataItems","apply","previousItemId","itemLevel","itemId","hasFooter","_hasFooterTemplate","parents","previousLevel","_hierarchyFooterRows","rootAggregate","parentId","_hierarchyFooter","_prependHeaderRows","currentLevel","parent","pop","fieldAggregates","footerCellOptions","templateData","footer","keys","key","groupFooterCellOptions","_isColumnVisible","exportable","excel","visibleInExport","hidden","visibleInExportOnly","visible","_headerRow","row","headers","cell","rowSpan","firstCell","headerPaddingCellOptions","headerRows","_prepareHeaderRows","parentCell","parentRow","childRow","totalColSpan","headerCellOptions","_headerDepth","max","temp","colSplit","locked","rowSplit","cellOptions","width","parseInt","autoWidth","current","toString","IntlService","dateToJulianDays","y","m","d","format","BASE_DATE","dateToSerial","date","hh","mm","ss","ms","time","getHours","getMinutes","getSeconds","getMilliseconds","serial","year","month","packDate","getFullYear","getMonth","getDate","MIME_TYPE","DATA_URL_PREFIX","DATA_URL_OPTIONS","compression","BLOB_OPTIONS","ARRAYBUFFER_OPTIONS","toDataURI","content","indexOf","thing","parseJSON","JSON","parse","bind","ESC","String","repeat","count","str","foreach","arr","Array","isArray","XMLHEAD","RELS","WORKSHEET","ref$1","frozenColumns","frozenRows","defaults","mergeCells","autoFilter","showGridLines","hyperlinks","validations","defaultCellStyleId","rtl","legacyDrawing","drawing","lastRow","lastCol","hasDisabledCells","ref","fromCharCode","skipCustomHeight","rowHeight","columnWidth","toWidth","ci","columnIndex","ri","height","style","formula","src","writeFormula","spreadsheetFilters","sqref","join","operator","error","errorTitle","formula1","formula2","link","DRAWINGS_RELS_XML","rels","rel","numChar","colIndex","letter","Math","floor","rowIndex","$ref","filterRowIndex","px","Worksheet","sharedStrings","styles","borders","_strings","_styles","_borders","_validations","_comments","_drawings","drawings","_hyperlinks","rId","countData","last","relsToXML","comments","sheetIndex","target","WORKSHEET_RELS","toXML","mergedCells","rowData","rowsByIndex","indexRows","_source","sorted","sortByIndex","slice","ctx","fillCells","inflate","_readCells","hasOwnProperty","call","defaultCellStyle","_hasDisabledCells","disabled","_lookupStyle","_getLastRow","_getLastCol","commentsXML","comment","COMMENTS_XML","drawingsXML","images","main","drw","parseRef","topLeftCell","img","image","col","colOffset","pixelsToExcel","offsetX","rowOffset","offsetY","imageId","LEGACY_DRAWING","_lookupString","indexes","uniqueCount","json","stringify","_lookupBorder","border","j","cellData","cellIndex","EMPTY_CELL","borderLeft","left","borderRight","right","borderTop","top","borderBottom","bottom","dBorders","diagonal","add","defStyle","borderId","prop","enable","displayValue","stripFunnyChars","Number","getTime","cellName","validation","_addValidation","anchor","v","tmp","showErrorMessage","MAP_EXCEL_TYPE","dataType","MAP_EXCEL_OPERATOR","comparerType","allowBlank","allowNulls","showDropDown","showButton","messageTemplate","titleTemplate","greaterThanOrEqualTo","lessThanOrEqualTo","number","defaultFormats","General","t0","convertColor","hex","x","exec","trim","parseFloat","maybeRGB","$0","$1","substring","toUpperCase","Workbook","_images","_imgId","_sheets","borderSideTemplate","name","alias","size","borderTemplate","diag","imageFilename","mimeType","toZIP","zip","J","docProps","folder","file","creator","lastModifiedBy","created","modified","CORE","Date","toJSON","sheetCount","sheet","APP","xl","WORKBOOK_RELS","media","filename","sheetIds","filterNames","userNames","state","f","test","quoteSheet","localSheetId","WORKBOOK","sheetName","toLowerCase","a","split","names","def","localName","worksheets","drawingsRels","sheetRels","commentFiles","drawingFiles","sheetXML","relsXML","name$1","hasFont","underline","bold","italic","fontFamily","fontSize","fonts","fontInPt","fontInPx","formats","fills","fi","font","fill","fontId","fillId","numFmtId","textAlign","verticalAlign","wrap","indent","STYLES","SHARED_STRINGS","CONTENT_TYPES","toDataURL","generateAsync","then","generate","toBlob","Blob","sort","b","getSpan","topLeft","bottomRight","upperStr","charCodeAt","getcol","round","insertCell","topLeftRef","spanCell","nextRow","insertCellAt","appendCell","startIndex","SPREADSHEET_FILTERS","generators","SPREADSHEET_CUSTOM_FILTER","logic","criteria","op","customOperator","customValue","SPREADSHEET_DYNAMIC_FILTER","dynamicFilterType","SPREADSHEET_TOP_FILTER","SPREADSHEET_VALUE_FILTER","blanks","custom","dynamic","eq","gt","gte","lt","lte","ne","doesnotstartwith","doesnotendwith","doesnotcontain","doesnotmatch","esc","quarter1","quarter2","quarter3","quarter4","january","february","march","april","may","june","july","august","september","october","november","december","E","I","T","W","__meta__","category","description","depends","chunk"],"sources":["kendo.ooxml.cmn.chunk.js"],"mappings":"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","ignoreList":[],"sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('kendo.jszip-esm.cmn.chunk.js')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'kendo.jszip-esm.cmn.chunk'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.kendo = global.kendo || {}, global.kendo._globals = global.kendo._globals || {}, global.kendo._globals.OoxmlCmnChunk = {}), global.kendo._globals.JszipEsmCmnChunk));\n})(this, (function (exports, kendo_jszipEsm_cmn_chunk_js) {\n  const __meta__ = {\n      id: \"ooxml.cmn.chunk\",\n      name: \"OoxmlCmnChunk\",\n      category: \"web\",\n      description: \"A reusable outputed chunk of code\",\n      depends: ['jszip-esm.cmn.chunk'],\n      hidden: true,\n      chunk: true\n  };\n\n\n\n  var current$1 = {\n      compile: function(template) {\n          return template;\n      }\n  };\n\n  var TemplateService = function TemplateService () {};\n\n  TemplateService.register = function register (userImplementation) {\n      current$1 = userImplementation;\n  };\n\n  TemplateService.compile = function compile (template) {\n      return current$1.compile(template);\n  };\n\n  var FIELD_REGEX = /\\[(?:(\\d+)|['\"](.*?)['\"])\\]|((?:(?!\\[.*?\\]|\\.).)+)/g;\n  var getterCache = {};\n  var UNDEFINED = 'undefined';\n\n  getterCache[UNDEFINED] = function(obj) {\n      return obj;\n  };\n\n  function getter(field) {\n      if (getterCache[field]) {\n          return getterCache[field];\n      }\n\n      var fields = [];\n      field.replace(FIELD_REGEX, function(match, index, indexAccessor, field) {\n          fields.push(typeof index !== UNDEFINED ? index : (indexAccessor || field));\n      });\n\n      getterCache[field] = function(obj) {\n          var result = obj;\n          for (var idx = 0; idx < fields.length && result; idx++) {\n              result = result[fields[idx]];\n          }\n\n          return result;\n      };\n\n      return getterCache[field];\n  }\n\n  function map(array, func) {\n      return array.reduce(function (result, el, i) {\n          var val = func(el, i);\n          if (val != null) {\n              result.push(val);\n          }\n          return result;\n      }, []);\n  }\n\n  function defaultGroupHeaderTemplate(data) {\n      return ((data.title) + \": \" + (data.value));\n  }\n\n  function createArray(length, callback) {\n      var result = [];\n\n      for (var idx = 0; idx < length; idx++) {\n          result.push(callback(idx));\n      }\n\n      return result;\n  }\n\n  function defaultItemId(item) {\n      return item.id;\n  }\n\n  var ExcelExporter = function ExcelExporter(options) {\n      options.columns = this._trimColumns(options.columns || []);\n\n      this.allColumns = map(this._leafColumns(options.columns || []), this._prepareColumn);\n\n      this.columns = this._visibleColumns(this.allColumns);\n\n      this.options = options;\n      this.data = options.data || [];\n      this.aggregates = options.aggregates || {};\n      this.groups = [].concat(options.groups || []);\n      this.hasGroups = this.groups.length > 0;\n      this.hierarchy = options.hierarchy;\n      this.hasGroupHeaderColumn = this.columns.some(function (column) { return column.groupHeaderColumnTemplate; });\n      this.collapsible = this.options.collapsible;\n  };\n\n  ExcelExporter.prototype.workbook = function workbook () {\n      var workbook = {\n          sheets: [ {\n              columns: this._columns(),\n              rows: this.hierarchy ? this._hierarchyRows() : this._rows(),\n              freezePane: this._freezePane(),\n              filter: this._filter()\n          } ]\n      };\n\n      return workbook;\n  };\n\n  ExcelExporter.prototype._trimColumns = function _trimColumns (columns) {\n          var this$1$1 = this;\n\n      return columns.filter(function (column) {\n          var result = Boolean(column.field);\n\n          if (!result && column.columns) {\n              result = this$1$1._trimColumns(column.columns).length > 0;\n          }\n\n          return result;\n      });\n  };\n\n  ExcelExporter.prototype._leafColumns = function _leafColumns (columns) {\n          var this$1$1 = this;\n\n      var result = [];\n\n      for (var idx = 0; idx < columns.length; idx++) {\n          if (!columns[idx].columns) {\n              result.push(columns[idx]);\n          } else {\n              result = result.concat(this$1$1._leafColumns(columns[idx].columns));\n          }\n      }\n\n      return result;\n  };\n\n  ExcelExporter.prototype._prepareColumn = function _prepareColumn (column) {\n      if (!column.field) {\n          return null;\n      }\n\n      var value = function(dataItem) {\n          return getter(column.field, true)(dataItem);\n      };\n\n      var values = null;\n\n      if (column.values) {\n          values = {};\n\n          column.values.forEach(function(item) {\n              values[item.value] = item.text;\n          });\n\n          value = function(dataItem) {\n              return values[getter(column.field, true)(dataItem)];\n          };\n      }\n\n      return Object.assign({}, column, {\n          value: value,\n          values: values,\n          groupHeaderTemplate: column.groupHeaderTemplate ? TemplateService.compile(column.groupHeaderTemplate) : defaultGroupHeaderTemplate,\n          groupHeaderColumnTemplate: column.groupHeaderColumnTemplate ? TemplateService.compile(column.groupHeaderColumnTemplate) : null,\n          groupFooterTemplate: column.groupFooterTemplate ? TemplateService.compile(column.groupFooterTemplate) : null,\n          footerTemplate: column.footerTemplate ? TemplateService.compile(column.footerTemplate) : null\n      });\n  };\n\n  ExcelExporter.prototype._filter = function _filter () {\n      if (!this.options.filterable) {\n          return null;\n      }\n\n      var depth = this._depth();\n\n      return {\n          from: depth,\n          to: depth + this.columns.length - 1\n      };\n  };\n\n  ExcelExporter.prototype._createPaddingCells = function _createPaddingCells (length) {\n          var this$1$1 = this;\n\n      return createArray(length, function () { return Object.assign({\n          background: \"#dfdfdf\",\n          color: \"#333\"\n      }, this$1$1.options.paddingCellOptions); });\n  };\n\n  ExcelExporter.prototype._dataRow = function _dataRow (dataItem, level, depth) {\n          var this$1$1 = this;\n\n      var cells = this._createPaddingCells(level);\n\n      // grouped\n      if (this.hasGroups && depth && dataItem.items) {\n          cells = cells.concat(this._groupHeaderCells(dataItem, level, depth));\n          var rows = this._dataRows(dataItem.items, level + 1);\n\n          rows.unshift({\n              type: \"group-header\",\n              cells: cells,\n              level: this.collapsible ? level : null\n          });\n\n          return rows.concat(this._footer(dataItem, level));\n      }\n\n      var dataCells = [];\n\n      for (var cellIdx = 0; cellIdx < this.columns.length; cellIdx++) {\n          dataCells[cellIdx] = this$1$1._cell(dataItem, this$1$1.columns[cellIdx]);\n      }\n\n      if (this.hierarchy) {\n          dataCells[0].colSpan = depth - level + 1;\n      }\n\n      return [ {\n          type: \"data\",\n          cells: cells.concat(dataCells),\n          level: this.collapsible ? level : null\n      } ];\n  };\n\n  ExcelExporter.prototype._groupHeaderCells = function _groupHeaderCells (dataItem, level, depth) {\n      var cells = [];\n\n      var column = this.allColumns.filter(function(column) {\n          return column.field === dataItem.field;\n      })[0] || {};\n\n      var title = column && column.title ? column.title : dataItem.field;\n      var template = column ? column.groupHeaderTemplate || column.groupHeaderColumnTemplate : null;\n      var group = Object.assign({\n          title: title,\n          field: dataItem.field,\n          value: column && column.values ? column.values[dataItem.value] : dataItem.value,\n          aggregates: dataItem.aggregates,\n          items: dataItem.items\n      }, dataItem.aggregates[dataItem.field]);\n\n      var value = template ? template(group) : (title + \": \" + (dataItem.value));\n\n      cells.push(Object.assign({\n          value: value,\n          background: \"#dfdfdf\",\n          color: \"#333\",\n          colSpan: (this.hasGroupHeaderColumn ? 1 : this.columns.length) + depth - level\n      }, column.groupHeaderCellOptions));\n\n      if (this.hasGroupHeaderColumn) {\n          this.columns.forEach(function(column, index) {\n              if (index > 0) {\n                  cells.push(Object.assign({\n                      background: \"#dfdfdf\",\n                      color: \"#333\",\n                      value: column.groupHeaderColumnTemplate ?\n                          column.groupHeaderColumnTemplate(Object.assign({ group: group }, group, dataItem.aggregates[column.field])) :\n                          undefined\n                  }, column.groupHeaderCellOptions));\n              }\n          });\n      }\n\n      return cells;\n  };\n\n  ExcelExporter.prototype._dataRows = function _dataRows (dataItems, level) {\n          var this$1$1 = this;\n\n      var depth = this._depth();\n      var rows = [];\n\n      for (var idx = 0; idx < dataItems.length; idx++) {\n          rows.push.apply(rows, this$1$1._dataRow(dataItems[idx], level, depth));\n      }\n\n      return rows;\n  };\n\n  ExcelExporter.prototype._hierarchyRows = function _hierarchyRows () {\n          var this$1$1 = this;\n\n      var depth = this._depth();\n      var data = this.data;\n      var itemLevel = this.hierarchy.itemLevel;\n      var itemId = this.hierarchy.itemId || defaultItemId;\n      var hasFooter = this._hasFooterTemplate();\n      var rows = [];\n      var parents = [];\n      var previousLevel = 0;\n      var previousItemId;\n\n      if (!hasFooter) {\n          this.collapsible = false;\n      }\n\n      for (var idx = 0; idx < data.length; idx++) {\n          var item = data[idx];\n          var level = itemLevel(item, idx);\n\n          if (hasFooter) {\n              if (level > previousLevel) {\n                  parents.push({ id: previousItemId, level: previousLevel });\n              } else if (level < previousLevel) {\n                  rows.push.apply(rows, this$1$1._hierarchyFooterRows(parents, level, depth));\n              }\n\n              previousLevel = level;\n              previousItemId = itemId(item, idx);\n          }\n\n          rows.push.apply(rows, this$1$1._dataRow(item, level + 1, depth));\n      }\n\n      if (hasFooter) {\n          rows.push.apply(rows, this._hierarchyFooterRows(parents, 0, depth));\n\n          var rootAggregate = data.length ? this.aggregates[data[0].parentId] : {};\n          rows.push(this._hierarchyFooter(rootAggregate, 0, depth));\n      }\n\n      this._prependHeaderRows(rows);\n\n      return rows;\n  };\n\n  ExcelExporter.prototype._hierarchyFooterRows = function _hierarchyFooterRows (parents, currentLevel, depth) {\n          var this$1$1 = this;\n\n      var rows = [];\n      while (parents.length && parents[parents.length - 1].level >= currentLevel) {\n          var parent = parents.pop();\n          rows.push(this$1$1._hierarchyFooter(this$1$1.aggregates[parent.id], parent.level + 1, depth));\n      }\n\n      return rows;\n  };\n\n  ExcelExporter.prototype._hasFooterTemplate = function _hasFooterTemplate () {\n      var columns = this.columns;\n      for (var idx = 0; idx < columns.length; idx++) {\n          if (columns[idx].footerTemplate) {\n              return true;\n          }\n      }\n  };\n\n  ExcelExporter.prototype._hierarchyFooter = function _hierarchyFooter (aggregates, level, depth) {\n      var cells = this.columns.map(function(column, index) {\n          var colSpan = index ? 1 : depth - level + 1;\n          if (column.footerTemplate) {\n              var fieldAggregates = (aggregates || {})[column.field];\n              return Object.assign({\n                  background: \"#dfdfdf\",\n                  color: \"#333\",\n                  colSpan: colSpan,\n                  value: column.footerTemplate(Object.assign({ aggregates: aggregates }, fieldAggregates))\n              }, column.footerCellOptions);\n          }\n\n          return Object.assign({\n              background: \"#dfdfdf\",\n              color: \"#333\",\n              colSpan: colSpan\n          }, column.footerCellOptions);\n      });\n\n      return {\n          type: \"footer\",\n          cells: this._createPaddingCells(level).concat(cells),\n          level: this.collapsible ? level : null\n      };\n  };\n\n  ExcelExporter.prototype._footer = function _footer (dataItem, level) {\n      var rows = [];\n      var footer = this.columns.some(function (column) { return column.groupFooterTemplate; });\n\n      var templateData, group;\n      if (footer) {\n          group = {\n              group: { items: dataItem.items,\n                       field: dataItem.field,\n                       value: dataItem.value }\n          };\n          templateData = {};\n          Object.keys(dataItem.aggregates).forEach(function (key) {\n              templateData[key] = Object.assign({}, dataItem.aggregates[key], group);\n          });\n      }\n\n      var cells = this.columns.map(function (column) {\n          if (column.groupFooterTemplate) {\n              var data = Object.assign({}, templateData, dataItem.aggregates[column.field], group);\n              return Object.assign({\n                  background: \"#dfdfdf\",\n                  color: \"#333\",\n                  value: column.groupFooterTemplate(data)\n              }, column.groupFooterCellOptions);\n          }\n\n          return Object.assign({\n              background: \"#dfdfdf\",\n              color: \"#333\"\n          }, column.groupFooterCellOptions);\n      });\n\n      if (footer) {\n          rows.push({\n              type: \"group-footer\",\n              cells: this._createPaddingCells(this.groups.length).concat(cells),\n              level: this.collapsible ? level : null\n          });\n      }\n\n      return rows;\n  };\n\n  ExcelExporter.prototype._isColumnVisible = function _isColumnVisible (column) {\n      return this._visibleColumns([ column ]).length > 0 && (column.field || column.columns);\n  };\n\n  ExcelExporter.prototype._visibleColumns = function _visibleColumns (columns) {\n          var this$1$1 = this;\n\n      return columns.filter(function (column) {\n          var exportable = column.exportable;\n          if (typeof exportable === 'object') {\n              exportable = column.exportable.excel;\n          }\n\n          var visibleInExport = !column.hidden && exportable !== false;\n          var visibleInExportOnly = column.hidden && exportable === true;\n          var visible = visibleInExport || visibleInExportOnly;\n          if (visible && column.columns) {\n              visible = this$1$1._visibleColumns(column.columns).length > 0;\n          }\n          return visible;\n      });\n  };\n\n  ExcelExporter.prototype._headerRow = function _headerRow (row, groups) {\n          var this$1$1 = this;\n\n      var headers = row.cells.map(function(cell) {\n          return Object.assign(cell, {\n              colSpan: cell.colSpan > 1 ? cell.colSpan : 1,\n              rowSpan: row.rowSpan > 1 && !cell.colSpan ? row.rowSpan : 1\n          });\n      });\n\n      if (this.hierarchy && headers[0].firstCell) {\n          headers[0].colSpan += this._depth();\n      }\n\n      return {\n          type: \"header\",\n          cells: createArray(groups.length, function () { return Object.assign({\n              background: \"#7a7a7a\",\n              color: \"#fff\"\n          }, this$1$1.options.headerPaddingCellOptions); }).concat(headers)\n      };\n  };\n\n  ExcelExporter.prototype._prependHeaderRows = function _prependHeaderRows (rows) {\n          var this$1$1 = this;\n\n      var groups = this.groups;\n\n      var headerRows = [ { rowSpan: 1, cells: [], index: 0 } ];\n\n      this._prepareHeaderRows(headerRows, this.options.columns);\n\n      for (var idx = headerRows.length - 1; idx >= 0; idx--) {\n          rows.unshift(this$1$1._headerRow(headerRows[idx], groups));\n      }\n  };\n\n  ExcelExporter.prototype._prepareHeaderRows = function _prepareHeaderRows (rows, columns, parentCell, parentRow) {\n          var this$1$1 = this;\n\n      var row = parentRow || rows[rows.length - 1];\n      var childRow = rows[row.index + 1];\n      var totalColSpan = 0;\n\n      for (var idx = 0; idx < columns.length; idx++) {\n          var column = columns[idx];\n          if (this$1$1._isColumnVisible(column)) {\n\n              var cell = Object.assign({\n                  background: \"#7a7a7a\",\n                  color: \"#fff\",\n                  value: column.title || column.field,\n                  colSpan: 0,\n                  firstCell: idx === 0 && (!parentCell || parentCell.firstCell)\n              }, column.headerCellOptions);\n              row.cells.push(cell);\n\n              if (column.columns && column.columns.length) {\n                  if (!childRow) {\n                      childRow = { rowSpan: 0, cells: [], index: rows.length };\n                      rows.push(childRow);\n                  }\n                  cell.colSpan = this$1$1._trimColumns(this$1$1._visibleColumns(column.columns)).length;\n                  this$1$1._prepareHeaderRows(rows, column.columns, cell, childRow);\n                  totalColSpan += cell.colSpan - 1;\n                  row.rowSpan = rows.length - row.index;\n              }\n          }\n      }\n\n      if (parentCell) {\n          parentCell.colSpan += totalColSpan;\n      }\n  };\n\n  ExcelExporter.prototype._rows = function _rows () {\n          var this$1$1 = this;\n\n      var rows = this._dataRows(this.data, 0);\n\n      if (this.columns.length) {\n          this._prependHeaderRows(rows);\n          var footer = false;\n\n          var cells = this.columns.map(function (column) {\n              if (column.footerTemplate) {\n                  footer = true;\n\n                  return Object.assign({\n                      background: \"#dfdfdf\",\n                      color: \"#333\",\n                      value: column.footerTemplate(Object.assign({}, this$1$1.aggregates, this$1$1.aggregates[column.field]))\n                  }, column.footerCellOptions);\n              }\n\n              return Object.assign({\n                  background: \"#dfdfdf\",\n                  color: \"#333\"\n              }, column.footerCellOptions);\n          });\n\n          if (footer) {\n              rows.push({\n                  type: \"footer\",\n                  cells: this._createPaddingCells(this.groups.length).concat(cells)\n              });\n          }\n      }\n\n      return rows;\n  };\n\n  ExcelExporter.prototype._headerDepth = function _headerDepth (columns) {\n          var this$1$1 = this;\n\n      var result = 1;\n      var max = 0;\n\n      for (var idx = 0; idx < columns.length; idx++) {\n          if (columns[idx].columns) {\n              var temp = this$1$1._headerDepth(columns[idx].columns);\n              if (temp > max) {\n                  max = temp;\n              }\n          }\n      }\n      return result + max;\n  };\n\n  ExcelExporter.prototype._freezePane = function _freezePane () {\n      var columns = this._visibleColumns(this.options.columns || []);\n\n      var colSplit = this._visibleColumns(this._trimColumns(this._leafColumns(columns.filter(function(column) {\n          return column.locked;\n      })))).length;\n\n      return {\n          rowSplit: this._headerDepth(columns),\n          colSplit: colSplit ? colSplit + this.groups.length : 0\n      };\n  };\n\n  ExcelExporter.prototype._cell = function _cell (dataItem, column) {\n      return Object.assign({\n          value: column.value(dataItem)\n      }, column.cellOptions);\n  };\n\n  ExcelExporter.prototype._depth = function _depth () {\n      var depth = 0;\n\n      if (this.hierarchy) {\n          depth = this.hierarchy.depth;\n      } else {\n          depth = this.groups.length;\n      }\n\n      return depth;\n  };\n\n  ExcelExporter.prototype._columns = function _columns () {\n      var depth = this._depth();\n      var columns = createArray(depth, function () { return ({ width: 20 }); });\n\n      return columns.concat(this.columns.map(function(column) {\n          return {\n              width: parseInt(column.width, 10),\n              autoWidth: column.width ? false : true\n          };\n      }));\n  };\n\n  var current = {\n      toString: function (value) { return value; }\n  };\n\n  var IntlService = function IntlService () {};\n\n  IntlService.register = function register (userImplementation) {\n      current = userImplementation;\n  };\n\n  IntlService.toString = function toString (value, format) {\n      return current.toString(value, format);\n  };\n\n  function createZip() {\n      return new kendo_jszipEsm_cmn_chunk_js.J();\n  }\n\n  // date packing utilities from Kendo Spreadsheet\n\n  // Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n  function dateToJulianDays(y, m, d) {\n      return ((1461 * (y + 4800 + ((m - 13) / 12 | 0))) / 4 | 0) +\n          ((367 * (m - 1 - 12 * ((m - 13) / 12 | 0))) / 12 | 0) -\n          ((3 * (((y + 4900 + ((m - 13) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n          d - 32075;\n  }\n\n  // This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n  // implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\n  var BASE_DATE = dateToJulianDays(1900, 0, -1);\n\n  function packDate(year, month, date) {\n      return dateToJulianDays(year, month, date) - BASE_DATE;\n  }\n\n  function packTime(hh, mm, ss, ms) {\n      return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n  }\n\n  function dateToSerial(date) {\n      var time = packTime(date.getHours(),\n                            date.getMinutes(),\n                            date.getSeconds(),\n                            date.getMilliseconds());\n      var serial = packDate(date.getFullYear(),\n                              date.getMonth(),\n                              date.getDate());\n      return serial < 0 ? serial - 1 + time : serial + time;\n  }\n\n  var MIME_TYPE = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n  var DATA_URL_PREFIX = \"data:\" + MIME_TYPE + \";base64,\";\n  var DATA_URL_OPTIONS = { compression: \"DEFLATE\", type: \"base64\" };\n  var BLOB_OPTIONS = { compression: \"DEFLATE\", type: \"blob\" };\n  var ARRAYBUFFER_OPTIONS = { compression: \"DEFLATE\", type: \"arraybuffer\" };\n\n  /* eslint-disable key-spacing, no-confusing-arrow, no-constant-condition, indent, no-nested-ternary, consistent-return */\n\n  function toDataURI(content) {\n      return DATA_URL_PREFIX + content;\n  }\n\n  function indexOf(thing, array) {\n      return array.indexOf(thing);\n  }\n\n  var parseJSON = JSON.parse.bind(JSON);\n\n  function ESC(val) {\n      return String(val)\n          .replace(/&/g, \"&amp;\")\n          .replace(/</g, \"&lt;\")\n          .replace(/>/g, \"&gt;\")\n          .replace(/\\\"/g, \"&quot;\")\n          .replace(/\\'/g, \"&#39;\");\n  }\n\n  function repeat(count, func) {\n      var str = \"\";\n      for (var i = 0; i < count; ++i) {\n          str += func(i);\n      }\n      return str;\n  }\n\n  function foreach(arr, func) {\n      var str = \"\";\n      if (arr != null) {\n          if (Array.isArray(arr)) {\n              for (var i = 0; i < arr.length; ++i) {\n                  str += func(arr[i], i);\n              }\n          } else if (typeof arr == \"object\") {\n              Object.keys(arr).forEach(function (key, i) {\n                  str += func(arr[key], key, i);\n              });\n          }\n      }\n      return str;\n  }\n\n  var XMLHEAD = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r';\n\n  var RELS = XMLHEAD + \"\\n            <Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n               <Relationship Id=\\\"rId3\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\\\" Target=\\\"docProps/app.xml\\\"/>\\n               <Relationship Id=\\\"rId2\\\" Type=\\\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\\\" Target=\\\"docProps/core.xml\\\"/>\\n               <Relationship Id=\\\"rId1\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\\\" Target=\\\"xl/workbook.xml\\\"/>\\n            </Relationships>\";\n\n  var CORE = function (ref) {\n    var creator = ref.creator;\n    var lastModifiedBy = ref.lastModifiedBy;\n    var created = ref.created;\n    var modified = ref.modified;\n\n    return (XMLHEAD + \"\\n <cp:coreProperties xmlns:cp=\\\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\\\"\\n   xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\" xmlns:dcterms=\\\"http://purl.org/dc/terms/\\\"\\n   xmlns:dcmitype=\\\"http://purl.org/dc/dcmitype/\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\n   <dc:creator>\" + (ESC(creator)) + \"</dc:creator>\\n   <cp:lastModifiedBy>\" + (ESC(lastModifiedBy)) + \"</cp:lastModifiedBy>\\n   <dcterms:created xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(created)) + \"</dcterms:created>\\n   <dcterms:modified xsi:type=\\\"dcterms:W3CDTF\\\">\" + (ESC(modified)) + \"</dcterms:modified>\\n</cp:coreProperties>\");\n  };\n\n  var APP = function (ref) {\n    var sheets = ref.sheets;\n\n    return (XMLHEAD + \"\\n<Properties xmlns=\\\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\\\" xmlns:vt=\\\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\\\">\\n  <Application>Microsoft Excel</Application>\\n  <DocSecurity>0</DocSecurity>\\n  <ScaleCrop>false</ScaleCrop>\\n  <HeadingPairs>\\n    <vt:vector size=\\\"2\\\" baseType=\\\"variant\\\">\\n      <vt:variant>\\n        <vt:lpstr>Worksheets</vt:lpstr>\\n      </vt:variant>\\n      <vt:variant>\\n        <vt:i4>\" + (sheets.length) + \"</vt:i4>\\n      </vt:variant>\\n    </vt:vector>\\n  </HeadingPairs>\\n  <TitlesOfParts>\\n    <vt:vector size=\\\"\" + (sheets.length) + \"\\\" baseType=\\\"lpstr\\\">\" + (foreach(sheets, function (sheet, i) { return sheet.options.title\n            ? (\"<vt:lpstr>\" + (ESC(sheet.options.title)) + \"</vt:lpstr>\")\n            : (\"<vt:lpstr>Sheet\" + (i + 1) + \"</vt:lpstr>\"); }\n        )) + \"</vt:vector>\\n  </TitlesOfParts>\\n  <LinksUpToDate>false</LinksUpToDate>\\n  <SharedDoc>false</SharedDoc>\\n  <HyperlinksChanged>false</HyperlinksChanged>\\n  <AppVersion>14.0300</AppVersion>\\n</Properties>\");\n  };\n\n  var CONTENT_TYPES = function (ref) {\n    var sheetCount = ref.sheetCount;\n    var commentFiles = ref.commentFiles;\n    var drawingFiles = ref.drawingFiles;\n\n    return (XMLHEAD + \"\\n<Types xmlns=\\\"http://schemas.openxmlformats.org/package/2006/content-types\\\">\\n  <Default Extension=\\\"png\\\" ContentType=\\\"image/png\\\"/>\\n  <Default Extension=\\\"gif\\\" ContentType=\\\"image/gif\\\"/>\\n  <Default Extension=\\\"jpg\\\" ContentType=\\\"image/jpeg\\\"/>\\n  <Default Extension=\\\"rels\\\" ContentType=\\\"application/vnd.openxmlformats-package.relationships+xml\\\" />\\n  <Default Extension=\\\"xml\\\" ContentType=\\\"application/xml\\\" />\\n  <Default Extension=\\\"vml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.vmlDrawing\\\"/>\\n  <Override PartName=\\\"/xl/workbook.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\\\" />\\n  <Override PartName=\\\"/xl/styles.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\\\"/>\\n  <Override PartName=\\\"/xl/sharedStrings.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\\\"/>\\n  \" + (repeat(sheetCount, function (idx) { return (\"<Override PartName=\\\"/xl/worksheets/sheet\" + (idx + 1) + \".xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\\\" />\"); })) + \"\\n  \" + (foreach(commentFiles, function (filename) { return (\"<Override PartName=\\\"/xl/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\\\"/>\"); })) + \"\\n  \" + (foreach(drawingFiles, function (filename) { return (\"<Override PartName=\\\"/xl/drawings/\" + filename + \"\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.drawing+xml\\\"/>\"); })) + \"\\n  <Override PartName=\\\"/docProps/core.xml\\\" ContentType=\\\"application/vnd.openxmlformats-package.core-properties+xml\\\" />\\n  <Override PartName=\\\"/docProps/app.xml\\\" ContentType=\\\"application/vnd.openxmlformats-officedocument.extended-properties+xml\\\" />\\n</Types>\");\n  };\n\n  var WORKBOOK = function (ref) {\n    var sheets = ref.sheets;\n    var filterNames = ref.filterNames;\n    var userNames = ref.userNames;\n\n    return (XMLHEAD + \"\\n<workbook xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  <fileVersion appName=\\\"xl\\\" lastEdited=\\\"5\\\" lowestEdited=\\\"5\\\" rupBuild=\\\"9303\\\" />\\n  <workbookPr defaultThemeVersion=\\\"124226\\\" />\\n  <bookViews>\\n    <workbookView xWindow=\\\"240\\\" yWindow=\\\"45\\\" windowWidth=\\\"18195\\\" windowHeight=\\\"7995\\\" />\\n  </bookViews>\\n  <sheets>\\n  \" + (foreach(sheets, function (ref, i) {\n      var options = ref.options;\n\n      var name = options.name || options.title || (\"Sheet\" + (i + 1));\n      var state = options.state || 'visible';\n      return (\"<sheet name=\\\"\" + (ESC(name)) + \"\\\" state=\\\"\" + state + \"\\\" sheetId=\\\"\" + (i + 1) + \"\\\" r:id=\\\"rId\" + (i + 1) + \"\\\" />\");\n    })) + \"\\n  </sheets>\\n  \" + (filterNames.length || userNames.length ? (\"\\n    <definedNames>\\n      \" + (foreach(filterNames, function (f) { return (\"\\n         <definedName name=\\\"_xlnm._FilterDatabase\\\" hidden=\\\"1\\\" localSheetId=\\\"\" + (f.localSheetId) + \"\\\">\" + (ESC(quoteSheet(f.name))) + \"!\" + (ESC(f.from)) + \":\" + (ESC(f.to)) + \"</definedName>\"); })) + \"\\n      \" + (foreach(userNames, function (f) { return (\"\\n         <definedName name=\\\"\" + (f.name) + \"\\\" hidden=\\\"\" + (f.hidden ? 1 : 0) + \"\\\" \" + (f.localSheetId != null ? (\"localSheetId=\\\"\" + (f.localSheetId) + \"\\\"\") : '') + \">\" + (ESC(f.value)) + \"</definedName>\"); })) + \"\\n    </definedNames>\") : '') + \"\\n  <calcPr fullCalcOnLoad=\\\"1\\\" calcId=\\\"145621\\\" />\\n</workbook>\");\n  };\n\n  var WORKSHEET = function (ref$1) {\n    var frozenColumns = ref$1.frozenColumns;\n    var frozenRows = ref$1.frozenRows;\n    var columns = ref$1.columns;\n    var defaults = ref$1.defaults;\n    var data = ref$1.data;\n    var index = ref$1.index;\n    var mergeCells = ref$1.mergeCells;\n    var autoFilter = ref$1.autoFilter;\n    var filter = ref$1.filter;\n    var showGridLines = ref$1.showGridLines;\n    var hyperlinks = ref$1.hyperlinks;\n    var validations = ref$1.validations;\n    var defaultCellStyleId = ref$1.defaultCellStyleId;\n    var rtl = ref$1.rtl;\n    var legacyDrawing = ref$1.legacyDrawing;\n    var drawing = ref$1.drawing;\n    var lastRow = ref$1.lastRow;\n    var lastCol = ref$1.lastCol;\n    var hasDisabledCells = ref$1.hasDisabledCells;\n\n    return (XMLHEAD + \"\\n<worksheet xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\" xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\" xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\" mc:Ignorable=\\\"x14ac\\\">\\n   \" + (lastRow && lastCol ? (\"<dimension ref=\\\"A1:\" + (ref(lastRow - 1, lastCol - 1)) + \"\\\" />\") : \"\") + \"\\n\\n   <sheetViews>\\n     <sheetView \" + (rtl ? 'rightToLeft=\"1\"' : '') + \" \" + (index === 0 ? 'tabSelected=\"1\"' : '') + \" workbookViewId=\\\"0\\\" \" + (showGridLines === false ? 'showGridLines=\"0\"' : '') + \">\\n     \" + (frozenRows || frozenColumns ? (\"\\n       <pane state=\\\"frozen\\\"\\n         \" + (frozenColumns ? (\"xSplit=\\\"\" + frozenColumns + \"\\\"\") : '') + \"\\n         \" + (frozenRows ? (\"ySplit=\\\"\" + frozenRows + \"\\\"\") : '') + \"\\n         topLeftCell=\\\"\" + (String.fromCharCode(65 + (frozenColumns || 0)) + ((frozenRows || 0) + 1)) + \"\\\"\\n       />\") : '') + \"\\n     </sheetView>\\n   </sheetViews>\\n\\n   <sheetFormatPr x14ac:dyDescent=\\\"0.25\\\" \" + (!defaults.skipCustomHeight ? 'customHeight=\"1\"' : '') + \" defaultRowHeight=\\\"\" + (defaults.rowHeight ? defaults.rowHeight * 0.75 : 15) + \"\\\"\\n     \" + (defaults.columnWidth ? (\"defaultColWidth=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" />\\n\\n   \" + (defaultCellStyleId != null || (columns && columns.length > 0) ? (\"\\n     <cols>\\n       \" + (!columns || !columns.length ? (\"\\n         <col min=\\\"1\\\" max=\\\"16384\\\" style=\\\"\" + defaultCellStyleId + \"\\\"\\n              \" + (defaults.columnWidth ? (\"width=\\\"\" + (toWidth(defaults.columnWidth)) + \"\\\"\") : '') + \" /> \") : '') + \"\\n       \" + (foreach(columns, function (column, ci) {\n           var columnIndex = typeof column.index === \"number\" ? column.index + 1 : (ci + 1);\n           if (column.width === 0) {\n             return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                        min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" hidden=\\\"1\\\" customWidth=\\\"1\\\" />\");\n           }\n           return (\"<col \" + (defaultCellStyleId != null ? (\"style=\\\"\" + defaultCellStyleId + \"\\\"\") : '') + \"\\n                      min=\\\"\" + columnIndex + \"\\\" max=\\\"\" + columnIndex + \"\\\" customWidth=\\\"1\\\"\\n                      \" + (column.autoWidth\n                            ? (\"width=\\\"\" + (((column.width * 7 + 5) / 7 * 256) / 256) + \"\\\" bestFit=\\\"1\\\"\")\n                            : (\"width=\\\"\" + (toWidth(column.width)) + \"\\\"\")) + \" />\");\n         })) + \"\\n     </cols>\") : '') + \"\\n\\n   <sheetData>\\n     \" + (foreach(data, function (row, ri) {\n         var rowIndex = typeof row.index === \"number\" ? row.index + 1 : (ri + 1);\n         return (\"\\n         <row r=\\\"\" + rowIndex + \"\\\" x14ac:dyDescent=\\\"0.25\\\"\\n              \" + (row.level ? (\"outlineLevel=\\\"\" + (row.level) + \"\\\"\") : '') + \"\\n              \" + (row.height === 0 ? 'hidden=\"1\"'\n                                   : row.height ? (\"ht=\\\"\" + (toHeight(row.height)) + \"\\\" customHeight=\\\"1\\\"\") : \"\") + \">\\n           \" + (foreach(row.data, function (cell) { return (\"\\n             <c r=\\\"\" + (cell.ref) + \"\\\" \" + (cell.style ? (\"s=\\\"\" + (cell.style) + \"\\\"\") : '') + \" \" + (cell.type ? (\"t=\\\"\" + (cell.type) + \"\\\"\") : '') + \">\\n               \" + (cell.formula != null ? writeFormula(cell.formula) : '') + \"\\n               \" + (cell.value != null ? (\"<v>\" + (ESC(cell.value)) + \"</v>\") : '') + \"\\n             </c>\"); })) + \"\\n         </row>\\n       \");})) + \"\\n   </sheetData>\\n\\n   \" + (hasDisabledCells ? \"<sheetProtection sheet=\\\"1\\\" objects=\\\"1\\\" scenarios=\\\"1\\\"/>\" : '') + \"\\n\\n   \" + (autoFilter ? (\"<autoFilter ref=\\\"\" + (autoFilter.from) + \":\" + (autoFilter.to) + \"\\\"/>\")\n                  : filter ? spreadsheetFilters(filter) : '') + \"\\n\\n   \" + (mergeCells.length ? (\"\\n     <mergeCells count=\\\"\" + (mergeCells.length) + \"\\\">\\n       \" + (foreach(mergeCells, function (ref) { return (\"<mergeCell ref=\\\"\" + ref + \"\\\"/>\"); })) + \"\\n     </mergeCells>\") : '') + \"\\n\\n   \" + (validations.length ? (\"\\n     <dataValidations>\\n       \" + (foreach(validations, function (val) { return (\"\\n         <dataValidation sqref=\\\"\" + (val.sqref.join(\" \")) + \"\\\"\\n                         showErrorMessage=\\\"\" + (val.showErrorMessage) + \"\\\"\\n                         type=\\\"\" + (ESC(val.type)) + \"\\\"\\n                         \" + (val.type !== \"list\" ? (\"operator=\\\"\" + (ESC(val.operator)) + \"\\\"\") : '') + \"\\n                         allowBlank=\\\"\" + (val.allowBlank) + \"\\\"\\n                         showDropDown=\\\"\" + (val.showDropDown) + \"\\\"\\n                         \" + (val.error ? (\"error=\\\"\" + (ESC(val.error)) + \"\\\"\") : '') + \"\\n                         \" + (val.errorTitle ? (\"errorTitle=\\\"\" + (ESC(val.errorTitle)) + \"\\\"\") : '') + \">\\n           \" + (val.formula1 ? (\"<formula1>\" + (ESC(val.formula1)) + \"</formula1>\") : '') + \"\\n           \" + (val.formula2 ? (\"<formula2>\" + (ESC(val.formula2)) + \"</formula2>\") : '') + \"\\n         </dataValidation>\"); })) + \"\\n     </dataValidations>\") : '') + \"\\n\\n   \" + (hyperlinks.length ? (\"\\n     <hyperlinks>\\n       \" + (foreach(hyperlinks, function (link) { return (\"\\n         <hyperlink ref=\\\"\" + (link.ref) + \"\\\" r:id=\\\"\" + (link.rId) + \"\\\"/>\"); })) + \"\\n     </hyperlinks>\") : '') + \"\\n\\n   <pageMargins left=\\\"0.7\\\" right=\\\"0.7\\\" top=\\\"0.75\\\" bottom=\\\"0.75\\\" header=\\\"0.3\\\" footer=\\\"0.3\\\" />\\n   \" + (drawing ? (\"<drawing r:id=\\\"\" + drawing + \"\\\"/>\") : '') + \"\\n   \" + (legacyDrawing ? (\"<legacyDrawing r:id=\\\"\" + legacyDrawing + \"\\\"/>\") : '') + \"\\n</worksheet>\");\n  };\n\n  var WORKBOOK_RELS = function (ref) {\n    var count = ref.count;\n\n    return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (repeat(count, function (idx) { return (\"\\n    <Relationship Id=\\\"rId\" + (idx + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\\\" Target=\\\"worksheets/sheet\" + (idx + 1) + \".xml\\\" />\"); })) + \"\\n  <Relationship Id=\\\"rId\" + (count + 1) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\\\" Target=\\\"styles.xml\\\" />\\n  <Relationship Id=\\\"rId\" + (count + 2) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\\\" Target=\\\"sharedStrings.xml\\\" />\\n</Relationships>\");\n  };\n\n  var WORKSHEET_RELS = function (ref) {\n    var hyperlinks = ref.hyperlinks;\n    var comments = ref.comments;\n    var sheetIndex = ref.sheetIndex;\n    var drawings = ref.drawings;\n\n    return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(hyperlinks, function (link) { return (\"\\n    <Relationship Id=\\\"\" + (link.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\\\" Target=\\\"\" + (ESC(link.target)) + \"\\\" TargetMode=\\\"External\\\" />\"); })) + \"\\n  \" + (!comments.length ? '' : (\"\\n    <Relationship Id=\\\"comment\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\\\" Target=\\\"../comments\" + sheetIndex + \".xml\\\"/>\\n    <Relationship Id=\\\"vml\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\\\" Target=\\\"../drawings/vmlDrawing\" + sheetIndex + \".vml\\\"/>\")) + \"\\n  \" + (!drawings.length ? '' : (\"\\n    <Relationship Id=\\\"drw\" + sheetIndex + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\\\" Target=\\\"../drawings/drawing\" + sheetIndex + \".xml\\\"/>\")) + \"\\n</Relationships>\");\n  };\n\n  var COMMENTS_XML = function (ref) {\n    var comments = ref.comments;\n\n    return (XMLHEAD + \"\\n<comments xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\">\\n  <authors>\\n    <author></author>\\n  </authors>\\n  <commentList>\\n    \" + (foreach(comments, function (comment) { return (\"\\n      <comment ref=\\\"\" + (comment.ref) + \"\\\" authorId=\\\"0\\\">\\n        <text>\\n          <r>\\n            <rPr>\\n              <sz val=\\\"8\\\"/>\\n              <color indexed=\\\"81\\\"/>\\n              <rFont val=\\\"Tahoma\\\"/>\\n              <charset val=\\\"1\\\"/>\\n            </rPr>\\n            <t>\" + (ESC(comment.text)) + \"</t>\\n          </r>\\n        </text>\\n      </comment>\"); })) + \"\\n  </commentList>\\n</comments>\");\n  };\n\n  var LEGACY_DRAWING = function (ref) {\n    var comments = ref.comments;\n\n    return (\"<xml xmlns:v=\\\"urn:schemas-microsoft-com:vml\\\"\\n     xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\"\\n     xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\">\\n  <v:shapetype coordsize=\\\"21600,21600\\\" id=\\\"_x0000_t202\\\" path=\\\"m,l,21600r21600,l21600,xe\\\">\\n    <v:stroke joinstyle=\\\"miter\\\"/>\\n    <v:path gradientshapeok=\\\"t\\\" o:connecttype=\\\"rect\\\"/>\\n  </v:shapetype>\\n  \" + (foreach(comments, function (comment) { return (\"\\n    <v:shape type=\\\"#_x0000_t202\\\" style=\\\"visibility: hidden\\\" fillcolor=\\\"#ffffe1\\\" o:insetmode=\\\"auto\\\">\\n      <v:shadow on=\\\"t\\\" color=\\\"black\\\" obscured=\\\"t\\\"/>\\n      <x:ClientData ObjectType=\\\"Note\\\">\\n        <x:MoveWithCells/>\\n        <x:SizeWithCells/>\\n        <x:Anchor>\" + (comment.anchor) + \"</x:Anchor>\\n        <x:AutoFill>False</x:AutoFill>\\n        <x:Row>\" + (comment.row) + \"</x:Row>\\n        <x:Column>\" + (comment.col) + \"</x:Column>\\n      </x:ClientData>\\n    </v:shape>\"); })) + \"\\n</xml>\");\n  };\n\n  var DRAWINGS_XML = function (drawings) { return (XMLHEAD + \"\\n<xdr:wsDr xmlns:xdr=\\\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\\\"\\n          xmlns:a=\\\"http://schemas.openxmlformats.org/drawingml/2006/main\\\"\\n          xmlns:r=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\\\">\\n  \" + (foreach(drawings, function (drawing, index) { return (\"\\n    <xdr:oneCellAnchor editAs=\\\"oneCell\\\">\\n      <xdr:from>\\n        <xdr:col>\" + (drawing.col) + \"</xdr:col>\\n        <xdr:colOff>\" + (drawing.colOffset) + \"</xdr:colOff>\\n        <xdr:row>\" + (drawing.row) + \"</xdr:row>\\n        <xdr:rowOff>\" + (drawing.rowOffset) + \"</xdr:rowOff>\\n      </xdr:from>\\n      <xdr:ext cx=\\\"\" + (drawing.width) + \"\\\" cy=\\\"\" + (drawing.height) + \"\\\" />\\n      <xdr:pic>\\n        <xdr:nvPicPr>\\n          <xdr:cNvPr id=\\\"\" + (index + 1) + \"\\\" name=\\\"Picture \" + (index + 1) + \"\\\"/>\\n          <xdr:cNvPicPr/>\\n        </xdr:nvPicPr>\\n        <xdr:blipFill>\\n          <a:blip r:embed=\\\"\" + (drawing.imageId) + \"\\\"/>\\n          <a:stretch>\\n            <a:fillRect/>\\n          </a:stretch>\\n        </xdr:blipFill>\\n        <xdr:spPr>\\n          <a:prstGeom prst=\\\"rect\\\">\\n            <a:avLst/>\\n          </a:prstGeom>\\n        </xdr:spPr>\\n      </xdr:pic>\\n      <xdr:clientData/>\\n    </xdr:oneCellAnchor>\"); })) + \"\\n</xdr:wsDr>\"); };\n\n  var DRAWINGS_RELS_XML = function (rels) { return (XMLHEAD + \"\\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\\n  \" + (foreach(rels, function (rel) { return (\"\\n    <Relationship Id=\\\"\" + (rel.rId) + \"\\\" Type=\\\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\\\" Target=\\\"\" + (rel.target) + \"\\\"/>\"); })) + \"\\n</Relationships>\"); };\n\n  var SHARED_STRINGS = function (ref) {\n    var count = ref.count;\n    var uniqueCount = ref.uniqueCount;\n    var indexes = ref.indexes;\n\n    return (XMLHEAD + \"\\n<sst xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\" count=\\\"\" + count + \"\\\" uniqueCount=\\\"\" + uniqueCount + \"\\\">\\n  \" + (foreach(Object.keys(indexes), function (index) { return (\"\\n    <si><t xml:space=\\\"preserve\\\">\" + (ESC(index.substring(1))) + \"</t></si>\"); })) + \"\\n</sst>\");\n  };\n\n  var STYLES = function (ref) {\n    var formats = ref.formats;\n    var fonts = ref.fonts;\n    var fills = ref.fills;\n    var borders = ref.borders;\n    var styles = ref.styles;\n\n    return (XMLHEAD + \"\\n<styleSheet\\n    xmlns=\\\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\\\"\\n    xmlns:mc=\\\"http://schemas.openxmlformats.org/markup-compatibility/2006\\\"\\n    mc:Ignorable=\\\"x14ac\\\"\\n    xmlns:x14ac=\\\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\\\">\\n  <numFmts count=\\\"\" + (formats.length) + \"\\\">\\n  \" + (foreach(formats, function (format, fi) { return (\"\\n    <numFmt formatCode=\\\"\" + (ESC(format.format)) + \"\\\" numFmtId=\\\"\" + (165 + fi) + \"\\\" />\"); })) + \"\\n  </numFmts>\\n  <fonts count=\\\"\" + (fonts.length + 1) + \"\\\" x14ac:knownFonts=\\\"1\\\">\\n    <font>\\n       <sz val=\\\"11\\\" />\\n       <color theme=\\\"1\\\" />\\n       <name val=\\\"Calibri\\\" />\\n       <family val=\\\"2\\\" />\\n       <scheme val=\\\"minor\\\" />\\n    </font>\\n    \" + (foreach(fonts, function (font) { return (\"\\n    <font>\\n      \" + (font.bold ? '<b/>' : '') + \"\\n      \" + (font.italic ? '<i/>' : '') + \"\\n      \" + (font.underline ? '<u/>' : '') + \"\\n      <sz val=\\\"\" + (font.fontSize || 11) + \"\\\" />\\n      \" + (font.color ? (\"<color rgb=\\\"\" + (ESC(font.color)) + \"\\\" />\") : '<color theme=\"1\" />') + \"\\n      \" + (font.fontFamily ? (\"\\n        <name val=\\\"\" + (ESC(font.fontFamily)) + \"\\\" />\\n        <family val=\\\"2\\\" />\\n      \") : \"\\n        <name val=\\\"Calibri\\\" />\\n        <family val=\\\"2\\\" />\\n        <scheme val=\\\"minor\\\" />\\n      \") + \"\\n    </font>\"); })) + \"\\n  </fonts>\\n  <fills count=\\\"\" + (fills.length + 2) + \"\\\">\\n      <fill><patternFill patternType=\\\"none\\\"/></fill>\\n      <fill><patternFill patternType=\\\"gray125\\\"/></fill>\\n    \" + (foreach(fills, function (fill) { return (\"\\n      \" + (fill.background ? (\"\\n        <fill>\\n          <patternFill patternType=\\\"solid\\\">\\n              <fgColor rgb=\\\"\" + (ESC(fill.background)) + \"\\\"/>\\n          </patternFill>\\n        </fill>\\n      \") : '')); })) + \"\\n  </fills>\\n  <borders count=\\\"\" + (borders.length + 1) + \"\\\">\\n    <border><left/><right/><top/><bottom/><diagonal/></border>\\n    \" + (foreach(borders, borderTemplate)) + \"\\n  </borders>\\n  <cellStyleXfs count=\\\"1\\\">\\n    <xf borderId=\\\"0\\\" fillId=\\\"0\\\" fontId=\\\"0\\\" />\\n  </cellStyleXfs>\\n  <cellXfs count=\\\"\" + (styles.length + 1) + \"\\\">\\n    <xf numFmtId=\\\"0\\\" fontId=\\\"0\\\" fillId=\\\"0\\\" borderId=\\\"0\\\" xfId=\\\"0\\\" />\\n    \" + (foreach(styles, function (style) { return (\"\\n      <xf xfId=\\\"0\\\"\\n          \" + (style.fontId ? (\"fontId=\\\"\" + (style.fontId) + \"\\\" applyFont=\\\"1\\\"\") : '') + \"\\n          \" + (style.fillId ? (\"fillId=\\\"\" + (style.fillId) + \"\\\" applyFill=\\\"1\\\"\") : '') + \"\\n          \" + (style.numFmtId ? (\"numFmtId=\\\"\" + (style.numFmtId) + \"\\\" applyNumberFormat=\\\"1\\\"\") : '') + \"\\n          \" + (style.textAlign || style.verticalAlign || style.wrap ? 'applyAlignment=\"1\"' : '') + \"\\n          \" + (style.borderId ? (\"borderId=\\\"\" + (style.borderId) + \"\\\" applyBorder=\\\"1\\\"\") : '') + \"\\n          \" + (style.disabled != null ? \"applyProtection=\\\"1\\\"\" : '') + \">\\n        \" + (style.textAlign || style.verticalAlign || style.wrap ? (\"\\n        <alignment\\n          \" + (style.textAlign ? (\"horizontal=\\\"\" + (ESC(style.textAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.verticalAlign ? (\"vertical=\\\"\" + (ESC(style.verticalAlign)) + \"\\\"\") : '') + \"\\n          \" + (style.indent ? (\"indent=\\\"\" + (ESC(style.indent)) + \"\\\"\") : '') + \"\\n          \" + (style.wrap ? 'wrapText=\"1\"' : '') + \" />\\n        \") : '') + \"\\n        \" + (style.disabled != null ? (\"\\n        <protection locked=\\\"\" + (style.disabled ? 1 : 0) + \"\\\" />\\n        \") : '') + \"\\n      </xf>\\n    \"); })) + \"\\n  </cellXfs>\\n  <cellStyles count=\\\"1\\\">\\n    <cellStyle name=\\\"Normal\\\" xfId=\\\"0\\\" builtinId=\\\"0\\\"/>\\n  </cellStyles>\\n  <dxfs count=\\\"0\\\" />\\n  <tableStyles count=\\\"0\\\" defaultTableStyle=\\\"TableStyleMedium2\\\" defaultPivotStyle=\\\"PivotStyleMedium9\\\" />\\n</styleSheet>\");\n  };\n\n  function writeFormula(formula) {\n      if (typeof formula == \"string\") {\n          return (\"<f>\" + (ESC(formula)) + \"</f>\");\n      }\n      // array formulas\n      return (\"<f t=\\\"array\\\" ref=\\\"\" + (formula.ref) + \"\\\">\" + (ESC(formula.src)) + \"</f>\");\n  }\n\n  function numChar(colIndex) {\n     var letter = Math.floor(colIndex / 26) - 1;\n\n     return (letter >= 0 ? numChar(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n  }\n\n  function ref(rowIndex, colIndex) {\n      return numChar(colIndex) + (rowIndex + 1);\n  }\n\n  function $ref(rowIndex, colIndex) {\n      return \"$\" + numChar(colIndex) + \"$\" + (rowIndex + 1);\n  }\n\n  function filterRowIndex(options) {\n      var frozenRows = options.frozenRows || (options.freezePane || {}).rowSplit || 1;\n      return frozenRows - 1;\n  }\n\n  function toWidth(px) {\n      var maximumDigitWidth = 7;\n      return (px / maximumDigitWidth) - (Math.floor(128 / maximumDigitWidth) / 256);\n  }\n\n  function toHeight(px) {\n      return px * 0.75;\n  }\n\n  function stripFunnyChars(value) {\n      return String(value)\n          .replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F]/g, \"\") // leave CRLF in\n          .replace(/\\r?\\n/g, \"\\r\\n\");                   // make sure LF is preceded by CR\n  }\n\n  var Worksheet = function Worksheet(options, sharedStrings, styles, borders) {\n        this.options = options;\n        this._strings = sharedStrings;\n        this._styles = styles;\n        this._borders = borders;\n        this._validations = {};\n        this._comments = [];\n        this._drawings = options.drawings || [];\n        this._hyperlinks = (this.options.hyperlinks || []).map(\n            function (link, i) { return Object.assign({}, link, { rId: (\"link\" + i) }); });\n    };\n\n    Worksheet.prototype.relsToXML = function relsToXML () {\n        var hyperlinks = this._hyperlinks;\n        var comments = this._comments;\n        var drawings = this._drawings;\n\n        if (hyperlinks.length || comments.length || drawings.length) {\n            return WORKSHEET_RELS({\n                hyperlinks : hyperlinks,\n                comments : comments,\n                sheetIndex : this.options.sheetIndex,\n                drawings : drawings\n            });\n        }\n    };\n\n    Worksheet.prototype.toXML = function toXML (index) {\n          var this$1$1 = this;\n\n        var mergeCells = this.options.mergedCells || [];\n        var rows = this.options.rows || [];\n        var data = inflate(rows, mergeCells);\n\n        this._readCells(data);\n\n        var autoFilter = this.options.filter;\n        var filter;\n        if (autoFilter && (typeof autoFilter.from === \"number\") && (typeof autoFilter.to === \"number\")) {\n            // Grid enables auto filter\n            autoFilter = {\n                from: ref(filterRowIndex(this.options), autoFilter.from),\n                to: ref(filterRowIndex(this.options), autoFilter.to)\n            };\n        } else if (autoFilter && autoFilter.ref && autoFilter.columns) {\n            // this is probably from the Spreadsheet\n            filter = autoFilter;\n            autoFilter = null;\n        }\n\n        var validations = [];\n        for (var i in this$1$1._validations) {\n            if (Object.prototype.hasOwnProperty.call(this$1$1._validations, i)) {\n                validations.push(this$1$1._validations[i]);\n            }\n        }\n\n        var defaultCellStyleId = null;\n        var defaultCellStyle = this.options.defaultCellStyle;\n        if (this._hasDisabledCells) {\n            if (!defaultCellStyle) {\n                defaultCellStyle = { disabled: false };\n            } else {\n                defaultCellStyle = Object.assign({ disabled: false }, defaultCellStyle);\n            }\n        }\n        if (defaultCellStyle) {\n            defaultCellStyleId = this._lookupStyle(defaultCellStyle);\n        }\n\n        var freezePane = this.options.freezePane || {};\n        var defaults = this.options.defaults || {};\n        var lastRow = this.options.rows ? this._getLastRow() : 1;\n        var lastCol = this.options.rows ? this._getLastCol() : 1;\n\n        return WORKSHEET({\n            frozenColumns: this.options.frozenColumns || freezePane.colSplit,\n            frozenRows: this.options.frozenRows || freezePane.rowSplit,\n            columns: this.options.columns,\n            defaults: defaults,\n            data: data,\n            index: index,\n            mergeCells: mergeCells,\n            autoFilter: autoFilter,\n            filter: filter,\n            showGridLines: this.options.showGridLines,\n            hyperlinks: this._hyperlinks,\n            validations: validations,\n            defaultCellStyleId: defaultCellStyleId,\n            rtl: this.options.rtl !== undefined ? this.options.rtl : defaults.rtl,\n            legacyDrawing: this._comments.length ? (\"vml\" + (this.options.sheetIndex)) : null,\n            drawing: this._drawings.length ? (\"drw\" + (this.options.sheetIndex)) : null,\n            lastRow: lastRow,\n            lastCol: lastCol,\n            hasDisabledCells: this._hasDisabledCells,\n        });\n    };\n\n    Worksheet.prototype.commentsXML = function commentsXML () {\n        if (this._comments.length) {\n            return COMMENTS_XML({ comments: this._comments });\n        }\n    };\n\n    Worksheet.prototype.drawingsXML = function drawingsXML (images) {\n        if (this._drawings.length) {\n            var rels = {};\n            var main = this._drawings.map(function (drw) {\n                var ref = parseRef(drw.topLeftCell);\n                var img = rels[drw.image];\n                if (!img) {\n                    img = rels[drw.image] = {\n                        rId: (\"img\" + (drw.image)),\n                        target: images[drw.image].target\n                    };\n                }\n                return {\n                    col     : ref.col,\n                    colOffset : pixelsToExcel(drw.offsetX),\n                    row     : ref.row,\n                    rowOffset : pixelsToExcel(drw.offsetY),\n                    width   : pixelsToExcel(drw.width),\n                    height  : pixelsToExcel(drw.height),\n                    imageId : img.rId\n                };\n            });\n            return {\n                main: DRAWINGS_XML(main),\n                rels: DRAWINGS_RELS_XML(rels)\n            };\n        }\n    };\n\n    Worksheet.prototype.legacyDrawing = function legacyDrawing () {\n        if (this._comments.length) {\n            return LEGACY_DRAWING({ comments: this._comments });\n        }\n    };\n\n    Worksheet.prototype._lookupString = function _lookupString (value) {\n        var key = \"$\" + value;\n        var index = this._strings.indexes[key];\n        var result;\n\n        if (index !== undefined) {\n            result = index;\n        } else {\n            result = this._strings.indexes[key] = this._strings.uniqueCount;\n            this._strings.uniqueCount ++;\n        }\n\n        this._strings.count ++;\n\n        return result;\n    };\n\n    Worksheet.prototype._lookupStyle = function _lookupStyle (style) {\n        var json = JSON.stringify(style);\n\n        if (json === \"{}\") {\n            return 0;\n        }\n\n        var index = indexOf(json, this._styles);\n\n        if (index < 0) {\n            index = this._styles.push(json) - 1;\n        }\n\n        // There is one default style\n        return index + 1;\n    };\n\n    Worksheet.prototype._lookupBorder = function _lookupBorder (border) {\n        var json = JSON.stringify(border);\n        if (json === \"{}\") {\n            return;\n        }\n\n        var index = indexOf(json, this._borders);\n        if (index < 0) {\n            index = this._borders.push(json) - 1;\n        }\n\n        // There is one default border\n        return index + 1;\n    };\n\n    Worksheet.prototype._readCells = function _readCells (rowData) {\n          var this$1$1 = this;\n\n        for (var i = 0; i < rowData.length; i++) {\n            var row = rowData[i];\n            var cells = row.cells;\n\n            row.data = [];\n\n            for (var j = 0; j < cells.length; j++) {\n                var cellData = this$1$1._cell(cells[j], row.index, j);\n                if (cellData) {\n                    row.data.push(cellData);\n                }\n            }\n        }\n    };\n\n    Worksheet.prototype._cell = function _cell (data, rowIndex, cellIndex) {\n          var this$1$1 = this;\n\n        if (!data || data === EMPTY_CELL) {\n            return null;\n        }\n\n        var value = data.value;\n\n        var border = {};\n\n        if (data.borderLeft) {\n            border.left = data.borderLeft;\n        }\n\n        if (data.borderRight) {\n            border.right = data.borderRight;\n        }\n\n        if (data.borderTop) {\n            border.top = data.borderTop;\n        }\n\n        if (data.borderBottom) {\n            border.bottom = data.borderBottom;\n        }\n\n        if (data.dBorders) {\n            border.diagonal = data.dBorders;\n        }\n\n        border = this._lookupBorder(border);\n\n        var defStyle = this.options.defaultCellStyle || {};\n        var style = { borderId: border };\n\n        (function (add) {\n            add(\"color\");\n            add(\"background\");\n            add(\"bold\");\n            add(\"italic\");\n            add(\"underline\");\n            if (!add(\"fontFamily\")) { add(\"fontName\", \"fontFamily\"); }\n            add(\"fontSize\");\n            add(\"format\");\n            if (!add(\"textAlign\")) { add(\"hAlign\", \"textAlign\"); }\n            if (!add(\"verticalAlign\")) { add(\"vAlign\", \"verticalAlign\"); }\n            add(\"wrap\");\n            add(\"indent\");\n            if (!add(\"disabled\")) {\n                if (add(\"enable\")) {\n                    style.disabled = !style.enable;\n                    delete style.enable;\n                }\n            }\n            if (style.disabled) {\n                this$1$1._hasDisabledCells = true;\n            }\n        })(function (prop, target) {\n            var val = data[prop];\n            if (val === undefined) {\n                val = defStyle[prop];\n            }\n            if (val !== undefined) {\n                style[target || prop] = val;\n                return true;\n            }\n        });\n\n        var columns = this.options.columns || [];\n\n        var column = columns[cellIndex];\n        var type = typeof value;\n\n        if (column && column.autoWidth && (!data.colSpan || data.colSpan === 1)) {\n            var displayValue = value;\n\n            // XXX: let's not bring kendo.toString in only for this.\n            //    better wait until the spreadsheet engine is available as a separate\n            //    component, then we can use a real Excel-like formatter.\n            //\n            if (type === \"number\") {\n                // kendo.toString will not behave exactly like the Excel format\n                // Still, it's the best we have available for estimating the character count.\n                displayValue = IntlService.toString(value, data.format);\n            }\n\n            column.width = Math.max(column.width || 0, String(displayValue).length);\n        }\n\n        if (type === \"string\") {\n            value = stripFunnyChars(value);\n            value = this._lookupString(value);\n            type = \"s\";\n        } else if (type === \"number\") {\n            type = \"n\";\n        } else if (type === \"boolean\") {\n            type = \"b\";\n            value = Number(value);\n        } else if (value && value.getTime) {\n            type = null;\n            value = dateToSerial(value);\n            if (!style.format) {\n                style.format = \"mm-dd-yy\";\n            }\n        } else {\n            type = null;\n            value = null;\n        }\n\n        style = this._lookupStyle(style);\n\n        var cellName = ref(rowIndex, cellIndex);\n\n        if (data.validation) {\n            this._addValidation(data.validation, cellName);\n        }\n\n        if (data.comment) {\n            var anchor = [\n                cellIndex + 1,// start column\n                15,           // start column offset\n                rowIndex,     // start row\n                10,           // start row offset\n                cellIndex + 3,// end column\n                15,           // end column offset\n                rowIndex + 3, // end row\n                4             // end row offset\n            ];\n            this._comments.push({\n                ref  : cellName,\n                text : data.comment,\n                row  : rowIndex,\n                col  : cellIndex,\n                anchor : anchor.join(\", \")\n            });\n        }\n\n        return {\n            value: value,\n            formula: data.formula,\n            type: type,\n            style: style,\n            ref: cellName\n        };\n    };\n\n    Worksheet.prototype._addValidation = function _addValidation (v, ref) {\n        var tmp = {\n            showErrorMessage : v.type === \"reject\" ? 1 : 0,\n            formula1       : v.from,\n            formula2       : v.to,\n            type           : MAP_EXCEL_TYPE[v.dataType] || v.dataType,\n            operator       : MAP_EXCEL_OPERATOR[v.comparerType] || v.comparerType,\n            allowBlank     : v.allowNulls ? 1 : 0,\n            showDropDown   : v.showButton ? 0 : 1, // LOL, Excel!\n            error          : v.messageTemplate,\n            errorTitle     : v.titleTemplate\n        };\n        var json = JSON.stringify(tmp);\n        if (!this._validations[json]) {\n            this._validations[json] = tmp;\n            tmp.sqref = [];\n        }\n        this._validations[json].sqref.push(ref);\n    };\n\n    Worksheet.prototype._getLastRow = function _getLastRow () {\n        return countData(this.options.rows);\n    };\n\n    Worksheet.prototype._getLastCol = function _getLastCol () {\n        var last = 0;\n        this.options.rows.forEach(function(row) {\n            if (row.cells) {\n                last = Math.max(last, countData(row.cells));\n            }\n        });\n        return last;\n    };\n\n  function countData(data) {\n      var last = data.length;\n      data.forEach(function(el) {\n          if (el.index && el.index >= last) {\n              last = el.index + 1;\n          }\n      });\n      return last;\n  }\n\n  var MAP_EXCEL_OPERATOR = {\n      // includes only what differs; key is our operator, value is Excel\n      // operator.\n      greaterThanOrEqualTo : \"greaterThanOrEqual\",\n      lessThanOrEqualTo    : \"lessThanOrEqual\"\n  };\n\n  var MAP_EXCEL_TYPE = {\n      // eslint-disable-next-line id-denylist\n      number: \"decimal\"\n  };\n\n  var defaultFormats = {\n      \"General\": 0,\n      \"0\": 1,\n      \"0.00\": 2,\n      \"#,##0\": 3,\n      \"#,##0.00\": 4,\n      \"0%\": 9,\n      \"0.00%\": 10,\n      \"0.00E+00\": 11,\n      \"# ?/?\": 12,\n      \"# ??/??\": 13,\n      \"mm-dd-yy\": 14,\n      \"d-mmm-yy\": 15,\n      \"d-mmm\": 16,\n      \"mmm-yy\": 17,\n      \"h:mm AM/PM\": 18,\n      \"h:mm:ss AM/PM\": 19,\n      \"h:mm\": 20,\n      \"h:mm:ss\": 21,\n      \"m/d/yy h:mm\": 22,\n      \"#,##0 ;(#,##0)\": 37,\n      \"#,##0 ;[Red](#,##0)\": 38,\n      \"#,##0.00;(#,##0.00)\": 39,\n      \"#,##0.00;[Red](#,##0.00)\": 40,\n      \"mm:ss\": 45,\n      \"[h]:mm:ss\": 46,\n      \"mmss.0\": 47,\n      \"##0.0E+0\": 48,\n      \"@\": 49,\n      \"[$-404]e/m/d\": 27,\n      \"m/d/yy\": 30,\n      \"t0\": 59,\n      \"t0.00\": 60,\n      \"t#,##0\": 61,\n      \"t#,##0.00\": 62,\n      \"t0%\": 67,\n      \"t0.00%\": 68,\n      \"t# ?/?\": 69,\n      \"t# ??/??\": 70\n  };\n\n  function maybeRGB(value) {\n      function hex(val) {\n          var x = parseInt(val, 10).toString(16);\n          return x.length < 2 ? \"0\" + x : x;\n      }\n\n      var m = /^rgba?\\((\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*([0-9.]+)\\s*)?\\)/i.exec(value.trim());\n      if (m) {\n          var opacity = (m[4] ? parseFloat(m[4]) : 1) * 255 | 0;\n          return \"#\" + hex(opacity) + hex(m[1]) + hex(m[2]) + hex(m[3]);\n      }\n      return value;\n  }\n\n  function convertColor(value) {\n      var color = maybeRGB(value);\n      if (color.length < 6) {\n          color = color.replace(/(\\w)/g, function($0, $1) {\n              return $1 + $1;\n          });\n      }\n\n      color = color.substring(1).toUpperCase();\n\n      if (color.length < 8) {\n          color = \"FF\" + color;\n      }\n\n      return color;\n  }\n\n  var Workbook = function Workbook(options) {\n        var this$1$1 = this;\n\n        this.options = options || {};\n        this._strings = {\n            indexes: {},\n            count: 0,\n            uniqueCount: 0\n        };\n        this._styles = [];\n        this._borders = [];\n        this._images = this.options.images;\n        this._imgId = 0;\n\n        this._sheets = map(this.options.sheets || [], function (options, i) {\n            options.defaults = this$1$1.options;\n            options.sheetIndex = i + 1;\n            return new Worksheet(options, this$1$1._strings, this$1$1._styles, this$1$1._borders);\n        });\n    };\n\n    Workbook.prototype.imageFilename = function imageFilename (mimeType) {\n        var id = ++this._imgId;\n        switch (mimeType) {\n          case \"image/jpg\":\n          case \"image/jpeg\":\n            return (\"image\" + id + \".jpg\");\n          case \"image/png\":\n            return (\"image\" + id + \".png\");\n          case \"image/gif\":\n            return (\"image\" + id + \".gif\");\n          default:\n            return (\"image\" + id + \".bin\"); // XXX: anything better to do here?\n        }\n    };\n\n    Workbook.prototype.toZIP = function toZIP () {\n          var this$1$1 = this;\n\n        var zip = createZip();\n\n        var docProps = zip.folder(\"docProps\");\n\n        docProps.file(\"core.xml\", CORE({\n            creator: this.options.creator || \"Kendo UI\",\n            lastModifiedBy: this.options.creator || \"Kendo UI\",\n            created: this.options.date || new Date().toJSON(),\n            modified: this.options.date || new Date().toJSON()\n        }));\n\n        var sheetCount = this._sheets.length;\n\n        docProps.file(\"app.xml\", APP({ sheets: this._sheets }));\n\n        var rels = zip.folder(\"_rels\");\n        rels.file(\".rels\", RELS);\n\n        var xl = zip.folder(\"xl\");\n\n        var xlRels = xl.folder(\"_rels\");\n        xlRels.file(\"workbook.xml.rels\", WORKBOOK_RELS({ count: sheetCount }));\n\n        if (this._images) {\n            var media = xl.folder(\"media\");\n            Object.keys(this._images).forEach(function (id) {\n                var img = this$1$1._images[id];\n                var filename = this$1$1.imageFilename(img.type);\n                media.file(filename, img.data);\n                img.target = \"../media/\" + filename;\n            });\n        }\n\n        var sheetIds = {};\n        xl.file(\"workbook.xml\", WORKBOOK({\n            sheets: this._sheets,\n            filterNames: map(this._sheets, function(sheet, index) {\n                var options = sheet.options;\n                var sheetName = (options.name || options.title || \"Sheet\" + (index + 1));\n                sheetIds[sheetName.toLowerCase()] = index;\n                var filter = options.filter;\n                if (filter) {\n                    if (filter.ref) {\n                        // spreadsheet provides `ref`\n                        var a = filter.ref.split(\":\");\n                        var from = parseRef(a[0]);\n                        var to = parseRef(a[1]);\n                        return {\n                            localSheetId: index,\n                            name: sheetName,\n                            from: $ref(from.row, from.col),\n                            to: $ref(to.row, to.col)\n                        };\n                    } else if (typeof filter.from !== \"undefined\" && typeof filter.to !== \"undefined\") {\n                        // grid does this\n                        return {\n                            localSheetId: index,\n                            name: sheetName,\n                            from: $ref(filterRowIndex(options), filter.from),\n                            to: $ref(filterRowIndex(options), filter.to)\n                        };\n                    }\n                }\n            }),\n            userNames: map(this.options.names || [], function(def) {\n                return {\n                    name: def.localName,\n                    localSheetId: def.sheet ? sheetIds[def.sheet.toLowerCase()] : null,\n                    value: def.value,\n                    hidden: def.hidden\n                };\n            })\n        }));\n\n        var worksheets = xl.folder(\"worksheets\");\n        var drawings = xl.folder(\"drawings\");\n        var drawingsRels = drawings.folder(\"_rels\");\n        var sheetRels = worksheets.folder(\"_rels\");\n        var commentFiles = [];\n        var drawingFiles = [];\n\n        for (var idx = 0; idx < sheetCount; idx++) {\n            var sheet = this$1$1._sheets[idx];\n            var sheetName = \"sheet\" + (idx + 1) + \".xml\";\n            var sheetXML = sheet.toXML(idx); // must be called before relsToXML\n            var relsXML = sheet.relsToXML();\n            var commentsXML = sheet.commentsXML();\n            var legacyDrawing = sheet.legacyDrawing();\n            var drawingsXML = sheet.drawingsXML(this$1$1._images);\n\n            if (relsXML) {\n                sheetRels.file(sheetName + \".rels\", relsXML);\n            }\n            if (commentsXML) {\n                var name = \"comments\" + (sheet.options.sheetIndex) + \".xml\";\n                xl.file(name, commentsXML);\n                commentFiles.push(name);\n            }\n            if (legacyDrawing) {\n                drawings.file((\"vmlDrawing\" + (sheet.options.sheetIndex) + \".vml\"), legacyDrawing);\n            }\n            if (drawingsXML) {\n                var name$1 = \"drawing\" + (sheet.options.sheetIndex) + \".xml\";\n                drawings.file(name$1, drawingsXML.main);\n                drawingsRels.file((name$1 + \".rels\"), drawingsXML.rels);\n                drawingFiles.push(name$1);\n            }\n\n            worksheets.file(sheetName, sheetXML);\n        }\n\n        var borders = map(this._borders, parseJSON);\n\n        var styles = map(this._styles, parseJSON);\n\n        var hasFont = function(style) {\n            return style.underline || style.bold || style.italic || style.color || style.fontFamily || style.fontSize;\n        };\n\n        var convertFontSize = function(value) {\n            var fontInPx = Number(value);\n            var fontInPt;\n\n            if (fontInPx) {\n                fontInPt = fontInPx * 3 / 4;\n            }\n\n            return fontInPt;\n        };\n\n        var fonts = map(styles, function(style) {\n            if (style.fontSize) {\n                style.fontSize = convertFontSize(style.fontSize);\n            }\n\n            if (style.color) {\n                style.color = convertColor(style.color);\n            }\n\n            if (hasFont(style)) {\n                return style;\n            }\n        });\n\n        var formats = map(styles, function(style) {\n            if (style.format && defaultFormats[style.format] === undefined) {\n                return style;\n            }\n        });\n\n        var fills = map(styles, function(style) {\n            if (style.background) {\n                style.background = convertColor(style.background);\n                return style;\n            }\n        });\n\n        xl.file(\"styles.xml\", STYLES({\n            fonts: fonts,\n            fills: fills,\n            formats: formats,\n            borders: borders,\n            styles: map(styles, function(style) {\n                var result = {};\n\n                if (hasFont(style)) {\n                    result.fontId = indexOf(style, fonts) + 1;\n                }\n\n                if (style.background) {\n                    result.fillId = indexOf(style, fills) + 2;\n                }\n\n                result.textAlign = style.textAlign;\n                result.indent = style.indent;\n                result.verticalAlign = style.verticalAlign;\n                result.wrap = style.wrap;\n                result.borderId = style.borderId;\n\n                if (style.format) {\n                    if (defaultFormats[style.format] !== undefined) {\n                        result.numFmtId = defaultFormats[style.format];\n                    } else {\n                        result.numFmtId = 165 + indexOf(style, formats);\n                    }\n                }\n\n                if (style.disabled != null) {\n                    result.disabled = style.disabled;\n                }\n\n                return result;\n            })\n        }));\n\n        xl.file(\"sharedStrings.xml\", SHARED_STRINGS(this._strings));\n\n        zip.file(\"[Content_Types].xml\", CONTENT_TYPES({\n            sheetCount: sheetCount,\n            commentFiles: commentFiles,\n            drawingFiles: drawingFiles\n        }));\n\n        return zip;\n    };\n\n    Workbook.prototype.toDataURL = function toDataURL () {\n        var zip = this.toZIP();\n\n        return zip.generateAsync ? zip.generateAsync(DATA_URL_OPTIONS).then(toDataURI) : toDataURI(zip.generate(DATA_URL_OPTIONS));\n    };\n\n    Workbook.prototype.toBlob = function toBlob () {\n        var zip = this.toZIP();\n        if (zip.generateAsync) {\n            return zip.generateAsync(BLOB_OPTIONS);\n        }\n        return new Blob([ zip.generate(ARRAYBUFFER_OPTIONS) ], { type: MIME_TYPE });\n    };\n\n  function borderStyle(width) {\n      var alias = \"thin\";\n\n      if (width === 2) {\n          alias = \"medium\";\n      } else if (width === 3) {\n          alias = \"thick\";\n      }\n\n      return alias;\n  }\n\n  function borderSideTemplate(name, style) {\n      var result = \"\";\n\n      if (style) {\n          result += \"<\" + name + \" style=\\\"\" + borderStyle(style.size) + \"\\\">\";\n          if (style.color) {\n              result += \"<color rgb=\\\"\" + convertColor(style.color) + \"\\\"/>\";\n          }\n          result += \"</\" + name + \">\";\n      }\n\n      return result;\n  }\n\n  function borderTemplate(border) {\n      var diag = border.diagonal ? border.diagonal.type : 0;\n      return (\"<border \" + (diag & 2 ? 'diagonalUp=\"true\"' : '') + \" \" + (diag & 1 ? 'diagonalDown=\"true\"' : '') + \">\\n      \" + (borderSideTemplate(\"left\", border.left)) + \"\\n      \" + (borderSideTemplate(\"right\", border.right)) + \"\\n      \" + (borderSideTemplate(\"top\", border.top)) + \"\\n      \" + (borderSideTemplate(\"bottom\", border.bottom)) + \"\\n      \" + (borderSideTemplate(\"diagonal\", border.diagonal)) + \"\\n    </border>\");\n  }\n\n  var EMPTY_CELL = {};\n  function inflate(rows, mergedCells) {\n      var rowData = [];\n      var rowsByIndex = [];\n\n      indexRows(rows, function(row, index) {\n          var data = {\n              _source: row,\n              index: index,\n              height: row.height,\n              level: row.level,\n              cells: []\n          };\n\n          rowData.push(data);\n          rowsByIndex[index] = data;\n      });\n\n      var sorted = sortByIndex(rowData).slice(0);\n      var ctx = {\n          rowData: rowData,\n          rowsByIndex: rowsByIndex,\n          mergedCells: mergedCells\n      };\n\n      for (var i = 0; i < sorted.length; i++) {\n          fillCells(sorted[i], ctx);\n          delete sorted[i]._source;\n      }\n\n      return sortByIndex(rowData);\n  }\n\n  function indexRows(rows, callback) {\n      for (var i = 0; i < rows.length; i++) {\n          var row = rows[i];\n          if (!row) {\n              continue;\n          }\n\n          var index = row.index;\n          if (typeof index !== \"number\") {\n              index = i;\n          }\n\n          callback(row, index);\n      }\n  }\n\n  function sortByIndex(items) {\n      return items.sort(function(a, b) {\n          return a.index - b.index;\n      });\n  }\n\n  function pushUnique(array, el) {\n      if (array.indexOf(el) < 0) {\n          array.push(el);\n      }\n  }\n\n  function getSpan(mergedCells, ref) {\n      for (var i = 0; i < mergedCells.length; ++i) {\n          var range = mergedCells[i];\n          var a = range.split(\":\");\n          var topLeft = a[0];\n          if (topLeft === ref) {\n              var bottomRight = a[1];\n              topLeft = parseRef(topLeft);\n              bottomRight = parseRef(bottomRight);\n              return {\n                  rowSpan: bottomRight.row - topLeft.row + 1,\n                  colSpan: bottomRight.col - topLeft.col + 1\n              };\n          }\n      }\n  }\n\n  function parseRef(ref) {\n      function getcol(str) {\n          var upperStr = str.toUpperCase();\n          var col = 0;\n          for (var i = 0; i < upperStr.length; ++i) {\n              col = col * 26 + upperStr.charCodeAt(i) - 64;\n          }\n          return col - 1;\n      }\n\n      function getrow(str) {\n          return parseInt(str, 10) - 1;\n      }\n\n      var m = /^([a-z]+)(\\d+)$/i.exec(ref);\n      return {\n          row: getrow(m[2]),\n          col: getcol(m[1])\n      };\n  }\n\n  function pixelsToExcel(px) {\n      return Math.round(px * 9525);\n  }\n\n  function fillCells(data, ctx) {\n      var row = data._source;\n      var rowIndex = data.index;\n      var cells = row.cells;\n      var cellData = data.cells;\n\n      if (!cells) {\n          return;\n      }\n\n      for (var i = 0; i < cells.length; i++) {\n          var cell = cells[i] || EMPTY_CELL;\n\n          var rowSpan = cell.rowSpan || 1;\n          var colSpan = cell.colSpan || 1;\n\n          var cellIndex = insertCell(cellData, cell);\n          var topLeftRef = ref(rowIndex, cellIndex);\n\n          if (rowSpan === 1 && colSpan === 1) {\n              // could still be merged: the spreadsheet does not send\n              // rowSpan/colSpan, but mergedCells is already populated.\n              // https://github.com/telerik/kendo-ui-core/issues/2401\n              var tmp = getSpan(ctx.mergedCells, topLeftRef);\n              if (tmp) {\n                  colSpan = tmp.colSpan;\n                  rowSpan = tmp.rowSpan;\n              }\n          }\n\n          spanCell(cell, cellData, cellIndex, colSpan);\n\n          if (rowSpan > 1 || colSpan > 1) {\n              pushUnique(ctx.mergedCells,\n                         topLeftRef + \":\" + ref(rowIndex + rowSpan - 1,\n                                                cellIndex + colSpan - 1));\n          }\n\n          if (rowSpan > 1) {\n              for (var ri = rowIndex + 1; ri < rowIndex + rowSpan; ri++) {\n                  var nextRow = ctx.rowsByIndex[ri];\n                  if (!nextRow) {\n                      nextRow = ctx.rowsByIndex[ri] = { index: ri, cells: [] };\n                      ctx.rowData.push(nextRow);\n                  }\n\n                  spanCell(cell, nextRow.cells, cellIndex - 1, colSpan + 1);\n              }\n          }\n      }\n  }\n\n  function insertCell(data, cell) {\n      var index;\n\n      if (typeof cell.index === \"number\") {\n          index = cell.index;\n          insertCellAt(data, cell, cell.index);\n      } else {\n          index = appendCell(data, cell);\n      }\n\n      return index;\n  }\n\n  function insertCellAt(data, cell, index) {\n      data[index] = cell;\n  }\n\n  function appendCell(data, cell) {\n      var index = data.length;\n\n      for (var i = 0; i < data.length + 1; i++) {\n          if (!data[i]) {\n              data[i] = cell;\n              index = i;\n              break;\n          }\n      }\n\n      return index;\n  }\n\n  function spanCell(cell, row, startIndex, colSpan) {\n      for (var i = 1; i < colSpan; i++) {\n          var tmp = {\n              borderTop    : cell.borderTop,\n              borderRight  : cell.borderRight,\n              borderBottom : cell.borderBottom,\n              borderLeft   : cell.borderLeft\n          };\n          insertCellAt(row, tmp, startIndex + i);\n      }\n  }\n\n  var SPREADSHEET_FILTERS = function (ref$1) {\n    var ref = ref$1.ref;\n    var columns = ref$1.columns;\n    var generators = ref$1.generators;\n\n    return (\"\\n<autoFilter ref=\\\"\" + ref + \"\\\">\\n  \" + (foreach(columns, function (col) { return (\"\\n    <filterColumn colId=\\\"\" + (col.index) + \"\\\">\\n      \" + (generators[col.filter](col)) + \"\\n    </filterColumn>\\n  \"); })) + \"\\n</autoFilter>\");\n  };\n\n  var SPREADSHEET_CUSTOM_FILTER = function (ref) {\n    var logic = ref.logic;\n    var criteria = ref.criteria;\n\n    return (\"\\n<customFilters \" + (logic === 'and' ? 'and=\"1\"' : '') + \">\\n\" + (foreach(criteria, function (f) {\n      var op = spreadsheetFilters.customOperator(f);\n      var val = spreadsheetFilters.customValue(f);\n      return (\"<customFilter \" + (op ? (\"operator=\\\"\" + op + \"\\\"\") : '') + \" val=\\\"\" + val + \"\\\"/>\");\n  })) + \"\\n</customFilters>\");\n  };\n\n  var SPREADSHEET_DYNAMIC_FILTER = function (ref) {\n    var type = ref.type;\n\n    return (\"<dynamicFilter type=\\\"\" + (spreadsheetFilters.dynamicFilterType(type)) + \"\\\" />\");\n  };\n\n  var SPREADSHEET_TOP_FILTER = function (ref) {\n    var type = ref.type;\n    var value = ref.value;\n\n    return (\"<top10 percent=\\\"\" + (/percent$/i.test(type) ? 1 : 0) + \"\\\"\\n       top=\\\"\" + (/^top/i.test(type) ? 1 : 0) + \"\\\"\\n       val=\\\"\" + value + \"\\\" />\");\n  };\n\n  var SPREADSHEET_VALUE_FILTER = function (ref) {\n      var blanks = ref.blanks;\n      var values = ref.values;\n\n      return (\"<filters \" + (blanks ? 'blank=\"1\"' : '') + \">\\n    \" + (foreach(values, function (value) { return (\"\\n      <filter val=\\\"\" + value + \"\\\" />\"); })) + \"\\n  </filters>\");\n  };\n\n  function spreadsheetFilters(filter) {\n      return SPREADSHEET_FILTERS({\n          ref: filter.ref,\n          columns: filter.columns,\n          generators: {\n              custom  : SPREADSHEET_CUSTOM_FILTER,\n              dynamic : SPREADSHEET_DYNAMIC_FILTER,\n              top     : SPREADSHEET_TOP_FILTER,\n              value   : SPREADSHEET_VALUE_FILTER\n          }\n      });\n  }\n\n  spreadsheetFilters.customOperator = function(f) {\n      return {\n          eq  : \"equal\",\n          gt  : \"greaterThan\",\n          gte : \"greaterThanOrEqual\",\n          lt  : \"lessThan\",\n          lte : \"lessThanOrEqual\",\n          ne  : \"notEqual\",\n\n          // These are not in the spec, but seems to be how Excel does\n          // it (see customValue below).  For the non-negated versions,\n          // the operator attribute is missing completely.\n          doesnotstartwith: \"notEqual\",\n          doesnotendwith: \"notEqual\",\n          doesnotcontain: \"notEqual\",\n          doesnotmatch: \"notEqual\"\n      }[f.operator.toLowerCase()];\n  };\n\n  function quoteSheet(name) {\n      if (/^\\'/.test(name)) { // assume already quoted, the Spreadsheet does it.\n          return name;\n      }\n      if (/^[a-z_][a-z0-9_]*$/i.test(name)) {\n          return name;        // no need to quote it\n      }\n      return \"'\" + name.replace(/\\x27/g, \"\\\\'\") + \"'\";\n  }\n\n  spreadsheetFilters.customValue = function(f) {\n      function esc(str) {\n          return str.replace(/([*?])/g, \"~$1\");\n      }\n\n      switch (f.operator.toLowerCase()) {\n          case \"startswith\":\n          case \"doesnotstartwith\":\n              return esc(f.value) + \"*\";\n\n          case \"endswith\":\n          case \"doesnotendwith\":\n              return \"*\" + esc(f.value);\n\n          case \"contains\":\n          case \"doesnotcontain\":\n              return \"*\" + esc(f.value) + \"*\";\n\n          default:\n              return f.value;\n      }\n  };\n\n  spreadsheetFilters.dynamicFilterType = function(type) {\n      return {\n          quarter1  : \"Q1\",\n          quarter2  : \"Q2\",\n          quarter3  : \"Q3\",\n          quarter4  : \"Q4\",\n          january   : \"M1\",\n          february  : \"M2\",\n          march     : \"M3\",\n          april     : \"M4\",\n          may       : \"M5\",\n          june      : \"M6\",\n          july      : \"M7\",\n          august    : \"M8\",\n          september : \"M9\",\n          october   : \"M10\",\n          november  : \"M11\",\n          december  : \"M12\"\n      }[type.toLowerCase()] || type;\n  };\n\n  exports.E = ExcelExporter;\n  exports.I = IntlService;\n  exports.T = TemplateService;\n  exports.W = Workbook;\n  exports.__meta__ = __meta__;\n  exports.a = Worksheet;\n\n}));\n"]}